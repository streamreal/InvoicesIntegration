<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="6/29/2020 12:20:10 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="ETP025"
  DTS:CreatorName="ELTRANSPLUS\andreydruzhinin"
  DTS:DTSID="{5C0B9BEF-53BE-4825-A5BD-39E46DE23A58}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.71"
  DTS:LocaleID="1049"
  DTS:ObjectName="Package3"
  DTS:PackageType="5"
  DTS:VersionBuild="155"
  DTS:VersionGUID="{E7412520-2789-43C1-BD3B-044D12B1665C}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{CD71CE9C-3DB4-46F5-9AD8-33749C6A35DF}"
      DTS:ObjectName="depth_months"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">1</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{1A2E678A-BC7C-4D8D-AEC8-03BF4B400642}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="depth_months">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Delete add roles"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{74FD6FC9-1405-49B5-8B47-9C035B459966}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Delete add roles"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="DELETE&#xA;FROM [motivation].[dbo].[ttr_workers]&#xA;WHERE role_type = 2" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload add roles"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{8874660C-BE88-46A6-9497-45C1F42E83B4}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload add roles"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="DECLARE @start [date] = CAST(DATEFROMPARTS(YEAR(DATEADD(MONTH, -2, GETDATE())), MONTH(DATEADD(MONTH, -2, GETDATE())), 1) AS datetime);&#xA;&#xA;WITH cte_search AS (&#xA;&#x9;SELECT &#xA;&#x9;DATEPART(YEAR, decision_date) AS ttr_id_year,&#xA;&#x9;DATEPART(MONTH, decision_date) AS ttr_id_month,&#xA;&#x9;[service_type_row] AS ttr_service,&#xA;&#x9;[assigned_ttr] AS ttr_assigned&#xA;&#x9;FROM [webproject].[dbo].[deals] d&#xA;&#x9;WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND decision_date &gt;= @start&#xA;&#x9;UNION&#xA;&#xA;&#x9;SELECT &#xA;&#x9;DATEPART(YEAR, req_calc_finish) AS ttr_id_year,&#xA;&#x9;DATEPART(MONTH, req_calc_finish) AS ttr_id_month,&#xA;&#x9;[service_type_row] AS ttr_service,&#xA;&#x9;[assigned_ttr] AS ttr_assigned&#xA;&#x9;FROM [webproject].[dbo].[deals] d&#xA;&#x9;WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND service_type_row IN ('ТО','ТЭО')&#xA;&#x9;AND req_calc_finish &gt;= @start AND req_calc_finish &lt;= GETDATE()&#xA;&#xA;&#x9;UNION&#xA;&#xA;&#x9;SELECT &#xA;&#x9;DATEPART(YEAR, calc_finish_date) AS ttr_id_year,&#xA;&#x9;DATEPART(MONTH, calc_finish_date) AS ttr_id_month,&#xA;&#x9;[service_type_row] AS ttr_service,&#xA;&#x9;[assigned_ttr] AS ttr_assigned&#xA;&#x9;FROM [webproject].[dbo].[calculation_deals] d&#xA;&#x9;WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND calc_finish_date &gt;= @start AND calc_finish_date &lt;= GETDATE()&#xA;&#xA;),&#xA;&#xA;cte_insert AS (&#xA;&#xA;SELECT &#xA;ttr_service AS [service],&#xA;ca.SalespersonName AS [name],&#xA;ttr_assigned AS [bitrix_name],&#xA;ca.SalespersonCode AS [code],&#xA;'ttr_specialist' AS [type],&#xA;NULL AS [schedule],&#xA;CAST(DATEFROMPARTS(ttr_id_year, ttr_id_month, 1) AS date) AS [date_begin],&#xA;CAST(EOMONTH(DATEFROMPARTS(ttr_id_year, ttr_id_month, 1)) AS date) AS [date_end],&#xA;'0' AS [is_archive],&#xA;'0' AS [estimate_participant],&#xA;'2' AS [role_type]&#xA;&#xA;FROM cte_search AS c&#xA;CROSS APPLY (SELECT TOP (1) * FROM [BI].[dwh].[ETP$Salesperson_Purchaser] AS sp WHERE sp.SalespersonName LIKE ttr_assigned + '%') AS ca&#xA;WHERE [Dept_ Code] &lt;&gt; 'УВОЛЕННЫЕ'&#xA;AND NOT EXISTS (&#xA;SELECT 0 FROM [motivation].[dbo].[ttr_workers] AS w&#xA;WHERE w.code = ca.SalespersonCode AND w.[role_type] = 1&#xA;AND CAST(DATEFROMPARTS(ttr_id_year, ttr_id_month, 15) AS date) &#xA;BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date))&#xA;)&#xA;)&#xA;&#xA;INSERT [motivation].[dbo].[ttr_workers]&#xA;([service]&#xA;      ,[name]&#xA;      ,[bitrix_name]&#xA;      ,[code]&#xA;      ,[type]&#xA;      ,[schedule]&#xA;      ,[date_begin]&#xA;      ,[date_end]&#xA;      ,[is_archive]&#xA;      ,[estimate_participant]&#xA;      ,[role_type])&#xA;SELECT [service]&#xA;      ,[name]&#xA;      ,[bitrix_name]&#xA;      ,[code]&#xA;      ,[type]&#xA;      ,[schedule]&#xA;      ,[date_begin]&#xA;      ,[date_end]&#xA;      ,[is_archive]&#xA;      ,[estimate_participant]&#xA;      ,[role_type]&#xA;&#x9;  FROM cte_insert&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload commissions"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:Disabled="True"
      DTS:DTSID="{17A25BAF-BF08-461E-8558-61D2203989DE}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload commissions"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"WITH cte_deals AS (
SELECT d.*
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS deals_rownum
,ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS distinct_deals_rownum
FROM [webproject].[dbo].[deals] AS d
),

cte_commission_data AS (
SELECT cd.* , d.*
,ROW_NUMBER() OVER (PARTITION BY cd_parent_deal_id, cd_service_type ORDER BY (SELECT NULL)) AS commission_rownum
FROM [webproject].[dbo].[commission_data] AS cd
JOIN cte_deals AS d
ON cd.cd_parent_deal_id = d.deal_id
AND cd.cd_service_type = d.service_type_row
AND d.deals_rownum = 1
),

cte_main AS (
SELECT
COALESCE(c1.[deal_id], c2.[deal_id]) AS [deal_id]
,COALESCE(c1.[service_type], c2.[service_type]) AS [service_type]
,COALESCE(c1.[client], c2.[client]) AS [client]
,COALESCE(c1.[client_type], c2.[client_type]) AS [client_type]
,COALESCE(c1.[service_type_row], c2.[service_type_row]) AS [service_type_row]

,c1.margin_fact AS old_margin_fact
,c1.[comission_date] AS old_commission_date
,c1.[delivery_number] AS old_delivery_number

,[cd_margin_fact] AS new_margin_fact
,[cd_delivery_number] AS new_delivery_number
,[cd_comission_date] AS new_commission_date

,c1.deals_rownum
,c1.distinct_deals_rownum
,c2.commission_rownum

,COUNT(commission_rownum) OVER (PARTITION BY COALESCE(c1.[deal_id], c2.[deal_id]), COALESCE(c1.[service_type_row], c2.[service_type_row])) AS prefiltered_commission_row_count

FROM
cte_deals AS c1 FULL JOIN cte_commission_data AS c2
ON c1.deal_id = c2.cd_parent_deal_id
AND c1.service_type_row = c2.cd_service_type
AND c1.deals_rownum = c2.commission_rownum
),

cte_merged AS (
SELECT
c.*
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_margin_fact] ELSE new_margin_fact END AS [margin_fact]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_commission_date] ELSE new_commission_date END AS [commission_date]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_delivery_number] ELSE new_delivery_number END AS [delivery_number]
FROM cte_main AS c
),

cte_partition AS (
SELECT
ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS deal_level_pointer
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS service_level_pointer
,COUNT(deals_rownum) OVER (PARTITION BY deal_id, service_type_row) AS deal_row_count
,COUNT(commission_rownum) OVER (PARTITION BY deal_id, service_type_row) AS commission_row_count
, c.*
, ca_delivery.close_date
FROM cte_merged AS c
OUTER APPLY (SELECT TOP (1) CASE WHEN [DRLLastFactDate] &gt;= '20200101' THEN [DRLLastFactDate] END AS close_date FROM [BI].[dwh].[ETP$SQL_Delivery] sd WHERE sd.No_ = c.delivery_number) AS ca_delivery
),

cte_sum AS (
	SELECT 	
	[deal_id]
    ,[service_type_row]  
    ,[client]
	,SUM(margin_fact) AS sum_margin_fact
	,close_date
	,MONTH(close_date) AS [close_month]
	,YEAR(close_date) AS [close_year]
	FROM cte_partition AS d	
	WHERE close_date IS NOT NULL AND [commission_date] &gt;= '20200101'
	AND 	
	(([commission_row_count] = 0 AND [service_level_pointer] = 1)
    OR
	([commission_row_count] &gt; 0 AND [commission_rownum] IS NOT NULL))
	GROUP BY
	[deal_id]
    ,[service_type_row]  
    ,[client]	
	,close_date
	,MONTH(close_date)
	,YEAR(close_date)
)

	SELECT 
	c.*, 
	ca.code,
	(sum_margin_fact / COUNT(*) OVER (PARTITION BY c.deal_id, c.service_type_row)) AS personal_margin
	FROM [webproject].[dbo].[deals] AS d
	JOIN cte_sum AS c ON d.deal_id = c.deal_id AND d.service_type_row = c.service_type_row
	CROSS APPLY (SELECT TOP (1) code FROM [motivation].[dbo].[ttr_workers] AS t WHERE t.bitrix_name = d.assigned_ttr) AS ca
	WHERE d.accept_cs = 'Y'
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR(close_date), MONTH(close_date), 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload commissions\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_deals AS (
SELECT d.*
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS deals_rownum
,ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS distinct_deals_rownum
FROM [webproject].[dbo].[deals] AS d
),

cte_commission_data AS (
SELECT cd.* , d.*
,ROW_NUMBER() OVER (PARTITION BY cd_parent_deal_id, cd_service_type ORDER BY (SELECT NULL)) AS commission_rownum
FROM [webproject].[dbo].[commission_data] AS cd
JOIN cte_deals AS d
ON cd.cd_parent_deal_id = d.deal_id
AND cd.cd_service_type = d.service_type_row
AND d.deals_rownum = 1
),

cte_main AS (
SELECT
COALESCE(c1.[deal_id], c2.[deal_id]) AS [deal_id]
,COALESCE(c1.[service_type], c2.[service_type]) AS [service_type]
,COALESCE(c1.[client], c2.[client]) AS [client]
,COALESCE(c1.[client_type], c2.[client_type]) AS [client_type]
,COALESCE(c1.[service_type_row], c2.[service_type_row]) AS [service_type_row]

,c1.margin_fact AS old_margin_fact
,c1.[comission_date] AS old_commission_date
,c1.[delivery_number] AS old_delivery_number

,[cd_margin_fact] AS new_margin_fact
,[cd_delivery_number] AS new_delivery_number
,[cd_comission_date] AS new_commission_date

,c1.deals_rownum
,c1.distinct_deals_rownum
,c2.commission_rownum

,COUNT(commission_rownum) OVER (PARTITION BY COALESCE(c1.[deal_id], c2.[deal_id]), COALESCE(c1.[service_type_row], c2.[service_type_row])) AS prefiltered_commission_row_count

FROM
cte_deals AS c1 FULL JOIN cte_commission_data AS c2
ON c1.deal_id = c2.cd_parent_deal_id
AND c1.service_type_row = c2.cd_service_type
AND c1.deals_rownum = c2.commission_rownum
),

cte_merged AS (
SELECT
c.*
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_margin_fact] ELSE new_margin_fact END AS [margin_fact]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_commission_date] ELSE new_commission_date END AS [commission_date]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_delivery_number] ELSE new_delivery_number END AS [delivery_number]
FROM cte_main AS c
),

cte_partition AS (
SELECT
ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS deal_level_pointer
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS service_level_pointer
,COUNT(deals_rownum) OVER (PARTITION BY deal_id, service_type_row) AS deal_row_count
,COUNT(commission_rownum) OVER (PARTITION BY deal_id, service_type_row) AS commission_row_count
, c.*
, ca_delivery.close_date
FROM cte_merged AS c
OUTER APPLY (SELECT TOP (1) CASE WHEN [DRLLastFactDate] &gt;= '20200101' THEN [DRLLastFactDate] END AS close_date FROM [BI].[dwh].[ETP$SQL_Delivery] sd WHERE sd.No_ = c.delivery_number) AS ca_delivery
),

cte_sum AS (
	SELECT 	
	[deal_id]
    ,[service_type_row]  
    ,[client]
	,SUM(margin_fact) AS sum_margin_fact
	,close_date
	,MONTH(close_date) AS [close_month]
	,YEAR(close_date) AS [close_year]
	FROM cte_partition AS d	
	WHERE close_date IS NOT NULL AND [commission_date] &gt;= '20200101'
	AND 	
	(([commission_row_count] = 0 AND [service_level_pointer] = 1)
    OR
	([commission_row_count] &gt; 0 AND [commission_rownum] IS NOT NULL))
	GROUP BY
	[deal_id]
    ,[service_type_row]  
    ,[client]	
	,close_date
	,MONTH(close_date)
	,YEAR(close_date)
)

	SELECT 
	c.*, 
	ca.code,
	(sum_margin_fact / COUNT(*) OVER (PARTITION BY c.deal_id, c.service_type_row)) AS personal_margin
	FROM [webproject].[dbo].[deals] AS d
	JOIN cte_sum AS c ON d.deal_id = c.deal_id AND d.service_type_row = c.service_type_row
	CROSS APPLY (SELECT TOP (1) code FROM [motivation].[dbo].[ttr_workers] AS t WHERE t.bitrix_name = d.assigned_ttr) AS ca
	WHERE d.accept_cs = 'Y'
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR(close_date), MONTH(close_date), 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload commissions\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      length="3"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      name="service_type_row"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[sum_margin_fact]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_margin_fact]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[sum_margin_fact]"
                      name="sum_margin_fact"
                      precision="38"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_date]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_date]"
                      name="close_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_month]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_month]"
                      name="close_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_year]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_year]"
                      name="close_year"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      length="10"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[personal_margin]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[personal_margin]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[personal_margin]"
                      name="personal_margin"
                      precision="38"
                      scale="6"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="3"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_margin_fact]"
                      dataType="numeric"
                      name="sum_margin_fact"
                      precision="38"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_date]"
                      dataType="dbTimeStamp"
                      name="close_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_month]"
                      dataType="i4"
                      name="close_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_year]"
                      dataType="i4"
                      name="close_year" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[personal_margin]"
                      dataType="numeric"
                      name="personal_margin"
                      precision="38"
                      scale="6" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      dataType="wstr"
                      length="3"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      name="service_type_row" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[sum_margin_fact]"
                      dataType="numeric"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[sum_margin_fact]"
                      name="sum_margin_fact"
                      precision="38"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_date]"
                      name="close_date" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_month]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_month]"
                      name="close_month" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_year]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_year]"
                      name="close_year" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[personal_margin]"
                      dataType="numeric"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[personal_margin]"
                      name="personal_margin"
                      precision="38"
                      scale="6" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload commissions\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ttr_marginality</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload commissions\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[service_type_row]"
                      cachedDataType="wstr"
                      cachedLength="3"
                      cachedName="service_type_row"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[service_type_row]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[sum_margin_fact]"
                      cachedDataType="numeric"
                      cachedName="sum_margin_fact"
                      cachedPrecision="38"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_margin_fact]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[sum_margin_fact]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[close_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="close_date"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_date]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_date]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[close_month]"
                      cachedDataType="i4"
                      cachedName="close_month"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_month]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_month]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[close_year]"
                      cachedDataType="i4"
                      cachedName="close_year"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_year]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_year]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="code"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[personal_margin]"
                      cachedDataType="numeric"
                      cachedName="personal_margin"
                      cachedPrecision="38"
                      cachedScale="6"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[personal_margin]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[personal_margin]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="3"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_margin_fact]"
                      dataType="numeric"
                      name="sum_margin_fact"
                      precision="38"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_date]"
                      dataType="dbTimeStamp"
                      name="close_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_month]"
                      dataType="i4"
                      name="close_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_year]"
                      dataType="i4"
                      name="close_year" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[personal_margin]"
                      dataType="numeric"
                      name="personal_margin"
                      precision="38"
                      scale="6" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload commissions.Paths[ADO NET Source Output]"
              endId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload commissions\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload main"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{4AE26949-B59B-40D4-8234-D154A8727BBC}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload main"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2020
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code]
	FROM [motivation].[dbo].[ttr_workers] 
	WHERE [type] = 'ttr_specialist'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [motivation].[dbo].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt; CAST(GETDATE() AS date) AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [service], [bitrix_name], 
	
	CASE WHEN oa_participant.not_a_participant IS NOT NULL THEN 0
	ELSE [estimate_participant] END AS [raw_estimate_participant], 
	
	COALESCE([work_days], 0) [work_days]

	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[ttr_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [service], [bitrix_name], [estimate_participant] FROM [motivation].[dbo].[ttr_workers] w
	WHERE w.[type] = 'ttr_specialist' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days

	
	OUTER APPLY (
	SELECT 1 AS not_a_participant
	FROM [motivation].[dbo].[calc_exceptions] AS ce
	WHERE ce.[type] = 'ttr_specialist' AND ce.code = cte_distinct_code.code
	) AS oa_participant

),

cte_finished AS (
	
	SELECT
	
	DATEPART(YEAR, TRY_CONVERT(date, req_calc_finish, 104)) AS ttr_id_year,
	DATEPART(MONTH, TRY_CONVERT(date, req_calc_finish, 104)) AS ttr_id_month,
	ttr_service,
	ttr_assigned,	

	COUNT(0) AS ttr_req_qty_all,
	COUNT(ALL CASE WHEN ttr_req_qty_tender = 1 THEN 0 END) AS ttr_req_qty_tender,
	COUNT(ALL CASE WHEN ttr_req_qty_project = 1 THEN 0 END) AS ttr_req_qty_project,
	COUNT(ALL CASE WHEN ttr_req_qty_complex = 1 THEN 0 END) AS ttr_req_qty_complex,
	COUNT(ALL CASE WHEN ttr_req_qty_typical = 1 THEN 0 END) AS ttr_req_qty_typical,
	COUNT(ALL CASE WHEN ttr_req_qty_indicative = 1 THEN 0 END) AS ttr_req_qty_indicative,
		 
	COUNT(ALL CASE 
	WHEN   
	  [ttr_req_fast_qty_tender]       = 1 OR 
      [ttr_req_fast_qty_project]	  = 1 OR
      [ttr_req_fast_qty_complex]	  = 1 OR
      [ttr_req_fast_qty_typical]	  = 1 OR
      [ttr_req_fast_qty_indicative]	  = 1
	THEN 0 END) AS ttr_req_fast_qty_all,
	
	COUNT(ALL CASE WHEN ttr_req_fast_qty_tender = 1 THEN 0 END) AS ttr_req_fast_qty_tender,
	COUNT(ALL CASE WHEN ttr_req_fast_qty_project = 1 THEN 0 END) AS ttr_req_fast_qty_project,
	COUNT(ALL CASE WHEN ttr_req_fast_qty_complex = 1 THEN 0 END) AS ttr_req_fast_qty_complex,
	COUNT(ALL CASE WHEN ttr_req_fast_qty_typical = 1 THEN 0 END) AS ttr_req_fast_qty_typical,
	COUNT(ALL CASE WHEN ttr_req_fast_qty_indicative = 1 THEN 0 END) AS ttr_req_fast_qty_indicative,

	COUNT(ALL CASE 
	WHEN  [ttr_req_slow_qty_tender]       = 1 OR 
      [ttr_req_slow_qty_project]	  = 1 OR
      [ttr_req_slow_qty_complex]	  = 1 OR
      [ttr_req_slow_qty_typical]	  = 1 OR
      [ttr_req_slow_qty_indicative]	  = 1	
	THEN 0 END) AS ttr_req_slow_qty_all,
	
	COUNT(ALL CASE WHEN ttr_req_slow_qty_tender = 1 THEN 0 END) AS ttr_req_slow_qty_tender,
	COUNT(ALL CASE WHEN ttr_req_slow_qty_project = 1 THEN 0 END) AS ttr_req_slow_qty_project,
	COUNT(ALL CASE WHEN ttr_req_slow_qty_complex = 1 THEN 0 END) AS ttr_req_slow_qty_complex,
	COUNT(ALL CASE WHEN ttr_req_slow_qty_typical = 1 THEN 0 END) AS ttr_req_slow_qty_typical,
	COUNT(ALL CASE WHEN ttr_req_slow_qty_indicative = 1 THEN 0 END) AS ttr_req_slow_qty_indicative,

	SUM(ttr_rework_qty) AS ttr_rework_qty,
	SUM(ttr_classified_qty) AS ttr_classified_qty,
	SUM(ttr_clothes_classified_qty) AS ttr_clothes_classified_qty

	FROM [motivation].[dbo].[ttr_request_details]
	WHERE COALESCE(ttr_assigned, '') &lt;&gt; '' AND TRY_CONVERT(date, req_calc_finish, 104) &gt;= '20200101'
	GROUP BY 
	ttr_assigned, 
	ttr_service,
	DATEPART(YEAR, TRY_CONVERT(date, req_calc_finish, 104)),
	DATEPART(MONTH, TRY_CONVERT(date, req_calc_finish, 104))
),

cte_result AS (

	SELECT
	
	DATEPART(YEAR, TRY_CONVERT(date, decision_date, 104)) AS ttr_id_year,
	DATEPART(MONTH, TRY_CONVERT(date, decision_date, 104)) AS ttr_id_month,
	ttr_service,
	ttr_assigned,	

	COUNT(0) AS ttr_des_qty_all,	
	COUNT(ALL CASE WHEN ttr_des_qty_accepted = 1 THEN 0 END) AS ttr_des_qty_accepted,
	COUNT(ALL CASE WHEN ttr_des_qty_commission = 1 THEN 0 END) AS ttr_des_qty_commission,	
	COUNT(ALL CASE WHEN ttr_des_qty_indicative = 1 THEN 0 END) AS ttr_des_qty_indicative,
	COUNT(ALL CASE WHEN ttr_des_qty_rejected_expensive = 1 THEN 0 END) AS ttr_des_qty_rejected_expensive,
	COUNT(ALL CASE WHEN ttr_des_qty_rejected_other = 1 THEN 0 END) AS ttr_des_qty_rejected_other

	FROM [motivation].[dbo].[ttr_result_details]
	WHERE COALESCE(ttr_assigned, '') &lt;&gt; '' AND TRY_CONVERT(date, decision_date, 104) &gt;= '20200101'
	GROUP BY 
	ttr_assigned, 
	ttr_service,
	DATEPART(YEAR, TRY_CONVERT(date, decision_date, 104)),
	DATEPART(MONTH, TRY_CONVERT(date, decision_date, 104))
),

cte_marginality AS (

SELECT	
	[code]
	,close_month
	,close_year
	,CAST((COALESCE(SUM(personal_margin), 0) * 0.4) AS decimal(18,2)) AS personal_margin
	FROM motivation.dbo.ttr_marginality
	GROUP BY 
	[code]
	,close_month
	,close_year
),

cte_marginality_overall AS (
	SELECT [close_month], [close_year], CAST((COALESCE(SUM(margin_fact), 0) * 0.4) AS decimal(18,2)) AS ttr_sum_margin
	FROM [motivation].[dbo].[ks_commissions]
	GROUP BY
	[close_month], [close_year]	
),

cte_bitrix_321 AS (
	SELECT [code], [ttr_id_year], [ttr_id_month]
	,SUM(COALESCE(ttr_classified_qty, 0)) AS ext_ttr_classified_qty
	,SUM(COALESCE(ttr_classified_clothes_qty, 0)) AS ext_ttr_classified_clothes_qty
	FROM [motivation].[dbo].[ttr_bitrix_commission_details]
	GROUP BY
	[code], [ttr_id_year], [ttr_id_month]
),

cte_extended AS (

SELECT 
cte_base.*
,COALESCE(ttr_req_qty_all, 0) AS ttr_req_qty_all
,COALESCE(ttr_req_qty_tender, 0) AS ttr_req_qty_tender
,COALESCE(ttr_req_qty_project, 0) AS ttr_req_qty_project
,COALESCE(ttr_req_qty_complex, 0) AS ttr_req_qty_complex
,COALESCE(ttr_req_qty_typical, 0) AS ttr_req_qty_typical
,COALESCE(ttr_req_qty_indicative, 0) AS ttr_req_qty_indicative
,COALESCE(ttr_req_fast_qty_all, 0) AS ttr_req_fast_qty_all
,COALESCE(ttr_req_fast_qty_tender, 0) AS ttr_req_fast_qty_tender
,COALESCE(ttr_req_fast_qty_project, 0) AS ttr_req_fast_qty_project
,COALESCE(ttr_req_fast_qty_complex, 0) AS ttr_req_fast_qty_complex
,COALESCE(ttr_req_fast_qty_typical, 0) AS ttr_req_fast_qty_typical
,COALESCE(ttr_req_fast_qty_indicative, 0) AS ttr_req_fast_qty_indicative
,COALESCE(ttr_req_slow_qty_all, 0) AS ttr_req_slow_qty_all
,COALESCE(ttr_req_slow_qty_tender, 0) AS ttr_req_slow_qty_tender
,COALESCE(ttr_req_slow_qty_project, 0) AS ttr_req_slow_qty_project
,COALESCE(ttr_req_slow_qty_complex, 0) AS ttr_req_slow_qty_complex
,COALESCE(ttr_req_slow_qty_typical, 0) AS ttr_req_slow_qty_typical
,COALESCE(ttr_req_slow_qty_indicative, 0) AS ttr_req_slow_qty_indicative
,COALESCE(ttr_rework_qty, 0) AS ttr_rework_qty
,COALESCE(ttr_classified_qty, 0) + COALESCE(ext_ttr_classified_qty, 0) AS ttr_classified_qty
,COALESCE(ttr_clothes_classified_qty, 0) + COALESCE(ext_ttr_classified_clothes_qty, 0) AS ttr_classified_clothes_qty
,COALESCE(ttr_des_qty_all, 0) AS ttr_des_qty_all
,COALESCE(ttr_des_qty_accepted, 0) AS ttr_des_qty_accepted
,COALESCE(ttr_des_qty_commission, 0) AS ttr_des_qty_commission
,COALESCE(ttr_des_qty_indicative, 0) AS ttr_des_qty_indicative
,COALESCE(ttr_des_qty_rejected_expensive, 0) AS ttr_des_qty_rejected_expensive
,COALESCE(ttr_des_qty_rejected_other, 0) AS ttr_des_qty_rejected_other
,COALESCE(CAST(personal_margin AS decimal(18,2)), 0) AS ttr_personal_marginality
,COALESCE(CAST(ttr_sum_margin AS decimal(18,2)), 0) AS ttr_sum_margin

,CASE WHEN raw_estimate_participant = 1 
AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt; MONTH(GETDATE())))
AND COALESCE(ttr_req_qty_all, 0) &lt; 20 AND [service] = 'ТЭО' THEN 0
ELSE raw_estimate_participant END AS estimate_participant

FROM cte_base
LEFT JOIN cte_finished 
	ON cte_finished.ttr_id_year = cte_base.id_year 
	AND cte_finished.ttr_id_month = cte_base.id_month
	AND cte_finished.ttr_assigned = cte_base.bitrix_name
LEFT JOIN cte_result 
	ON cte_result.ttr_id_year = cte_base.id_year 
	AND cte_result.ttr_id_month = cte_base.id_month
	AND cte_result.ttr_assigned = cte_base.bitrix_name
LEFT JOIN cte_marginality
	ON cte_marginality.close_year = cte_base.id_year 
	AND cte_marginality.close_month = cte_base.id_month
	AND cte_marginality.code = cte_base.code
LEFT JOIN cte_marginality_overall
	ON cte_marginality_overall.close_year = cte_base.id_year 
	AND cte_marginality_overall.close_month = cte_base.id_month
LEFT JOIN cte_bitrix_321
	ON cte_bitrix_321.ttr_id_year = cte_base.id_year 
	AND cte_bitrix_321.ttr_id_month = cte_base.id_month
	AND cte_bitrix_321.code = cte_base.code
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month, c.[service]) [workers_count]

	,f.[req_qty_tender]
    ,f.[req_qty_project]
    ,f.[req_qty_complex]
    ,f.[req_qty_typical]
    ,f.[req_qty_indicative]
    ,f.[req_fast_qty_tender]
    ,f.[req_fast_qty_project]
    ,f.[req_fast_qty_complex]
    ,f.[req_fast_qty_typical]
    ,f.[req_fast_qty_indicative]
    ,f.[req_slow_qty_tender]
    ,f.[req_slow_qty_project]
    ,f.[req_slow_qty_complex]
    ,f.[req_slow_qty_typical]
    ,f.[req_slow_qty_indicative]
    ,f.[rework_qty]
    ,f.[des_qty_accepted]
    ,f.[des_qty_commission]
    ,f.[des_qty_indicative]
    ,f.[des_qty_rejected_expensive]
    ,f.[des_qty_rejected_other]	
	
	,estimate =  
	(f.req_qty_tender * ttr_req_qty_tender
	+ f.req_qty_project * ttr_req_qty_project
	+ f.req_qty_complex * ttr_req_qty_complex
	+ f.req_qty_typical * ttr_req_qty_typical
	+ f.req_qty_indicative * ttr_req_qty_indicative
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_tender) * ttr_req_fast_qty_tender
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_project) * ttr_req_fast_qty_project
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_complex) * ttr_req_fast_qty_complex
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_typical) * ttr_req_fast_qty_typical
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_indicative) * ttr_req_fast_qty_indicative
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_tender) * ttr_req_slow_qty_tender
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_project) * ttr_req_slow_qty_project
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_complex) * ttr_req_slow_qty_complex
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_typical) * ttr_req_slow_qty_typical
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_indicative) * ttr_req_slow_qty_indicative
	+ f.rework_qty * ttr_rework_qty
	+ f.des_qty_accepted * ttr_des_qty_accepted
	+ f.des_qty_commission * ttr_des_qty_commission
	+ f.des_qty_indicative * ttr_des_qty_indicative
	+ f.des_qty_rejected_expensive * ttr_des_qty_rejected_expensive
	+ f.des_qty_rejected_other * ttr_des_qty_rejected_other
	+ CASE
         WHEN ttr_classified_qty &lt;= 500 THEN ttr_classified_qty * COALESCE(f.req_art_classify, 0)
         ELSE (ttr_classified_qty - 500) * COALESCE(f.req_art_clothes_classify, 0) + 500 * COALESCE(f.req_art_classify, 0)
    END
	)

	FROM cte_extended c
	JOIN [motivation].[dbo].[ttr_factors] f ON f.[service] = c.[service]
	CROSS APPLY (SELECT TOP (1) [f_profit_fact] FROM [motivation].[dbo].[ks_factors]) AS ca
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt; CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
),

cte_calc_done_corrected AS (
	SELECT 
 id_year
,id_month
,work_days_in_month
,name
,code
,service
,bitrix_name
,raw_estimate_participant
,work_days
,ttr_req_qty_all
,ttr_req_qty_tender
,ttr_req_qty_project
,ttr_req_qty_complex
,ttr_req_qty_typical
,ttr_req_qty_indicative
,ttr_req_fast_qty_all
,ttr_req_fast_qty_tender
,ttr_req_fast_qty_project
,ttr_req_fast_qty_complex
,ttr_req_fast_qty_typical
,ttr_req_fast_qty_indicative
,ttr_req_slow_qty_all
,ttr_req_slow_qty_tender
,ttr_req_slow_qty_project
,ttr_req_slow_qty_complex
,ttr_req_slow_qty_typical
,ttr_req_slow_qty_indicative
,ttr_rework_qty
,ttr_classified_qty
,ttr_des_qty_all
,ttr_des_qty_accepted
,ttr_des_qty_commission
,ttr_des_qty_indicative
,ttr_des_qty_rejected_expensive
,ttr_des_qty_rejected_other
,ttr_personal_marginality
,ttr_sum_margin
,workers_count
,req_qty_tender
,req_qty_project
,req_qty_complex
,req_qty_typical
,req_qty_indicative
,req_fast_qty_tender
,req_fast_qty_project
,req_fast_qty_complex
,req_fast_qty_typical
,req_fast_qty_indicative
,req_slow_qty_tender
,req_slow_qty_project
,req_slow_qty_complex
,req_slow_qty_typical
,req_slow_qty_indicative
,rework_qty
,des_qty_accepted
,des_qty_commission
,des_qty_indicative
,des_qty_rejected_expensive
,des_qty_rejected_other
,estimate
,overall_estimate
	
,[estimate_participant] = CASE 
WHEN c.[estimate_participant] = 0 THEN 0
WHEN c.estimate &lt; 0 AND service = 'ТО' THEN 0 
WHEN COALESCE(work_days, 0) = 0 THEN 0 
ELSE 1
END

FROM cte_calc_done AS c
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month, [service])
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month, [service])
, 0)
, 0)
) worker_factor

FROM cte_calc_done_corrected c
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(id_year, id_month, 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload main\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2020
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code]
	FROM [motivation].[dbo].[ttr_workers] 
	WHERE [type] = 'ttr_specialist'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [motivation].[dbo].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt; CAST(GETDATE() AS date) AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [service], [bitrix_name], 
	
	CASE WHEN oa_participant.not_a_participant IS NOT NULL THEN 0
	ELSE [estimate_participant] END AS [raw_estimate_participant], 
	
	COALESCE([work_days], 0) [work_days]

	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[ttr_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [service], [bitrix_name], [estimate_participant] FROM [motivation].[dbo].[ttr_workers] w
	WHERE w.[type] = 'ttr_specialist' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days

	
	OUTER APPLY (
	SELECT 1 AS not_a_participant
	FROM [motivation].[dbo].[calc_exceptions] AS ce
	WHERE ce.[type] = 'ttr_specialist' AND ce.code = cte_distinct_code.code
	) AS oa_participant

),

cte_finished AS (
	
	SELECT
	
	DATEPART(YEAR, TRY_CONVERT(date, req_calc_finish, 104)) AS ttr_id_year,
	DATEPART(MONTH, TRY_CONVERT(date, req_calc_finish, 104)) AS ttr_id_month,
	ttr_service,
	ttr_assigned,	

	COUNT(0) AS ttr_req_qty_all,
	COUNT(ALL CASE WHEN ttr_req_qty_tender = 1 THEN 0 END) AS ttr_req_qty_tender,
	COUNT(ALL CASE WHEN ttr_req_qty_project = 1 THEN 0 END) AS ttr_req_qty_project,
	COUNT(ALL CASE WHEN ttr_req_qty_complex = 1 THEN 0 END) AS ttr_req_qty_complex,
	COUNT(ALL CASE WHEN ttr_req_qty_typical = 1 THEN 0 END) AS ttr_req_qty_typical,
	COUNT(ALL CASE WHEN ttr_req_qty_indicative = 1 THEN 0 END) AS ttr_req_qty_indicative,
		 
	COUNT(ALL CASE 
	WHEN   
	  [ttr_req_fast_qty_tender]       = 1 OR 
      [ttr_req_fast_qty_project]	  = 1 OR
      [ttr_req_fast_qty_complex]	  = 1 OR
      [ttr_req_fast_qty_typical]	  = 1 OR
      [ttr_req_fast_qty_indicative]	  = 1
	THEN 0 END) AS ttr_req_fast_qty_all,
	
	COUNT(ALL CASE WHEN ttr_req_fast_qty_tender = 1 THEN 0 END) AS ttr_req_fast_qty_tender,
	COUNT(ALL CASE WHEN ttr_req_fast_qty_project = 1 THEN 0 END) AS ttr_req_fast_qty_project,
	COUNT(ALL CASE WHEN ttr_req_fast_qty_complex = 1 THEN 0 END) AS ttr_req_fast_qty_complex,
	COUNT(ALL CASE WHEN ttr_req_fast_qty_typical = 1 THEN 0 END) AS ttr_req_fast_qty_typical,
	COUNT(ALL CASE WHEN ttr_req_fast_qty_indicative = 1 THEN 0 END) AS ttr_req_fast_qty_indicative,

	COUNT(ALL CASE 
	WHEN  [ttr_req_slow_qty_tender]       = 1 OR 
      [ttr_req_slow_qty_project]	  = 1 OR
      [ttr_req_slow_qty_complex]	  = 1 OR
      [ttr_req_slow_qty_typical]	  = 1 OR
      [ttr_req_slow_qty_indicative]	  = 1	
	THEN 0 END) AS ttr_req_slow_qty_all,
	
	COUNT(ALL CASE WHEN ttr_req_slow_qty_tender = 1 THEN 0 END) AS ttr_req_slow_qty_tender,
	COUNT(ALL CASE WHEN ttr_req_slow_qty_project = 1 THEN 0 END) AS ttr_req_slow_qty_project,
	COUNT(ALL CASE WHEN ttr_req_slow_qty_complex = 1 THEN 0 END) AS ttr_req_slow_qty_complex,
	COUNT(ALL CASE WHEN ttr_req_slow_qty_typical = 1 THEN 0 END) AS ttr_req_slow_qty_typical,
	COUNT(ALL CASE WHEN ttr_req_slow_qty_indicative = 1 THEN 0 END) AS ttr_req_slow_qty_indicative,

	SUM(ttr_rework_qty) AS ttr_rework_qty,
	SUM(ttr_classified_qty) AS ttr_classified_qty,
	SUM(ttr_clothes_classified_qty) AS ttr_clothes_classified_qty

	FROM [motivation].[dbo].[ttr_request_details]
	WHERE COALESCE(ttr_assigned, '') &lt;&gt; '' AND TRY_CONVERT(date, req_calc_finish, 104) &gt;= '20200101'
	GROUP BY 
	ttr_assigned, 
	ttr_service,
	DATEPART(YEAR, TRY_CONVERT(date, req_calc_finish, 104)),
	DATEPART(MONTH, TRY_CONVERT(date, req_calc_finish, 104))
),

cte_result AS (

	SELECT
	
	DATEPART(YEAR, TRY_CONVERT(date, decision_date, 104)) AS ttr_id_year,
	DATEPART(MONTH, TRY_CONVERT(date, decision_date, 104)) AS ttr_id_month,
	ttr_service,
	ttr_assigned,	

	COUNT(0) AS ttr_des_qty_all,	
	COUNT(ALL CASE WHEN ttr_des_qty_accepted = 1 THEN 0 END) AS ttr_des_qty_accepted,
	COUNT(ALL CASE WHEN ttr_des_qty_commission = 1 THEN 0 END) AS ttr_des_qty_commission,	
	COUNT(ALL CASE WHEN ttr_des_qty_indicative = 1 THEN 0 END) AS ttr_des_qty_indicative,
	COUNT(ALL CASE WHEN ttr_des_qty_rejected_expensive = 1 THEN 0 END) AS ttr_des_qty_rejected_expensive,
	COUNT(ALL CASE WHEN ttr_des_qty_rejected_other = 1 THEN 0 END) AS ttr_des_qty_rejected_other

	FROM [motivation].[dbo].[ttr_result_details]
	WHERE COALESCE(ttr_assigned, '') &lt;&gt; '' AND TRY_CONVERT(date, decision_date, 104) &gt;= '20200101'
	GROUP BY 
	ttr_assigned, 
	ttr_service,
	DATEPART(YEAR, TRY_CONVERT(date, decision_date, 104)),
	DATEPART(MONTH, TRY_CONVERT(date, decision_date, 104))
),

cte_marginality AS (

SELECT	
	[code]
	,close_month
	,close_year
	,CAST((COALESCE(SUM(personal_margin), 0) * 0.4) AS decimal(18,2)) AS personal_margin
	FROM motivation.dbo.ttr_marginality
	GROUP BY 
	[code]
	,close_month
	,close_year
),

cte_marginality_overall AS (
	SELECT [close_month], [close_year], CAST((COALESCE(SUM(margin_fact), 0) * 0.4) AS decimal(18,2)) AS ttr_sum_margin
	FROM [motivation].[dbo].[ks_commissions]
	GROUP BY
	[close_month], [close_year]	
),

cte_bitrix_321 AS (
	SELECT [code], [ttr_id_year], [ttr_id_month]
	,SUM(COALESCE(ttr_classified_qty, 0)) AS ext_ttr_classified_qty
	,SUM(COALESCE(ttr_classified_clothes_qty, 0)) AS ext_ttr_classified_clothes_qty
	FROM [motivation].[dbo].[ttr_bitrix_commission_details]
	GROUP BY
	[code], [ttr_id_year], [ttr_id_month]
),

cte_extended AS (

SELECT 
cte_base.*
,COALESCE(ttr_req_qty_all, 0) AS ttr_req_qty_all
,COALESCE(ttr_req_qty_tender, 0) AS ttr_req_qty_tender
,COALESCE(ttr_req_qty_project, 0) AS ttr_req_qty_project
,COALESCE(ttr_req_qty_complex, 0) AS ttr_req_qty_complex
,COALESCE(ttr_req_qty_typical, 0) AS ttr_req_qty_typical
,COALESCE(ttr_req_qty_indicative, 0) AS ttr_req_qty_indicative
,COALESCE(ttr_req_fast_qty_all, 0) AS ttr_req_fast_qty_all
,COALESCE(ttr_req_fast_qty_tender, 0) AS ttr_req_fast_qty_tender
,COALESCE(ttr_req_fast_qty_project, 0) AS ttr_req_fast_qty_project
,COALESCE(ttr_req_fast_qty_complex, 0) AS ttr_req_fast_qty_complex
,COALESCE(ttr_req_fast_qty_typical, 0) AS ttr_req_fast_qty_typical
,COALESCE(ttr_req_fast_qty_indicative, 0) AS ttr_req_fast_qty_indicative
,COALESCE(ttr_req_slow_qty_all, 0) AS ttr_req_slow_qty_all
,COALESCE(ttr_req_slow_qty_tender, 0) AS ttr_req_slow_qty_tender
,COALESCE(ttr_req_slow_qty_project, 0) AS ttr_req_slow_qty_project
,COALESCE(ttr_req_slow_qty_complex, 0) AS ttr_req_slow_qty_complex
,COALESCE(ttr_req_slow_qty_typical, 0) AS ttr_req_slow_qty_typical
,COALESCE(ttr_req_slow_qty_indicative, 0) AS ttr_req_slow_qty_indicative
,COALESCE(ttr_rework_qty, 0) AS ttr_rework_qty
,COALESCE(ttr_classified_qty, 0) + COALESCE(ext_ttr_classified_qty, 0) AS ttr_classified_qty
,COALESCE(ttr_clothes_classified_qty, 0) + COALESCE(ext_ttr_classified_clothes_qty, 0) AS ttr_classified_clothes_qty
,COALESCE(ttr_des_qty_all, 0) AS ttr_des_qty_all
,COALESCE(ttr_des_qty_accepted, 0) AS ttr_des_qty_accepted
,COALESCE(ttr_des_qty_commission, 0) AS ttr_des_qty_commission
,COALESCE(ttr_des_qty_indicative, 0) AS ttr_des_qty_indicative
,COALESCE(ttr_des_qty_rejected_expensive, 0) AS ttr_des_qty_rejected_expensive
,COALESCE(ttr_des_qty_rejected_other, 0) AS ttr_des_qty_rejected_other
,COALESCE(CAST(personal_margin AS decimal(18,2)), 0) AS ttr_personal_marginality
,COALESCE(CAST(ttr_sum_margin AS decimal(18,2)), 0) AS ttr_sum_margin

,CASE WHEN raw_estimate_participant = 1 
AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt; MONTH(GETDATE())))
AND COALESCE(ttr_req_qty_all, 0) &lt; 20 AND [service] = 'ТЭО' THEN 0
ELSE raw_estimate_participant END AS estimate_participant

FROM cte_base
LEFT JOIN cte_finished 
	ON cte_finished.ttr_id_year = cte_base.id_year 
	AND cte_finished.ttr_id_month = cte_base.id_month
	AND cte_finished.ttr_assigned = cte_base.bitrix_name
LEFT JOIN cte_result 
	ON cte_result.ttr_id_year = cte_base.id_year 
	AND cte_result.ttr_id_month = cte_base.id_month
	AND cte_result.ttr_assigned = cte_base.bitrix_name
LEFT JOIN cte_marginality
	ON cte_marginality.close_year = cte_base.id_year 
	AND cte_marginality.close_month = cte_base.id_month
	AND cte_marginality.code = cte_base.code
LEFT JOIN cte_marginality_overall
	ON cte_marginality_overall.close_year = cte_base.id_year 
	AND cte_marginality_overall.close_month = cte_base.id_month
LEFT JOIN cte_bitrix_321
	ON cte_bitrix_321.ttr_id_year = cte_base.id_year 
	AND cte_bitrix_321.ttr_id_month = cte_base.id_month
	AND cte_bitrix_321.code = cte_base.code
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month, c.[service]) [workers_count]

	,f.[req_qty_tender]
    ,f.[req_qty_project]
    ,f.[req_qty_complex]
    ,f.[req_qty_typical]
    ,f.[req_qty_indicative]
    ,f.[req_fast_qty_tender]
    ,f.[req_fast_qty_project]
    ,f.[req_fast_qty_complex]
    ,f.[req_fast_qty_typical]
    ,f.[req_fast_qty_indicative]
    ,f.[req_slow_qty_tender]
    ,f.[req_slow_qty_project]
    ,f.[req_slow_qty_complex]
    ,f.[req_slow_qty_typical]
    ,f.[req_slow_qty_indicative]
    ,f.[rework_qty]
    ,f.[des_qty_accepted]
    ,f.[des_qty_commission]
    ,f.[des_qty_indicative]
    ,f.[des_qty_rejected_expensive]
    ,f.[des_qty_rejected_other]	
	
	,estimate =  
	(f.req_qty_tender * ttr_req_qty_tender
	+ f.req_qty_project * ttr_req_qty_project
	+ f.req_qty_complex * ttr_req_qty_complex
	+ f.req_qty_typical * ttr_req_qty_typical
	+ f.req_qty_indicative * ttr_req_qty_indicative
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_tender) * ttr_req_fast_qty_tender
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_project) * ttr_req_fast_qty_project
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_complex) * ttr_req_fast_qty_complex
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_typical) * ttr_req_fast_qty_typical
	+ (COALESCE(f.req_in_time, 0) + f.req_fast_qty_indicative) * ttr_req_fast_qty_indicative
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_tender) * ttr_req_slow_qty_tender
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_project) * ttr_req_slow_qty_project
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_complex) * ttr_req_slow_qty_complex
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_typical) * ttr_req_slow_qty_typical
	+ (COALESCE(f.req_not_in_time, 0) + f.req_slow_qty_indicative) * ttr_req_slow_qty_indicative
	+ f.rework_qty * ttr_rework_qty
	+ f.des_qty_accepted * ttr_des_qty_accepted
	+ f.des_qty_commission * ttr_des_qty_commission
	+ f.des_qty_indicative * ttr_des_qty_indicative
	+ f.des_qty_rejected_expensive * ttr_des_qty_rejected_expensive
	+ f.des_qty_rejected_other * ttr_des_qty_rejected_other
	+ CASE
         WHEN ttr_classified_qty &lt;= 500 THEN ttr_classified_qty * COALESCE(f.req_art_classify, 0)
         ELSE (ttr_classified_qty - 500) * COALESCE(f.req_art_clothes_classify, 0) + 500 * COALESCE(f.req_art_classify, 0)
    END
	)

	FROM cte_extended c
	JOIN [motivation].[dbo].[ttr_factors] f ON f.[service] = c.[service]
	CROSS APPLY (SELECT TOP (1) [f_profit_fact] FROM [motivation].[dbo].[ks_factors]) AS ca
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt; CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
),

cte_calc_done_corrected AS (
	SELECT 
 id_year
,id_month
,work_days_in_month
,name
,code
,service
,bitrix_name
,raw_estimate_participant
,work_days
,ttr_req_qty_all
,ttr_req_qty_tender
,ttr_req_qty_project
,ttr_req_qty_complex
,ttr_req_qty_typical
,ttr_req_qty_indicative
,ttr_req_fast_qty_all
,ttr_req_fast_qty_tender
,ttr_req_fast_qty_project
,ttr_req_fast_qty_complex
,ttr_req_fast_qty_typical
,ttr_req_fast_qty_indicative
,ttr_req_slow_qty_all
,ttr_req_slow_qty_tender
,ttr_req_slow_qty_project
,ttr_req_slow_qty_complex
,ttr_req_slow_qty_typical
,ttr_req_slow_qty_indicative
,ttr_rework_qty
,ttr_classified_qty
,ttr_des_qty_all
,ttr_des_qty_accepted
,ttr_des_qty_commission
,ttr_des_qty_indicative
,ttr_des_qty_rejected_expensive
,ttr_des_qty_rejected_other
,ttr_personal_marginality
,ttr_sum_margin
,workers_count
,req_qty_tender
,req_qty_project
,req_qty_complex
,req_qty_typical
,req_qty_indicative
,req_fast_qty_tender
,req_fast_qty_project
,req_fast_qty_complex
,req_fast_qty_typical
,req_fast_qty_indicative
,req_slow_qty_tender
,req_slow_qty_project
,req_slow_qty_complex
,req_slow_qty_typical
,req_slow_qty_indicative
,rework_qty
,des_qty_accepted
,des_qty_commission
,des_qty_indicative
,des_qty_rejected_expensive
,des_qty_rejected_other
,estimate
,overall_estimate
	
,[estimate_participant] = CASE 
WHEN c.[estimate_participant] = 0 THEN 0
WHEN c.estimate &lt; 0 AND service = 'ТО' THEN 0 
WHEN COALESCE(work_days, 0) = 0 THEN 0 
ELSE 1
END

FROM cte_calc_done AS c
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month, [service])
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month, [service])
, 0)
, 0)
) worker_factor

FROM cte_calc_done_corrected c
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(id_year, id_month, 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload main\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload main\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                      name="id_year"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                      name="id_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                      name="work_days_in_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                      length="200"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                      name="name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      length="10"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[service]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[service]"
                      length="20"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[service]"
                      name="service"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[bitrix_name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[bitrix_name]"
                      length="200"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[bitrix_name]"
                      name="bitrix_name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[raw_estimate_participant]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[raw_estimate_participant]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[raw_estimate_participant]"
                      name="raw_estimate_participant"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                      name="work_days"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_all]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_all]"
                      name="ttr_req_qty_all"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_tender]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_tender]"
                      name="ttr_req_qty_tender"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_project]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_project]"
                      name="ttr_req_qty_project"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_complex]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_complex]"
                      name="ttr_req_qty_complex"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_typical]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_typical]"
                      name="ttr_req_qty_typical"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_indicative]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_indicative]"
                      name="ttr_req_qty_indicative"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_all]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_all]"
                      name="ttr_req_fast_qty_all"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_tender]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_tender]"
                      name="ttr_req_fast_qty_tender"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_project]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_project]"
                      name="ttr_req_fast_qty_project"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_complex]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_complex]"
                      name="ttr_req_fast_qty_complex"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_typical]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_typical]"
                      name="ttr_req_fast_qty_typical"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_indicative]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_indicative]"
                      name="ttr_req_fast_qty_indicative"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_all]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_all]"
                      name="ttr_req_slow_qty_all"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_tender]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_tender]"
                      name="ttr_req_slow_qty_tender"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_project]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_project]"
                      name="ttr_req_slow_qty_project"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_complex]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_complex]"
                      name="ttr_req_slow_qty_complex"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_typical]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_typical]"
                      name="ttr_req_slow_qty_typical"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_indicative]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_indicative]"
                      name="ttr_req_slow_qty_indicative"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_rework_qty]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_rework_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_rework_qty]"
                      name="ttr_rework_qty"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_classified_qty]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_classified_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_classified_qty]"
                      name="ttr_classified_qty"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_all]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_all]"
                      name="ttr_des_qty_all"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_accepted]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_accepted]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_accepted]"
                      name="ttr_des_qty_accepted"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_commission]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_commission]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_commission]"
                      name="ttr_des_qty_commission"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_indicative]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_indicative]"
                      name="ttr_des_qty_indicative"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_expensive]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_rejected_expensive]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_expensive]"
                      name="ttr_des_qty_rejected_expensive"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_other]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_rejected_other]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_other]"
                      name="ttr_des_qty_rejected_other"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_personal_marginality]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_personal_marginality]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_personal_marginality]"
                      name="ttr_personal_marginality"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_sum_margin]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_sum_margin]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_sum_margin]"
                      name="ttr_sum_margin"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                      name="estimate_participant"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                      name="workers_count"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_tender]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_tender]"
                      name="req_qty_tender"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_project]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_project]"
                      name="req_qty_project"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_complex]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_complex]"
                      name="req_qty_complex"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_typical]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_typical]"
                      name="req_qty_typical"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_indicative]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_indicative]"
                      name="req_qty_indicative"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_tender]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_tender]"
                      name="req_fast_qty_tender"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_project]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_project]"
                      name="req_fast_qty_project"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_complex]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_complex]"
                      name="req_fast_qty_complex"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_typical]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_typical]"
                      name="req_fast_qty_typical"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_indicative]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_indicative]"
                      name="req_fast_qty_indicative"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_tender]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_tender]"
                      name="req_slow_qty_tender"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_project]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_project]"
                      name="req_slow_qty_project"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_complex]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_complex]"
                      name="req_slow_qty_complex"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_typical]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_typical]"
                      name="req_slow_qty_typical"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_indicative]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_indicative]"
                      name="req_slow_qty_indicative"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[rework_qty]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[rework_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[rework_qty]"
                      name="rework_qty"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_accepted]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_accepted]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_accepted]"
                      name="des_qty_accepted"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_commission]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_commission]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_commission]"
                      name="des_qty_commission"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_indicative]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_indicative]"
                      name="des_qty_indicative"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_rejected_expensive]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_rejected_expensive]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_rejected_expensive]"
                      name="des_qty_rejected_expensive"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_rejected_other]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_rejected_other]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_rejected_other]"
                      name="des_qty_rejected_other"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                      name="estimate"
                      precision="38"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                      name="overall_estimate"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                      name="average_group_estimate"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                      name="worker_factor"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                      dataType="i4"
                      name="id_year" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                      dataType="i4"
                      name="id_month" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                      dataType="i4"
                      name="work_days_in_month" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                      dataType="wstr"
                      length="200"
                      name="name" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[service]"
                      dataType="wstr"
                      length="20"
                      name="service" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[bitrix_name]"
                      dataType="wstr"
                      length="200"
                      name="bitrix_name" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[raw_estimate_participant]"
                      dataType="i4"
                      name="raw_estimate_participant" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                      dataType="i4"
                      name="work_days" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_all]"
                      dataType="i4"
                      name="ttr_req_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_tender]"
                      dataType="i4"
                      name="ttr_req_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_project]"
                      dataType="i4"
                      name="ttr_req_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_complex]"
                      dataType="i4"
                      name="ttr_req_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_typical]"
                      dataType="i4"
                      name="ttr_req_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_all]"
                      dataType="i4"
                      name="ttr_req_fast_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_tender]"
                      dataType="i4"
                      name="ttr_req_fast_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_project]"
                      dataType="i4"
                      name="ttr_req_fast_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_complex]"
                      dataType="i4"
                      name="ttr_req_fast_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_typical]"
                      dataType="i4"
                      name="ttr_req_fast_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_fast_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_all]"
                      dataType="i4"
                      name="ttr_req_slow_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_tender]"
                      dataType="i4"
                      name="ttr_req_slow_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_project]"
                      dataType="i4"
                      name="ttr_req_slow_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_complex]"
                      dataType="i4"
                      name="ttr_req_slow_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_typical]"
                      dataType="i4"
                      name="ttr_req_slow_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_slow_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_rework_qty]"
                      dataType="i4"
                      name="ttr_rework_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_classified_qty]"
                      dataType="i4"
                      name="ttr_classified_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_all]"
                      dataType="i4"
                      name="ttr_des_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_accepted]"
                      dataType="i4"
                      name="ttr_des_qty_accepted" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_commission]"
                      dataType="i4"
                      name="ttr_des_qty_commission" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_indicative]"
                      dataType="i4"
                      name="ttr_des_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_rejected_expensive]"
                      dataType="i4"
                      name="ttr_des_qty_rejected_expensive" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_rejected_other]"
                      dataType="i4"
                      name="ttr_des_qty_rejected_other" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_personal_marginality]"
                      dataType="numeric"
                      name="ttr_personal_marginality"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_sum_margin]"
                      dataType="numeric"
                      name="ttr_sum_margin"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                      dataType="i4"
                      name="estimate_participant" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                      dataType="i4"
                      name="workers_count" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_tender]"
                      dataType="numeric"
                      name="req_qty_tender"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_project]"
                      dataType="numeric"
                      name="req_qty_project"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_complex]"
                      dataType="numeric"
                      name="req_qty_complex"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_typical]"
                      dataType="numeric"
                      name="req_qty_typical"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_qty_indicative]"
                      dataType="numeric"
                      name="req_qty_indicative"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_tender]"
                      dataType="numeric"
                      name="req_fast_qty_tender"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_project]"
                      dataType="numeric"
                      name="req_fast_qty_project"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_complex]"
                      dataType="numeric"
                      name="req_fast_qty_complex"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_typical]"
                      dataType="numeric"
                      name="req_fast_qty_typical"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_fast_qty_indicative]"
                      dataType="numeric"
                      name="req_fast_qty_indicative"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_tender]"
                      dataType="numeric"
                      name="req_slow_qty_tender"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_project]"
                      dataType="numeric"
                      name="req_slow_qty_project"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_complex]"
                      dataType="numeric"
                      name="req_slow_qty_complex"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_typical]"
                      dataType="numeric"
                      name="req_slow_qty_typical"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[req_slow_qty_indicative]"
                      dataType="numeric"
                      name="req_slow_qty_indicative"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[rework_qty]"
                      dataType="numeric"
                      name="rework_qty"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_accepted]"
                      dataType="numeric"
                      name="des_qty_accepted"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_commission]"
                      dataType="numeric"
                      name="des_qty_commission"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_indicative]"
                      dataType="numeric"
                      name="des_qty_indicative"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_rejected_expensive]"
                      dataType="numeric"
                      name="des_qty_rejected_expensive"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[des_qty_rejected_other]"
                      dataType="numeric"
                      name="des_qty_rejected_other"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                      dataType="numeric"
                      name="estimate"
                      precision="38"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                      dataType="numeric"
                      name="overall_estimate"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                      dataType="numeric"
                      name="average_group_estimate"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                      dataType="numeric"
                      name="worker_factor"
                      precision="18"
                      scale="2" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                      name="id_year" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                      name="id_month" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                      name="work_days_in_month" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                      name="name" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[service]"
                      dataType="wstr"
                      length="20"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[service]"
                      name="service" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[bitrix_name]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[bitrix_name]"
                      name="bitrix_name" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[raw_estimate_participant]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[raw_estimate_participant]"
                      name="raw_estimate_participant" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                      name="work_days" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_all]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_all]"
                      name="ttr_req_qty_all" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_tender]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_tender]"
                      name="ttr_req_qty_tender" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_project]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_project]"
                      name="ttr_req_qty_project" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_complex]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_complex]"
                      name="ttr_req_qty_complex" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_typical]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_typical]"
                      name="ttr_req_qty_typical" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_indicative]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_indicative]"
                      name="ttr_req_qty_indicative" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_all]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_all]"
                      name="ttr_req_fast_qty_all" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_tender]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_tender]"
                      name="ttr_req_fast_qty_tender" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_project]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_project]"
                      name="ttr_req_fast_qty_project" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_complex]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_complex]"
                      name="ttr_req_fast_qty_complex" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_typical]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_typical]"
                      name="ttr_req_fast_qty_typical" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_indicative]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_indicative]"
                      name="ttr_req_fast_qty_indicative" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_all]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_all]"
                      name="ttr_req_slow_qty_all" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_tender]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_tender]"
                      name="ttr_req_slow_qty_tender" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_project]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_project]"
                      name="ttr_req_slow_qty_project" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_complex]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_complex]"
                      name="ttr_req_slow_qty_complex" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_typical]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_typical]"
                      name="ttr_req_slow_qty_typical" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_indicative]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_indicative]"
                      name="ttr_req_slow_qty_indicative" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_rework_qty]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_rework_qty]"
                      name="ttr_rework_qty" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_classified_qty]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_classified_qty]"
                      name="ttr_classified_qty" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_all]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_all]"
                      name="ttr_des_qty_all" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_accepted]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_accepted]"
                      name="ttr_des_qty_accepted" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_commission]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_commission]"
                      name="ttr_des_qty_commission" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_indicative]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_indicative]"
                      name="ttr_des_qty_indicative" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_rejected_expensive]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_rejected_expensive]"
                      name="ttr_des_qty_rejected_expensive" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_rejected_other]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_rejected_other]"
                      name="ttr_des_qty_rejected_other" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_personal_marginality]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_personal_marginality]"
                      name="ttr_personal_marginality"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_sum_margin]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ttr_sum_margin]"
                      name="ttr_sum_margin"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                      name="estimate_participant" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                      name="workers_count" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_tender]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_tender]"
                      name="req_qty_tender"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_project]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_project]"
                      name="req_qty_project"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_complex]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_complex]"
                      name="req_qty_complex"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_typical]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_typical]"
                      name="req_qty_typical"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_indicative]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_qty_indicative]"
                      name="req_qty_indicative"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_tender]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_tender]"
                      name="req_fast_qty_tender"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_project]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_project]"
                      name="req_fast_qty_project"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_complex]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_complex]"
                      name="req_fast_qty_complex"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_typical]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_typical]"
                      name="req_fast_qty_typical"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_indicative]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_fast_qty_indicative]"
                      name="req_fast_qty_indicative"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_tender]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_tender]"
                      name="req_slow_qty_tender"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_project]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_project]"
                      name="req_slow_qty_project"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_complex]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_complex]"
                      name="req_slow_qty_complex"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_typical]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_typical]"
                      name="req_slow_qty_typical"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_indicative]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[req_slow_qty_indicative]"
                      name="req_slow_qty_indicative"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[rework_qty]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[rework_qty]"
                      name="rework_qty"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_accepted]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_accepted]"
                      name="des_qty_accepted"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_commission]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_commission]"
                      name="des_qty_commission"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_indicative]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_indicative]"
                      name="des_qty_indicative"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_rejected_expensive]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_rejected_expensive]"
                      name="des_qty_rejected_expensive"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_rejected_other]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[des_qty_rejected_other]"
                      name="des_qty_rejected_other"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                      name="estimate"
                      precision="38"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                      name="overall_estimate"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                      name="average_group_estimate"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                      name="worker_factor"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload main\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ttr_main</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload main\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload main\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_year]"
                      cachedDataType="i4"
                      cachedName="id_year"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_month]"
                      cachedDataType="i4"
                      cachedName="id_month"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days_in_month]"
                      cachedDataType="i4"
                      cachedName="work_days_in_month"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[name]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="name"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="code"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[service]"
                      cachedDataType="wstr"
                      cachedLength="20"
                      cachedName="service"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[service]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[service]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[bitrix_name]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="bitrix_name"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[bitrix_name]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[bitrix_name]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate_participant]"
                      cachedDataType="i4"
                      cachedName="estimate_participant"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days]"
                      cachedDataType="i4"
                      cachedName="work_days"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_all]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_all"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_all]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_tender]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_tender"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_project]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_project"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_project]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_complex]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_complex"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_typical]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_typical"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_indicative]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_indicative"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_all]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_all"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_all]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_tender]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_tender"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_project]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_project"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_project]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_complex]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_complex"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_typical]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_typical"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_indicative]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_indicative"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_all]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_all"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_all]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_tender]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_tender"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_project]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_project"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_project]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_complex]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_complex"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_typical]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_typical"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_indicative]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_indicative"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_rework_qty]"
                      cachedDataType="i4"
                      cachedName="ttr_rework_qty"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_rework_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_rework_qty]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_classified_qty]"
                      cachedDataType="i4"
                      cachedName="ttr_classified_qty"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_classified_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_classified_qty]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_all]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_all"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_all]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_accepted]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_accepted"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_accepted]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_accepted]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_commission]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_commission"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_commission]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_commission]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_indicative]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_indicative"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_rejected_expensive]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_rejected_expensive"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_rejected_expensive]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_expensive]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_rejected_other]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_rejected_other"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_rejected_other]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_other]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_personal_marginality]"
                      cachedDataType="numeric"
                      cachedName="ttr_personal_marginality"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_personal_marginality]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_personal_marginality]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ttr_sum_margin]"
                      cachedDataType="numeric"
                      cachedName="ttr_sum_margin"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_sum_margin]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ttr_sum_margin]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[workers_count]"
                      cachedDataType="i4"
                      cachedName="workers_count"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_qty_tender]"
                      cachedDataType="numeric"
                      cachedName="req_qty_tender"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_qty_project]"
                      cachedDataType="numeric"
                      cachedName="req_qty_project"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_project]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_qty_complex]"
                      cachedDataType="numeric"
                      cachedName="req_qty_complex"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_qty_typical]"
                      cachedDataType="numeric"
                      cachedName="req_qty_typical"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_qty_indicative]"
                      cachedDataType="numeric"
                      cachedName="req_qty_indicative"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_fast_qty_tender]"
                      cachedDataType="numeric"
                      cachedName="req_fast_qty_tender"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_fast_qty_project]"
                      cachedDataType="numeric"
                      cachedName="req_fast_qty_project"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_project]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_fast_qty_complex]"
                      cachedDataType="numeric"
                      cachedName="req_fast_qty_complex"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_fast_qty_typical]"
                      cachedDataType="numeric"
                      cachedName="req_fast_qty_typical"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_fast_qty_indicative]"
                      cachedDataType="numeric"
                      cachedName="req_fast_qty_indicative"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_fast_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_slow_qty_tender]"
                      cachedDataType="numeric"
                      cachedName="req_slow_qty_tender"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_slow_qty_project]"
                      cachedDataType="numeric"
                      cachedName="req_slow_qty_project"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_project]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_slow_qty_complex]"
                      cachedDataType="numeric"
                      cachedName="req_slow_qty_complex"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_slow_qty_typical]"
                      cachedDataType="numeric"
                      cachedName="req_slow_qty_typical"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[req_slow_qty_indicative]"
                      cachedDataType="numeric"
                      cachedName="req_slow_qty_indicative"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[req_slow_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[rework_qty]"
                      cachedDataType="numeric"
                      cachedName="rework_qty"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[rework_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[rework_qty]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[des_qty_accepted]"
                      cachedDataType="numeric"
                      cachedName="des_qty_accepted"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_accepted]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_accepted]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[des_qty_commission]"
                      cachedDataType="numeric"
                      cachedName="des_qty_commission"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_commission]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_commission]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[des_qty_indicative]"
                      cachedDataType="numeric"
                      cachedName="des_qty_indicative"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[des_qty_rejected_expensive]"
                      cachedDataType="numeric"
                      cachedName="des_qty_rejected_expensive"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_rejected_expensive]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_rejected_expensive]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[des_qty_rejected_other]"
                      cachedDataType="numeric"
                      cachedName="des_qty_rejected_other"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_rejected_other]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[des_qty_rejected_other]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate]"
                      cachedDataType="numeric"
                      cachedName="estimate"
                      cachedPrecision="38"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[overall_estimate]"
                      cachedDataType="numeric"
                      cachedName="overall_estimate"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[average_group_estimate]"
                      cachedDataType="numeric"
                      cachedName="average_group_estimate"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[worker_factor]"
                      cachedDataType="numeric"
                      cachedName="worker_factor"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                      dataType="i4"
                      name="id_year" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                      dataType="i4"
                      name="id_month" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                      dataType="i4"
                      name="work_days_in_month" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                      dataType="wstr"
                      length="200"
                      name="name" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[service]"
                      dataType="wstr"
                      length="20"
                      name="service" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[bitrix_name]"
                      dataType="wstr"
                      length="200"
                      name="bitrix_name" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                      dataType="i4"
                      name="estimate_participant" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                      dataType="i4"
                      name="work_days" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_all]"
                      dataType="i4"
                      name="ttr_req_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_tender]"
                      dataType="i4"
                      name="ttr_req_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_project]"
                      dataType="i4"
                      name="ttr_req_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_complex]"
                      dataType="i4"
                      name="ttr_req_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_typical]"
                      dataType="i4"
                      name="ttr_req_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_all]"
                      dataType="i4"
                      name="ttr_req_fast_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_tender]"
                      dataType="i4"
                      name="ttr_req_fast_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_project]"
                      dataType="i4"
                      name="ttr_req_fast_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_complex]"
                      dataType="i4"
                      name="ttr_req_fast_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_typical]"
                      dataType="i4"
                      name="ttr_req_fast_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_fast_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_all]"
                      dataType="i4"
                      name="ttr_req_slow_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_tender]"
                      dataType="i4"
                      name="ttr_req_slow_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_project]"
                      dataType="i4"
                      name="ttr_req_slow_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_complex]"
                      dataType="i4"
                      name="ttr_req_slow_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_typical]"
                      dataType="i4"
                      name="ttr_req_slow_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_slow_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_rework_qty]"
                      dataType="i4"
                      name="ttr_rework_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_all]"
                      dataType="i4"
                      name="ttr_des_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_accepted]"
                      dataType="i4"
                      name="ttr_des_qty_accepted" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_commission]"
                      dataType="i4"
                      name="ttr_des_qty_commission" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_indicative]"
                      dataType="i4"
                      name="ttr_des_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_rejected_expensive]"
                      dataType="i4"
                      name="ttr_des_qty_rejected_expensive" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_rejected_other]"
                      dataType="i4"
                      name="ttr_des_qty_rejected_other" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_personal_marginality]"
                      dataType="numeric"
                      name="ttr_personal_marginality"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_sum_margin]"
                      dataType="numeric"
                      name="ttr_sum_margin"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                      dataType="i4"
                      name="workers_count" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_tender]"
                      dataType="numeric"
                      name="req_qty_tender"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_project]"
                      dataType="numeric"
                      name="req_qty_project"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_complex]"
                      dataType="numeric"
                      name="req_qty_complex"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_typical]"
                      dataType="numeric"
                      name="req_qty_typical"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_qty_indicative]"
                      dataType="numeric"
                      name="req_qty_indicative"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_tender]"
                      dataType="numeric"
                      name="req_fast_qty_tender"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_project]"
                      dataType="numeric"
                      name="req_fast_qty_project"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_complex]"
                      dataType="numeric"
                      name="req_fast_qty_complex"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_typical]"
                      dataType="numeric"
                      name="req_fast_qty_typical"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_fast_qty_indicative]"
                      dataType="numeric"
                      name="req_fast_qty_indicative"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_tender]"
                      dataType="numeric"
                      name="req_slow_qty_tender"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_project]"
                      dataType="numeric"
                      name="req_slow_qty_project"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_complex]"
                      dataType="numeric"
                      name="req_slow_qty_complex"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_typical]"
                      dataType="numeric"
                      name="req_slow_qty_typical"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_slow_qty_indicative]"
                      dataType="numeric"
                      name="req_slow_qty_indicative"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[rework_qty]"
                      dataType="numeric"
                      name="rework_qty"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_accepted]"
                      dataType="numeric"
                      name="des_qty_accepted"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_commission]"
                      dataType="numeric"
                      name="des_qty_commission"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_indicative]"
                      dataType="numeric"
                      name="des_qty_indicative"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_rejected_expensive]"
                      dataType="numeric"
                      name="des_qty_rejected_expensive"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[des_qty_rejected_other]"
                      dataType="numeric"
                      name="des_qty_rejected_other"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                      dataType="numeric"
                      name="estimate"
                      precision="38"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                      dataType="numeric"
                      name="overall_estimate"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                      dataType="numeric"
                      name="average_group_estimate"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                      dataType="numeric"
                      name="worker_factor"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[role_type]"
                      dataType="wstr"
                      length="50"
                      name="role_type" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_classified_qty]"
                      dataType="i4"
                      name="ttr_classified_qty" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload main\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload main.Paths[ADO NET Source Output]"
              endId="Package\Reload main\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload main\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload request details"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{2059FDFF-3286-4396-83B0-204724A5FF20}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload request details"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"WITH cte_cloth AS (
	SELECT deal_id, COUNT(CASE WHEN LEFT(hs_code,2) IN ('61','62') THEN 1 END) AS clothes_count
	FROM NAV.[webproject].[dbo].[bitrix_requests]
	GROUP BY deal_id
)

SELECT	

	DATEPART(YEAR, req_calc_finish) AS ttr_id_year,

	DATEPART(MONTH, req_calc_finish) AS ttr_id_month,

	[service_type_row] AS ttr_service,

	[assigned_ttr] AS ttr_assigned,	

	ca.code,

	d.deal_id,

	client,

	COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) req_calc_duration,

	FORMAT(req_calc_finish, 'dd.MM.yyyy') req_calc_finish,



	CASE WHEN request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_qty_tender,

	CASE WHEN request_type = 'Проект' THEN 1 ELSE 0 END AS ttr_req_qty_project,

	CASE WHEN request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_qty_complex,

	CASE WHEN request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_qty_typical,

	CASE WHEN request_type = 'Индикативный' THEN 1 ELSE 0 END AS ttr_req_qty_indicative,



	CASE WHEN req_calc_finish &lt;= COALESCE(tender_reply_date, '1900-01-01 00:00:00.000') AND request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_fast_qty_tender,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &lt; 96 AND request_type = 'Проект' THEN 1 ELSE 0 END AS ttr_req_fast_qty_project,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &lt; 24 AND request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_fast_qty_complex,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &lt; 24 AND request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_fast_qty_typical,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &lt; 24 AND request_type = 'Индикативный' THEN 1 ELSE 0 END AS ttr_req_fast_qty_indicative,



	CASE WHEN req_calc_finish &gt; COALESCE(tender_reply_date, '1900-01-01 00:00:00.000') AND request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_slow_qty_tender,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &gt;= 96 AND request_type = 'Проект' THEN 1 ELSE 0 END AS ttr_req_slow_qty_project,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &gt;= 24 AND request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_slow_qty_complex,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &gt;= 24 AND request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_slow_qty_typical,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &gt;= 24 AND request_type = 'Индикативный' THEN 1 ELSE 0 END AS ttr_req_slow_qty_indicative,



	CAST(ROUND((COALESCE([calc_fact_duration], 0) / 3600), 0) AS int) AS ttr_calc_fact_duration,

	CAST(COALESCE(calc_classified_qty, 0) AS int) AS ttr_classified_qty,
	CASE WHEN cc.clothes_count &gt; CAST(COALESCE(calc_classified_qty, 0) AS int) THEN CAST(COALESCE(calc_classified_qty, 0) AS int) ELSE cc.clothes_count END AS ttr_clothes_classified_qty,

	calc_rework_num AS ttr_rework_qty

	FROM [webproject].[dbo].[deals] d 

	CROSS APPLY (SELECT TOP (1) code FROM [motivation].[dbo].[ttr_workers] t WHERE t.bitrix_name = d.assigned_ttr) AS ca
		LEFT JOIN cte_cloth AS cc ON cc.deal_id = d.deal_id
	WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND req_calc_finish &gt;= '20200101'

AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(DATEPART(YEAR, req_calc_finish), DATEPART(MONTH, req_calc_finish), 10)) AS date)



UNION



SELECT	

	DATEPART(YEAR, calc_finish_date) AS ttr_id_year,

	DATEPART(MONTH, calc_finish_date) AS ttr_id_month,

	[service_type_row] AS ttr_service,

	[assigned_ttr] AS ttr_assigned,	

	ca.code,

	calc_id AS deal_id,

	COALESCE(client, '') AS client,

	COALESCE(CAST(ROUND([calc_fact_duration], 0) AS int), calc_duration, 0) req_calc_duration,

	FORMAT(calc_finish_date, 'dd.MM.yyyy') req_calc_finish,

	

	CASE WHEN request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_qty_tender,

	CASE WHEN request_type LIKE 'Проект%' THEN 1 ELSE 0 END AS ttr_req_qty_project,

	CASE WHEN request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_qty_complex,

	CASE WHEN request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_qty_typical,

	0 AS ttr_req_qty_indicative,



	CASE WHEN calc_in_time = 1 AND request_type = 'Тендер' THEN 1 ELSE 0 END  AS ttr_req_fast_qty_tender,

	CASE WHEN calc_in_time = 1 AND request_type LIKE 'Проект%' THEN 1 ELSE 0 END AS ttr_req_fast_qty_project,

	CASE WHEN calc_in_time = 1 AND request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_fast_qty_complex,

	CASE WHEN calc_in_time = 1 AND request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_fast_qty_typical,

	0 AS ttr_req_fast_qty_indicative,



	CASE WHEN calc_in_time = 0 AND request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_slow_qty_tender,

	CASE WHEN calc_in_time = 0 AND request_type LIKE 'Проект%' THEN 1 ELSE 0 END AS ttr_req_slow_qty_project,

	CASE WHEN calc_in_time = 0 AND request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_slow_qty_complex,

	CASE WHEN calc_in_time = 0 AND request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_slow_qty_typical,

	0 AS ttr_req_slow_qty_indicative,	



	CAST(ROUND((COALESCE([calc_fact_duration], 0)), 0) AS int) AS ttr_calc_fact_duration,

	calc_classified_qty AS ttr_classified_qty,
	CASE WHEN cc.clothes_count &gt; CAST(COALESCE(calc_classified_qty, 0) AS int) THEN CAST(COALESCE(calc_classified_qty, 0) AS int) ELSE cc.clothes_count END AS ttr_clothes_classified_qty,

	calc_rework_num AS ttr_rework_qty

	FROM [webproject].[dbo].[calculation_deals] d 

	CROSS APPLY (SELECT TOP (1) code FROM [motivation].[dbo].[ttr_workers] t WHERE t.bitrix_name = d.assigned_ttr) AS ca
		LEFT JOIN cte_cloth AS cc ON cc.deal_id = d.calc_id
	WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND calc_finish_date &gt;= '20200101' AND service_type_row IN ('ТО','ТЭО')

AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(DATEPART(YEAR, calc_finish_date), DATEPART(MONTH, calc_finish_date), 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload request details\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_cloth AS (
	SELECT deal_id, COUNT(CASE WHEN LEFT(hs_code,2) IN ('61','62') THEN 1 END) AS clothes_count
	FROM NAV.[webproject].[dbo].[bitrix_requests]
	GROUP BY deal_id
)

SELECT	

	DATEPART(YEAR, req_calc_finish) AS ttr_id_year,

	DATEPART(MONTH, req_calc_finish) AS ttr_id_month,

	[service_type_row] AS ttr_service,

	[assigned_ttr] AS ttr_assigned,	

	ca.code,

	d.deal_id,

	client,

	COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) req_calc_duration,

	FORMAT(req_calc_finish, 'dd.MM.yyyy') req_calc_finish,



	CASE WHEN request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_qty_tender,

	CASE WHEN request_type = 'Проект' THEN 1 ELSE 0 END AS ttr_req_qty_project,

	CASE WHEN request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_qty_complex,

	CASE WHEN request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_qty_typical,

	CASE WHEN request_type = 'Индикативный' THEN 1 ELSE 0 END AS ttr_req_qty_indicative,



	CASE WHEN req_calc_finish &lt;= COALESCE(tender_reply_date, '1900-01-01 00:00:00.000') AND request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_fast_qty_tender,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &lt; 96 AND request_type = 'Проект' THEN 1 ELSE 0 END AS ttr_req_fast_qty_project,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &lt; 24 AND request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_fast_qty_complex,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &lt; 24 AND request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_fast_qty_typical,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &lt; 24 AND request_type = 'Индикативный' THEN 1 ELSE 0 END AS ttr_req_fast_qty_indicative,



	CASE WHEN req_calc_finish &gt; COALESCE(tender_reply_date, '1900-01-01 00:00:00.000') AND request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_slow_qty_tender,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &gt;= 96 AND request_type = 'Проект' THEN 1 ELSE 0 END AS ttr_req_slow_qty_project,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &gt;= 24 AND request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_slow_qty_complex,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &gt;= 24 AND request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_slow_qty_typical,

	CASE WHEN COALESCE(CAST(ROUND([calc_fact_duration] / 3600, 0) AS int), [req_calc_duration], 0) &gt;= 24 AND request_type = 'Индикативный' THEN 1 ELSE 0 END AS ttr_req_slow_qty_indicative,



	CAST(ROUND((COALESCE([calc_fact_duration], 0) / 3600), 0) AS int) AS ttr_calc_fact_duration,

	CAST(COALESCE(calc_classified_qty, 0) AS int) AS ttr_classified_qty,
	CASE WHEN cc.clothes_count &gt; CAST(COALESCE(calc_classified_qty, 0) AS int) THEN CAST(COALESCE(calc_classified_qty, 0) AS int) ELSE cc.clothes_count END AS ttr_clothes_classified_qty,

	calc_rework_num AS ttr_rework_qty

	FROM [webproject].[dbo].[deals] d 

	CROSS APPLY (SELECT TOP (1) code FROM [motivation].[dbo].[ttr_workers] t WHERE t.bitrix_name = d.assigned_ttr) AS ca
		LEFT JOIN cte_cloth AS cc ON cc.deal_id = d.deal_id
	WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND req_calc_finish &gt;= '20200101'

AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(DATEPART(YEAR, req_calc_finish), DATEPART(MONTH, req_calc_finish), 10)) AS date)



UNION



SELECT	

	DATEPART(YEAR, calc_finish_date) AS ttr_id_year,

	DATEPART(MONTH, calc_finish_date) AS ttr_id_month,

	[service_type_row] AS ttr_service,

	[assigned_ttr] AS ttr_assigned,	

	ca.code,

	calc_id AS deal_id,

	COALESCE(client, '') AS client,

	COALESCE(CAST(ROUND([calc_fact_duration], 0) AS int), calc_duration, 0) req_calc_duration,

	FORMAT(calc_finish_date, 'dd.MM.yyyy') req_calc_finish,

	

	CASE WHEN request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_qty_tender,

	CASE WHEN request_type LIKE 'Проект%' THEN 1 ELSE 0 END AS ttr_req_qty_project,

	CASE WHEN request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_qty_complex,

	CASE WHEN request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_qty_typical,

	0 AS ttr_req_qty_indicative,



	CASE WHEN calc_in_time = 1 AND request_type = 'Тендер' THEN 1 ELSE 0 END  AS ttr_req_fast_qty_tender,

	CASE WHEN calc_in_time = 1 AND request_type LIKE 'Проект%' THEN 1 ELSE 0 END AS ttr_req_fast_qty_project,

	CASE WHEN calc_in_time = 1 AND request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_fast_qty_complex,

	CASE WHEN calc_in_time = 1 AND request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_fast_qty_typical,

	0 AS ttr_req_fast_qty_indicative,



	CASE WHEN calc_in_time = 0 AND request_type = 'Тендер' THEN 1 ELSE 0 END AS ttr_req_slow_qty_tender,

	CASE WHEN calc_in_time = 0 AND request_type LIKE 'Проект%' THEN 1 ELSE 0 END AS ttr_req_slow_qty_project,

	CASE WHEN calc_in_time = 0 AND request_type = 'Сложный' THEN 1 ELSE 0 END AS ttr_req_slow_qty_complex,

	CASE WHEN calc_in_time = 0 AND request_type = 'Типовой' THEN 1 ELSE 0 END AS ttr_req_slow_qty_typical,

	0 AS ttr_req_slow_qty_indicative,	



	CAST(ROUND((COALESCE([calc_fact_duration], 0)), 0) AS int) AS ttr_calc_fact_duration,

	calc_classified_qty AS ttr_classified_qty,
	CASE WHEN cc.clothes_count &gt; CAST(COALESCE(calc_classified_qty, 0) AS int) THEN CAST(COALESCE(calc_classified_qty, 0) AS int) ELSE cc.clothes_count END AS ttr_clothes_classified_qty,

	calc_rework_num AS ttr_rework_qty

	FROM [webproject].[dbo].[calculation_deals] d 

	CROSS APPLY (SELECT TOP (1) code FROM [motivation].[dbo].[ttr_workers] t WHERE t.bitrix_name = d.assigned_ttr) AS ca
		LEFT JOIN cte_cloth AS cc ON cc.deal_id = d.calc_id
	WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND calc_finish_date &gt;= '20200101' AND service_type_row IN ('ТО','ТЭО')

AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(DATEPART(YEAR, calc_finish_date), DATEPART(MONTH, calc_finish_date), 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload request details\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload request details\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_id_year]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_year]"
                      name="ttr_id_year"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_id_month]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_month]"
                      name="ttr_id_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_service]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_service]"
                      length="50"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_service]"
                      name="ttr_service"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_assigned]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_assigned]"
                      length="200"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_assigned]"
                      name="ttr_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      length="10"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[req_calc_duration]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[req_calc_duration]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[req_calc_duration]"
                      name="req_calc_duration"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[req_calc_finish]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[req_calc_finish]"
                      length="4000"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[req_calc_finish]"
                      name="req_calc_finish"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_tender]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_tender]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_tender]"
                      name="ttr_req_qty_tender"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_project]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_project]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_project]"
                      name="ttr_req_qty_project"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_complex]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_complex]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_complex]"
                      name="ttr_req_qty_complex"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_typical]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_typical]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_typical]"
                      name="ttr_req_qty_typical"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_indicative]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_indicative]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_indicative]"
                      name="ttr_req_qty_indicative"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_tender]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_tender]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_tender]"
                      name="ttr_req_fast_qty_tender"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_project]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_project]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_project]"
                      name="ttr_req_fast_qty_project"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_complex]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_complex]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_complex]"
                      name="ttr_req_fast_qty_complex"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_typical]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_typical]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_typical]"
                      name="ttr_req_fast_qty_typical"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_indicative]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_indicative]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_indicative]"
                      name="ttr_req_fast_qty_indicative"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_tender]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_tender]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_tender]"
                      name="ttr_req_slow_qty_tender"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_project]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_project]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_project]"
                      name="ttr_req_slow_qty_project"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_complex]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_complex]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_complex]"
                      name="ttr_req_slow_qty_complex"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_typical]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_typical]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_typical]"
                      name="ttr_req_slow_qty_typical"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_indicative]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_indicative]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_indicative]"
                      name="ttr_req_slow_qty_indicative"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_calc_fact_duration]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_calc_fact_duration]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_calc_fact_duration]"
                      name="ttr_calc_fact_duration"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_classified_qty]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_classified_qty]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_classified_qty]"
                      name="ttr_classified_qty"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_clothes_classified_qty]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_clothes_classified_qty]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_clothes_classified_qty]"
                      name="ttr_clothes_classified_qty"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_rework_qty]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_rework_qty]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_rework_qty]"
                      name="ttr_rework_qty"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_id_year]"
                      dataType="i4"
                      name="ttr_id_year" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_id_month]"
                      dataType="i4"
                      name="ttr_id_month" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_service]"
                      dataType="wstr"
                      length="50"
                      name="ttr_service" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_assigned]"
                      dataType="wstr"
                      length="200"
                      name="ttr_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[req_calc_duration]"
                      dataType="i4"
                      name="req_calc_duration" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[req_calc_finish]"
                      dataType="wstr"
                      length="4000"
                      name="req_calc_finish" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_tender]"
                      dataType="i4"
                      name="ttr_req_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_project]"
                      dataType="i4"
                      name="ttr_req_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_complex]"
                      dataType="i4"
                      name="ttr_req_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_typical]"
                      dataType="i4"
                      name="ttr_req_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_tender]"
                      dataType="i4"
                      name="ttr_req_fast_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_project]"
                      dataType="i4"
                      name="ttr_req_fast_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_complex]"
                      dataType="i4"
                      name="ttr_req_fast_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_typical]"
                      dataType="i4"
                      name="ttr_req_fast_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_fast_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_fast_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_tender]"
                      dataType="i4"
                      name="ttr_req_slow_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_project]"
                      dataType="i4"
                      name="ttr_req_slow_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_complex]"
                      dataType="i4"
                      name="ttr_req_slow_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_typical]"
                      dataType="i4"
                      name="ttr_req_slow_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_req_slow_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_slow_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_calc_fact_duration]"
                      dataType="i4"
                      name="ttr_calc_fact_duration" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_classified_qty]"
                      dataType="i4"
                      name="ttr_classified_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_clothes_classified_qty]"
                      dataType="i4"
                      name="ttr_clothes_classified_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_rework_qty]"
                      dataType="i4"
                      name="ttr_rework_qty" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_id_year]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_id_year]"
                      name="ttr_id_year" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_id_month]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_id_month]"
                      name="ttr_id_month" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_service]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_service]"
                      name="ttr_service" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_assigned]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_assigned]"
                      name="ttr_assigned" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[req_calc_duration]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[req_calc_duration]"
                      name="req_calc_duration" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[req_calc_finish]"
                      dataType="wstr"
                      length="4000"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[req_calc_finish]"
                      name="req_calc_finish" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_tender]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_tender]"
                      name="ttr_req_qty_tender" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_project]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_project]"
                      name="ttr_req_qty_project" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_complex]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_complex]"
                      name="ttr_req_qty_complex" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_typical]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_typical]"
                      name="ttr_req_qty_typical" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_indicative]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_qty_indicative]"
                      name="ttr_req_qty_indicative" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_tender]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_tender]"
                      name="ttr_req_fast_qty_tender" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_project]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_project]"
                      name="ttr_req_fast_qty_project" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_complex]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_complex]"
                      name="ttr_req_fast_qty_complex" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_typical]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_typical]"
                      name="ttr_req_fast_qty_typical" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_indicative]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_fast_qty_indicative]"
                      name="ttr_req_fast_qty_indicative" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_tender]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_tender]"
                      name="ttr_req_slow_qty_tender" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_project]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_project]"
                      name="ttr_req_slow_qty_project" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_complex]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_complex]"
                      name="ttr_req_slow_qty_complex" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_typical]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_typical]"
                      name="ttr_req_slow_qty_typical" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_indicative]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_req_slow_qty_indicative]"
                      name="ttr_req_slow_qty_indicative" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_calc_fact_duration]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_calc_fact_duration]"
                      name="ttr_calc_fact_duration" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_classified_qty]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_classified_qty]"
                      name="ttr_classified_qty" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_clothes_classified_qty]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_clothes_classified_qty]"
                      name="ttr_clothes_classified_qty" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_rework_qty]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_rework_qty]"
                      name="ttr_rework_qty" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload request details\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ttr_request_details</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload request details\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_id_year]"
                      cachedDataType="i4"
                      cachedName="ttr_id_year"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_id_year]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_year]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_id_month]"
                      cachedDataType="i4"
                      cachedName="ttr_id_month"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_id_month]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_month]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_service]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="ttr_service"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_service]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_service]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_assigned]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="ttr_assigned"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_assigned]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_assigned]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="code"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[req_calc_duration]"
                      cachedDataType="i4"
                      cachedName="req_calc_duration"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_calc_duration]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[req_calc_duration]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[req_calc_finish]"
                      cachedDataType="wstr"
                      cachedLength="4000"
                      cachedName="req_calc_finish"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_calc_finish]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[req_calc_finish]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_tender]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_tender"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_tender]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_project]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_project"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_project]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_project]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_complex]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_complex"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_complex]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_typical]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_typical"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_typical]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_qty_indicative]"
                      cachedDataType="i4"
                      cachedName="ttr_req_qty_indicative"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_indicative]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_tender]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_tender"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_tender]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_project]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_project"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_project]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_project]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_complex]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_complex"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_complex]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_typical]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_typical"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_typical]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_fast_qty_indicative]"
                      cachedDataType="i4"
                      cachedName="ttr_req_fast_qty_indicative"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_indicative]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_fast_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_tender]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_tender"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_tender]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_project]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_project"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_project]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_project]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_complex]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_complex"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_complex]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_typical]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_typical"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_typical]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_req_slow_qty_indicative]"
                      cachedDataType="i4"
                      cachedName="ttr_req_slow_qty_indicative"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_indicative]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_req_slow_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_calc_fact_duration]"
                      cachedDataType="i4"
                      cachedName="ttr_calc_fact_duration"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_calc_fact_duration]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_calc_fact_duration]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_classified_qty]"
                      cachedDataType="i4"
                      cachedName="ttr_classified_qty"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_classified_qty]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_classified_qty]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_clothes_classified_qty]"
                      cachedDataType="i4"
                      cachedName="ttr_clothes_classified_qty"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_clothes_classified_qty]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_clothes_classified_qty]" />
                    <inputColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].Columns[ttr_rework_qty]"
                      cachedDataType="i4"
                      cachedName="ttr_rework_qty"
                      externalMetadataColumnId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_rework_qty]"
                      lineageId="Package\Reload request details\Query.Outputs[ADO NET Source Output].Columns[ttr_rework_qty]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_id_year]"
                      dataType="i4"
                      name="ttr_id_year" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_id_month]"
                      dataType="i4"
                      name="ttr_id_month" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_service]"
                      dataType="wstr"
                      length="10"
                      name="ttr_service" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_assigned]"
                      dataType="wstr"
                      length="100"
                      name="ttr_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_calc_duration]"
                      dataType="i4"
                      name="req_calc_duration" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_calc_finish]"
                      dataType="wstr"
                      length="4000"
                      name="req_calc_finish" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_tender]"
                      dataType="i4"
                      name="ttr_req_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_project]"
                      dataType="i4"
                      name="ttr_req_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_complex]"
                      dataType="i4"
                      name="ttr_req_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_typical]"
                      dataType="i4"
                      name="ttr_req_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_tender]"
                      dataType="i4"
                      name="ttr_req_fast_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_project]"
                      dataType="i4"
                      name="ttr_req_fast_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_complex]"
                      dataType="i4"
                      name="ttr_req_fast_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_typical]"
                      dataType="i4"
                      name="ttr_req_fast_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_fast_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_fast_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_tender]"
                      dataType="i4"
                      name="ttr_req_slow_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_project]"
                      dataType="i4"
                      name="ttr_req_slow_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_complex]"
                      dataType="i4"
                      name="ttr_req_slow_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_typical]"
                      dataType="i4"
                      name="ttr_req_slow_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_req_slow_qty_indicative]"
                      dataType="i4"
                      name="ttr_req_slow_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_calc_fact_duration]"
                      dataType="i4"
                      name="ttr_calc_fact_duration" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_classified_qty]"
                      dataType="i4"
                      name="ttr_classified_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_classified_type]"
                      dataType="wstr"
                      length="50"
                      name="ttr_classified_type" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_rework_qty]"
                      dataType="i4"
                      name="ttr_rework_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload request details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_clothes_classified_qty]"
                      dataType="i4"
                      name="ttr_clothes_classified_qty" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload request details\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload request details\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload request details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload request details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload request details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload request details.Paths[ADO NET Source Output]"
              endId="Package\Reload request details\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload request details\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload result details"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{025A8500-549F-4719-99A3-BE2C7823D981}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload result details"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"SELECT
	
	DATEPART(YEAR, calc_decision_date) AS ttr_id_year,
	DATEPART(MONTH, calc_decision_date) AS ttr_id_month,
	[service_type_row] AS ttr_service,
	[assigned_ttr] AS ttr_assigned,
	ca.code,
	calc_id AS [deal_id],
	[client],
	FORMAT(calc_decision_date, 'dd.MM.yyyy') AS decision_date,
	'-' AS [comission_date],
	
	CASE WHEN calc_status_id = 'C16:WON' THEN 1 ELSE 0 END AS ttr_des_qty_accepted,
	0 AS ttr_des_qty_commission,	
	CASE WHEN calc_status_id = 'C16:LOSE' THEN 1 ELSE 0 END AS ttr_des_qty_indicative,
	CASE WHEN calc_status_id = 'C16:1' THEN 1 ELSE 0 END AS ttr_des_qty_rejected_expensive,
	CASE WHEN calc_status_id IN ('C16:APOLOGY', 'C16:2', 'C16:3') THEN 1 ELSE 0 END AS ttr_des_qty_rejected_other

	FROM [webproject].[dbo].calculation_deals d
	CROSS APPLY (SELECT TOP (1) [code] FROM [motivation].[dbo].[ttr_workers] t WHERE t.bitrix_name = d.assigned_ttr) AS ca
	WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND calc_decision_date &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(DATEPART(YEAR, calc_decision_date), DATEPART(MONTH, calc_decision_date), 10)) AS date)

UNION

SELECT
	
	DATEPART(YEAR, decision_date) AS ttr_id_year,
	DATEPART(MONTH, decision_date) AS ttr_id_month,
	[service_type_row] AS ttr_service,
	[assigned_ttr] AS ttr_assigned,
	ca.code,
	[deal_id],
	[client],
	FORMAT(decision_date, 'dd.MM.yyyy') AS decision_date,
	CASE 
	WHEN CAST([comission_date] AS date) &gt;= '20190101' THEN FORMAT([comission_date], 'dd.MM.yyyy')
	ELSE '-' END
	AS [comission_date],
	
	CASE WHEN UPPER([client_decision]) = 'ПРИНЯТО' AND CAST([comission_date] AS date) &lt; '20190101' THEN 1 ELSE 0 END AS ttr_des_qty_accepted,
	CASE WHEN CAST([comission_date] AS date) &gt;= '20190101' THEN 1 ELSE 0 END AS ttr_des_qty_commission,	
	CASE WHEN UPPER([client_decision]) = 'ИНДИКАТИВ' THEN 1 ELSE 0 END AS ttr_des_qty_indicative,
	CASE WHEN UPPER([client_decision]) = 'ОТКАЗ / ДОРОГО' THEN 1 ELSE 0 END AS ttr_des_qty_rejected_expensive,
	CASE WHEN UPPER([client_decision]) IN ('ОТКАЗ / ДОЛГО ОТВЕЧАЛИ', 'НЕ АКТУАЛЬНО', 'ОТКАЗ / ТРАНЗИТНОЕ ВРЕМЯ') THEN 1 ELSE 0 END AS ttr_des_qty_rejected_other

	FROM [webproject].[dbo].[deals] d
	CROSS APPLY (SELECT TOP (1) [code] FROM [motivation].[dbo].[ttr_workers] t WHERE t.bitrix_name = d.assigned_ttr) AS ca
	WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND decision_date &gt;= '20200101'
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(DATEPART(YEAR, decision_date), DATEPART(MONTH, decision_date), 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload result details\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT
	
	DATEPART(YEAR, calc_decision_date) AS ttr_id_year,
	DATEPART(MONTH, calc_decision_date) AS ttr_id_month,
	[service_type_row] AS ttr_service,
	[assigned_ttr] AS ttr_assigned,
	ca.code,
	calc_id AS [deal_id],
	[client],
	FORMAT(calc_decision_date, 'dd.MM.yyyy') AS decision_date,
	'-' AS [comission_date],
	
	CASE WHEN calc_status_id = 'C16:WON' THEN 1 ELSE 0 END AS ttr_des_qty_accepted,
	0 AS ttr_des_qty_commission,	
	CASE WHEN calc_status_id = 'C16:LOSE' THEN 1 ELSE 0 END AS ttr_des_qty_indicative,
	CASE WHEN calc_status_id = 'C16:1' THEN 1 ELSE 0 END AS ttr_des_qty_rejected_expensive,
	CASE WHEN calc_status_id IN ('C16:APOLOGY', 'C16:2', 'C16:3') THEN 1 ELSE 0 END AS ttr_des_qty_rejected_other

	FROM [webproject].[dbo].calculation_deals d
	CROSS APPLY (SELECT TOP (1) [code] FROM [motivation].[dbo].[ttr_workers] t WHERE t.bitrix_name = d.assigned_ttr) AS ca
	WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND calc_decision_date &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(DATEPART(YEAR, calc_decision_date), DATEPART(MONTH, calc_decision_date), 10)) AS date)

UNION

SELECT
	
	DATEPART(YEAR, decision_date) AS ttr_id_year,
	DATEPART(MONTH, decision_date) AS ttr_id_month,
	[service_type_row] AS ttr_service,
	[assigned_ttr] AS ttr_assigned,
	ca.code,
	[deal_id],
	[client],
	FORMAT(decision_date, 'dd.MM.yyyy') AS decision_date,
	CASE 
	WHEN CAST([comission_date] AS date) &gt;= '20190101' THEN FORMAT([comission_date], 'dd.MM.yyyy')
	ELSE '-' END
	AS [comission_date],
	
	CASE WHEN UPPER([client_decision]) = 'ПРИНЯТО' AND CAST([comission_date] AS date) &lt; '20190101' THEN 1 ELSE 0 END AS ttr_des_qty_accepted,
	CASE WHEN CAST([comission_date] AS date) &gt;= '20190101' THEN 1 ELSE 0 END AS ttr_des_qty_commission,	
	CASE WHEN UPPER([client_decision]) = 'ИНДИКАТИВ' THEN 1 ELSE 0 END AS ttr_des_qty_indicative,
	CASE WHEN UPPER([client_decision]) = 'ОТКАЗ / ДОРОГО' THEN 1 ELSE 0 END AS ttr_des_qty_rejected_expensive,
	CASE WHEN UPPER([client_decision]) IN ('ОТКАЗ / ДОЛГО ОТВЕЧАЛИ', 'НЕ АКТУАЛЬНО', 'ОТКАЗ / ТРАНЗИТНОЕ ВРЕМЯ') THEN 1 ELSE 0 END AS ttr_des_qty_rejected_other

	FROM [webproject].[dbo].[deals] d
	CROSS APPLY (SELECT TOP (1) [code] FROM [motivation].[dbo].[ttr_workers] t WHERE t.bitrix_name = d.assigned_ttr) AS ca
	WHERE COALESCE([assigned_ttr], '') &lt;&gt; '' AND decision_date &gt;= '20200101'
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(DATEPART(YEAR, decision_date), DATEPART(MONTH, decision_date), 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload result details\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload result details\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_id_year]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_year]"
                      name="ttr_id_year"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_id_month]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_month]"
                      name="ttr_id_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_service]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_service]"
                      length="50"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_service]"
                      name="ttr_service"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_assigned]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_assigned]"
                      length="200"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_assigned]"
                      name="ttr_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      length="10"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[decision_date]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[decision_date]"
                      length="4000"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[decision_date]"
                      name="decision_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[comission_date]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[comission_date]"
                      length="4000"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[comission_date]"
                      name="comission_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_accepted]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_accepted]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_accepted]"
                      name="ttr_des_qty_accepted"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_commission]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_commission]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_commission]"
                      name="ttr_des_qty_commission"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_indicative]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_indicative]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_indicative]"
                      name="ttr_des_qty_indicative"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_expensive]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_rejected_expensive]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_expensive]"
                      name="ttr_des_qty_rejected_expensive"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_other]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_rejected_other]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_other]"
                      name="ttr_des_qty_rejected_other"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_id_year]"
                      dataType="i4"
                      name="ttr_id_year" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_id_month]"
                      dataType="i4"
                      name="ttr_id_month" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_service]"
                      dataType="wstr"
                      length="50"
                      name="ttr_service" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_assigned]"
                      dataType="wstr"
                      length="200"
                      name="ttr_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[decision_date]"
                      dataType="wstr"
                      length="4000"
                      name="decision_date" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[comission_date]"
                      dataType="wstr"
                      length="4000"
                      name="comission_date" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_accepted]"
                      dataType="i4"
                      name="ttr_des_qty_accepted" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_commission]"
                      dataType="i4"
                      name="ttr_des_qty_commission" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_indicative]"
                      dataType="i4"
                      name="ttr_des_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_rejected_expensive]"
                      dataType="i4"
                      name="ttr_des_qty_rejected_expensive" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Output].ExternalColumns[ttr_des_qty_rejected_other]"
                      dataType="i4"
                      name="ttr_des_qty_rejected_other" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_id_year]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_id_year]"
                      name="ttr_id_year" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_id_month]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_id_month]"
                      name="ttr_id_month" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_service]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_service]"
                      name="ttr_service" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_assigned]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_assigned]"
                      name="ttr_assigned" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[decision_date]"
                      dataType="wstr"
                      length="4000"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[decision_date]"
                      name="decision_date" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[comission_date]"
                      dataType="wstr"
                      length="4000"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[comission_date]"
                      name="comission_date" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_accepted]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_accepted]"
                      name="ttr_des_qty_accepted" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_commission]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_commission]"
                      name="ttr_des_qty_commission" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_indicative]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_indicative]"
                      name="ttr_des_qty_indicative" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_rejected_expensive]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_rejected_expensive]"
                      name="ttr_des_qty_rejected_expensive" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_rejected_other]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ttr_des_qty_rejected_other]"
                      name="ttr_des_qty_rejected_other" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload result details\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ttr_result_details</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload result details\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[ttr_id_year]"
                      cachedDataType="i4"
                      cachedName="ttr_id_year"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_id_year]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_year]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[ttr_id_month]"
                      cachedDataType="i4"
                      cachedName="ttr_id_month"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_id_month]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_id_month]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[ttr_service]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="ttr_service"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_service]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_service]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[ttr_assigned]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="ttr_assigned"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_assigned]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_assigned]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="code"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[decision_date]"
                      cachedDataType="wstr"
                      cachedLength="4000"
                      cachedName="decision_date"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[decision_date]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[decision_date]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[comission_date]"
                      cachedDataType="wstr"
                      cachedLength="4000"
                      cachedName="comission_date"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[comission_date]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[comission_date]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_accepted]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_accepted"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_accepted]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_accepted]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_commission]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_commission"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_commission]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_commission]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_indicative]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_indicative"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_indicative]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_rejected_expensive]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_rejected_expensive"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_rejected_expensive]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_expensive]" />
                    <inputColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].Columns[ttr_des_qty_rejected_other]"
                      cachedDataType="i4"
                      cachedName="ttr_des_qty_rejected_other"
                      externalMetadataColumnId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_rejected_other]"
                      lineageId="Package\Reload result details\Query.Outputs[ADO NET Source Output].Columns[ttr_des_qty_rejected_other]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_id_year]"
                      dataType="i4"
                      name="ttr_id_year" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_id_month]"
                      dataType="i4"
                      name="ttr_id_month" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_service]"
                      dataType="wstr"
                      length="10"
                      name="ttr_service" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_assigned]"
                      dataType="wstr"
                      length="100"
                      name="ttr_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[decision_date]"
                      dataType="wstr"
                      length="4000"
                      name="decision_date" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[comission_date]"
                      dataType="wstr"
                      length="4000"
                      name="comission_date" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_accepted]"
                      dataType="i4"
                      name="ttr_des_qty_accepted" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_commission]"
                      dataType="i4"
                      name="ttr_des_qty_commission" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_indicative]"
                      dataType="i4"
                      name="ttr_des_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_rejected_expensive]"
                      dataType="i4"
                      name="ttr_des_qty_rejected_expensive" />
                    <externalMetadataColumn
                      refId="Package\Reload result details\Table.Inputs[ADO NET Destination Input].ExternalColumns[ttr_des_qty_rejected_other]"
                      dataType="i4"
                      name="ttr_des_qty_rejected_other" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload result details\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload result details\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload result details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload result details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload result details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload result details.Paths[ADO NET Source Output]"
              endId="Package\Reload result details\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload result details\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Remove fired"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{7B53D4A8-E24D-44DA-A658-9476D0EF2F8F}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Remove fired"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="WITH cte AS (&#xA;SELECT w.*&#xA;FROM [motivation].[dbo].[ttr_workers] AS w&#xA;JOIN [motivation].[dbo].[bitrix_users] AS sp ON sp.nav_code = w.code AND sp.active = 'N'&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR(w.date_begin), MONTH(w.date_begin), 10)) AS date)&#xA;AND w.role_type = 1&#xA;AND w.estimate_participant = 1&#xA;AND w.type = 'ttr_specialist'&#xA;AND w.service = 'ТО'&#xA;)&#xA;UPDATE cte&#xA;SET estimate_participant = 0" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Set depth"
      DTS:CreationName="Microsoft.ExpressionTask"
      DTS:Description="Expression Task"
      DTS:DTSID="{D39DDB24-16E9-445D-A35C-6A3E5A45C1D8}"
      DTS:ExecutableType="Microsoft.ExpressionTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Set depth"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExpressionTask
          Expression="@[User::depth_months] =  @[$Package::depth_months]" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Truncate"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{C701D2E2-76C4-4044-9154-63126B7F4629}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Truncate"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="DELETE FROM [motivation].[dbo].[ttr_main]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(id_year, id_month, 10)) AS date)&#xA;DELETE FROM [motivation].[dbo].[ttr_result_details]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(ttr_id_year, ttr_id_month, 10)) AS date)&#xA;DELETE FROM [motivation].[dbo].[ttr_marginality]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(close_year, close_month, 10)) AS date)&#xA;DELETE FROM [motivation].[dbo].[ttr_request_details]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(ttr_id_year, ttr_id_month, 10)) AS date)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update main TEO roles"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{B23EC01A-0AF7-4F58-B871-CA856D929822}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update main TEO roles"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="UPDATE [motivation].[dbo].[ttr_workers]&#xA;SET [is_archive] = 1&#xA;WHERE [is_archive] = 0 AND [role_type] = 1 AND [service] = 'ТЭО' AND&#xA;[date_end] &lt; CAST(GETDATE() AS date)&#xA;&#xA;GO&#xA;&#xA;WITH cte_calendar AS (&#xA;&#x9;SELECT id_year, id_month, CASE WHEN id_year = YEAR(GETDATE()) AND id_month = MONTH(GETDATE()) THEN 1 ELSE 0 END AS current_month&#xA;&#x9;FROM [BI].[dbo].[DimCalendar] dc&#xA;&#x9;WHERE id_year &gt;= 2020 &#xA;&#x9;AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))&#xA;&#x9;GROUP BY id_year, id_month&#xA;),&#xA;&#xA;cte_final AS (&#xA;&#x9;SELECT &#xA;&#x9;b.nav_code AS SalespersonCode,&#xA;&#x9;b.[name] AS SalespersonName,&#xA;&#x9;b.bitrix_name AS bitrix_name,&#xA;&#x9;b.[department_name] AS [Dept_ Code]&#xA;&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND group_id IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_declarant&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND COALESCE(group_id, '') NOT IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_sto_spec&#xA;&#x9;,CASE WHEN office_id = '34' AND has_ttr_calculations = 1 AND department_id = '1123' THEN 1 ELSE 0 END AS is_sto_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '52' AND (department_id IN ('1044','56','60','64','66','68') OR (department_id = '1090' AND COALESCE(group_id, '') = '')) THEN 1 ELSE 0 END AS is_stl_spec&#xA;&#x9;,CASE WHEN office_id = '52' AND department_id = '1090' AND has_ttr_calculations = 1 AND COALESCE(group_id, '') &lt;&gt; '' THEN 1 ELSE 0 END AS is_stl_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '628' AND department_id IN ('1052','1082','22','76') THEN 1 ELSE 0 END AS is_ks&#xA;&#x9;FROM [motivation].[dbo].[bitrix_users] AS b&#xA;&#x9;WHERE active = 'Y' AND COALESCE(nav_code, '') &lt;&gt; ''&#xA;)&#xA;&#xA;INSERT [motivation].[dbo].[ttr_workers] ([service]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[name]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[bitrix_name]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[code]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[type]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[schedule]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_begin]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_end]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[is_archive]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[estimate_participant]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[role_type])&#xA;SELECT &#xA;'ТЭО' AS [service],&#xA;c.SalespersonName AS [name],&#xA;c.bitrix_name AS [bitrix_name],&#xA;c.SalespersonCode AS [code],&#xA;'ttr_specialist' AS [type],&#xA;NULL AS [schedule],&#x9;&#x9;&#xA;CAST(DATEFROMPARTS(id_year, id_month, 1) AS date) AS [date_begin],&#xA;CAST(EOMONTH(DATEFROMPARTS(id_year, id_month, 1)) AS date) AS [date_end],&#xA;CASE WHEN current_month = 1 THEN 0 ELSE 1 END AS [is_archive],&#xA;1 AS [estimate_participant],&#xA;1 AS [role_type]&#xA;&#xA;FROM cte_final AS c&#xA;CROSS JOIN cte_calendar AS cc&#xA;WHERE is_stl_ttr = 1&#xA;AND NOT EXISTS (SELECT 0 FROM [motivation].[dbo].[ttr_workers] AS sw &#xA;WHERE sw.[service] = 'ТЭО' AND cc.id_year = YEAR([date_begin]) AND cc.id_month = MONTH([date_begin]))" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update main TO roles"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{F08F58E2-AE1F-4C73-9C1E-FA622FF1C8DE}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update main TO roles"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="UPDATE [motivation].[dbo].[ttr_workers]&#xA;SET [is_archive] = 1&#xA;WHERE [is_archive] = 0 AND [role_type] = 1 AND [service] = 'ТО' AND&#xA;[date_end] &lt; CAST(GETDATE() AS date)&#xA;&#xA;GO&#xA;&#xA;WITH cte_calendar AS (&#xA;&#x9;SELECT id_year, id_month, CASE WHEN id_year = YEAR(GETDATE()) AND id_month = MONTH(GETDATE()) THEN 1 ELSE 0 END AS current_month&#xA;&#x9;FROM [BI].[dbo].[DimCalendar] dc&#xA;&#x9;WHERE id_year &gt;= 2020 &#xA;&#x9;AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))&#xA;&#x9;GROUP BY id_year, id_month&#xA;),&#xA;&#xA;cte_final AS (&#xA;&#x9;SELECT &#xA;&#x9;b.nav_code AS SalespersonCode,&#xA;&#x9;b.[name] AS SalespersonName,&#xA;&#x9;b.bitrix_name AS bitrix_name,&#xA;&#x9;b.[department_name] AS [Dept_ Code]&#xA;&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND group_id IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_declarant&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND COALESCE(group_id, '') NOT IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_sto_spec&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id = '1123' AND has_ttr_calculations = 1 THEN 1 ELSE 0 END AS is_sto_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '52' AND department_id IN ('1044','56','60','64','66','68') THEN 1 ELSE 0 END AS is_stl_spec&#xA;&#x9;,CASE WHEN office_id = '52' AND department_id = '1090' AND has_ttr_calculations = 1 THEN 1 ELSE 0 END AS is_stl_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '628' AND department_id IN ('1052','1082','22','76') THEN 1 ELSE 0 END AS is_ks&#xA;&#x9;FROM [motivation].[dbo].[bitrix_users] AS b&#xA;&#x9;WHERE active = 'Y' AND COALESCE(nav_code, '') &lt;&gt; ''&#xA;)&#xA;&#xA;INSERT [motivation].[dbo].[ttr_workers] ([service]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[name]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[bitrix_name]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[code]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[type]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[schedule]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_begin]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_end]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[is_archive]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[estimate_participant]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[role_type])&#xA;SELECT &#xA;'ТО' AS [service],&#xA;c.SalespersonName AS [name],&#xA;c.bitrix_name AS [bitrix_name],&#xA;c.SalespersonCode AS [code],&#xA;'ttr_specialist' AS [type],&#xA;NULL AS [schedule],&#x9;&#x9;&#xA;CAST(DATEFROMPARTS(id_year, id_month, 1) AS date) AS [date_begin],&#xA;CAST(EOMONTH(DATEFROMPARTS(id_year, id_month, 1)) AS date) AS [date_end],&#xA;CASE WHEN current_month = 1 THEN 0 ELSE 1 END AS [is_archive],&#xA;1 AS [estimate_participant],&#xA;1 AS [role_type]&#xA;&#xA;FROM cte_final AS c&#xA;CROSS JOIN cte_calendar AS cc&#xA;WHERE is_sto_ttr = 1&#xA;AND NOT EXISTS (SELECT 0 FROM [motivation].[dbo].[ttr_workers] AS sw &#xA;WHERE sw.[service] = 'ТО' AND cc.id_year = YEAR([date_begin]) AND cc.id_month = MONTH([date_begin]))" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update role_type"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{35B5FE0E-CB8C-43BC-94DD-BFC0B85E4AA6}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update role_type"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="UPDATE main&#xA;SET role_type = CASE oa.role_type WHEN 1 THEN 'Основная' ELSE 'Дополнительная' END&#xA;FROM [motivation].[dbo].[ttr_main] AS main&#xA;OUTER APPLY (SELECT TOP (1) role_type&#xA;FROM [motivation].[dbo].[ttr_workers] AS w&#xA;WHERE main.code = w.code&#xA;AND DATEFROMPARTS(main.id_year, main.id_month, 15) BETWEEN w.date_begin AND w.date_end) AS oa" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Updated at"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{463422FE-E648-4939-AED6-E79A8B904892}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Updated at"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="  UPDATE [motivation].[dbo].[updated_at]&#xA;  SET [date_time] = GETDATE()&#xA;  WHERE [department] = 'ttr'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение]"
      DTS:CreationName=""
      DTS:DTSID="{A92E242A-100E-417E-8C15-88F964BA2409}"
      DTS:From="Package\Truncate"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение"
      DTS:To="Package\Reload add roles" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 1]"
      DTS:CreationName=""
      DTS:DTSID="{690A5233-E5D1-4A0B-BC99-CE8C525B6EC5}"
      DTS:From="Package\Reload main"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 1"
      DTS:To="Package\Updated at" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 10]"
      DTS:CreationName=""
      DTS:DTSID="{49C67913-1586-4D2D-823B-3CA4D88E811A}"
      DTS:From="Package\Reload main"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 10"
      DTS:To="Package\Update role_type" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 11]"
      DTS:CreationName=""
      DTS:DTSID="{0CDB28F2-7B32-46BD-ADE2-B9D3792FDFB3}"
      DTS:From="Package\Delete add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 11"
      DTS:To="Package\Update main TO roles" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 12]"
      DTS:CreationName=""
      DTS:DTSID="{E329D6B2-7E4E-4D19-AAC4-F4C9A56E3FD2}"
      DTS:From="Package\Remove fired"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 12"
      DTS:To="Package\Delete add roles" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 13]"
      DTS:CreationName=""
      DTS:DTSID="{0076833A-6ADB-4825-8174-BBCF80F7FF05}"
      DTS:From="Package\Set depth"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 13"
      DTS:To="Package\Remove fired" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 2]"
      DTS:CreationName=""
      DTS:DTSID="{6012FE42-066E-4422-87A9-1E298C308971}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 2"
      DTS:To="Package\Reload commissions" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 3]"
      DTS:CreationName=""
      DTS:DTSID="{D62A580B-07D6-49FA-82F7-A72463CA5614}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 3"
      DTS:To="Package\Reload request details" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 4]"
      DTS:CreationName=""
      DTS:DTSID="{AF4E3F16-6355-45F0-9525-AEF77968A0B9}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 4"
      DTS:To="Package\Reload result details" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 5]"
      DTS:CreationName=""
      DTS:DTSID="{25360B76-543F-4216-B7FE-0D48166585B9}"
      DTS:From="Package\Reload result details"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 5"
      DTS:To="Package\Reload main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 6]"
      DTS:CreationName=""
      DTS:DTSID="{818B5CD2-2857-4196-A494-F825988C3DF8}"
      DTS:From="Package\Reload commissions"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 6"
      DTS:To="Package\Reload main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 7]"
      DTS:CreationName=""
      DTS:DTSID="{ECB62B67-37DC-44D1-8389-A8F1050EFAA8}"
      DTS:From="Package\Reload request details"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 7"
      DTS:To="Package\Reload main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 8]"
      DTS:CreationName=""
      DTS:DTSID="{05C5D94A-B957-4D93-BAB0-5540B793721D}"
      DTS:From="Package\Update main TO roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 8"
      DTS:To="Package\Update main TEO roles" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 9]"
      DTS:CreationName=""
      DTS:DTSID="{98B1CB98-991A-485F-A978-303E536EFC5F}"
      DTS:From="Package\Update main TEO roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 9"
      DTS:To="Package\Truncate" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--В данном разделе CDATA содержатся сведения о макете пакета. В данном разделе содержатся сведения о координатах (x,y), ширине и высоте.-->
<!--В случае возникновения ошибки при редактировании этого раздела вручную его можно удалить. -->
<!--Пакет можно загрузить обычным образом, но прежние сведения о макете будут утеряны, и конструктор автоматически перераспределит элементы в области конструктора.-->
<Objects
  Version="8">
  <!--Все приведенные ниже узлы будут содержать свойства, не влияющие на поведение среды выполнения.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="156,42"
          Id="Package\Delete add roles"
          TopLeft="191,17" />
        <NodeLayout
          Size="157,42"
          Id="Package\Reload add roles"
          TopLeft="201,291" />
        <NodeLayout
          Size="174,42"
          Id="Package\Reload commissions"
          TopLeft="193,369" />
        <NodeLayout
          Size="137,42"
          Id="Package\Reload main"
          TopLeft="205,501" />
        <NodeLayout
          Size="183,42"
          Id="Package\Reload request details"
          TopLeft="385,368" />
        <NodeLayout
          Size="174,42"
          Id="Package\Reload result details"
          TopLeft="4,365" />
        <NodeLayout
          Size="141,42"
          Id="Package\Remove fired"
          TopLeft="9,21" />
        <NodeLayout
          Size="124,42"
          Id="Package\Set depth"
          TopLeft="19,90" />
        <NodeLayout
          Size="121,42"
          Id="Package\Truncate"
          TopLeft="213,217" />
        <NodeLayout
          Size="188,42"
          Id="Package\Update main TEO roles"
          TopLeft="174,141" />
        <NodeLayout
          Size="182,42"
          Id="Package\Update main TO roles"
          TopLeft="176,75" />
        <NodeLayout
          Size="160,42"
          Id="Package\Update role_type"
          TopLeft="376,501" />
        <NodeLayout
          Size="131,42"
          Id="Package\Updated at"
          TopLeft="206,586" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение]"
          TopLeft="276.5,259">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32"
              Start="0,0"
              End="0,24.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 1]"
          TopLeft="272.5,543">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,43"
              Start="0,0"
              End="0,35.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,35.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 10]"
          TopLeft="342,522">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="34,0"
              Start="0,0"
              End="26.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="26.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 11]"
          TopLeft="347,38">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="11,58"
              Start="0,0"
              End="18.5,58">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="29.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="29.5,0"
                    Point2="33.5,0"
                    Point3="33.5,4" />
                  <mssgle:LineSegment
                    End="33.5,54" />
                  <mssgle:CubicBezierSegment
                    Point1="33.5,54"
                    Point2="33.5,58"
                    Point3="29.5,58" />
                  <mssgle:LineSegment
                    End="18.5,58" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 12]"
          TopLeft="150,40">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="41,0"
              Start="0,0"
              End="33.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="33.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 13]"
          TopLeft="80.25,90">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-27"
              Start="0,0"
              End="0,-19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 2]"
          TopLeft="279.75,333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,36"
              Start="0,0"
              End="0,28.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,28.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 3]"
          TopLeft="316.75,333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="159.75,35"
              Start="0,0"
              End="159.75,27.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,8.0563674321503" />
                  <mssgle:CubicBezierSegment
                    Point1="0,8.0563674321503"
                    Point2="0,12.0563674321503"
                    Point3="4,12.0563674321503" />
                  <mssgle:LineSegment
                    End="155.75,12.0563674321503" />
                  <mssgle:CubicBezierSegment
                    Point1="155.75,12.0563674321503"
                    Point2="159.75,12.0563674321503"
                    Point3="159.75,16.0563674321503" />
                  <mssgle:LineSegment
                    End="159.75,27.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 4]"
          TopLeft="242.25,333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-151.25,32"
              Start="0,0"
              End="-151.25,24.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,7.02296450939457" />
                  <mssgle:CubicBezierSegment
                    Point1="0,7.02296450939457"
                    Point2="0,11.0229645093946"
                    Point3="-4,11.0229645093946" />
                  <mssgle:LineSegment
                    End="-147.25,11.0229645093946" />
                  <mssgle:CubicBezierSegment
                    Point1="-147.25,11.0229645093946"
                    Point2="-151.25,11.0229645093946"
                    Point3="-151.25,15.0229645093946" />
                  <mssgle:LineSegment
                    End="-151.25,24.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 5]"
          TopLeft="91,407">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="150.25,94"
              Start="0,0"
              End="150.25,86.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,57.4701670644391" />
                  <mssgle:CubicBezierSegment
                    Point1="0,57.4701670644391"
                    Point2="0,61.4701670644391"
                    Point3="4,61.4701670644391" />
                  <mssgle:LineSegment
                    End="146.25,61.4701670644391" />
                  <mssgle:CubicBezierSegment
                    Point1="146.25,61.4701670644391"
                    Point2="150.25,61.4701670644391"
                    Point3="150.25,65.4701670644392" />
                  <mssgle:LineSegment
                    End="150.25,86.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 6]"
          TopLeft="276.75,411">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,90"
              Start="0,0"
              End="0,82.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,82.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 7]"
          TopLeft="476.5,410">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-170.75,91"
              Start="0,0"
              End="-170.75,83.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,55.508353221957" />
                  <mssgle:CubicBezierSegment
                    Point1="0,55.508353221957"
                    Point2="0,59.508353221957"
                    Point3="-4,59.508353221957" />
                  <mssgle:LineSegment
                    End="-166.75,59.508353221957" />
                  <mssgle:CubicBezierSegment
                    Point1="-166.75,59.508353221957"
                    Point2="-170.75,59.508353221957"
                    Point3="-170.75,63.508353221957" />
                  <mssgle:LineSegment
                    End="-170.75,83.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 8]"
          TopLeft="267.5,117">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 9]"
          TopLeft="270.75,183">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Reload commissions">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Reload commissions\Table"
          TopLeft="112,105" />
        <NodeLayout
          Size="107,42"
          Id="Package\Reload commissions\Query"
          TopLeft="115,40" />
        <EdgeLayout
          Id="Package\Reload commissions.Paths[ADO NET Source Output]"
          TopLeft="166.5,82">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,23"
              Start="0,0"
              End="0,15.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload commissions\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload commissions\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload main">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="105,42"
          Id="Package\Reload main\Table"
          TopLeft="195,136" />
        <NodeLayout
          Size="107,42"
          Id="Package\Reload main\Query"
          TopLeft="193,63" />
        <EdgeLayout
          Id="Package\Reload main.Paths[ADO NET Source Output]"
          TopLeft="247,105">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,31"
              Start="0,0"
              End="0,23.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload main\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload main\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload request details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="107,42"
          Id="Package\Reload request details\Query"
          TopLeft="107,54" />
        <NodeLayout
          Size="105,42"
          Id="Package\Reload request details\Table"
          TopLeft="109,129" />
        <EdgeLayout
          Id="Package\Reload request details.Paths[ADO NET Source Output]"
          TopLeft="161,96">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33"
              Start="0,0"
              End="0,25.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload request details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload request details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload result details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="107,42"
          Id="Package\Reload result details\Query"
          TopLeft="124,75" />
        <NodeLayout
          Size="105,42"
          Id="Package\Reload result details\Table"
          TopLeft="123,161" />
        <EdgeLayout
          Id="Package\Reload result details.Paths[ADO NET Source Output]"
          TopLeft="176.5,117">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,44"
              Start="0,0"
              End="0,36.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,36.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload result details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload result details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>