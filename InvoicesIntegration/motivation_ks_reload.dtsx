<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="7/8/2020 4:38:48 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="ETP025"
  DTS:CreatorName="ELTRANSPLUS\andreydruzhinin"
  DTS:DTSID="{EDDE5B14-143A-4AB3-92C3-814F40351FFC}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.71"
  DTS:LocaleID="1049"
  DTS:ObjectName="Package3"
  DTS:PackageType="5"
  DTS:VersionBuild="140"
  DTS:VersionGUID="{259EE9C9-13AB-4B1C-BEE7-936DC6681007}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{F908B9AF-1CBD-446B-98FE-E7EE90550E36}"
      DTS:ObjectName="depth_months"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">1</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7EAA451C-643D-4CB9-B09E-090AFB59ED38}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="depth_months">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Delete add roles"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{EDC89386-EC1A-416A-B499-27DD970B410F}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Delete add roles"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="DELETE&#xA;FROM [motivation].[dbo].[ks_workers]&#xA;WHERE role_type = 2" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload accepted"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{A608D03C-5090-425D-B1B7-0B071D01F307}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload accepted"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"SELECT DISTINCT
	[request_id] AS [deal_id]
	,ca.code
    ,[service_type_row]
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,calc_decision_date AS [decision_date]
	,MONTH([calc_decision_date]) AS [accept_month]
	,YEAR([calc_decision_date]) AS [accept_year]		
	FROM [webproject].[dbo].[calculation_deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [calc_decision_date] &gt;= '20200101' AND calc_status_id = 'C16:WON'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR(calc_decision_date), MONTH(calc_decision_date), 10)) AS date)

UNION

SELECT DISTINCT
	[deal_id]
	,ca.code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,[decision_date]
	,MONTH([decision_date]) AS [accept_month]
	,YEAR([decision_date]) AS [accept_year]		
	FROM [webproject].[dbo].[deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [decision_date] &gt;= '20200101' AND UPPER([client_decision]) = 'ПРИНЯТО'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR([decision_date]), MONTH([decision_date]), 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload accepted\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT DISTINCT
	[request_id] AS [deal_id]
	,ca.code
    ,[service_type_row]
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,calc_decision_date AS [decision_date]
	,MONTH([calc_decision_date]) AS [accept_month]
	,YEAR([calc_decision_date]) AS [accept_year]		
	FROM [webproject].[dbo].[calculation_deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [calc_decision_date] &gt;= '20200101' AND calc_status_id = 'C16:WON'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR(calc_decision_date), MONTH(calc_decision_date), 10)) AS date)

UNION

SELECT DISTINCT
	[deal_id]
	,ca.code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,[decision_date]
	,MONTH([decision_date]) AS [accept_month]
	,YEAR([decision_date]) AS [accept_year]		
	FROM [webproject].[dbo].[deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [decision_date] &gt;= '20200101' AND UPPER([client_decision]) = 'ПРИНЯТО'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR([decision_date]), MONTH([decision_date]), 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload accepted\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      length="10"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      length="50"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      name="service_type_row"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      length="50"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      name="request_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      length="200"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      name="client_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[decision_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[decision_date]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[decision_date]"
                      name="decision_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[accept_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[accept_month]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[accept_month]"
                      name="accept_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[accept_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[accept_year]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[accept_year]"
                      name="accept_year"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="50"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[decision_date]"
                      dataType="dbTimeStamp"
                      name="decision_date" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[accept_month]"
                      dataType="i4"
                      name="accept_month" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].ExternalColumns[accept_year]"
                      dataType="i4"
                      name="accept_year" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      name="service_type_row" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      name="request_type" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      name="client_type" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[decision_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[decision_date]"
                      name="decision_date" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[accept_month]"
                      dataType="i4"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[accept_month]"
                      name="accept_month" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[accept_year]"
                      dataType="i4"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[accept_year]"
                      name="accept_year" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload accepted\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ks_accepted</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload accepted\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].Columns[code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="code"
                      externalMetadataColumnId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].Columns[service_type_row]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="service_type_row"
                      externalMetadataColumnId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[service_type_row]" />
                    <inputColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].Columns[request_type]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="request_type"
                      externalMetadataColumnId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[request_type]" />
                    <inputColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].Columns[client_type]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="client_type"
                      externalMetadataColumnId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[client_type]" />
                    <inputColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].Columns[decision_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="decision_date"
                      externalMetadataColumnId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[decision_date]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[decision_date]" />
                    <inputColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].Columns[accept_month]"
                      cachedDataType="i4"
                      cachedName="accept_month"
                      externalMetadataColumnId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[accept_month]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[accept_month]" />
                    <inputColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].Columns[accept_year]"
                      cachedDataType="i4"
                      cachedName="accept_year"
                      externalMetadataColumnId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[accept_year]"
                      lineageId="Package\Reload accepted\Query.Outputs[ADO NET Source Output].Columns[accept_year]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="10"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[decision_date]"
                      dataType="dbTimeStamp"
                      name="decision_date" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[accept_month]"
                      dataType="i4"
                      name="accept_month" />
                    <externalMetadataColumn
                      refId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input].ExternalColumns[accept_year]"
                      dataType="i4"
                      name="accept_year" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload accepted\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload accepted\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload accepted\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload accepted\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload accepted\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload accepted.Paths[ADO NET Source Output]"
              endId="Package\Reload accepted\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload accepted\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload add roles"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E04950C0-C927-4A6A-A0A2-E123401A50D4}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload add roles"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="DECLARE @start [date] = CAST(DATEFROMPARTS(YEAR(DATEADD(MONTH, -2, GETDATE())), MONTH(DATEADD(MONTH, -2, GETDATE())), 1) AS datetime);&#xA;&#xA;WITH cte_search AS (&#xA;&#x9;SELECT DISTINCT&#xA;&#x9;DATEPART(YEAR, request_date) AS id_year,&#xA;&#x9;DATEPART(MONTH, request_date) AS id_month,&#xA;&#x9;[assigned] AS ks_specialist&#xA;&#x9;FROM [webproject].[dbo].[deals] d&#xA;&#x9;WHERE COALESCE([assigned], '') &lt;&gt; '' AND request_date &gt;= @start AND request_date &lt;= GETDATE()&#xA;&#xA;&#x9;UNION&#xA;&#xA;&#x9;SELECT DISTINCT&#xA;&#x9;DATEPART(YEAR, request_date) AS id_year,&#xA;&#x9;DATEPART(MONTH, request_date) AS id_month,&#xA;&#x9;[assigned] AS ks_specialist&#xA;&#x9;FROM [webproject].[dbo].[calculation_deals] d&#xA;&#x9;WHERE COALESCE([assigned], '') &lt;&gt; '' AND request_date &gt;= @start AND request_date &lt;= GETDATE()&#xA;),&#xA;&#xA;cte_insert AS (&#xA;&#xA;SELECT &#xA;ca.SalespersonName AS [name],&#xA;ks_specialist AS [bitrix_name],&#xA;ca.SalespersonCode AS [code],&#xA;'manager' AS [type],&#xA;NULL AS [schedule],&#xA;CAST(DATEFROMPARTS(id_year, id_month, 1) AS date) AS [date_begin],&#xA;CAST(EOMONTH(DATEFROMPARTS(id_year, id_month, 1)) AS date) AS [date_end],&#xA;'0' AS [is_archive],&#xA;'0' AS [estimate_participant],&#xA;'2' AS [role_type]&#xA;&#xA;FROM cte_search AS c&#xA;CROSS APPLY (SELECT TOP (1) * FROM [BI].[dwh].[ETP$Salesperson_Purchaser] AS sp WHERE sp.SalespersonName LIKE ks_specialist + '%') AS ca&#xA;WHERE [Dept_ Code] &lt;&gt; 'УВОЛЕННЫЕ'&#xA;AND NOT EXISTS (&#xA;SELECT 0 FROM [motivation].[dbo].[ks_workers] AS w&#xA;WHERE w.code = ca.SalespersonCode AND w.[role_type] = 1&#xA;AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) &#xA;BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date))&#xA;)&#xA;)&#xA;&#xA;INSERT [motivation].[dbo].[ks_workers]&#xA;([name]&#xA;      ,[bitrix_name]&#xA;      ,[code]&#xA;      ,[type]&#xA;      ,[schedule]&#xA;      ,[date_begin]&#xA;      ,[date_end]&#xA;      ,[is_archive]&#xA;      ,[estimate_participant]&#xA;      ,[role_type])&#xA;SELECT [name]&#xA;      ,[bitrix_name]&#xA;      ,[code]&#xA;      ,[type]&#xA;      ,[schedule]&#xA;      ,[date_begin]&#xA;      ,[date_end]&#xA;      ,[is_archive]&#xA;      ,[estimate_participant]&#xA;      ,[role_type]&#xA;&#x9;  FROM cte_insert&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload calculations"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{648FB1CA-78E4-4552-A582-FEBDB8315E9E}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload calculations"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"SELECT
	[request_id] AS [deal_id]
	,ca.code
    ,CAST([service_type_row] AS varchar(100)) AS service_type_row
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,calc_rework_num
	,COALESCE(calc_duration, 0) AS req_calc_duration
	,calc_finish_date AS [req_calc_finish]
	,MONTH([calc_finish_date]) AS [calc_month]
	,YEAR([calc_finish_date]) AS [calc_year]	
	FROM [webproject].[dbo].[calculation_deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca
	WHERE [request_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR([calc_finish_date]), MONTH([calc_finish_date]), 10)) AS date)

UNION

SELECT
	[deal_id]
	,ca.code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,calc_rework_num
	,COALESCE(req_calc_duration, 0) AS req_calc_duration
	,[req_calc_finish]
	,MONTH([req_calc_finish]) AS [calc_month]
	,YEAR([req_calc_finish]) AS [calc_year]	
	FROM [webproject].[dbo].[deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca
	WHERE [request_date] &gt;= '20200101' AND [accept_cs] = 'Y'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR([req_calc_finish]), MONTH([req_calc_finish]), 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload calculations\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT
	[request_id] AS [deal_id]
	,ca.code
    ,CAST([service_type_row] AS varchar(100)) AS service_type_row
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,calc_rework_num
	,COALESCE(calc_duration, 0) AS req_calc_duration
	,calc_finish_date AS [req_calc_finish]
	,MONTH([calc_finish_date]) AS [calc_month]
	,YEAR([calc_finish_date]) AS [calc_year]	
	FROM [webproject].[dbo].[calculation_deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca
	WHERE [request_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR([calc_finish_date]), MONTH([calc_finish_date]), 10)) AS date)

UNION

SELECT
	[deal_id]
	,ca.code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,calc_rework_num
	,COALESCE(req_calc_duration, 0) AS req_calc_duration
	,[req_calc_finish]
	,MONTH([req_calc_finish]) AS [calc_month]
	,YEAR([req_calc_finish]) AS [calc_year]	
	FROM [webproject].[dbo].[deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca
	WHERE [request_date] &gt;= '20200101' AND [accept_cs] = 'Y'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR([req_calc_finish]), MONTH([req_calc_finish]), 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload calculations\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      length="10"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      length="100"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      name="service_type_row"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      length="50"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      name="request_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      length="200"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      name="client_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[calc_rework_num]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[calc_rework_num]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[calc_rework_num]"
                      name="calc_rework_num"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[req_calc_duration]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[req_calc_duration]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[req_calc_duration]"
                      name="req_calc_duration"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[req_calc_finish]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[req_calc_finish]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[req_calc_finish]"
                      name="req_calc_finish"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[calc_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[calc_month]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[calc_month]"
                      name="calc_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[calc_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[calc_year]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[calc_year]"
                      name="calc_year"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="100"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[calc_rework_num]"
                      dataType="i4"
                      name="calc_rework_num" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[req_calc_duration]"
                      dataType="i4"
                      name="req_calc_duration" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[req_calc_finish]"
                      dataType="dbTimeStamp"
                      name="req_calc_finish" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[calc_month]"
                      dataType="i4"
                      name="calc_month" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].ExternalColumns[calc_year]"
                      dataType="i4"
                      name="calc_year" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      dataType="wstr"
                      length="100"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      name="service_type_row" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      name="request_type" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      name="client_type" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[calc_rework_num]"
                      dataType="i4"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[calc_rework_num]"
                      name="calc_rework_num" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[req_calc_duration]"
                      dataType="i4"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[req_calc_duration]"
                      name="req_calc_duration" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[req_calc_finish]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[req_calc_finish]"
                      name="req_calc_finish" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[calc_month]"
                      dataType="i4"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[calc_month]"
                      name="calc_month" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[calc_year]"
                      dataType="i4"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[calc_year]"
                      name="calc_year" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload calculations\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ks_calculations</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload calculations\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="code"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[service_type_row]"
                      cachedDataType="wstr"
                      cachedLength="100"
                      cachedName="service_type_row"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[service_type_row]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[request_type]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="request_type"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[request_type]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[client_type]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="client_type"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[client_type]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[calc_rework_num]"
                      cachedDataType="i4"
                      cachedName="calc_rework_num"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[calc_rework_num]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[calc_rework_num]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[req_calc_duration]"
                      cachedDataType="i4"
                      cachedName="req_calc_duration"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_calc_duration]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[req_calc_duration]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[req_calc_finish]"
                      cachedDataType="dbTimeStamp"
                      cachedName="req_calc_finish"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_calc_finish]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[req_calc_finish]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[calc_month]"
                      cachedDataType="i4"
                      cachedName="calc_month"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[calc_month]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[calc_month]" />
                    <inputColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].Columns[calc_year]"
                      cachedDataType="i4"
                      cachedName="calc_year"
                      externalMetadataColumnId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[calc_year]"
                      lineageId="Package\Reload calculations\Query.Outputs[ADO NET Source Output].Columns[calc_year]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="10"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[calc_rework_num]"
                      dataType="i4"
                      name="calc_rework_num" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_calc_duration]"
                      dataType="i4"
                      name="req_calc_duration" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[req_calc_finish]"
                      dataType="dbTimeStamp"
                      name="req_calc_finish" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[calc_month]"
                      dataType="i4"
                      name="calc_month" />
                    <externalMetadataColumn
                      refId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input].ExternalColumns[calc_year]"
                      dataType="i4"
                      name="calc_year" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload calculations\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload calculations\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload calculations\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload calculations\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload calculations\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload calculations.Paths[ADO NET Source Output]"
              endId="Package\Reload calculations\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload calculations\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload commissions"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:Disabled="True"
      DTS:DTSID="{755F9E54-C9AE-468A-9D3C-7B1FF3F8BCDE}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload commissions"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"WITH cte_deals AS (
SELECT d.*
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS deals_rownum
,ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS distinct_deals_rownum
FROM [webproject].[dbo].[deals] AS d
),

cte_commission_data AS (
SELECT cd.* , d.*
,ROW_NUMBER() OVER (PARTITION BY cd_parent_deal_id, cd_service_type ORDER BY (SELECT NULL)) AS commission_rownum
FROM [webproject].[dbo].[commission_data] AS cd
JOIN cte_deals AS d
ON cd.cd_parent_deal_id = d.deal_id
AND cd.cd_service_type = d.service_type_row
AND d.deals_rownum = 1
),

cte_main AS (
SELECT
COALESCE(c1.[deal_id], c2.[deal_id]) AS [deal_id]
,COALESCE(c1.[assigned], c2.[assigned]) AS [assigned]
,COALESCE(c1.[service_type], c2.[service_type]) AS [service_type]
,COALESCE(c1.[request_type], c2.[request_type]) AS [request_type]
,COALESCE(c1.[client], c2.[client]) AS [client]
,COALESCE(c1.[client_type], c2.[client_type]) AS [client_type]
,COALESCE(c1.[service_type_row], c2.[service_type_row]) AS [service_type_row]
,COALESCE(c1.[responsible_ks], c2.[responsible_ks]) AS [responsible_ks]

,c1.[assigned_ttr]
,c1.[accept_cs]

,c1.margin_fact AS old_margin_fact
,c1.[comission_date] AS old_commission_date
,c1.[delivery_number] AS old_delivery_number

,[cd_margin_fact] AS new_margin_fact
,[cd_delivery_number] AS new_delivery_number
,[cd_comission_date] AS new_commission_date

,c1.deals_rownum
,c1.distinct_deals_rownum
,c2.commission_rownum

,COUNT(commission_rownum) OVER (PARTITION BY COALESCE(c1.[deal_id], c2.[deal_id]), COALESCE(c1.[service_type_row], c2.[service_type_row])) AS prefiltered_commission_row_count

FROM
cte_deals AS c1 FULL JOIN cte_commission_data AS c2
ON c1.deal_id = c2.cd_parent_deal_id
AND c1.service_type_row = c2.cd_service_type
AND c1.deals_rownum = c2.commission_rownum
),

cte_merged AS (
SELECT
c.*
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_margin_fact] ELSE new_margin_fact END AS [margin_fact]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_commission_date] ELSE new_commission_date END AS [commission_date]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_delivery_number] ELSE new_delivery_number END AS [delivery_number]
FROM cte_main AS c
),

cte_partition AS (
SELECT
ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS deal_level_pointer
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS service_level_pointer
,COUNT(deals_rownum) OVER (PARTITION BY deal_id, service_type_row) AS deal_row_count
,COUNT(commission_rownum) OVER (PARTITION BY deal_id, service_type_row) AS commission_row_count
, c.*
FROM cte_merged AS c
)	
	SELECT 	
	[deal_id]
	,ca_assigned.code AS assigned_code
	,ca_resp.code AS responsible_code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,commission_date
	,MONTH(commission_date) AS [commission_month]
	,YEAR(commission_date) AS [commission_year] 
	,margin_fact
	,ca_delivery.close_date
	,MONTH(ca_delivery.close_date) AS [close_month]
	,YEAR(ca_delivery.close_date) AS [close_year]
	FROM cte_partition AS d	
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca_assigned
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca_resp
	OUTER APPLY (SELECT TOP (1) CASE WHEN [DRLLastFactDate] &gt;= '20200101' THEN [DRLLastFactDate] END AS close_date FROM [BI].[dwh].[ETP$SQL_Delivery] sd WHERE sd.No_ = d.delivery_number) AS ca_delivery
	WHERE [commission_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR(commission_date), MONTH(commission_date), 10)) AS date)
	AND 	
	(([commission_row_count] = 0 AND [service_level_pointer] = 1)
    OR
	([commission_row_count] &gt; 0 AND [commission_rownum] IS NOT NULL))"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload commissions\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_deals AS (
SELECT d.*
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS deals_rownum
,ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS distinct_deals_rownum
FROM [webproject].[dbo].[deals] AS d
),

cte_commission_data AS (
SELECT cd.* , d.*
,ROW_NUMBER() OVER (PARTITION BY cd_parent_deal_id, cd_service_type ORDER BY (SELECT NULL)) AS commission_rownum
FROM [webproject].[dbo].[commission_data] AS cd
JOIN cte_deals AS d
ON cd.cd_parent_deal_id = d.deal_id
AND cd.cd_service_type = d.service_type_row
AND d.deals_rownum = 1
),

cte_main AS (
SELECT
COALESCE(c1.[deal_id], c2.[deal_id]) AS [deal_id]
,COALESCE(c1.[assigned], c2.[assigned]) AS [assigned]
,COALESCE(c1.[service_type], c2.[service_type]) AS [service_type]
,COALESCE(c1.[request_type], c2.[request_type]) AS [request_type]
,COALESCE(c1.[client], c2.[client]) AS [client]
,COALESCE(c1.[client_type], c2.[client_type]) AS [client_type]
,COALESCE(c1.[service_type_row], c2.[service_type_row]) AS [service_type_row]
,COALESCE(c1.[responsible_ks], c2.[responsible_ks]) AS [responsible_ks]

,c1.[assigned_ttr]
,c1.[accept_cs]

,c1.margin_fact AS old_margin_fact
,c1.[comission_date] AS old_commission_date
,c1.[delivery_number] AS old_delivery_number

,[cd_margin_fact] AS new_margin_fact
,[cd_delivery_number] AS new_delivery_number
,[cd_comission_date] AS new_commission_date

,c1.deals_rownum
,c1.distinct_deals_rownum
,c2.commission_rownum

,COUNT(commission_rownum) OVER (PARTITION BY COALESCE(c1.[deal_id], c2.[deal_id]), COALESCE(c1.[service_type_row], c2.[service_type_row])) AS prefiltered_commission_row_count

FROM
cte_deals AS c1 FULL JOIN cte_commission_data AS c2
ON c1.deal_id = c2.cd_parent_deal_id
AND c1.service_type_row = c2.cd_service_type
AND c1.deals_rownum = c2.commission_rownum
),

cte_merged AS (
SELECT
c.*
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_margin_fact] ELSE new_margin_fact END AS [margin_fact]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_commission_date] ELSE new_commission_date END AS [commission_date]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_delivery_number] ELSE new_delivery_number END AS [delivery_number]
FROM cte_main AS c
),

cte_partition AS (
SELECT
ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS deal_level_pointer
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS service_level_pointer
,COUNT(deals_rownum) OVER (PARTITION BY deal_id, service_type_row) AS deal_row_count
,COUNT(commission_rownum) OVER (PARTITION BY deal_id, service_type_row) AS commission_row_count
, c.*
FROM cte_merged AS c
)	
	SELECT 	
	[deal_id]
	,ca_assigned.code AS assigned_code
	,ca_resp.code AS responsible_code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,commission_date
	,MONTH(commission_date) AS [commission_month]
	,YEAR(commission_date) AS [commission_year] 
	,margin_fact
	,ca_delivery.close_date
	,MONTH(ca_delivery.close_date) AS [close_month]
	,YEAR(ca_delivery.close_date) AS [close_year]
	FROM cte_partition AS d	
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca_assigned
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca_resp
	OUTER APPLY (SELECT TOP (1) CASE WHEN [DRLLastFactDate] &gt;= '20200101' THEN [DRLLastFactDate] END AS close_date FROM [BI].[dwh].[ETP$SQL_Delivery] sd WHERE sd.No_ = d.delivery_number) AS ca_delivery
	WHERE [commission_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR(commission_date), MONTH(commission_date), 10)) AS date)
	AND 	
	(([commission_row_count] = 0 AND [service_level_pointer] = 1)
    OR
	([commission_row_count] &gt; 0 AND [commission_rownum] IS NOT NULL))</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload commissions\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[assigned_code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[assigned_code]"
                      length="10"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[assigned_code]"
                      name="assigned_code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[responsible_code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[responsible_code]"
                      length="10"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[responsible_code]"
                      name="responsible_code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      length="3"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      name="service_type_row"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      length="50"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      name="request_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      length="200"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      name="client_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[commission_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_date]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[commission_date]"
                      name="commission_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[commission_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_month]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[commission_month]"
                      name="commission_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[commission_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_year]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[commission_year]"
                      name="commission_year"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[margin_fact]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[margin_fact]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[margin_fact]"
                      name="margin_fact"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_date]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_date]"
                      name="close_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_month]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_month]"
                      name="close_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_year]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_year]"
                      name="close_year"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[assigned_code]"
                      dataType="wstr"
                      length="10"
                      name="assigned_code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[responsible_code]"
                      dataType="wstr"
                      length="10"
                      name="responsible_code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="3"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_date]"
                      dataType="dbTimeStamp"
                      name="commission_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_month]"
                      dataType="i4"
                      name="commission_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_year]"
                      dataType="i4"
                      name="commission_year" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[margin_fact]"
                      dataType="numeric"
                      name="margin_fact"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_date]"
                      dataType="dbTimeStamp"
                      name="close_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_month]"
                      dataType="i4"
                      name="close_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].ExternalColumns[close_year]"
                      dataType="i4"
                      name="close_year" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[assigned_code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[assigned_code]"
                      name="assigned_code" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[responsible_code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[responsible_code]"
                      name="responsible_code" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      dataType="wstr"
                      length="3"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      name="service_type_row" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      name="request_type" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      name="client_type" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[commission_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[commission_date]"
                      name="commission_date" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[commission_month]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[commission_month]"
                      name="commission_month" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[commission_year]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[commission_year]"
                      name="commission_year" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[margin_fact]"
                      dataType="numeric"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[margin_fact]"
                      name="margin_fact"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_date]"
                      name="close_date" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_month]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_month]"
                      name="close_month" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_year]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[close_year]"
                      name="close_year" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload commissions\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ks_commissions</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload commissions\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[assigned_code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="assigned_code"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[assigned_code]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[assigned_code]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[responsible_code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="responsible_code"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[responsible_code]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[responsible_code]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[service_type_row]"
                      cachedDataType="wstr"
                      cachedLength="3"
                      cachedName="service_type_row"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[service_type_row]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[request_type]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="request_type"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[request_type]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[client_type]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="client_type"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[client_type]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[commission_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="commission_date"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_date]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[commission_date]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[commission_month]"
                      cachedDataType="i4"
                      cachedName="commission_month"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_month]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[commission_month]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[commission_year]"
                      cachedDataType="i4"
                      cachedName="commission_year"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_year]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[commission_year]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[margin_fact]"
                      cachedDataType="numeric"
                      cachedName="margin_fact"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[margin_fact]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[margin_fact]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[close_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="close_date"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_date]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_date]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[close_month]"
                      cachedDataType="i4"
                      cachedName="close_month"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_month]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_month]" />
                    <inputColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].Columns[close_year]"
                      cachedDataType="i4"
                      cachedName="close_year"
                      externalMetadataColumnId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_year]"
                      lineageId="Package\Reload commissions\Query.Outputs[ADO NET Source Output].Columns[close_year]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[assigned_code]"
                      dataType="wstr"
                      length="10"
                      name="assigned_code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[responsible_code]"
                      dataType="wstr"
                      length="10"
                      name="responsible_code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="10"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_date]"
                      dataType="dbTimeStamp"
                      name="commission_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_month]"
                      dataType="i4"
                      name="commission_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_year]"
                      dataType="i4"
                      name="commission_year" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[margin_fact]"
                      dataType="numeric"
                      name="margin_fact"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_date]"
                      dataType="dbTimeStamp"
                      name="close_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_month]"
                      dataType="i4"
                      name="close_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_year]"
                      dataType="i4"
                      name="close_year" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload commissions\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload commissions.Paths[ADO NET Source Output]"
              endId="Package\Reload commissions\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload commissions\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload commissions close"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:Disabled="True"
      DTS:DTSID="{3825FE98-2A34-4552-A688-387254445226}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload commissions close"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"WITH cte_deals AS (
SELECT d.*
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS deals_rownum
,ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS distinct_deals_rownum
FROM [webproject].[dbo].[deals] AS d
),

cte_commission_data AS (
SELECT cd.* , d.*
,ROW_NUMBER() OVER (PARTITION BY cd_parent_deal_id, cd_service_type ORDER BY (SELECT NULL)) AS commission_rownum
FROM [webproject].[dbo].[commission_data] AS cd
JOIN cte_deals AS d
ON cd.cd_parent_deal_id = d.deal_id
AND cd.cd_service_type = d.service_type_row
AND d.deals_rownum = 1
),

cte_main AS (
SELECT
COALESCE(c1.[deal_id], c2.[deal_id]) AS [deal_id]
,COALESCE(c1.[assigned], c2.[assigned]) AS [assigned]
,COALESCE(c1.[service_type], c2.[service_type]) AS [service_type]
,COALESCE(c1.[request_type], c2.[request_type]) AS [request_type]
,COALESCE(c1.[client], c2.[client]) AS [client]
,COALESCE(c1.[client_type], c2.[client_type]) AS [client_type]
,COALESCE(c1.[service_type_row], c2.[service_type_row]) AS [service_type_row]
,COALESCE(c1.[responsible_ks], c2.[responsible_ks]) AS [responsible_ks]

,c1.[assigned_ttr]
,c1.[accept_cs]

,c1.margin_fact AS old_margin_fact
,c1.[comission_date] AS old_commission_date
,c1.[delivery_number] AS old_delivery_number

,[cd_margin_fact] AS new_margin_fact
,[cd_delivery_number] AS new_delivery_number
,[cd_comission_date] AS new_commission_date

,c1.deals_rownum
,c1.distinct_deals_rownum
,c2.commission_rownum

,COUNT(commission_rownum) OVER (PARTITION BY COALESCE(c1.[deal_id], c2.[deal_id]), COALESCE(c1.[service_type_row], c2.[service_type_row])) AS prefiltered_commission_row_count

FROM
cte_deals AS c1 FULL JOIN cte_commission_data AS c2
ON c1.deal_id = c2.cd_parent_deal_id
AND c1.service_type_row = c2.cd_service_type
AND c1.deals_rownum = c2.commission_rownum
),

cte_merged AS (
SELECT
c.*
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_margin_fact] ELSE new_margin_fact END AS [margin_fact]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_commission_date] ELSE new_commission_date END AS [commission_date]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_delivery_number] ELSE new_delivery_number END AS [delivery_number]
FROM cte_main AS c
),

cte_partition AS (
SELECT
ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS deal_level_pointer
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS service_level_pointer
,COUNT(deals_rownum) OVER (PARTITION BY deal_id, service_type_row) AS deal_row_count
,COUNT(commission_rownum) OVER (PARTITION BY deal_id, service_type_row) AS commission_row_count
, c.*
FROM cte_merged AS c
)	
	SELECT 	
	[deal_id]
	,ca_assigned.code AS assigned_code
	,ca_resp.code AS responsible_code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,commission_date
	,MONTH(commission_date) AS [commission_month]
	,YEAR(commission_date) AS [commission_year] 
	,margin_fact
	,ca_delivery.close_date
	,MONTH(ca_delivery.close_date) AS [close_month]
	,YEAR(ca_delivery.close_date) AS [close_year]
	FROM cte_partition AS d	
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca_assigned
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca_resp
	OUTER APPLY (SELECT TOP (1) CASE WHEN [DRLLastFactDate] &gt;= '20200101' THEN [DRLLastFactDate] END AS close_date FROM [BI].[dwh].[ETP$SQL_Delivery] sd WHERE sd.No_ = d.delivery_number) AS ca_delivery
	WHERE [commission_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR(close_date), MONTH(close_date), 10)) AS date)
	AND 	
	(([commission_row_count] = 0 AND [service_level_pointer] = 1)
    OR
	([commission_row_count] &gt; 0 AND [commission_rownum] IS NOT NULL))"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload commissions close\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_deals AS (
SELECT d.*
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS deals_rownum
,ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS distinct_deals_rownum
FROM [webproject].[dbo].[deals] AS d
),

cte_commission_data AS (
SELECT cd.* , d.*
,ROW_NUMBER() OVER (PARTITION BY cd_parent_deal_id, cd_service_type ORDER BY (SELECT NULL)) AS commission_rownum
FROM [webproject].[dbo].[commission_data] AS cd
JOIN cte_deals AS d
ON cd.cd_parent_deal_id = d.deal_id
AND cd.cd_service_type = d.service_type_row
AND d.deals_rownum = 1
),

cte_main AS (
SELECT
COALESCE(c1.[deal_id], c2.[deal_id]) AS [deal_id]
,COALESCE(c1.[assigned], c2.[assigned]) AS [assigned]
,COALESCE(c1.[service_type], c2.[service_type]) AS [service_type]
,COALESCE(c1.[request_type], c2.[request_type]) AS [request_type]
,COALESCE(c1.[client], c2.[client]) AS [client]
,COALESCE(c1.[client_type], c2.[client_type]) AS [client_type]
,COALESCE(c1.[service_type_row], c2.[service_type_row]) AS [service_type_row]
,COALESCE(c1.[responsible_ks], c2.[responsible_ks]) AS [responsible_ks]

,c1.[assigned_ttr]
,c1.[accept_cs]

,c1.margin_fact AS old_margin_fact
,c1.[comission_date] AS old_commission_date
,c1.[delivery_number] AS old_delivery_number

,[cd_margin_fact] AS new_margin_fact
,[cd_delivery_number] AS new_delivery_number
,[cd_comission_date] AS new_commission_date

,c1.deals_rownum
,c1.distinct_deals_rownum
,c2.commission_rownum

,COUNT(commission_rownum) OVER (PARTITION BY COALESCE(c1.[deal_id], c2.[deal_id]), COALESCE(c1.[service_type_row], c2.[service_type_row])) AS prefiltered_commission_row_count

FROM
cte_deals AS c1 FULL JOIN cte_commission_data AS c2
ON c1.deal_id = c2.cd_parent_deal_id
AND c1.service_type_row = c2.cd_service_type
AND c1.deals_rownum = c2.commission_rownum
),

cte_merged AS (
SELECT
c.*
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_margin_fact] ELSE new_margin_fact END AS [margin_fact]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_commission_date] ELSE new_commission_date END AS [commission_date]
,CASE WHEN prefiltered_commission_row_count = 0 THEN [old_delivery_number] ELSE new_delivery_number END AS [delivery_number]
FROM cte_main AS c
),

cte_partition AS (
SELECT
ROW_NUMBER() OVER (PARTITION BY deal_id ORDER BY (SELECT NULL)) AS deal_level_pointer
,ROW_NUMBER() OVER (PARTITION BY deal_id, service_type_row ORDER BY (SELECT NULL)) AS service_level_pointer
,COUNT(deals_rownum) OVER (PARTITION BY deal_id, service_type_row) AS deal_row_count
,COUNT(commission_rownum) OVER (PARTITION BY deal_id, service_type_row) AS commission_row_count
, c.*
FROM cte_merged AS c
)	
	SELECT 	
	[deal_id]
	,ca_assigned.code AS assigned_code
	,ca_resp.code AS responsible_code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,commission_date
	,MONTH(commission_date) AS [commission_month]
	,YEAR(commission_date) AS [commission_year] 
	,margin_fact
	,ca_delivery.close_date
	,MONTH(ca_delivery.close_date) AS [close_month]
	,YEAR(ca_delivery.close_date) AS [close_year]
	FROM cte_partition AS d	
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca_assigned
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca_resp
	OUTER APPLY (SELECT TOP (1) CASE WHEN [DRLLastFactDate] &gt;= '20200101' THEN [DRLLastFactDate] END AS close_date FROM [BI].[dwh].[ETP$SQL_Delivery] sd WHERE sd.No_ = d.delivery_number) AS ca_delivery
	WHERE [commission_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR(close_date), MONTH(close_date), 10)) AS date)
	AND 	
	(([commission_row_count] = 0 AND [service_level_pointer] = 1)
    OR
	([commission_row_count] &gt; 0 AND [commission_rownum] IS NOT NULL))</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload commissions close\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[assigned_code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[assigned_code]"
                      length="10"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[assigned_code]"
                      name="assigned_code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[responsible_code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[responsible_code]"
                      length="10"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[responsible_code]"
                      name="responsible_code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      length="3"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      name="service_type_row"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      length="50"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      name="request_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      length="200"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      name="client_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[commission_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_date]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[commission_date]"
                      name="commission_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[commission_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_month]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[commission_month]"
                      name="commission_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[commission_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_year]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[commission_year]"
                      name="commission_year"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[margin_fact]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[margin_fact]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[margin_fact]"
                      name="margin_fact"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[close_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[close_date]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[close_date]"
                      name="close_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[close_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[close_month]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[close_month]"
                      name="close_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[close_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[close_year]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[close_year]"
                      name="close_year"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[assigned_code]"
                      dataType="wstr"
                      length="10"
                      name="assigned_code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[responsible_code]"
                      dataType="wstr"
                      length="10"
                      name="responsible_code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="3"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_date]"
                      dataType="dbTimeStamp"
                      name="commission_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_month]"
                      dataType="i4"
                      name="commission_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[commission_year]"
                      dataType="i4"
                      name="commission_year" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[margin_fact]"
                      dataType="numeric"
                      name="margin_fact"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[close_date]"
                      dataType="dbTimeStamp"
                      name="close_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[close_month]"
                      dataType="i4"
                      name="close_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].ExternalColumns[close_year]"
                      dataType="i4"
                      name="close_year" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[assigned_code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[assigned_code]"
                      name="assigned_code" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[responsible_code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[responsible_code]"
                      name="responsible_code" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      dataType="wstr"
                      length="3"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      name="service_type_row" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      name="request_type" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      name="client_type" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[commission_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[commission_date]"
                      name="commission_date" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[commission_month]"
                      dataType="i4"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[commission_month]"
                      name="commission_month" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[commission_year]"
                      dataType="i4"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[commission_year]"
                      name="commission_year" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[margin_fact]"
                      dataType="numeric"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[margin_fact]"
                      name="margin_fact"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[close_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[close_date]"
                      name="close_date" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[close_month]"
                      dataType="i4"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[close_month]"
                      name="close_month" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[close_year]"
                      dataType="i4"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[close_year]"
                      name="close_year" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload commissions close\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ks_commissions_close</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload commissions close\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[assigned_code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="assigned_code"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[assigned_code]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[assigned_code]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[responsible_code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="responsible_code"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[responsible_code]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[responsible_code]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[service_type_row]"
                      cachedDataType="wstr"
                      cachedLength="3"
                      cachedName="service_type_row"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[service_type_row]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[request_type]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="request_type"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[request_type]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[client_type]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="client_type"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[client_type]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[commission_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="commission_date"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_date]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[commission_date]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[commission_month]"
                      cachedDataType="i4"
                      cachedName="commission_month"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_month]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[commission_month]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[commission_year]"
                      cachedDataType="i4"
                      cachedName="commission_year"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_year]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[commission_year]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[margin_fact]"
                      cachedDataType="numeric"
                      cachedName="margin_fact"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[margin_fact]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[margin_fact]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[close_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="close_date"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_date]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[close_date]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[close_month]"
                      cachedDataType="i4"
                      cachedName="close_month"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_month]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[close_month]" />
                    <inputColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].Columns[close_year]"
                      cachedDataType="i4"
                      cachedName="close_year"
                      externalMetadataColumnId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_year]"
                      lineageId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output].Columns[close_year]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[assigned_code]"
                      dataType="wstr"
                      length="10"
                      name="assigned_code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[responsible_code]"
                      dataType="wstr"
                      length="10"
                      name="responsible_code" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="10"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_date]"
                      dataType="dbTimeStamp"
                      name="commission_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_month]"
                      dataType="i4"
                      name="commission_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[commission_year]"
                      dataType="i4"
                      name="commission_year" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[margin_fact]"
                      dataType="numeric"
                      name="margin_fact"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_date]"
                      dataType="dbTimeStamp"
                      name="close_date" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_month]"
                      dataType="i4"
                      name="close_month" />
                    <externalMetadataColumn
                      refId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input].ExternalColumns[close_year]"
                      dataType="i4"
                      name="close_year" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload commissions close\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload commissions close\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload commissions close\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload commissions close\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload commissions close\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload commissions close.Paths[ADO NET Source Output]"
              endId="Package\Reload commissions close\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload commissions close\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload main"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{D26E5A04-4B82-4956-8069-68D3EAE5ACF9}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload main"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2020
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code]
	FROM [motivation].[dbo].[ks_workers] 
	WHERE [type] = 'manager'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [BI].[etl].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt; CAST(GETDATE() AS date) AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [bitrix_name], 
	
	CASE WHEN oa_participant.not_a_participant IS NOT NULL THEN 0
	ELSE [estimate_participant] END AS [estimate_participant], 
	
	COALESCE([work_days], 0) AS [work_days]
	
	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[ks_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [bitrix_name], [estimate_participant] FROM [motivation].[dbo].[ks_workers] w
	WHERE w.[type] = 'manager' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days
	
	OUTER APPLY (
	SELECT 1 AS not_a_participant
	FROM [motivation].[dbo].[calc_exceptions] AS ce
	WHERE ce.[type] = 'manager' AND ce.code = cte_distinct_code.code
	) AS oa_participant

),

cte_requests AS (
	
	SELECT  

	[code],
	[request_month],
	[request_year],
	COUNT(0) AS ks_req_qty_all,
	COUNT(ALL CASE WHEN request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_req_qty_tender,
	COUNT(ALL CASE WHEN request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_req_qty_project,
	COUNT(ALL CASE WHEN request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_req_qty_complex,
	COUNT(ALL CASE WHEN request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_req_qty_typical,
	COUNT(ALL CASE WHEN request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_req_qty_indicative,
	COUNT(ALL CASE WHEN client_type = 'Новый' THEN 0 ELSE NULL END) AS ks_req_qty_new_customer,
	COUNT(ALL CASE WHEN client_type = 'Действующий' THEN 0 ELSE NULL END) AS ks_req_qty_current_customer,
	COUNT(ALL CASE WHEN client_type = 'Вновь обратившийся' THEN 0 ELSE NULL END) AS ks_req_qty_renew_customer,

	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' THEN 0 ELSE NULL END) AS ks_req_qty_all_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_req_qty_tender_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_req_qty_project_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_req_qty_complex_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_req_qty_typical_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_req_qty_indicative_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND client_type = 'Новый' THEN 0 ELSE NULL END) AS ks_req_qty_new_customer_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND client_type = 'Действующий' THEN 0 ELSE NULL END) AS ks_req_qty_current_customer_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND client_type = 'Вновь обратившийся' THEN 0 ELSE NULL END) AS ks_req_qty_renew_customer_to_teo,
	
	COUNT(ALL CASE WHEN service_type = 'ТО' THEN 0 ELSE NULL END) AS ks_req_qty_all_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_req_qty_tender_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_req_qty_project_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_req_qty_complex_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_req_qty_typical_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_req_qty_indicative_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND client_type = 'Новый' THEN 0 ELSE NULL END) AS ks_req_qty_new_customer_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND client_type = 'Действующий' THEN 0 ELSE NULL END) AS ks_req_qty_current_customer_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND client_type = 'Вновь обратившийся' THEN 0 ELSE NULL END) AS ks_req_qty_renew_customer_to,

	COUNT(ALL CASE WHEN service_type = 'ТЭО' THEN 0 ELSE NULL END) AS ks_req_qty_all_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_req_qty_tender_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_req_qty_project_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_req_qty_complex_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_req_qty_typical_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_req_qty_indicative_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND client_type = 'Новый' THEN 0 ELSE NULL END) AS ks_req_qty_new_customer_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND client_type = 'Действующий' THEN 0 ELSE NULL END) AS ks_req_qty_current_customer_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND client_type = 'Вновь обратившийся' THEN 0 ELSE NULL END) AS ks_req_qty_renew_customer_teo

	FROM [motivation].[dbo].[ks_requests]
	GROUP BY 
	[code]
	,[request_month]
	,[request_year]
),

cte_calculations AS (

	SELECT 

	[code],
	[calc_month],
	[calc_year],
	COUNT(0) AS ks_calc_qty_all,
	COUNT(ALL CASE WHEN req_calc_duration &lt;= 9 THEN 0 ELSE NULL END) AS ks_calc_qty_all_fast,
	COUNT(ALL CASE WHEN req_calc_duration &gt; 9 THEN 0 ELSE NULL END) AS ks_calc_qty_all_slow,

	COUNT(ALL CASE WHEN service_type_row = 'ТО' THEN 0 ELSE NULL END) AS ks_calc_qty_all_to,
	COUNT(ALL CASE WHEN service_type_row = 'ТО' AND req_calc_duration &lt;= 9 THEN 0 ELSE NULL END) AS ks_calc_qty_to_fast,
	COUNT(ALL CASE WHEN service_type_row = 'ТО' AND req_calc_duration &gt; 9 THEN 0 ELSE NULL END) AS ks_calc_qty_to_slow,

	COUNT(ALL CASE WHEN service_type_row = 'ТЭО' THEN 0 ELSE NULL END) AS ks_calc_qty_all_teo,
	COUNT(ALL CASE WHEN service_type_row = 'ТЭО' AND req_calc_duration &lt;= 9 THEN 0 ELSE NULL END) AS ks_calc_qty_teo_fast,
	COUNT(ALL CASE WHEN service_type_row = 'ТЭО' AND req_calc_duration &gt; 9 THEN 0 ELSE NULL END) AS ks_calc_qty_teo_slow

	FROM [motivation].[dbo].[ks_calculations]
	GROUP BY 
	[code]
	,[calc_month]
	,[calc_year]
),

cte_accepted AS (	
	SELECT
	[code]     
    ,[accept_month]
    ,[accept_year]
	,COUNT(0) AS ks_kp_accepted_qty
	FROM [motivation].[dbo].[ks_accepted]
	GROUP BY 
	[code]     
    ,[accept_month]
    ,[accept_year]
),

cte_rejected AS (	
	SELECT
	[code]     
    ,[accept_month] AS reject_month
    ,[accept_year] AS reject_year
	,COUNT(0) AS ks_kp_rejected_qty	
	FROM [motivation].[dbo].[ks_rejected]
	GROUP BY 
	[code]     
    ,[accept_month]
    ,[accept_year]
),

cte_sent_replies_assigned AS (

	SELECT
	[assigned_code],
	[reply_month],
    [reply_year],
	
	COUNT(0) AS ks_reply_qty_all_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 THEN 0 ELSE NULL END) AS ks_reply_qty_all_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 THEN 0 ELSE NULL END) AS ks_reply_qty_all_slow_assigned,

	COUNT(ALL CASE WHEN request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_reply_qty_tender_assigned,
	COUNT(ALL CASE WHEN request_type = 'Тендер' AND kp_in_time = 1 THEN 0 ELSE NULL END) AS ks_reply_qty_tender_fast_assigned,
	COUNT(ALL CASE WHEN request_type = 'Тендер' AND kp_in_time = 0 THEN 0 ELSE NULL END) AS ks_reply_qty_tender_slow_assigned,

	COUNT(ALL CASE WHEN request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_slow_assigned,
	
	COUNT(ALL CASE WHEN request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_slow_assigned,
	
	COUNT(ALL CASE WHEN request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_slow_assigned,
	
	COUNT(ALL CASE WHEN request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_slow_assigned

	FROM [motivation].[dbo].[ks_sent_replies]
	GROUP BY 
	[assigned_code],
	[reply_month],
    [reply_year]
),

cte_sent_replies_responsible AS (

	SELECT
	[responsible_code],
	[reply_month],
    [reply_year],
	
	COUNT(0) AS ks_reply_qty_all_responsible,
	
	COUNT(ALL CASE WHEN kp_in_time = 1 THEN 0 ELSE NULL END) AS ks_reply_qty_all_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 THEN 0 ELSE NULL END) AS ks_reply_qty_all_slow_responsible,

	COUNT(ALL CASE WHEN request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_reply_qty_tender_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_reply_qty_tender_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_reply_qty_tender_slow_responsible,
	
	COUNT(ALL CASE WHEN request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_slow_responsible,
	
	COUNT(ALL CASE WHEN request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_slow_responsible,
	
	COUNT(ALL CASE WHEN request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_slow_responsible,
	
	COUNT(ALL CASE WHEN request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_slow_responsible

	FROM [motivation].[dbo].[ks_sent_replies]
	GROUP BY 
	[responsible_code],
	[reply_month],
    [reply_year]
),

cte_commissions_count_assigned AS (
	SELECT [assigned_code], [commission_month], [commission_year], COUNT(0) AS ks_commission_qty_assigned	
	FROM [motivation].[dbo].[ks_commissions]
	GROUP BY
	[assigned_code], [commission_month], [commission_year]
),

cte_commissions_count_responsible AS (
	SELECT [responsible_code], [commission_month], [commission_year], COUNT(0) AS ks_commission_qty_responsible
	FROM [motivation].[dbo].[ks_commissions]
	GROUP BY
	[responsible_code], [commission_month], [commission_year]
),

cte_commissions_profit_assigned AS (
	SELECT [assigned_code], [close_month], [close_year], COALESCE(SUM(margin_fact), 0) AS ks_profit_fact_sum_assigned
	FROM [motivation].[dbo].[ks_commissions_close]
	GROUP BY
	[assigned_code], [close_month], [close_year]
),

cte_commissions_profit_responsible AS (
	SELECT [responsible_code], [close_month], [close_year], COALESCE(SUM(margin_fact), 0) AS ks_profit_fact_sum_responsible
	FROM [motivation].[dbo].[ks_commissions_close]
	GROUP BY
	[responsible_code], [close_month], [close_year]
),

cte_commissions_profit_overall AS (
	SELECT [close_month], [close_year], CAST((COALESCE(SUM(margin_fact), 0) * 0.6) AS decimal(18,2)) AS ks_profit_fact_sum_overall
	FROM [motivation].[dbo].[ks_commissions_close]
	GROUP BY
	[close_month], [close_year]
),

cte_extended AS (

SELECT 
c0.*,
COALESCE(ks_req_qty_all, 0) AS ks_req_qty_all,
COALESCE(ks_req_qty_tender, 0) AS ks_req_qty_tender,
COALESCE(ks_req_qty_project, 0) AS ks_req_qty_project,
COALESCE(ks_req_qty_complex, 0) AS ks_req_qty_complex,
COALESCE(ks_req_qty_typical, 0) AS ks_req_qty_typical,
COALESCE(ks_req_qty_indicative, 0) AS ks_req_qty_indicative,
COALESCE(ks_req_qty_new_customer, 0) AS ks_req_qty_new_customer,
COALESCE(ks_req_qty_current_customer, 0) AS ks_req_qty_current_customer,
COALESCE(ks_req_qty_renew_customer, 0) AS ks_req_qty_renew_customer,
COALESCE(ks_req_qty_all_to_teo, 0) AS ks_req_qty_all_to_teo,
COALESCE(ks_req_qty_tender_to_teo, 0) AS ks_req_qty_tender_to_teo,
COALESCE(ks_req_qty_project_to_teo, 0) AS ks_req_qty_project_to_teo,
COALESCE(ks_req_qty_complex_to_teo, 0) AS ks_req_qty_complex_to_teo,
COALESCE(ks_req_qty_typical_to_teo, 0) AS ks_req_qty_typical_to_teo,
COALESCE(ks_req_qty_indicative_to_teo, 0) AS ks_req_qty_indicative_to_teo,
COALESCE(ks_req_qty_new_customer_to_teo, 0) AS ks_req_qty_new_customer_to_teo,
COALESCE(ks_req_qty_current_customer_to_teo, 0) AS ks_req_qty_current_customer_to_teo,
COALESCE(ks_req_qty_renew_customer_to_teo, 0) AS ks_req_qty_renew_customer_to_teo,
COALESCE(ks_req_qty_all_to, 0) AS ks_req_qty_all_to,
COALESCE(ks_req_qty_tender_to, 0) AS ks_req_qty_tender_to,
COALESCE(ks_req_qty_project_to, 0) AS ks_req_qty_project_to,
COALESCE(ks_req_qty_complex_to, 0) AS ks_req_qty_complex_to,
COALESCE(ks_req_qty_typical_to, 0) AS ks_req_qty_typical_to,
COALESCE(ks_req_qty_indicative_to, 0) AS ks_req_qty_indicative_to,
COALESCE(ks_req_qty_new_customer_to, 0) AS ks_req_qty_new_customer_to,
COALESCE(ks_req_qty_current_customer_to, 0) AS ks_req_qty_current_customer_to,
COALESCE(ks_req_qty_renew_customer_to, 0) AS ks_req_qty_renew_customer_to,
COALESCE(ks_req_qty_all_teo, 0) AS ks_req_qty_all_teo,
COALESCE(ks_req_qty_tender_teo, 0) AS ks_req_qty_tender_teo,
COALESCE(ks_req_qty_project_teo, 0) AS ks_req_qty_project_teo,
COALESCE(ks_req_qty_complex_teo, 0) AS ks_req_qty_complex_teo,
COALESCE(ks_req_qty_typical_teo, 0) AS ks_req_qty_typical_teo,
COALESCE(ks_req_qty_indicative_teo, 0) AS ks_req_qty_indicative_teo,
COALESCE(ks_req_qty_new_customer_teo, 0) AS ks_req_qty_new_customer_teo,
COALESCE(ks_req_qty_current_customer_teo, 0) AS ks_req_qty_current_customer_teo,
COALESCE(ks_req_qty_renew_customer_teo, 0) AS ks_req_qty_renew_customer_teo,
COALESCE(ks_calc_qty_all, 0) AS ks_calc_qty_all,
COALESCE(ks_calc_qty_all_fast, 0) AS ks_calc_qty_all_fast,
COALESCE(ks_calc_qty_all_slow, 0) AS ks_calc_qty_all_slow,
COALESCE(ks_calc_qty_all_to, 0) AS ks_calc_qty_all_to,
COALESCE(ks_calc_qty_to_fast, 0) AS ks_calc_qty_to_fast,
COALESCE(ks_calc_qty_to_slow, 0) AS ks_calc_qty_to_slow,
COALESCE(ks_calc_qty_all_teo, 0) AS ks_calc_qty_all_teo,
COALESCE(ks_calc_qty_teo_fast, 0) AS ks_calc_qty_teo_fast,
COALESCE(ks_calc_qty_teo_slow, 0) AS ks_calc_qty_teo_slow,
COALESCE(ks_kp_accepted_qty, 0) AS ks_kp_accepted_qty,
COALESCE(ks_kp_rejected_qty, 0) AS ks_kp_rejected_qty,
COALESCE(ks_reply_qty_all_assigned, 0) AS ks_reply_qty_all_assigned,
COALESCE(ks_reply_qty_all_fast_assigned, 0) AS ks_reply_qty_all_fast_assigned,
COALESCE(ks_reply_qty_all_slow_assigned, 0) AS ks_reply_qty_all_slow_assigned,
COALESCE(ks_reply_qty_tender_assigned, 0) AS ks_reply_qty_tender_assigned,
COALESCE(ks_reply_qty_tender_fast_assigned, 0) AS ks_reply_qty_tender_fast_assigned,
COALESCE(ks_reply_qty_tender_slow_assigned, 0) AS ks_reply_qty_tender_slow_assigned,
COALESCE(ks_reply_qty_project_assigned, 0) AS ks_reply_qty_project_assigned,
COALESCE(ks_reply_qty_project_fast_assigned, 0) AS ks_reply_qty_project_fast_assigned,
COALESCE(ks_reply_qty_project_slow_assigned, 0) AS ks_reply_qty_project_slow_assigned,
COALESCE(ks_reply_qty_complex_assigned, 0) AS ks_reply_qty_complex_assigned,
COALESCE(ks_reply_qty_complex_fast_assigned, 0) AS ks_reply_qty_complex_fast_assigned,
COALESCE(ks_reply_qty_complex_slow_assigned, 0) AS ks_reply_qty_complex_slow_assigned,
COALESCE(ks_reply_qty_typical_assigned, 0) AS ks_reply_qty_typical_assigned,
COALESCE(ks_reply_qty_typical_fast_assigned, 0) AS ks_reply_qty_typical_fast_assigned,
COALESCE(ks_reply_qty_typical_slow_assigned, 0) AS ks_reply_qty_typical_slow_assigned,
COALESCE(ks_reply_qty_indicative_assigned, 0) AS ks_reply_qty_indicative_assigned,
COALESCE(ks_reply_qty_indicative_fast_assigned, 0) AS ks_reply_qty_indicative_fast_assigned,
COALESCE(ks_reply_qty_indicative_slow_assigned, 0) AS ks_reply_qty_indicative_slow_assigned,
COALESCE(ks_reply_qty_all_responsible, 0) AS ks_reply_qty_all_responsible,
COALESCE(ks_reply_qty_all_fast_responsible, 0) AS ks_reply_qty_all_fast_responsible,
COALESCE(ks_reply_qty_all_slow_responsible, 0) AS ks_reply_qty_all_slow_responsible,
COALESCE(ks_reply_qty_tender_responsible, 0) AS ks_reply_qty_tender_responsible,
COALESCE(ks_reply_qty_tender_fast_responsible, 0) AS ks_reply_qty_tender_fast_responsible,
COALESCE(ks_reply_qty_tender_slow_responsible, 0) AS ks_reply_qty_tender_slow_responsible,
COALESCE(ks_reply_qty_project_responsible, 0) AS ks_reply_qty_project_responsible,
COALESCE(ks_reply_qty_project_fast_responsible, 0) AS ks_reply_qty_project_fast_responsible,
COALESCE(ks_reply_qty_project_slow_responsible, 0) AS ks_reply_qty_project_slow_responsible,
COALESCE(ks_reply_qty_complex_responsible, 0) AS ks_reply_qty_complex_responsible,
COALESCE(ks_reply_qty_complex_fast_responsible, 0) AS ks_reply_qty_complex_fast_responsible,
COALESCE(ks_reply_qty_complex_slow_responsible, 0) AS ks_reply_qty_complex_slow_responsible,
COALESCE(ks_reply_qty_typical_responsible, 0) AS ks_reply_qty_typical_responsible,
COALESCE(ks_reply_qty_typical_fast_responsible, 0) AS ks_reply_qty_typical_fast_responsible,
COALESCE(ks_reply_qty_typical_slow_responsible, 0) AS ks_reply_qty_typical_slow_responsible,
COALESCE(ks_reply_qty_indicative_responsible, 0) AS ks_reply_qty_indicative_responsible,
COALESCE(ks_reply_qty_indicative_fast_responsible, 0) AS ks_reply_qty_indicative_fast_responsible,
COALESCE(ks_reply_qty_indicative_slow_responsible, 0) AS ks_reply_qty_indicative_slow_responsible,
COALESCE(ks_commission_qty_assigned, 0) AS ks_commission_qty_assigned,
COALESCE(ks_commission_qty_responsible, 0) AS ks_commission_qty_responsible,
COALESCE(ks_profit_fact_sum_assigned, 0) AS ks_profit_fact_sum_assigned,
COALESCE(ks_profit_fact_sum_responsible, 0) AS ks_profit_fact_sum_responsible,
COALESCE(ks_profit_fact_sum_overall, 0) AS ks_profit_fact_sum_overall

FROM cte_base AS c0
LEFT JOIN cte_requests AS c1 ON c0.code = c1.code AND c0.id_month = c1.request_month AND c0.id_year = c1.request_year
LEFT JOIN cte_calculations AS c2 ON c0.code = c2.code AND c0.id_month = c2.calc_month AND c0.id_year = c2.calc_year 
LEFT JOIN cte_accepted AS c3 ON c0.code = c3.code AND c0.id_month = c3.accept_month AND c0.id_year = c3.accept_year
LEFT JOIN cte_rejected AS c4 ON c0.code = c4.code AND c0.id_month = c4.reject_month AND c0.id_year = c4.reject_year
LEFT JOIN cte_sent_replies_assigned AS c5 ON c0.code = c5.assigned_code AND c0.id_month = c5.reply_month AND c0.id_year = c5.reply_year
LEFT JOIN cte_sent_replies_responsible AS c6 ON c0.code = c6.responsible_code AND c0.id_month = c6.reply_month AND c0.id_year = c6.reply_year
LEFT JOIN cte_commissions_count_assigned AS c7 ON c0.code = c7.assigned_code AND c0.id_month = c7.commission_month AND c0.id_year = c7.commission_year
LEFT JOIN cte_commissions_count_responsible AS c8 ON c0.code = c8.responsible_code AND c0.id_month = c8.commission_month AND c0.id_year = c8.commission_year
LEFT JOIN cte_commissions_profit_assigned AS c9 ON c0.code = c9.assigned_code AND c0.id_month = c9.close_month AND c0.id_year = c9.close_year
LEFT JOIN cte_commissions_profit_responsible AS c10 ON c0.code = c10.responsible_code AND c0.id_month = c10.close_month AND c0.id_year = c10.close_year
LEFT JOIN cte_commissions_profit_overall AS c11 ON c0.id_month = c11.close_month AND c0.id_year = c11.close_year
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month) [workers_count]

	,f.f_req_current_customer
	,f.f_req_renew_customer
	,f.f_req_new_customer
	,f.f_req_qty_tender_to_teo
	,f.f_req_qty_project_to_teo
	,f.f_req_qty_complex_to_teo
	,f.f_req_qty_typical_to_teo
	,f.f_req_qty_indicative_to_teo
	,f.f_req_qty_tender_to
	,f.f_req_qty_project_to
	,f.f_req_qty_complex_to
	,f.f_req_qty_typical_to
	,f.f_req_qty_indicative_to
	,f.f_req_qty_tender_teo
	,f.f_req_qty_project_teo
	,f.f_req_qty_complex_teo
	,f.f_req_qty_typical_teo
	,f.f_req_qty_indicative_teo
	,f.f_reply_tender_fast
	,f.f_reply_tender_slow
	,f.f_reply_project_fast
	,f.f_reply_project_slow
	,f.f_reply_complex_fast
	,f.f_reply_complex_slow
	,f.f_reply_typical_fast
	,f.f_reply_typical_slow
	,f.f_reply_indicative_fast
	,f.f_reply_indicative_slow
	,f.f_kp_accepted
	,f.f_kp_rejected
	,f.f_commission
	,f.f_profit_fact
	,f.f_calc_to_fast
	,f.f_calc_to_slow
	,f.f_calc_teo_fast
	,f.f_calc_teo_slow
	
	,estimate =  
	(
	  f_calc_to_fast * ks_calc_qty_to_fast
	+ f_calc_to_slow * ks_calc_qty_to_slow
	+ f_calc_teo_fast * ks_calc_qty_teo_fast
	+ f_calc_teo_slow * ks_calc_qty_teo_slow
	
	+ f_kp_accepted * ks_kp_accepted_qty
	
	+ f_kp_rejected * ks_kp_rejected_qty
	
	+ f_commission * ks_commission_qty_assigned * 0.8
	+ f_commission * ks_commission_qty_responsible * 0.2

	+ (
		COALESCE(
		(f_req_current_customer * ks_req_qty_current_customer_to_teo + f_req_renew_customer * ks_req_qty_renew_customer_to_teo + f_req_new_customer * ks_req_qty_new_customer_to_teo)
		/
		NULLIF((ks_req_qty_current_customer_to_teo + ks_req_qty_renew_customer_to_teo + ks_req_qty_new_customer_to_teo), 0)
		, 1)
	
		*

		(
		f_req_qty_tender_to_teo * ks_req_qty_tender_to_teo
		+ f_req_qty_project_to_teo * ks_req_qty_project_to_teo
		+ f_req_qty_complex_to_teo * ks_req_qty_complex_to_teo
		+ f_req_qty_typical_to_teo * ks_req_qty_typical_to_teo
		+ f_req_qty_indicative_to_teo * ks_req_qty_indicative_to_teo
		)
	)
	
	+ (
		COALESCE(
		(f_req_current_customer * ks_req_qty_current_customer_to + f_req_renew_customer * ks_req_qty_renew_customer_to + f_req_new_customer * ks_req_qty_new_customer_to)
		/
		NULLIF((ks_req_qty_current_customer_to + ks_req_qty_renew_customer_to + ks_req_qty_new_customer_to), 0)
		, 1)
	
		*

		(
		f_req_qty_tender_to * ks_req_qty_tender_to
		+ f_req_qty_project_to * ks_req_qty_project_to
		+ f_req_qty_complex_to * ks_req_qty_complex_to
		+ f_req_qty_typical_to * ks_req_qty_typical_to
		+ f_req_qty_indicative_to * ks_req_qty_indicative_to
		)
	)

	+ (
		COALESCE(
		(f_req_current_customer * ks_req_qty_current_customer_teo + f_req_renew_customer * ks_req_qty_renew_customer_teo + f_req_new_customer * ks_req_qty_new_customer_teo)
		/
		NULLIF((ks_req_qty_current_customer_teo + ks_req_qty_renew_customer_teo + ks_req_qty_new_customer_teo), 0)
		, 1)
	
		*

		(
		f_req_qty_tender_teo * ks_req_qty_tender_teo
		+ f_req_qty_project_teo * ks_req_qty_project_teo
		+ f_req_qty_complex_teo * ks_req_qty_complex_teo
		+ f_req_qty_typical_teo * ks_req_qty_typical_teo
		+ f_req_qty_indicative_teo * ks_req_qty_indicative_teo
		)
	)	   
	
	+ 0.8 * (
		f_reply_tender_fast * ks_reply_qty_tender_fast_assigned
		+ f_reply_tender_slow * ks_reply_qty_tender_slow_assigned
		+ f_reply_project_fast * ks_reply_qty_project_fast_assigned
		+ f_reply_project_slow * ks_reply_qty_project_slow_assigned
		+ f_reply_complex_fast * ks_reply_qty_complex_fast_assigned
		+ f_reply_complex_slow * ks_reply_qty_complex_slow_assigned
		+ f_reply_typical_fast * ks_reply_qty_typical_fast_assigned
		+ f_reply_typical_slow * ks_reply_qty_typical_slow_assigned
		+ f_reply_indicative_fast * ks_reply_qty_indicative_fast_assigned
		+ f_reply_indicative_slow * ks_reply_qty_indicative_slow_assigned
	)
	
	+ 0.2 * (
		f_reply_tender_fast * ks_reply_qty_tender_fast_responsible
		+ f_reply_tender_slow * ks_reply_qty_tender_slow_responsible
		+ f_reply_project_fast * ks_reply_qty_project_fast_responsible
		+ f_reply_project_slow * ks_reply_qty_project_slow_responsible
		+ f_reply_complex_fast * ks_reply_qty_complex_fast_responsible
		+ f_reply_complex_slow * ks_reply_qty_complex_slow_responsible
		+ f_reply_typical_fast * ks_reply_qty_typical_fast_responsible
		+ f_reply_typical_slow * ks_reply_qty_typical_slow_responsible
		+ f_reply_indicative_fast * ks_reply_qty_indicative_fast_responsible
		+ f_reply_indicative_slow * ks_reply_qty_indicative_slow_responsible
	)

	)
							   
	FROM cte_extended c
	JOIN [motivation].[dbo].[ks_factors] f ON f.[id] = 1
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt; CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
, 0)
) worker_factor

FROM cte_calc_done c
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(id_year, id_month, 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload main\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2020
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code]
	FROM [motivation].[dbo].[ks_workers] 
	WHERE [type] = 'manager'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [BI].[etl].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt; CAST(GETDATE() AS date) AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [bitrix_name], 
	
	CASE WHEN oa_participant.not_a_participant IS NOT NULL THEN 0
	ELSE [estimate_participant] END AS [estimate_participant], 
	
	COALESCE([work_days], 0) AS [work_days]
	
	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[ks_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [bitrix_name], [estimate_participant] FROM [motivation].[dbo].[ks_workers] w
	WHERE w.[type] = 'manager' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days
	
	OUTER APPLY (
	SELECT 1 AS not_a_participant
	FROM [motivation].[dbo].[calc_exceptions] AS ce
	WHERE ce.[type] = 'manager' AND ce.code = cte_distinct_code.code
	) AS oa_participant

),

cte_requests AS (
	
	SELECT  

	[code],
	[request_month],
	[request_year],
	COUNT(0) AS ks_req_qty_all,
	COUNT(ALL CASE WHEN request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_req_qty_tender,
	COUNT(ALL CASE WHEN request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_req_qty_project,
	COUNT(ALL CASE WHEN request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_req_qty_complex,
	COUNT(ALL CASE WHEN request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_req_qty_typical,
	COUNT(ALL CASE WHEN request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_req_qty_indicative,
	COUNT(ALL CASE WHEN client_type = 'Новый' THEN 0 ELSE NULL END) AS ks_req_qty_new_customer,
	COUNT(ALL CASE WHEN client_type = 'Действующий' THEN 0 ELSE NULL END) AS ks_req_qty_current_customer,
	COUNT(ALL CASE WHEN client_type = 'Вновь обратившийся' THEN 0 ELSE NULL END) AS ks_req_qty_renew_customer,

	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' THEN 0 ELSE NULL END) AS ks_req_qty_all_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_req_qty_tender_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_req_qty_project_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_req_qty_complex_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_req_qty_typical_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_req_qty_indicative_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND client_type = 'Новый' THEN 0 ELSE NULL END) AS ks_req_qty_new_customer_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND client_type = 'Действующий' THEN 0 ELSE NULL END) AS ks_req_qty_current_customer_to_teo,
	COUNT(ALL CASE WHEN service_type = 'ТО+ТЭО' AND client_type = 'Вновь обратившийся' THEN 0 ELSE NULL END) AS ks_req_qty_renew_customer_to_teo,
	
	COUNT(ALL CASE WHEN service_type = 'ТО' THEN 0 ELSE NULL END) AS ks_req_qty_all_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_req_qty_tender_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_req_qty_project_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_req_qty_complex_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_req_qty_typical_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_req_qty_indicative_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND client_type = 'Новый' THEN 0 ELSE NULL END) AS ks_req_qty_new_customer_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND client_type = 'Действующий' THEN 0 ELSE NULL END) AS ks_req_qty_current_customer_to,
	COUNT(ALL CASE WHEN service_type = 'ТО' AND client_type = 'Вновь обратившийся' THEN 0 ELSE NULL END) AS ks_req_qty_renew_customer_to,

	COUNT(ALL CASE WHEN service_type = 'ТЭО' THEN 0 ELSE NULL END) AS ks_req_qty_all_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_req_qty_tender_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_req_qty_project_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_req_qty_complex_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_req_qty_typical_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_req_qty_indicative_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND client_type = 'Новый' THEN 0 ELSE NULL END) AS ks_req_qty_new_customer_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND client_type = 'Действующий' THEN 0 ELSE NULL END) AS ks_req_qty_current_customer_teo,
	COUNT(ALL CASE WHEN service_type = 'ТЭО' AND client_type = 'Вновь обратившийся' THEN 0 ELSE NULL END) AS ks_req_qty_renew_customer_teo

	FROM [motivation].[dbo].[ks_requests]
	GROUP BY 
	[code]
	,[request_month]
	,[request_year]
),

cte_calculations AS (

	SELECT 

	[code],
	[calc_month],
	[calc_year],
	COUNT(0) AS ks_calc_qty_all,
	COUNT(ALL CASE WHEN req_calc_duration &lt;= 9 THEN 0 ELSE NULL END) AS ks_calc_qty_all_fast,
	COUNT(ALL CASE WHEN req_calc_duration &gt; 9 THEN 0 ELSE NULL END) AS ks_calc_qty_all_slow,

	COUNT(ALL CASE WHEN service_type_row = 'ТО' THEN 0 ELSE NULL END) AS ks_calc_qty_all_to,
	COUNT(ALL CASE WHEN service_type_row = 'ТО' AND req_calc_duration &lt;= 9 THEN 0 ELSE NULL END) AS ks_calc_qty_to_fast,
	COUNT(ALL CASE WHEN service_type_row = 'ТО' AND req_calc_duration &gt; 9 THEN 0 ELSE NULL END) AS ks_calc_qty_to_slow,

	COUNT(ALL CASE WHEN service_type_row = 'ТЭО' THEN 0 ELSE NULL END) AS ks_calc_qty_all_teo,
	COUNT(ALL CASE WHEN service_type_row = 'ТЭО' AND req_calc_duration &lt;= 9 THEN 0 ELSE NULL END) AS ks_calc_qty_teo_fast,
	COUNT(ALL CASE WHEN service_type_row = 'ТЭО' AND req_calc_duration &gt; 9 THEN 0 ELSE NULL END) AS ks_calc_qty_teo_slow

	FROM [motivation].[dbo].[ks_calculations]
	GROUP BY 
	[code]
	,[calc_month]
	,[calc_year]
),

cte_accepted AS (	
	SELECT
	[code]     
    ,[accept_month]
    ,[accept_year]
	,COUNT(0) AS ks_kp_accepted_qty
	FROM [motivation].[dbo].[ks_accepted]
	GROUP BY 
	[code]     
    ,[accept_month]
    ,[accept_year]
),

cte_rejected AS (	
	SELECT
	[code]     
    ,[accept_month] AS reject_month
    ,[accept_year] AS reject_year
	,COUNT(0) AS ks_kp_rejected_qty	
	FROM [motivation].[dbo].[ks_rejected]
	GROUP BY 
	[code]     
    ,[accept_month]
    ,[accept_year]
),

cte_sent_replies_assigned AS (

	SELECT
	[assigned_code],
	[reply_month],
    [reply_year],
	
	COUNT(0) AS ks_reply_qty_all_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 THEN 0 ELSE NULL END) AS ks_reply_qty_all_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 THEN 0 ELSE NULL END) AS ks_reply_qty_all_slow_assigned,

	COUNT(ALL CASE WHEN request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_reply_qty_tender_assigned,
	COUNT(ALL CASE WHEN request_type = 'Тендер' AND kp_in_time = 1 THEN 0 ELSE NULL END) AS ks_reply_qty_tender_fast_assigned,
	COUNT(ALL CASE WHEN request_type = 'Тендер' AND kp_in_time = 0 THEN 0 ELSE NULL END) AS ks_reply_qty_tender_slow_assigned,

	COUNT(ALL CASE WHEN request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_slow_assigned,
	
	COUNT(ALL CASE WHEN request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_slow_assigned,
	
	COUNT(ALL CASE WHEN request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_slow_assigned,
	
	COUNT(ALL CASE WHEN request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_fast_assigned,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_slow_assigned

	FROM [motivation].[dbo].[ks_sent_replies]
	GROUP BY 
	[assigned_code],
	[reply_month],
    [reply_year]
),

cte_sent_replies_responsible AS (

	SELECT
	[responsible_code],
	[reply_month],
    [reply_year],
	
	COUNT(0) AS ks_reply_qty_all_responsible,
	
	COUNT(ALL CASE WHEN kp_in_time = 1 THEN 0 ELSE NULL END) AS ks_reply_qty_all_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 THEN 0 ELSE NULL END) AS ks_reply_qty_all_slow_responsible,

	COUNT(ALL CASE WHEN request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_reply_qty_tender_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_reply_qty_tender_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Тендер' THEN 0 ELSE NULL END) AS ks_reply_qty_tender_slow_responsible,
	
	COUNT(ALL CASE WHEN request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Проект' THEN 0 ELSE NULL END) AS ks_reply_qty_project_slow_responsible,
	
	COUNT(ALL CASE WHEN request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Сложный' THEN 0 ELSE NULL END) AS ks_reply_qty_complex_slow_responsible,
	
	COUNT(ALL CASE WHEN request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Типовой' THEN 0 ELSE NULL END) AS ks_reply_qty_typical_slow_responsible,
	
	COUNT(ALL CASE WHEN request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 1 AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_fast_responsible,
	COUNT(ALL CASE WHEN kp_in_time = 0 AND request_type = 'Индикативный' THEN 0 ELSE NULL END) AS ks_reply_qty_indicative_slow_responsible

	FROM [motivation].[dbo].[ks_sent_replies]
	GROUP BY 
	[responsible_code],
	[reply_month],
    [reply_year]
),

cte_commissions_count_assigned AS (
	SELECT [assigned_code], [commission_month], [commission_year], COUNT(0) AS ks_commission_qty_assigned	
	FROM [motivation].[dbo].[ks_commissions]
	GROUP BY
	[assigned_code], [commission_month], [commission_year]
),

cte_commissions_count_responsible AS (
	SELECT [responsible_code], [commission_month], [commission_year], COUNT(0) AS ks_commission_qty_responsible
	FROM [motivation].[dbo].[ks_commissions]
	GROUP BY
	[responsible_code], [commission_month], [commission_year]
),

cte_commissions_profit_assigned AS (
	SELECT [assigned_code], [close_month], [close_year], COALESCE(SUM(margin_fact), 0) AS ks_profit_fact_sum_assigned
	FROM [motivation].[dbo].[ks_commissions_close]
	GROUP BY
	[assigned_code], [close_month], [close_year]
),

cte_commissions_profit_responsible AS (
	SELECT [responsible_code], [close_month], [close_year], COALESCE(SUM(margin_fact), 0) AS ks_profit_fact_sum_responsible
	FROM [motivation].[dbo].[ks_commissions_close]
	GROUP BY
	[responsible_code], [close_month], [close_year]
),

cte_commissions_profit_overall AS (
	SELECT [close_month], [close_year], CAST((COALESCE(SUM(margin_fact), 0) * 0.6) AS decimal(18,2)) AS ks_profit_fact_sum_overall
	FROM [motivation].[dbo].[ks_commissions_close]
	GROUP BY
	[close_month], [close_year]
),

cte_extended AS (

SELECT 
c0.*,
COALESCE(ks_req_qty_all, 0) AS ks_req_qty_all,
COALESCE(ks_req_qty_tender, 0) AS ks_req_qty_tender,
COALESCE(ks_req_qty_project, 0) AS ks_req_qty_project,
COALESCE(ks_req_qty_complex, 0) AS ks_req_qty_complex,
COALESCE(ks_req_qty_typical, 0) AS ks_req_qty_typical,
COALESCE(ks_req_qty_indicative, 0) AS ks_req_qty_indicative,
COALESCE(ks_req_qty_new_customer, 0) AS ks_req_qty_new_customer,
COALESCE(ks_req_qty_current_customer, 0) AS ks_req_qty_current_customer,
COALESCE(ks_req_qty_renew_customer, 0) AS ks_req_qty_renew_customer,
COALESCE(ks_req_qty_all_to_teo, 0) AS ks_req_qty_all_to_teo,
COALESCE(ks_req_qty_tender_to_teo, 0) AS ks_req_qty_tender_to_teo,
COALESCE(ks_req_qty_project_to_teo, 0) AS ks_req_qty_project_to_teo,
COALESCE(ks_req_qty_complex_to_teo, 0) AS ks_req_qty_complex_to_teo,
COALESCE(ks_req_qty_typical_to_teo, 0) AS ks_req_qty_typical_to_teo,
COALESCE(ks_req_qty_indicative_to_teo, 0) AS ks_req_qty_indicative_to_teo,
COALESCE(ks_req_qty_new_customer_to_teo, 0) AS ks_req_qty_new_customer_to_teo,
COALESCE(ks_req_qty_current_customer_to_teo, 0) AS ks_req_qty_current_customer_to_teo,
COALESCE(ks_req_qty_renew_customer_to_teo, 0) AS ks_req_qty_renew_customer_to_teo,
COALESCE(ks_req_qty_all_to, 0) AS ks_req_qty_all_to,
COALESCE(ks_req_qty_tender_to, 0) AS ks_req_qty_tender_to,
COALESCE(ks_req_qty_project_to, 0) AS ks_req_qty_project_to,
COALESCE(ks_req_qty_complex_to, 0) AS ks_req_qty_complex_to,
COALESCE(ks_req_qty_typical_to, 0) AS ks_req_qty_typical_to,
COALESCE(ks_req_qty_indicative_to, 0) AS ks_req_qty_indicative_to,
COALESCE(ks_req_qty_new_customer_to, 0) AS ks_req_qty_new_customer_to,
COALESCE(ks_req_qty_current_customer_to, 0) AS ks_req_qty_current_customer_to,
COALESCE(ks_req_qty_renew_customer_to, 0) AS ks_req_qty_renew_customer_to,
COALESCE(ks_req_qty_all_teo, 0) AS ks_req_qty_all_teo,
COALESCE(ks_req_qty_tender_teo, 0) AS ks_req_qty_tender_teo,
COALESCE(ks_req_qty_project_teo, 0) AS ks_req_qty_project_teo,
COALESCE(ks_req_qty_complex_teo, 0) AS ks_req_qty_complex_teo,
COALESCE(ks_req_qty_typical_teo, 0) AS ks_req_qty_typical_teo,
COALESCE(ks_req_qty_indicative_teo, 0) AS ks_req_qty_indicative_teo,
COALESCE(ks_req_qty_new_customer_teo, 0) AS ks_req_qty_new_customer_teo,
COALESCE(ks_req_qty_current_customer_teo, 0) AS ks_req_qty_current_customer_teo,
COALESCE(ks_req_qty_renew_customer_teo, 0) AS ks_req_qty_renew_customer_teo,
COALESCE(ks_calc_qty_all, 0) AS ks_calc_qty_all,
COALESCE(ks_calc_qty_all_fast, 0) AS ks_calc_qty_all_fast,
COALESCE(ks_calc_qty_all_slow, 0) AS ks_calc_qty_all_slow,
COALESCE(ks_calc_qty_all_to, 0) AS ks_calc_qty_all_to,
COALESCE(ks_calc_qty_to_fast, 0) AS ks_calc_qty_to_fast,
COALESCE(ks_calc_qty_to_slow, 0) AS ks_calc_qty_to_slow,
COALESCE(ks_calc_qty_all_teo, 0) AS ks_calc_qty_all_teo,
COALESCE(ks_calc_qty_teo_fast, 0) AS ks_calc_qty_teo_fast,
COALESCE(ks_calc_qty_teo_slow, 0) AS ks_calc_qty_teo_slow,
COALESCE(ks_kp_accepted_qty, 0) AS ks_kp_accepted_qty,
COALESCE(ks_kp_rejected_qty, 0) AS ks_kp_rejected_qty,
COALESCE(ks_reply_qty_all_assigned, 0) AS ks_reply_qty_all_assigned,
COALESCE(ks_reply_qty_all_fast_assigned, 0) AS ks_reply_qty_all_fast_assigned,
COALESCE(ks_reply_qty_all_slow_assigned, 0) AS ks_reply_qty_all_slow_assigned,
COALESCE(ks_reply_qty_tender_assigned, 0) AS ks_reply_qty_tender_assigned,
COALESCE(ks_reply_qty_tender_fast_assigned, 0) AS ks_reply_qty_tender_fast_assigned,
COALESCE(ks_reply_qty_tender_slow_assigned, 0) AS ks_reply_qty_tender_slow_assigned,
COALESCE(ks_reply_qty_project_assigned, 0) AS ks_reply_qty_project_assigned,
COALESCE(ks_reply_qty_project_fast_assigned, 0) AS ks_reply_qty_project_fast_assigned,
COALESCE(ks_reply_qty_project_slow_assigned, 0) AS ks_reply_qty_project_slow_assigned,
COALESCE(ks_reply_qty_complex_assigned, 0) AS ks_reply_qty_complex_assigned,
COALESCE(ks_reply_qty_complex_fast_assigned, 0) AS ks_reply_qty_complex_fast_assigned,
COALESCE(ks_reply_qty_complex_slow_assigned, 0) AS ks_reply_qty_complex_slow_assigned,
COALESCE(ks_reply_qty_typical_assigned, 0) AS ks_reply_qty_typical_assigned,
COALESCE(ks_reply_qty_typical_fast_assigned, 0) AS ks_reply_qty_typical_fast_assigned,
COALESCE(ks_reply_qty_typical_slow_assigned, 0) AS ks_reply_qty_typical_slow_assigned,
COALESCE(ks_reply_qty_indicative_assigned, 0) AS ks_reply_qty_indicative_assigned,
COALESCE(ks_reply_qty_indicative_fast_assigned, 0) AS ks_reply_qty_indicative_fast_assigned,
COALESCE(ks_reply_qty_indicative_slow_assigned, 0) AS ks_reply_qty_indicative_slow_assigned,
COALESCE(ks_reply_qty_all_responsible, 0) AS ks_reply_qty_all_responsible,
COALESCE(ks_reply_qty_all_fast_responsible, 0) AS ks_reply_qty_all_fast_responsible,
COALESCE(ks_reply_qty_all_slow_responsible, 0) AS ks_reply_qty_all_slow_responsible,
COALESCE(ks_reply_qty_tender_responsible, 0) AS ks_reply_qty_tender_responsible,
COALESCE(ks_reply_qty_tender_fast_responsible, 0) AS ks_reply_qty_tender_fast_responsible,
COALESCE(ks_reply_qty_tender_slow_responsible, 0) AS ks_reply_qty_tender_slow_responsible,
COALESCE(ks_reply_qty_project_responsible, 0) AS ks_reply_qty_project_responsible,
COALESCE(ks_reply_qty_project_fast_responsible, 0) AS ks_reply_qty_project_fast_responsible,
COALESCE(ks_reply_qty_project_slow_responsible, 0) AS ks_reply_qty_project_slow_responsible,
COALESCE(ks_reply_qty_complex_responsible, 0) AS ks_reply_qty_complex_responsible,
COALESCE(ks_reply_qty_complex_fast_responsible, 0) AS ks_reply_qty_complex_fast_responsible,
COALESCE(ks_reply_qty_complex_slow_responsible, 0) AS ks_reply_qty_complex_slow_responsible,
COALESCE(ks_reply_qty_typical_responsible, 0) AS ks_reply_qty_typical_responsible,
COALESCE(ks_reply_qty_typical_fast_responsible, 0) AS ks_reply_qty_typical_fast_responsible,
COALESCE(ks_reply_qty_typical_slow_responsible, 0) AS ks_reply_qty_typical_slow_responsible,
COALESCE(ks_reply_qty_indicative_responsible, 0) AS ks_reply_qty_indicative_responsible,
COALESCE(ks_reply_qty_indicative_fast_responsible, 0) AS ks_reply_qty_indicative_fast_responsible,
COALESCE(ks_reply_qty_indicative_slow_responsible, 0) AS ks_reply_qty_indicative_slow_responsible,
COALESCE(ks_commission_qty_assigned, 0) AS ks_commission_qty_assigned,
COALESCE(ks_commission_qty_responsible, 0) AS ks_commission_qty_responsible,
COALESCE(ks_profit_fact_sum_assigned, 0) AS ks_profit_fact_sum_assigned,
COALESCE(ks_profit_fact_sum_responsible, 0) AS ks_profit_fact_sum_responsible,
COALESCE(ks_profit_fact_sum_overall, 0) AS ks_profit_fact_sum_overall

FROM cte_base AS c0
LEFT JOIN cte_requests AS c1 ON c0.code = c1.code AND c0.id_month = c1.request_month AND c0.id_year = c1.request_year
LEFT JOIN cte_calculations AS c2 ON c0.code = c2.code AND c0.id_month = c2.calc_month AND c0.id_year = c2.calc_year 
LEFT JOIN cte_accepted AS c3 ON c0.code = c3.code AND c0.id_month = c3.accept_month AND c0.id_year = c3.accept_year
LEFT JOIN cte_rejected AS c4 ON c0.code = c4.code AND c0.id_month = c4.reject_month AND c0.id_year = c4.reject_year
LEFT JOIN cte_sent_replies_assigned AS c5 ON c0.code = c5.assigned_code AND c0.id_month = c5.reply_month AND c0.id_year = c5.reply_year
LEFT JOIN cte_sent_replies_responsible AS c6 ON c0.code = c6.responsible_code AND c0.id_month = c6.reply_month AND c0.id_year = c6.reply_year
LEFT JOIN cte_commissions_count_assigned AS c7 ON c0.code = c7.assigned_code AND c0.id_month = c7.commission_month AND c0.id_year = c7.commission_year
LEFT JOIN cte_commissions_count_responsible AS c8 ON c0.code = c8.responsible_code AND c0.id_month = c8.commission_month AND c0.id_year = c8.commission_year
LEFT JOIN cte_commissions_profit_assigned AS c9 ON c0.code = c9.assigned_code AND c0.id_month = c9.close_month AND c0.id_year = c9.close_year
LEFT JOIN cte_commissions_profit_responsible AS c10 ON c0.code = c10.responsible_code AND c0.id_month = c10.close_month AND c0.id_year = c10.close_year
LEFT JOIN cte_commissions_profit_overall AS c11 ON c0.id_month = c11.close_month AND c0.id_year = c11.close_year
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month) [workers_count]

	,f.f_req_current_customer
	,f.f_req_renew_customer
	,f.f_req_new_customer
	,f.f_req_qty_tender_to_teo
	,f.f_req_qty_project_to_teo
	,f.f_req_qty_complex_to_teo
	,f.f_req_qty_typical_to_teo
	,f.f_req_qty_indicative_to_teo
	,f.f_req_qty_tender_to
	,f.f_req_qty_project_to
	,f.f_req_qty_complex_to
	,f.f_req_qty_typical_to
	,f.f_req_qty_indicative_to
	,f.f_req_qty_tender_teo
	,f.f_req_qty_project_teo
	,f.f_req_qty_complex_teo
	,f.f_req_qty_typical_teo
	,f.f_req_qty_indicative_teo
	,f.f_reply_tender_fast
	,f.f_reply_tender_slow
	,f.f_reply_project_fast
	,f.f_reply_project_slow
	,f.f_reply_complex_fast
	,f.f_reply_complex_slow
	,f.f_reply_typical_fast
	,f.f_reply_typical_slow
	,f.f_reply_indicative_fast
	,f.f_reply_indicative_slow
	,f.f_kp_accepted
	,f.f_kp_rejected
	,f.f_commission
	,f.f_profit_fact
	,f.f_calc_to_fast
	,f.f_calc_to_slow
	,f.f_calc_teo_fast
	,f.f_calc_teo_slow
	
	,estimate =  
	(
	  f_calc_to_fast * ks_calc_qty_to_fast
	+ f_calc_to_slow * ks_calc_qty_to_slow
	+ f_calc_teo_fast * ks_calc_qty_teo_fast
	+ f_calc_teo_slow * ks_calc_qty_teo_slow
	
	+ f_kp_accepted * ks_kp_accepted_qty
	
	+ f_kp_rejected * ks_kp_rejected_qty
	
	+ f_commission * ks_commission_qty_assigned * 0.8
	+ f_commission * ks_commission_qty_responsible * 0.2

	+ (
		COALESCE(
		(f_req_current_customer * ks_req_qty_current_customer_to_teo + f_req_renew_customer * ks_req_qty_renew_customer_to_teo + f_req_new_customer * ks_req_qty_new_customer_to_teo)
		/
		NULLIF((ks_req_qty_current_customer_to_teo + ks_req_qty_renew_customer_to_teo + ks_req_qty_new_customer_to_teo), 0)
		, 1)
	
		*

		(
		f_req_qty_tender_to_teo * ks_req_qty_tender_to_teo
		+ f_req_qty_project_to_teo * ks_req_qty_project_to_teo
		+ f_req_qty_complex_to_teo * ks_req_qty_complex_to_teo
		+ f_req_qty_typical_to_teo * ks_req_qty_typical_to_teo
		+ f_req_qty_indicative_to_teo * ks_req_qty_indicative_to_teo
		)
	)
	
	+ (
		COALESCE(
		(f_req_current_customer * ks_req_qty_current_customer_to + f_req_renew_customer * ks_req_qty_renew_customer_to + f_req_new_customer * ks_req_qty_new_customer_to)
		/
		NULLIF((ks_req_qty_current_customer_to + ks_req_qty_renew_customer_to + ks_req_qty_new_customer_to), 0)
		, 1)
	
		*

		(
		f_req_qty_tender_to * ks_req_qty_tender_to
		+ f_req_qty_project_to * ks_req_qty_project_to
		+ f_req_qty_complex_to * ks_req_qty_complex_to
		+ f_req_qty_typical_to * ks_req_qty_typical_to
		+ f_req_qty_indicative_to * ks_req_qty_indicative_to
		)
	)

	+ (
		COALESCE(
		(f_req_current_customer * ks_req_qty_current_customer_teo + f_req_renew_customer * ks_req_qty_renew_customer_teo + f_req_new_customer * ks_req_qty_new_customer_teo)
		/
		NULLIF((ks_req_qty_current_customer_teo + ks_req_qty_renew_customer_teo + ks_req_qty_new_customer_teo), 0)
		, 1)
	
		*

		(
		f_req_qty_tender_teo * ks_req_qty_tender_teo
		+ f_req_qty_project_teo * ks_req_qty_project_teo
		+ f_req_qty_complex_teo * ks_req_qty_complex_teo
		+ f_req_qty_typical_teo * ks_req_qty_typical_teo
		+ f_req_qty_indicative_teo * ks_req_qty_indicative_teo
		)
	)	   
	
	+ 0.8 * (
		f_reply_tender_fast * ks_reply_qty_tender_fast_assigned
		+ f_reply_tender_slow * ks_reply_qty_tender_slow_assigned
		+ f_reply_project_fast * ks_reply_qty_project_fast_assigned
		+ f_reply_project_slow * ks_reply_qty_project_slow_assigned
		+ f_reply_complex_fast * ks_reply_qty_complex_fast_assigned
		+ f_reply_complex_slow * ks_reply_qty_complex_slow_assigned
		+ f_reply_typical_fast * ks_reply_qty_typical_fast_assigned
		+ f_reply_typical_slow * ks_reply_qty_typical_slow_assigned
		+ f_reply_indicative_fast * ks_reply_qty_indicative_fast_assigned
		+ f_reply_indicative_slow * ks_reply_qty_indicative_slow_assigned
	)
	
	+ 0.2 * (
		f_reply_tender_fast * ks_reply_qty_tender_fast_responsible
		+ f_reply_tender_slow * ks_reply_qty_tender_slow_responsible
		+ f_reply_project_fast * ks_reply_qty_project_fast_responsible
		+ f_reply_project_slow * ks_reply_qty_project_slow_responsible
		+ f_reply_complex_fast * ks_reply_qty_complex_fast_responsible
		+ f_reply_complex_slow * ks_reply_qty_complex_slow_responsible
		+ f_reply_typical_fast * ks_reply_qty_typical_fast_responsible
		+ f_reply_typical_slow * ks_reply_qty_typical_slow_responsible
		+ f_reply_indicative_fast * ks_reply_qty_indicative_fast_responsible
		+ f_reply_indicative_slow * ks_reply_qty_indicative_slow_responsible
	)

	)
							   
	FROM cte_extended c
	JOIN [motivation].[dbo].[ks_factors] f ON f.[id] = 1
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt; CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
, 0)
) worker_factor

FROM cte_calc_done c
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(id_year, id_month, 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload main\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload main\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                      name="id_year"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                      name="id_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                      name="work_days_in_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                      length="50"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                      name="name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      length="10"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[bitrix_name]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[bitrix_name]"
                      length="50"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[bitrix_name]"
                      name="bitrix_name"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                      name="estimate_participant"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                      name="work_days"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all]"
                      name="ks_req_qty_all"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender]"
                      name="ks_req_qty_tender"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project]"
                      name="ks_req_qty_project"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex]"
                      name="ks_req_qty_complex"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical]"
                      name="ks_req_qty_typical"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative]"
                      name="ks_req_qty_indicative"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_new_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer]"
                      name="ks_req_qty_new_customer"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_current_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer]"
                      name="ks_req_qty_current_customer"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_renew_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer]"
                      name="ks_req_qty_renew_customer"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all_to_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_all_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all_to_teo]"
                      name="ks_req_qty_all_to_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender_to_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_tender_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender_to_teo]"
                      name="ks_req_qty_tender_to_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project_to_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_project_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project_to_teo]"
                      name="ks_req_qty_project_to_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex_to_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_complex_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex_to_teo]"
                      name="ks_req_qty_complex_to_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical_to_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_typical_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical_to_teo]"
                      name="ks_req_qty_typical_to_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative_to_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_indicative_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative_to_teo]"
                      name="ks_req_qty_indicative_to_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer_to_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_new_customer_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer_to_teo]"
                      name="ks_req_qty_new_customer_to_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer_to_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_current_customer_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer_to_teo]"
                      name="ks_req_qty_current_customer_to_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer_to_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_renew_customer_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer_to_teo]"
                      name="ks_req_qty_renew_customer_to_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_all_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all_to]"
                      name="ks_req_qty_all_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_tender_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender_to]"
                      name="ks_req_qty_tender_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_project_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project_to]"
                      name="ks_req_qty_project_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_complex_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex_to]"
                      name="ks_req_qty_complex_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_typical_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical_to]"
                      name="ks_req_qty_typical_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_indicative_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative_to]"
                      name="ks_req_qty_indicative_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_new_customer_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer_to]"
                      name="ks_req_qty_new_customer_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_current_customer_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer_to]"
                      name="ks_req_qty_current_customer_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_renew_customer_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer_to]"
                      name="ks_req_qty_renew_customer_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_all_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all_teo]"
                      name="ks_req_qty_all_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_tender_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender_teo]"
                      name="ks_req_qty_tender_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_project_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project_teo]"
                      name="ks_req_qty_project_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_complex_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex_teo]"
                      name="ks_req_qty_complex_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_typical_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical_teo]"
                      name="ks_req_qty_typical_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_indicative_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative_teo]"
                      name="ks_req_qty_indicative_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_new_customer_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer_teo]"
                      name="ks_req_qty_new_customer_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_current_customer_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer_teo]"
                      name="ks_req_qty_current_customer_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_renew_customer_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer_teo]"
                      name="ks_req_qty_renew_customer_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all]"
                      name="ks_calc_qty_all"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_fast]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_fast]"
                      name="ks_calc_qty_all_fast"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_slow]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_slow]"
                      name="ks_calc_qty_all_slow"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_to]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_to]"
                      name="ks_calc_qty_all_to"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_to_fast]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_to_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_to_fast]"
                      name="ks_calc_qty_to_fast"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_to_slow]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_to_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_to_slow]"
                      name="ks_calc_qty_to_slow"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_teo]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_teo]"
                      name="ks_calc_qty_all_teo"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_teo_fast]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_teo_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_teo_fast]"
                      name="ks_calc_qty_teo_fast"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_teo_slow]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_teo_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_teo_slow]"
                      name="ks_calc_qty_teo_slow"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_kp_accepted_qty]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_kp_accepted_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_kp_accepted_qty]"
                      name="ks_kp_accepted_qty"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_kp_rejected_qty]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_kp_rejected_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_kp_rejected_qty]"
                      name="ks_kp_rejected_qty"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_assigned]"
                      name="ks_reply_qty_all_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_fast_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_fast_assigned]"
                      name="ks_reply_qty_all_fast_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_slow_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_slow_assigned]"
                      name="ks_reply_qty_all_slow_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_assigned]"
                      name="ks_reply_qty_tender_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_fast_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_fast_assigned]"
                      name="ks_reply_qty_tender_fast_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_slow_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_slow_assigned]"
                      name="ks_reply_qty_tender_slow_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_assigned]"
                      name="ks_reply_qty_project_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_fast_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_fast_assigned]"
                      name="ks_reply_qty_project_fast_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_slow_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_slow_assigned]"
                      name="ks_reply_qty_project_slow_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_assigned]"
                      name="ks_reply_qty_complex_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_fast_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_fast_assigned]"
                      name="ks_reply_qty_complex_fast_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_slow_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_slow_assigned]"
                      name="ks_reply_qty_complex_slow_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_assigned]"
                      name="ks_reply_qty_typical_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_fast_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_fast_assigned]"
                      name="ks_reply_qty_typical_fast_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_slow_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_slow_assigned]"
                      name="ks_reply_qty_typical_slow_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_assigned]"
                      name="ks_reply_qty_indicative_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_fast_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_fast_assigned]"
                      name="ks_reply_qty_indicative_fast_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_slow_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_slow_assigned]"
                      name="ks_reply_qty_indicative_slow_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_responsible]"
                      name="ks_reply_qty_all_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_fast_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_fast_responsible]"
                      name="ks_reply_qty_all_fast_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_slow_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_slow_responsible]"
                      name="ks_reply_qty_all_slow_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_responsible]"
                      name="ks_reply_qty_tender_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_fast_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_fast_responsible]"
                      name="ks_reply_qty_tender_fast_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_slow_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_slow_responsible]"
                      name="ks_reply_qty_tender_slow_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_responsible]"
                      name="ks_reply_qty_project_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_fast_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_fast_responsible]"
                      name="ks_reply_qty_project_fast_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_slow_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_slow_responsible]"
                      name="ks_reply_qty_project_slow_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_responsible]"
                      name="ks_reply_qty_complex_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_fast_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_fast_responsible]"
                      name="ks_reply_qty_complex_fast_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_slow_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_slow_responsible]"
                      name="ks_reply_qty_complex_slow_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_responsible]"
                      name="ks_reply_qty_typical_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_fast_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_fast_responsible]"
                      name="ks_reply_qty_typical_fast_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_slow_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_slow_responsible]"
                      name="ks_reply_qty_typical_slow_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_responsible]"
                      name="ks_reply_qty_indicative_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_fast_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_fast_responsible]"
                      name="ks_reply_qty_indicative_fast_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_slow_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_slow_responsible]"
                      name="ks_reply_qty_indicative_slow_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_commission_qty_assigned]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_commission_qty_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_commission_qty_assigned]"
                      name="ks_commission_qty_assigned"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_commission_qty_responsible]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_commission_qty_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_commission_qty_responsible]"
                      name="ks_commission_qty_responsible"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_profit_fact_sum_assigned]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_profit_fact_sum_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_profit_fact_sum_assigned]"
                      name="ks_profit_fact_sum_assigned"
                      precision="38"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_profit_fact_sum_responsible]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_profit_fact_sum_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_profit_fact_sum_responsible]"
                      name="ks_profit_fact_sum_responsible"
                      precision="38"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_profit_fact_sum_overall]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_profit_fact_sum_overall]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_profit_fact_sum_overall]"
                      name="ks_profit_fact_sum_overall"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                      name="workers_count"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_current_customer]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_current_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_current_customer]"
                      name="f_req_current_customer"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_renew_customer]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_renew_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_renew_customer]"
                      name="f_req_renew_customer"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_new_customer]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_new_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_new_customer]"
                      name="f_req_new_customer"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_tender_to_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_tender_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_tender_to_teo]"
                      name="f_req_qty_tender_to_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_project_to_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_project_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_project_to_teo]"
                      name="f_req_qty_project_to_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_complex_to_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_complex_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_complex_to_teo]"
                      name="f_req_qty_complex_to_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_typical_to_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_typical_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_typical_to_teo]"
                      name="f_req_qty_typical_to_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_indicative_to_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_indicative_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_indicative_to_teo]"
                      name="f_req_qty_indicative_to_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_tender_to]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_tender_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_tender_to]"
                      name="f_req_qty_tender_to"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_project_to]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_project_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_project_to]"
                      name="f_req_qty_project_to"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_complex_to]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_complex_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_complex_to]"
                      name="f_req_qty_complex_to"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_typical_to]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_typical_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_typical_to]"
                      name="f_req_qty_typical_to"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_indicative_to]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_indicative_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_indicative_to]"
                      name="f_req_qty_indicative_to"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_tender_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_tender_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_tender_teo]"
                      name="f_req_qty_tender_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_project_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_project_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_project_teo]"
                      name="f_req_qty_project_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_complex_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_complex_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_complex_teo]"
                      name="f_req_qty_complex_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_typical_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_typical_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_typical_teo]"
                      name="f_req_qty_typical_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_indicative_teo]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_indicative_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_indicative_teo]"
                      name="f_req_qty_indicative_teo"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_tender_fast]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_tender_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_tender_fast]"
                      name="f_reply_tender_fast"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_tender_slow]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_tender_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_tender_slow]"
                      name="f_reply_tender_slow"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_project_fast]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_project_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_project_fast]"
                      name="f_reply_project_fast"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_project_slow]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_project_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_project_slow]"
                      name="f_reply_project_slow"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_complex_fast]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_complex_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_complex_fast]"
                      name="f_reply_complex_fast"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_complex_slow]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_complex_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_complex_slow]"
                      name="f_reply_complex_slow"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_typical_fast]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_typical_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_typical_fast]"
                      name="f_reply_typical_fast"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_typical_slow]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_typical_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_typical_slow]"
                      name="f_reply_typical_slow"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_indicative_fast]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_indicative_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_indicative_fast]"
                      name="f_reply_indicative_fast"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_indicative_slow]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_indicative_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_indicative_slow]"
                      name="f_reply_indicative_slow"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_kp_accepted]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_kp_accepted]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_kp_accepted]"
                      name="f_kp_accepted"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_kp_rejected]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_kp_rejected]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_kp_rejected]"
                      name="f_kp_rejected"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_commission]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_commission]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_commission]"
                      name="f_commission"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_profit_fact]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_profit_fact]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_profit_fact]"
                      name="f_profit_fact"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_to_fast]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_calc_to_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_to_fast]"
                      name="f_calc_to_fast"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_to_slow]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_calc_to_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_to_slow]"
                      name="f_calc_to_slow"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_teo_fast]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_calc_teo_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_teo_fast]"
                      name="f_calc_teo_fast"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_teo_slow]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_calc_teo_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_teo_slow]"
                      name="f_calc_teo_slow"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                      name="estimate"
                      precision="38"
                      scale="3"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                      name="overall_estimate"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                      name="average_group_estimate"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                      name="worker_factor"
                      precision="18"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                      dataType="i4"
                      name="id_year" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                      dataType="i4"
                      name="id_month" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                      dataType="i4"
                      name="work_days_in_month" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                      dataType="wstr"
                      length="50"
                      name="name" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[bitrix_name]"
                      dataType="wstr"
                      length="50"
                      name="bitrix_name" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                      dataType="i4"
                      name="estimate_participant" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                      dataType="i4"
                      name="work_days" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_all]"
                      dataType="i4"
                      name="ks_req_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_tender]"
                      dataType="i4"
                      name="ks_req_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_project]"
                      dataType="i4"
                      name="ks_req_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_complex]"
                      dataType="i4"
                      name="ks_req_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_typical]"
                      dataType="i4"
                      name="ks_req_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_indicative]"
                      dataType="i4"
                      name="ks_req_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_new_customer]"
                      dataType="i4"
                      name="ks_req_qty_new_customer" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_current_customer]"
                      dataType="i4"
                      name="ks_req_qty_current_customer" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_renew_customer]"
                      dataType="i4"
                      name="ks_req_qty_renew_customer" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_all_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_all_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_tender_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_tender_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_project_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_project_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_complex_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_complex_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_typical_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_typical_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_indicative_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_indicative_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_new_customer_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_new_customer_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_current_customer_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_current_customer_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_renew_customer_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_renew_customer_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_all_to]"
                      dataType="i4"
                      name="ks_req_qty_all_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_tender_to]"
                      dataType="i4"
                      name="ks_req_qty_tender_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_project_to]"
                      dataType="i4"
                      name="ks_req_qty_project_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_complex_to]"
                      dataType="i4"
                      name="ks_req_qty_complex_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_typical_to]"
                      dataType="i4"
                      name="ks_req_qty_typical_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_indicative_to]"
                      dataType="i4"
                      name="ks_req_qty_indicative_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_new_customer_to]"
                      dataType="i4"
                      name="ks_req_qty_new_customer_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_current_customer_to]"
                      dataType="i4"
                      name="ks_req_qty_current_customer_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_renew_customer_to]"
                      dataType="i4"
                      name="ks_req_qty_renew_customer_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_all_teo]"
                      dataType="i4"
                      name="ks_req_qty_all_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_tender_teo]"
                      dataType="i4"
                      name="ks_req_qty_tender_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_project_teo]"
                      dataType="i4"
                      name="ks_req_qty_project_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_complex_teo]"
                      dataType="i4"
                      name="ks_req_qty_complex_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_typical_teo]"
                      dataType="i4"
                      name="ks_req_qty_typical_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_indicative_teo]"
                      dataType="i4"
                      name="ks_req_qty_indicative_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_new_customer_teo]"
                      dataType="i4"
                      name="ks_req_qty_new_customer_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_current_customer_teo]"
                      dataType="i4"
                      name="ks_req_qty_current_customer_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_req_qty_renew_customer_teo]"
                      dataType="i4"
                      name="ks_req_qty_renew_customer_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all]"
                      dataType="i4"
                      name="ks_calc_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all_fast]"
                      dataType="i4"
                      name="ks_calc_qty_all_fast" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all_slow]"
                      dataType="i4"
                      name="ks_calc_qty_all_slow" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all_to]"
                      dataType="i4"
                      name="ks_calc_qty_all_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_to_fast]"
                      dataType="i4"
                      name="ks_calc_qty_to_fast" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_to_slow]"
                      dataType="i4"
                      name="ks_calc_qty_to_slow" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_all_teo]"
                      dataType="i4"
                      name="ks_calc_qty_all_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_teo_fast]"
                      dataType="i4"
                      name="ks_calc_qty_teo_fast" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_calc_qty_teo_slow]"
                      dataType="i4"
                      name="ks_calc_qty_teo_slow" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_kp_accepted_qty]"
                      dataType="i4"
                      name="ks_kp_accepted_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_kp_rejected_qty]"
                      dataType="i4"
                      name="ks_kp_rejected_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_all_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_all_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_all_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_tender_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_tender_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_tender_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_project_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_project_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_project_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_complex_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_complex_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_complex_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_typical_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_typical_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_typical_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_all_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_all_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_all_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_all_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_tender_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_tender_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_tender_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_tender_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_project_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_project_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_project_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_project_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_complex_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_complex_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_complex_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_complex_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_typical_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_typical_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_typical_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_typical_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_reply_qty_indicative_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_commission_qty_assigned]"
                      dataType="i4"
                      name="ks_commission_qty_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_commission_qty_responsible]"
                      dataType="i4"
                      name="ks_commission_qty_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_profit_fact_sum_assigned]"
                      dataType="numeric"
                      name="ks_profit_fact_sum_assigned"
                      precision="38"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_profit_fact_sum_responsible]"
                      dataType="numeric"
                      name="ks_profit_fact_sum_responsible"
                      precision="38"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[ks_profit_fact_sum_overall]"
                      dataType="numeric"
                      name="ks_profit_fact_sum_overall"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                      dataType="i4"
                      name="workers_count" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_current_customer]"
                      dataType="numeric"
                      name="f_req_current_customer"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_renew_customer]"
                      dataType="numeric"
                      name="f_req_renew_customer"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_new_customer]"
                      dataType="numeric"
                      name="f_req_new_customer"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_tender_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_tender_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_project_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_project_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_complex_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_complex_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_typical_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_typical_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_indicative_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_indicative_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_tender_to]"
                      dataType="numeric"
                      name="f_req_qty_tender_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_project_to]"
                      dataType="numeric"
                      name="f_req_qty_project_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_complex_to]"
                      dataType="numeric"
                      name="f_req_qty_complex_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_typical_to]"
                      dataType="numeric"
                      name="f_req_qty_typical_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_indicative_to]"
                      dataType="numeric"
                      name="f_req_qty_indicative_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_tender_teo]"
                      dataType="numeric"
                      name="f_req_qty_tender_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_project_teo]"
                      dataType="numeric"
                      name="f_req_qty_project_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_complex_teo]"
                      dataType="numeric"
                      name="f_req_qty_complex_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_typical_teo]"
                      dataType="numeric"
                      name="f_req_qty_typical_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_req_qty_indicative_teo]"
                      dataType="numeric"
                      name="f_req_qty_indicative_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_tender_fast]"
                      dataType="numeric"
                      name="f_reply_tender_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_tender_slow]"
                      dataType="numeric"
                      name="f_reply_tender_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_project_fast]"
                      dataType="numeric"
                      name="f_reply_project_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_project_slow]"
                      dataType="numeric"
                      name="f_reply_project_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_complex_fast]"
                      dataType="numeric"
                      name="f_reply_complex_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_complex_slow]"
                      dataType="numeric"
                      name="f_reply_complex_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_typical_fast]"
                      dataType="numeric"
                      name="f_reply_typical_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_typical_slow]"
                      dataType="numeric"
                      name="f_reply_typical_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_indicative_fast]"
                      dataType="numeric"
                      name="f_reply_indicative_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_reply_indicative_slow]"
                      dataType="numeric"
                      name="f_reply_indicative_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_kp_accepted]"
                      dataType="numeric"
                      name="f_kp_accepted"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_kp_rejected]"
                      dataType="numeric"
                      name="f_kp_rejected"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_commission]"
                      dataType="numeric"
                      name="f_commission"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_profit_fact]"
                      dataType="numeric"
                      name="f_profit_fact"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_calc_to_fast]"
                      dataType="numeric"
                      name="f_calc_to_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_calc_to_slow]"
                      dataType="numeric"
                      name="f_calc_to_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_calc_teo_fast]"
                      dataType="numeric"
                      name="f_calc_teo_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[f_calc_teo_slow]"
                      dataType="numeric"
                      name="f_calc_teo_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                      dataType="numeric"
                      name="estimate"
                      precision="38"
                      scale="3" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                      dataType="numeric"
                      name="overall_estimate"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                      dataType="numeric"
                      name="average_group_estimate"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                      dataType="numeric"
                      name="worker_factor"
                      precision="18"
                      scale="2" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                      name="id_year" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                      name="id_month" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                      name="work_days_in_month" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                      name="name" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[bitrix_name]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[bitrix_name]"
                      name="bitrix_name" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                      name="estimate_participant" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                      name="work_days" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_all]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_all]"
                      name="ks_req_qty_all" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_tender]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_tender]"
                      name="ks_req_qty_tender" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_project]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_project]"
                      name="ks_req_qty_project" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_complex]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_complex]"
                      name="ks_req_qty_complex" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_typical]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_typical]"
                      name="ks_req_qty_typical" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_indicative]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_indicative]"
                      name="ks_req_qty_indicative" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_new_customer]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_new_customer]"
                      name="ks_req_qty_new_customer" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_current_customer]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_current_customer]"
                      name="ks_req_qty_current_customer" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_renew_customer]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_renew_customer]"
                      name="ks_req_qty_renew_customer" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_all_to_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_all_to_teo]"
                      name="ks_req_qty_all_to_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_tender_to_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_tender_to_teo]"
                      name="ks_req_qty_tender_to_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_project_to_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_project_to_teo]"
                      name="ks_req_qty_project_to_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_complex_to_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_complex_to_teo]"
                      name="ks_req_qty_complex_to_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_typical_to_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_typical_to_teo]"
                      name="ks_req_qty_typical_to_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_indicative_to_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_indicative_to_teo]"
                      name="ks_req_qty_indicative_to_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_new_customer_to_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_new_customer_to_teo]"
                      name="ks_req_qty_new_customer_to_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_current_customer_to_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_current_customer_to_teo]"
                      name="ks_req_qty_current_customer_to_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_renew_customer_to_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_renew_customer_to_teo]"
                      name="ks_req_qty_renew_customer_to_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_all_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_all_to]"
                      name="ks_req_qty_all_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_tender_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_tender_to]"
                      name="ks_req_qty_tender_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_project_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_project_to]"
                      name="ks_req_qty_project_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_complex_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_complex_to]"
                      name="ks_req_qty_complex_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_typical_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_typical_to]"
                      name="ks_req_qty_typical_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_indicative_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_indicative_to]"
                      name="ks_req_qty_indicative_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_new_customer_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_new_customer_to]"
                      name="ks_req_qty_new_customer_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_current_customer_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_current_customer_to]"
                      name="ks_req_qty_current_customer_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_renew_customer_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_renew_customer_to]"
                      name="ks_req_qty_renew_customer_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_all_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_all_teo]"
                      name="ks_req_qty_all_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_tender_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_tender_teo]"
                      name="ks_req_qty_tender_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_project_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_project_teo]"
                      name="ks_req_qty_project_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_complex_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_complex_teo]"
                      name="ks_req_qty_complex_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_typical_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_typical_teo]"
                      name="ks_req_qty_typical_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_indicative_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_indicative_teo]"
                      name="ks_req_qty_indicative_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_new_customer_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_new_customer_teo]"
                      name="ks_req_qty_new_customer_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_current_customer_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_current_customer_teo]"
                      name="ks_req_qty_current_customer_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_renew_customer_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_req_qty_renew_customer_teo]"
                      name="ks_req_qty_renew_customer_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all]"
                      name="ks_calc_qty_all" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all_fast]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all_fast]"
                      name="ks_calc_qty_all_fast" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all_slow]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all_slow]"
                      name="ks_calc_qty_all_slow" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all_to]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all_to]"
                      name="ks_calc_qty_all_to" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_to_fast]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_to_fast]"
                      name="ks_calc_qty_to_fast" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_to_slow]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_to_slow]"
                      name="ks_calc_qty_to_slow" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all_teo]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_all_teo]"
                      name="ks_calc_qty_all_teo" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_teo_fast]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_teo_fast]"
                      name="ks_calc_qty_teo_fast" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_teo_slow]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_calc_qty_teo_slow]"
                      name="ks_calc_qty_teo_slow" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_kp_accepted_qty]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_kp_accepted_qty]"
                      name="ks_kp_accepted_qty" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_kp_rejected_qty]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_kp_rejected_qty]"
                      name="ks_kp_rejected_qty" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_assigned]"
                      name="ks_reply_qty_all_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_fast_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_fast_assigned]"
                      name="ks_reply_qty_all_fast_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_slow_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_slow_assigned]"
                      name="ks_reply_qty_all_slow_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_assigned]"
                      name="ks_reply_qty_tender_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_fast_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_fast_assigned]"
                      name="ks_reply_qty_tender_fast_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_slow_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_slow_assigned]"
                      name="ks_reply_qty_tender_slow_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_assigned]"
                      name="ks_reply_qty_project_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_fast_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_fast_assigned]"
                      name="ks_reply_qty_project_fast_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_slow_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_slow_assigned]"
                      name="ks_reply_qty_project_slow_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_assigned]"
                      name="ks_reply_qty_complex_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_fast_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_fast_assigned]"
                      name="ks_reply_qty_complex_fast_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_slow_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_slow_assigned]"
                      name="ks_reply_qty_complex_slow_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_assigned]"
                      name="ks_reply_qty_typical_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_fast_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_fast_assigned]"
                      name="ks_reply_qty_typical_fast_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_slow_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_slow_assigned]"
                      name="ks_reply_qty_typical_slow_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_assigned]"
                      name="ks_reply_qty_indicative_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_fast_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_fast_assigned]"
                      name="ks_reply_qty_indicative_fast_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_slow_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_slow_assigned]"
                      name="ks_reply_qty_indicative_slow_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_responsible]"
                      name="ks_reply_qty_all_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_fast_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_fast_responsible]"
                      name="ks_reply_qty_all_fast_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_slow_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_all_slow_responsible]"
                      name="ks_reply_qty_all_slow_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_responsible]"
                      name="ks_reply_qty_tender_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_fast_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_fast_responsible]"
                      name="ks_reply_qty_tender_fast_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_slow_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_tender_slow_responsible]"
                      name="ks_reply_qty_tender_slow_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_responsible]"
                      name="ks_reply_qty_project_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_fast_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_fast_responsible]"
                      name="ks_reply_qty_project_fast_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_slow_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_project_slow_responsible]"
                      name="ks_reply_qty_project_slow_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_responsible]"
                      name="ks_reply_qty_complex_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_fast_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_fast_responsible]"
                      name="ks_reply_qty_complex_fast_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_slow_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_complex_slow_responsible]"
                      name="ks_reply_qty_complex_slow_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_responsible]"
                      name="ks_reply_qty_typical_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_fast_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_fast_responsible]"
                      name="ks_reply_qty_typical_fast_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_slow_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_typical_slow_responsible]"
                      name="ks_reply_qty_typical_slow_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_responsible]"
                      name="ks_reply_qty_indicative_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_fast_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_fast_responsible]"
                      name="ks_reply_qty_indicative_fast_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_slow_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_reply_qty_indicative_slow_responsible]"
                      name="ks_reply_qty_indicative_slow_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_commission_qty_assigned]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_commission_qty_assigned]"
                      name="ks_commission_qty_assigned" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_commission_qty_responsible]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_commission_qty_responsible]"
                      name="ks_commission_qty_responsible" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_profit_fact_sum_assigned]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_profit_fact_sum_assigned]"
                      name="ks_profit_fact_sum_assigned"
                      precision="38"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_profit_fact_sum_responsible]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_profit_fact_sum_responsible]"
                      name="ks_profit_fact_sum_responsible"
                      precision="38"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_profit_fact_sum_overall]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ks_profit_fact_sum_overall]"
                      name="ks_profit_fact_sum_overall"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                      name="workers_count" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_current_customer]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_current_customer]"
                      name="f_req_current_customer"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_renew_customer]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_renew_customer]"
                      name="f_req_renew_customer"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_new_customer]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_new_customer]"
                      name="f_req_new_customer"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_tender_to_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_tender_to_teo]"
                      name="f_req_qty_tender_to_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_project_to_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_project_to_teo]"
                      name="f_req_qty_project_to_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_complex_to_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_complex_to_teo]"
                      name="f_req_qty_complex_to_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_typical_to_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_typical_to_teo]"
                      name="f_req_qty_typical_to_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_indicative_to_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_indicative_to_teo]"
                      name="f_req_qty_indicative_to_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_tender_to]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_tender_to]"
                      name="f_req_qty_tender_to"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_project_to]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_project_to]"
                      name="f_req_qty_project_to"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_complex_to]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_complex_to]"
                      name="f_req_qty_complex_to"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_typical_to]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_typical_to]"
                      name="f_req_qty_typical_to"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_indicative_to]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_indicative_to]"
                      name="f_req_qty_indicative_to"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_tender_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_tender_teo]"
                      name="f_req_qty_tender_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_project_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_project_teo]"
                      name="f_req_qty_project_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_complex_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_complex_teo]"
                      name="f_req_qty_complex_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_typical_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_typical_teo]"
                      name="f_req_qty_typical_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_indicative_teo]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_req_qty_indicative_teo]"
                      name="f_req_qty_indicative_teo"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_tender_fast]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_tender_fast]"
                      name="f_reply_tender_fast"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_tender_slow]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_tender_slow]"
                      name="f_reply_tender_slow"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_project_fast]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_project_fast]"
                      name="f_reply_project_fast"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_project_slow]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_project_slow]"
                      name="f_reply_project_slow"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_complex_fast]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_complex_fast]"
                      name="f_reply_complex_fast"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_complex_slow]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_complex_slow]"
                      name="f_reply_complex_slow"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_typical_fast]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_typical_fast]"
                      name="f_reply_typical_fast"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_typical_slow]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_typical_slow]"
                      name="f_reply_typical_slow"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_indicative_fast]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_indicative_fast]"
                      name="f_reply_indicative_fast"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_indicative_slow]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_reply_indicative_slow]"
                      name="f_reply_indicative_slow"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_kp_accepted]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_kp_accepted]"
                      name="f_kp_accepted"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_kp_rejected]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_kp_rejected]"
                      name="f_kp_rejected"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_commission]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_commission]"
                      name="f_commission"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_profit_fact]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_profit_fact]"
                      name="f_profit_fact"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_calc_to_fast]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_calc_to_fast]"
                      name="f_calc_to_fast"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_calc_to_slow]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_calc_to_slow]"
                      name="f_calc_to_slow"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_calc_teo_fast]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_calc_teo_fast]"
                      name="f_calc_teo_fast"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_calc_teo_slow]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[f_calc_teo_slow]"
                      name="f_calc_teo_slow"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                      name="estimate"
                      precision="38"
                      scale="3" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                      name="overall_estimate"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                      name="average_group_estimate"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                      dataType="numeric"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                      name="worker_factor"
                      precision="18"
                      scale="2" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload main\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ks_main</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload main\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload main\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_year]"
                      cachedDataType="i4"
                      cachedName="id_year"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_month]"
                      cachedDataType="i4"
                      cachedName="id_month"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days_in_month]"
                      cachedDataType="i4"
                      cachedName="work_days_in_month"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[name]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="name"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="code"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[bitrix_name]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="bitrix_name"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[bitrix_name]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[bitrix_name]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate_participant]"
                      cachedDataType="i4"
                      cachedName="estimate_participant"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days]"
                      cachedDataType="i4"
                      cachedName="work_days"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_all]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_all"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_tender]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_tender"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_tender]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_project]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_project"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_project]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_complex]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_complex"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_complex]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_typical]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_typical"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_typical]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_indicative]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_indicative"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_indicative]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_new_customer]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_new_customer"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_new_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_current_customer]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_current_customer"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_current_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_renew_customer]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_renew_customer"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_renew_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_all_to_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_all_to_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_all_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_tender_to_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_tender_to_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_tender_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_project_to_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_project_to_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_project_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_complex_to_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_complex_to_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_complex_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_typical_to_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_typical_to_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_typical_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_indicative_to_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_indicative_to_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_indicative_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_new_customer_to_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_new_customer_to_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_new_customer_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_current_customer_to_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_current_customer_to_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_current_customer_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_renew_customer_to_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_renew_customer_to_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_renew_customer_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_all_to]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_all_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_all_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_tender_to]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_tender_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_tender_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_project_to]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_project_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_project_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_complex_to]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_complex_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_complex_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_typical_to]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_typical_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_typical_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_indicative_to]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_indicative_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_indicative_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_new_customer_to]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_new_customer_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_new_customer_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_current_customer_to]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_current_customer_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_current_customer_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_renew_customer_to]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_renew_customer_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_renew_customer_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_all_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_all_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_all_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_all_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_tender_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_tender_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_tender_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_tender_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_project_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_project_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_project_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_project_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_complex_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_complex_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_complex_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_complex_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_typical_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_typical_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_typical_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_typical_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_indicative_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_indicative_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_indicative_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_indicative_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_new_customer_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_new_customer_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_new_customer_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_new_customer_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_current_customer_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_current_customer_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_current_customer_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_current_customer_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_req_qty_renew_customer_teo]"
                      cachedDataType="i4"
                      cachedName="ks_req_qty_renew_customer_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_renew_customer_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_req_qty_renew_customer_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_calc_qty_all]"
                      cachedDataType="i4"
                      cachedName="ks_calc_qty_all"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_calc_qty_all_fast]"
                      cachedDataType="i4"
                      cachedName="ks_calc_qty_all_fast"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_calc_qty_all_slow]"
                      cachedDataType="i4"
                      cachedName="ks_calc_qty_all_slow"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_calc_qty_all_to]"
                      cachedDataType="i4"
                      cachedName="ks_calc_qty_all_to"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_calc_qty_to_fast]"
                      cachedDataType="i4"
                      cachedName="ks_calc_qty_to_fast"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_to_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_to_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_calc_qty_to_slow]"
                      cachedDataType="i4"
                      cachedName="ks_calc_qty_to_slow"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_to_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_to_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_calc_qty_all_teo]"
                      cachedDataType="i4"
                      cachedName="ks_calc_qty_all_teo"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_all_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_calc_qty_teo_fast]"
                      cachedDataType="i4"
                      cachedName="ks_calc_qty_teo_fast"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_teo_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_teo_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_calc_qty_teo_slow]"
                      cachedDataType="i4"
                      cachedName="ks_calc_qty_teo_slow"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_teo_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_calc_qty_teo_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_kp_accepted_qty]"
                      cachedDataType="i4"
                      cachedName="ks_kp_accepted_qty"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_kp_accepted_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_kp_accepted_qty]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_kp_rejected_qty]"
                      cachedDataType="i4"
                      cachedName="ks_kp_rejected_qty"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_kp_rejected_qty]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_kp_rejected_qty]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_all_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_all_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_all_fast_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_all_fast_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_fast_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_all_slow_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_all_slow_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_slow_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_tender_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_tender_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_tender_fast_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_tender_fast_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_fast_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_tender_slow_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_tender_slow_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_slow_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_project_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_project_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_project_fast_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_project_fast_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_fast_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_project_slow_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_project_slow_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_slow_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_complex_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_complex_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_complex_fast_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_complex_fast_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_fast_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_complex_slow_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_complex_slow_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_slow_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_typical_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_typical_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_typical_fast_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_typical_fast_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_fast_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_typical_slow_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_typical_slow_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_slow_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_indicative_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_indicative_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_indicative_fast_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_indicative_fast_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_fast_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_fast_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_indicative_slow_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_indicative_slow_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_slow_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_slow_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_all_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_all_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_all_fast_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_all_fast_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_fast_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_all_slow_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_all_slow_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_all_slow_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_tender_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_tender_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_tender_fast_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_tender_fast_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_fast_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_tender_slow_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_tender_slow_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_tender_slow_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_project_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_project_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_project_fast_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_project_fast_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_fast_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_project_slow_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_project_slow_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_project_slow_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_complex_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_complex_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_complex_fast_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_complex_fast_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_fast_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_complex_slow_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_complex_slow_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_complex_slow_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_typical_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_typical_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_typical_fast_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_typical_fast_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_fast_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_typical_slow_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_typical_slow_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_typical_slow_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_indicative_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_indicative_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_indicative_fast_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_indicative_fast_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_fast_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_fast_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_reply_qty_indicative_slow_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_reply_qty_indicative_slow_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_slow_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_reply_qty_indicative_slow_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_commission_qty_assigned]"
                      cachedDataType="i4"
                      cachedName="ks_commission_qty_assigned"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_commission_qty_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_commission_qty_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_commission_qty_responsible]"
                      cachedDataType="i4"
                      cachedName="ks_commission_qty_responsible"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_commission_qty_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_commission_qty_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_profit_fact_sum_assigned]"
                      cachedDataType="numeric"
                      cachedName="ks_profit_fact_sum_assigned"
                      cachedPrecision="38"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_profit_fact_sum_assigned]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_profit_fact_sum_assigned]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_profit_fact_sum_responsible]"
                      cachedDataType="numeric"
                      cachedName="ks_profit_fact_sum_responsible"
                      cachedPrecision="38"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_profit_fact_sum_responsible]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_profit_fact_sum_responsible]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[ks_profit_fact_sum_overall]"
                      cachedDataType="numeric"
                      cachedName="ks_profit_fact_sum_overall"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_profit_fact_sum_overall]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[ks_profit_fact_sum_overall]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[workers_count]"
                      cachedDataType="i4"
                      cachedName="workers_count"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_current_customer]"
                      cachedDataType="numeric"
                      cachedName="f_req_current_customer"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_current_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_current_customer]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_renew_customer]"
                      cachedDataType="numeric"
                      cachedName="f_req_renew_customer"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_renew_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_renew_customer]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_new_customer]"
                      cachedDataType="numeric"
                      cachedName="f_req_new_customer"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_new_customer]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_new_customer]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_tender_to_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_tender_to_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_tender_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_tender_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_project_to_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_project_to_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_project_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_project_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_complex_to_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_complex_to_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_complex_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_complex_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_typical_to_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_typical_to_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_typical_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_typical_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_indicative_to_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_indicative_to_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_indicative_to_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_indicative_to_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_tender_to]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_tender_to"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_tender_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_tender_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_project_to]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_project_to"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_project_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_project_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_complex_to]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_complex_to"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_complex_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_complex_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_typical_to]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_typical_to"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_typical_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_typical_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_indicative_to]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_indicative_to"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_indicative_to]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_indicative_to]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_tender_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_tender_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_tender_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_tender_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_project_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_project_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_project_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_project_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_complex_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_complex_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_complex_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_complex_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_typical_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_typical_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_typical_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_typical_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_req_qty_indicative_teo]"
                      cachedDataType="numeric"
                      cachedName="f_req_qty_indicative_teo"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_indicative_teo]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_req_qty_indicative_teo]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_tender_fast]"
                      cachedDataType="numeric"
                      cachedName="f_reply_tender_fast"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_tender_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_tender_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_tender_slow]"
                      cachedDataType="numeric"
                      cachedName="f_reply_tender_slow"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_tender_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_tender_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_project_fast]"
                      cachedDataType="numeric"
                      cachedName="f_reply_project_fast"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_project_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_project_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_project_slow]"
                      cachedDataType="numeric"
                      cachedName="f_reply_project_slow"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_project_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_project_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_complex_fast]"
                      cachedDataType="numeric"
                      cachedName="f_reply_complex_fast"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_complex_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_complex_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_complex_slow]"
                      cachedDataType="numeric"
                      cachedName="f_reply_complex_slow"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_complex_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_complex_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_typical_fast]"
                      cachedDataType="numeric"
                      cachedName="f_reply_typical_fast"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_typical_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_typical_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_typical_slow]"
                      cachedDataType="numeric"
                      cachedName="f_reply_typical_slow"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_typical_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_typical_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_indicative_fast]"
                      cachedDataType="numeric"
                      cachedName="f_reply_indicative_fast"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_indicative_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_indicative_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_reply_indicative_slow]"
                      cachedDataType="numeric"
                      cachedName="f_reply_indicative_slow"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_indicative_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_reply_indicative_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_kp_accepted]"
                      cachedDataType="numeric"
                      cachedName="f_kp_accepted"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_kp_accepted]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_kp_accepted]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_kp_rejected]"
                      cachedDataType="numeric"
                      cachedName="f_kp_rejected"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_kp_rejected]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_kp_rejected]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_commission]"
                      cachedDataType="numeric"
                      cachedName="f_commission"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_commission]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_commission]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_profit_fact]"
                      cachedDataType="numeric"
                      cachedName="f_profit_fact"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_profit_fact]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_profit_fact]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_calc_to_fast]"
                      cachedDataType="numeric"
                      cachedName="f_calc_to_fast"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_calc_to_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_to_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_calc_to_slow]"
                      cachedDataType="numeric"
                      cachedName="f_calc_to_slow"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_calc_to_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_to_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_calc_teo_fast]"
                      cachedDataType="numeric"
                      cachedName="f_calc_teo_fast"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_calc_teo_fast]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_teo_fast]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[f_calc_teo_slow]"
                      cachedDataType="numeric"
                      cachedName="f_calc_teo_slow"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_calc_teo_slow]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[f_calc_teo_slow]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate]"
                      cachedDataType="numeric"
                      cachedName="estimate"
                      cachedPrecision="38"
                      cachedScale="3"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[overall_estimate]"
                      cachedDataType="numeric"
                      cachedName="overall_estimate"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[average_group_estimate]"
                      cachedDataType="numeric"
                      cachedName="average_group_estimate"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]" />
                    <inputColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].Columns[worker_factor]"
                      cachedDataType="numeric"
                      cachedName="worker_factor"
                      cachedPrecision="18"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                      lineageId="Package\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                      dataType="i4"
                      name="id_year" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                      dataType="i4"
                      name="id_month" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                      dataType="i4"
                      name="work_days_in_month" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                      dataType="wstr"
                      length="50"
                      name="name" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[bitrix_name]"
                      dataType="wstr"
                      length="50"
                      name="bitrix_name" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                      dataType="i4"
                      name="estimate_participant" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                      dataType="i4"
                      name="work_days" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_all]"
                      dataType="i4"
                      name="ks_req_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_tender]"
                      dataType="i4"
                      name="ks_req_qty_tender" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_project]"
                      dataType="i4"
                      name="ks_req_qty_project" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_complex]"
                      dataType="i4"
                      name="ks_req_qty_complex" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_typical]"
                      dataType="i4"
                      name="ks_req_qty_typical" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_indicative]"
                      dataType="i4"
                      name="ks_req_qty_indicative" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_new_customer]"
                      dataType="i4"
                      name="ks_req_qty_new_customer" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_current_customer]"
                      dataType="i4"
                      name="ks_req_qty_current_customer" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_renew_customer]"
                      dataType="i4"
                      name="ks_req_qty_renew_customer" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_all_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_all_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_tender_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_tender_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_project_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_project_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_complex_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_complex_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_typical_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_typical_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_indicative_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_indicative_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_new_customer_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_new_customer_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_current_customer_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_current_customer_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_renew_customer_to_teo]"
                      dataType="i4"
                      name="ks_req_qty_renew_customer_to_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_all_to]"
                      dataType="i4"
                      name="ks_req_qty_all_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_tender_to]"
                      dataType="i4"
                      name="ks_req_qty_tender_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_project_to]"
                      dataType="i4"
                      name="ks_req_qty_project_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_complex_to]"
                      dataType="i4"
                      name="ks_req_qty_complex_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_typical_to]"
                      dataType="i4"
                      name="ks_req_qty_typical_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_indicative_to]"
                      dataType="i4"
                      name="ks_req_qty_indicative_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_new_customer_to]"
                      dataType="i4"
                      name="ks_req_qty_new_customer_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_current_customer_to]"
                      dataType="i4"
                      name="ks_req_qty_current_customer_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_renew_customer_to]"
                      dataType="i4"
                      name="ks_req_qty_renew_customer_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_all_teo]"
                      dataType="i4"
                      name="ks_req_qty_all_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_tender_teo]"
                      dataType="i4"
                      name="ks_req_qty_tender_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_project_teo]"
                      dataType="i4"
                      name="ks_req_qty_project_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_complex_teo]"
                      dataType="i4"
                      name="ks_req_qty_complex_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_typical_teo]"
                      dataType="i4"
                      name="ks_req_qty_typical_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_indicative_teo]"
                      dataType="i4"
                      name="ks_req_qty_indicative_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_new_customer_teo]"
                      dataType="i4"
                      name="ks_req_qty_new_customer_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_current_customer_teo]"
                      dataType="i4"
                      name="ks_req_qty_current_customer_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_req_qty_renew_customer_teo]"
                      dataType="i4"
                      name="ks_req_qty_renew_customer_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all]"
                      dataType="i4"
                      name="ks_calc_qty_all" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all_fast]"
                      dataType="i4"
                      name="ks_calc_qty_all_fast" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all_slow]"
                      dataType="i4"
                      name="ks_calc_qty_all_slow" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all_to]"
                      dataType="i4"
                      name="ks_calc_qty_all_to" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_to_fast]"
                      dataType="i4"
                      name="ks_calc_qty_to_fast" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_to_slow]"
                      dataType="i4"
                      name="ks_calc_qty_to_slow" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_all_teo]"
                      dataType="i4"
                      name="ks_calc_qty_all_teo" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_teo_fast]"
                      dataType="i4"
                      name="ks_calc_qty_teo_fast" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_calc_qty_teo_slow]"
                      dataType="i4"
                      name="ks_calc_qty_teo_slow" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_kp_accepted_qty]"
                      dataType="i4"
                      name="ks_kp_accepted_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_kp_rejected_qty]"
                      dataType="i4"
                      name="ks_kp_rejected_qty" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_all_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_all_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_all_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_tender_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_tender_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_tender_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_project_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_project_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_project_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_complex_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_complex_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_complex_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_typical_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_typical_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_typical_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_fast_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_fast_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_slow_assigned]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_slow_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_all_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_all_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_all_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_all_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_tender_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_tender_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_tender_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_tender_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_project_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_project_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_project_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_project_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_complex_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_complex_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_complex_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_complex_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_typical_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_typical_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_typical_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_typical_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_fast_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_fast_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_reply_qty_indicative_slow_responsible]"
                      dataType="i4"
                      name="ks_reply_qty_indicative_slow_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_commission_qty_assigned]"
                      dataType="i4"
                      name="ks_commission_qty_assigned" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_commission_qty_responsible]"
                      dataType="i4"
                      name="ks_commission_qty_responsible" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_profit_fact_sum_assigned]"
                      dataType="numeric"
                      name="ks_profit_fact_sum_assigned"
                      precision="38"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_profit_fact_sum_responsible]"
                      dataType="numeric"
                      name="ks_profit_fact_sum_responsible"
                      precision="38"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[ks_profit_fact_sum_overall]"
                      dataType="numeric"
                      name="ks_profit_fact_sum_overall"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                      dataType="i4"
                      name="workers_count" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_current_customer]"
                      dataType="numeric"
                      name="f_req_current_customer"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_renew_customer]"
                      dataType="numeric"
                      name="f_req_renew_customer"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_new_customer]"
                      dataType="numeric"
                      name="f_req_new_customer"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_tender_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_tender_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_project_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_project_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_complex_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_complex_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_typical_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_typical_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_indicative_to_teo]"
                      dataType="numeric"
                      name="f_req_qty_indicative_to_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_tender_to]"
                      dataType="numeric"
                      name="f_req_qty_tender_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_project_to]"
                      dataType="numeric"
                      name="f_req_qty_project_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_complex_to]"
                      dataType="numeric"
                      name="f_req_qty_complex_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_typical_to]"
                      dataType="numeric"
                      name="f_req_qty_typical_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_indicative_to]"
                      dataType="numeric"
                      name="f_req_qty_indicative_to"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_tender_teo]"
                      dataType="numeric"
                      name="f_req_qty_tender_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_project_teo]"
                      dataType="numeric"
                      name="f_req_qty_project_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_complex_teo]"
                      dataType="numeric"
                      name="f_req_qty_complex_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_typical_teo]"
                      dataType="numeric"
                      name="f_req_qty_typical_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_req_qty_indicative_teo]"
                      dataType="numeric"
                      name="f_req_qty_indicative_teo"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_tender_fast]"
                      dataType="numeric"
                      name="f_reply_tender_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_tender_slow]"
                      dataType="numeric"
                      name="f_reply_tender_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_project_fast]"
                      dataType="numeric"
                      name="f_reply_project_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_project_slow]"
                      dataType="numeric"
                      name="f_reply_project_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_complex_fast]"
                      dataType="numeric"
                      name="f_reply_complex_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_complex_slow]"
                      dataType="numeric"
                      name="f_reply_complex_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_typical_fast]"
                      dataType="numeric"
                      name="f_reply_typical_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_typical_slow]"
                      dataType="numeric"
                      name="f_reply_typical_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_indicative_fast]"
                      dataType="numeric"
                      name="f_reply_indicative_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_reply_indicative_slow]"
                      dataType="numeric"
                      name="f_reply_indicative_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_kp_accepted]"
                      dataType="numeric"
                      name="f_kp_accepted"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_kp_rejected]"
                      dataType="numeric"
                      name="f_kp_rejected"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_commission]"
                      dataType="numeric"
                      name="f_commission"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_profit_fact]"
                      dataType="numeric"
                      name="f_profit_fact"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_calc_to_fast]"
                      dataType="numeric"
                      name="f_calc_to_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_calc_to_slow]"
                      dataType="numeric"
                      name="f_calc_to_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_calc_teo_fast]"
                      dataType="numeric"
                      name="f_calc_teo_fast"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[f_calc_teo_slow]"
                      dataType="numeric"
                      name="f_calc_teo_slow"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                      dataType="numeric"
                      name="estimate"
                      precision="38"
                      scale="3" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                      dataType="numeric"
                      name="overall_estimate"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                      dataType="numeric"
                      name="average_group_estimate"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                      dataType="numeric"
                      name="worker_factor"
                      precision="18"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[role_type]"
                      dataType="wstr"
                      length="50"
                      name="role_type" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload main\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload main.Paths[ADO NET Source Output]"
              endId="Package\Reload main\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload main\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload rejected"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{53E28DA5-83DE-4BF5-AAFE-50E1014E3ECB}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload rejected"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"SELECT DISTINCT
	[request_id] AS [deal_id]
	,ca.code
    ,[service_type_row]
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,calc_status AS client_decision
	,calc_decision_date AS [decision_date]
	,MONTH(calc_decision_date) AS [accept_month]
	,YEAR(calc_decision_date) AS [accept_year]	
	FROM [webproject].[dbo].[calculation_deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE calc_decision_date &gt;= '20200101' AND [calc_status_id] IN
	('C16:LOSE',
	'C16:APOLOGY',
	'C16:1',
	'C16:2',
	'C16:3')
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR([calc_decision_date]), MONTH([calc_decision_date]), 10)) AS date)

UNION 

SELECT DISTINCT
	[deal_id]
	,ca.code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,client_decision
	,[decision_date]
	,MONTH([decision_date]) AS [accept_month]
	,YEAR([decision_date]) AS [accept_year]	
	FROM [webproject].[dbo].[deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [decision_date] &gt;= '20200101' AND UPPER([client_decision]) IN
	('ОТКАЗ / ДОЛГО ОТВЕЧАЛИ',
	'ИНДИКАТИВ',
	'ОТКАЗ / ДОРОГО',
	'НЕ АКТУАЛЬНО',
	'ОТКАЗ / ТРАНЗИТНОЕ ВРЕМЯ')
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR([decision_date]), MONTH([decision_date]), 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload rejected\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT DISTINCT
	[request_id] AS [deal_id]
	,ca.code
    ,[service_type_row]
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,calc_status AS client_decision
	,calc_decision_date AS [decision_date]
	,MONTH(calc_decision_date) AS [accept_month]
	,YEAR(calc_decision_date) AS [accept_year]	
	FROM [webproject].[dbo].[calculation_deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE calc_decision_date &gt;= '20200101' AND [calc_status_id] IN
	('C16:LOSE',
	'C16:APOLOGY',
	'C16:1',
	'C16:2',
	'C16:3')
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR([calc_decision_date]), MONTH([calc_decision_date]), 10)) AS date)

UNION 

SELECT DISTINCT
	[deal_id]
	,ca.code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,client_decision
	,[decision_date]
	,MONTH([decision_date]) AS [accept_month]
	,YEAR([decision_date]) AS [accept_year]	
	FROM [webproject].[dbo].[deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [decision_date] &gt;= '20200101' AND UPPER([client_decision]) IN
	('ОТКАЗ / ДОЛГО ОТВЕЧАЛИ',
	'ИНДИКАТИВ',
	'ОТКАЗ / ДОРОГО',
	'НЕ АКТУАЛЬНО',
	'ОТКАЗ / ТРАНЗИТНОЕ ВРЕМЯ')
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR([decision_date]), MONTH([decision_date]), 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload rejected\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      length="10"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      length="50"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      name="service_type_row"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      length="50"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      name="request_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      length="200"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      name="client_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[client_decision]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[client_decision]"
                      length="100"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[client_decision]"
                      name="client_decision"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[decision_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[decision_date]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[decision_date]"
                      name="decision_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[accept_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[accept_month]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[accept_month]"
                      name="accept_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[accept_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[accept_year]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[accept_year]"
                      name="accept_year"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="50"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[client_decision]"
                      dataType="wstr"
                      length="100"
                      name="client_decision" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[decision_date]"
                      dataType="dbTimeStamp"
                      name="decision_date" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[accept_month]"
                      dataType="i4"
                      name="accept_month" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].ExternalColumns[accept_year]"
                      dataType="i4"
                      name="accept_year" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      name="service_type_row" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      name="request_type" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      name="client_type" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[client_decision]"
                      dataType="wstr"
                      length="100"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[client_decision]"
                      name="client_decision" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[decision_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[decision_date]"
                      name="decision_date" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[accept_month]"
                      dataType="i4"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[accept_month]"
                      name="accept_month" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[accept_year]"
                      dataType="i4"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[accept_year]"
                      name="accept_year" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload rejected\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ks_rejected</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload rejected\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="code"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[service_type_row]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="service_type_row"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[service_type_row]" />
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[request_type]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="request_type"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[request_type]" />
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[client_type]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="client_type"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[client_type]" />
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[client_decision]"
                      cachedDataType="wstr"
                      cachedLength="100"
                      cachedName="client_decision"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_decision]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[client_decision]" />
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[decision_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="decision_date"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[decision_date]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[decision_date]" />
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[accept_month]"
                      cachedDataType="i4"
                      cachedName="accept_month"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[accept_month]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[accept_month]" />
                    <inputColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].Columns[accept_year]"
                      cachedDataType="i4"
                      cachedName="accept_year"
                      externalMetadataColumnId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[accept_year]"
                      lineageId="Package\Reload rejected\Query.Outputs[ADO NET Source Output].Columns[accept_year]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="10"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_decision]"
                      dataType="wstr"
                      length="50"
                      name="client_decision" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[decision_date]"
                      dataType="dbTimeStamp"
                      name="decision_date" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[accept_month]"
                      dataType="i4"
                      name="accept_month" />
                    <externalMetadataColumn
                      refId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input].ExternalColumns[accept_year]"
                      dataType="i4"
                      name="accept_year" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload rejected\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload rejected\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload rejected\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload rejected\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload rejected\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload rejected.Paths[ADO NET Source Output]"
              endId="Package\Reload rejected\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload rejected\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload requests"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{C8085DD9-670E-42D6-8BB8-A88526E55437}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload requests"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"SELECT DISTINCT
	[request_id] AS [deal_id]
	,ca.code
    ,CAST([service_type] AS varchar(100)) AS service_type
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,[request_date]
	,MONTH([request_date]) AS [request_month]
	,YEAR([request_date]) AS [request_year]
	FROM [webproject].[dbo].[calculation_deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [request_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR([request_date]), MONTH([request_date]), 10)) AS date)

UNION

SELECT DISTINCT
	[deal_id]
	,ca.code
    ,[service_type]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,[request_date]
	,MONTH([request_date]) AS [request_month]
	,YEAR([request_date]) AS [request_year]
	FROM [webproject].[dbo].[deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [request_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR([request_date]), MONTH([request_date]), 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload requests\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT DISTINCT
	[request_id] AS [deal_id]
	,ca.code
    ,CAST([service_type] AS varchar(100)) AS service_type
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,[request_date]
	,MONTH([request_date]) AS [request_month]
	,YEAR([request_date]) AS [request_year]
	FROM [webproject].[dbo].[calculation_deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [request_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR([request_date]), MONTH([request_date]), 10)) AS date)

UNION

SELECT DISTINCT
	[deal_id]
	,ca.code
    ,[service_type]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,[request_date]
	,MONTH([request_date]) AS [request_month]
	,YEAR([request_date]) AS [request_year]
	FROM [webproject].[dbo].[deals]	AS d
	CROSS APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca
	WHERE [request_date] &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR([request_date]), MONTH([request_date]), 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload requests\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload requests\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      length="10"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[code]"
                      name="code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[service_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type]"
                      length="100"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[service_type]"
                      name="service_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      length="50"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      name="request_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      length="200"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      name="client_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[request_date]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_date]"
                      name="request_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[request_month]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_month]"
                      name="request_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[request_year]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_year]"
                      name="request_year"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type]"
                      dataType="wstr"
                      length="100"
                      name="service_type" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[request_date]"
                      dataType="dbTimeStamp"
                      name="request_date" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[request_month]"
                      dataType="i4"
                      name="request_month" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Output].ExternalColumns[request_year]"
                      dataType="i4"
                      name="request_year" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                      name="code" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[service_type]"
                      dataType="wstr"
                      length="100"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[service_type]"
                      name="service_type" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      name="request_type" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      name="client_type" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[request_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[request_date]"
                      name="request_date" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[request_month]"
                      dataType="i4"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[request_month]"
                      name="request_month" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[request_year]"
                      dataType="i4"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[request_year]"
                      name="request_year" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload requests\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ks_requests</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload requests\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].Columns[code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="code"
                      externalMetadataColumnId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[code]" />
                    <inputColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].Columns[service_type]"
                      cachedDataType="wstr"
                      cachedLength="100"
                      cachedName="service_type"
                      externalMetadataColumnId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[service_type]" />
                    <inputColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].Columns[request_type]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="request_type"
                      externalMetadataColumnId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_type]" />
                    <inputColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].Columns[client_type]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="client_type"
                      externalMetadataColumnId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[client_type]" />
                    <inputColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].Columns[request_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="request_date"
                      externalMetadataColumnId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_date]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_date]" />
                    <inputColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].Columns[request_month]"
                      cachedDataType="i4"
                      cachedName="request_month"
                      externalMetadataColumnId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_month]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_month]" />
                    <inputColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].Columns[request_year]"
                      cachedDataType="i4"
                      cachedName="request_year"
                      externalMetadataColumnId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_year]"
                      lineageId="Package\Reload requests\Query.Outputs[ADO NET Source Output].Columns[request_year]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                      dataType="wstr"
                      length="10"
                      name="code" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type]"
                      dataType="wstr"
                      length="50"
                      name="service_type" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_date]"
                      dataType="dbTimeStamp"
                      name="request_date" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_month]"
                      dataType="i4"
                      name="request_month" />
                    <externalMetadataColumn
                      refId="Package\Reload requests\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_year]"
                      dataType="i4"
                      name="request_year" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload requests\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload requests\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload requests\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload requests\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload requests\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload requests\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload requests.Paths[ADO NET Source Output]"
              endId="Package\Reload requests\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload requests\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Reload sent replies"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Задача потока данных"
      DTS:DTSID="{A1A96A2E-E956-4A12-B3E2-1AA306A7A7AE}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Reload sent replies"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:PropertyExpression
        DTS:Name="[Query].[SqlCommand]">"SELECT DISTINCT
	[request_id] AS [deal_id]
	,ca_assigned.code AS assigned_code
	,ca_resp.code AS responsible_code
    ,[service_type_row]
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,COALESCE(ex_reply_duration, 0) AS ex_reply_duration
	,calc_response_date AS ex_reply_date
	,DATEADD(HOUR, 96, request_date) AS tender_reply_date
	,MONTH(calc_response_date) AS [reply_month]
	,YEAR(calc_response_date) AS [reply_year]
	,kp_in_time
	FROM [webproject].[dbo].[calculation_deals]	AS d
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca_assigned
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca_resp
	WHERE calc_response_date &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR(calc_response_date), MONTH(calc_response_date), 10)) AS date)


UNION

SELECT DISTINCT
	[deal_id]
	,ca_assigned.code AS assigned_code
	,ca_resp.code AS responsible_code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,COALESCE(ex_reply_duration, 0) AS ex_reply_duration
	,ex_reply_date
	,tender_reply_date
	,MONTH(ex_reply_date) AS [reply_month]
	,YEAR(ex_reply_date) AS [reply_year]
	,NULL AS kp_in_time
	FROM [webproject].[dbo].[deals]	AS d
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca_assigned
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca_resp
	WHERE ex_reply_date &gt;= '20200101'
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YEAR(ex_reply_date), MONTH(ex_reply_date), 10)) AS date)"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Reload sent replies\Query"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
              name="Query"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement used by the component to extract data."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT DISTINCT
	[request_id] AS [deal_id]
	,ca_assigned.code AS assigned_code
	,ca_resp.code AS responsible_code
    ,[service_type_row]
    ,COALESCE([request_type], 'Типовой') AS request_type
    ,COALESCE([client], '') AS client
    ,(CASE WHEN COALESCE([client_type], '') = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,COALESCE(ex_reply_duration, 0) AS ex_reply_duration
	,calc_response_date AS ex_reply_date
	,DATEADD(HOUR, 96, request_date) AS tender_reply_date
	,MONTH(calc_response_date) AS [reply_month]
	,YEAR(calc_response_date) AS [reply_year]
	,kp_in_time
	FROM [webproject].[dbo].[calculation_deals]	AS d
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca_assigned
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca_resp
	WHERE calc_response_date &gt;= '20200101'
	AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR(calc_response_date), MONTH(calc_response_date), 10)) AS date)


UNION

SELECT DISTINCT
	[deal_id]
	,ca_assigned.code AS assigned_code
	,ca_resp.code AS responsible_code
    ,[service_type_row]
    ,[request_type]
    ,[client]
    ,(CASE WHEN [client_type] = '' THEN 'Действующий' ELSE [client_type] END) AS [client_type]
	,COALESCE(ex_reply_duration, 0) AS ex_reply_duration
	,ex_reply_date
	,tender_reply_date
	,MONTH(ex_reply_date) AS [reply_month]
	,YEAR(ex_reply_date) AS [reply_year]
	,NULL AS kp_in_time
	FROM [webproject].[dbo].[deals]	AS d
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.assigned) AS ca_assigned
	OUTER APPLY (SELECT TOP (1) code FROM motivation.dbo.ks_workers AS k WHERE k.bitrix_name = d.responsible_ks) AS ca_resp
	WHERE ex_reply_date &gt;= '20200101'
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR(ex_reply_date), MONTH(ex_reply_date), 10)) AS date)</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                  name="AllowImplicitStringConversion">true</property>
                <property
                  dataType="System.String"
                  description="The Source database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specify the mode to retrieve external column information"
                  name="AccessMode"
                  typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload sent replies\Query.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output]"
                  name="ADO NET Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[deal_id]"
                      name="deal_id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[assigned_code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[assigned_code]"
                      length="10"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[assigned_code]"
                      name="assigned_code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[responsible_code]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[responsible_code]"
                      length="10"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[responsible_code]"
                      name="responsible_code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      length="50"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[service_type_row]"
                      name="service_type_row"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      length="50"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[request_type]"
                      name="request_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[client]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      length="1000"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[client]"
                      name="client"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      length="200"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[client_type]"
                      name="client_type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[ex_reply_duration]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[ex_reply_duration]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[ex_reply_duration]"
                      name="ex_reply_duration"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[ex_reply_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[ex_reply_date]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[ex_reply_date]"
                      name="ex_reply_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[tender_reply_date]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[tender_reply_date]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[tender_reply_date]"
                      name="tender_reply_date"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[reply_month]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[reply_month]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[reply_month]"
                      name="reply_month"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[reply_year]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[reply_year]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[reply_year]"
                      name="reply_year"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[kp_in_time]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[kp_in_time]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[kp_in_time]"
                      name="kp_in_time"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[assigned_code]"
                      dataType="wstr"
                      length="10"
                      name="assigned_code" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[responsible_code]"
                      dataType="wstr"
                      length="10"
                      name="responsible_code" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="50"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[ex_reply_duration]"
                      dataType="i4"
                      name="ex_reply_duration" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[ex_reply_date]"
                      dataType="dbTimeStamp"
                      name="ex_reply_date" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[tender_reply_date]"
                      dataType="dbTimeStamp"
                      name="tender_reply_date" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[reply_month]"
                      dataType="i4"
                      name="reply_month" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[reply_year]"
                      dataType="i4"
                      name="reply_year" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].ExternalColumns[kp_in_time]"
                      dataType="i4"
                      name="kp_in_time" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output]"
                  isErrorOut="true"
                  name="ADO NET Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      dataType="i4"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[deal_id]"
                      name="deal_id" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[assigned_code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[assigned_code]"
                      name="assigned_code" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[responsible_code]"
                      dataType="wstr"
                      length="10"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[responsible_code]"
                      name="responsible_code" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[service_type_row]"
                      name="service_type_row" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      dataType="wstr"
                      length="50"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[request_type]"
                      name="request_type" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      dataType="wstr"
                      length="1000"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[client]"
                      name="client" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      dataType="wstr"
                      length="200"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[client_type]"
                      name="client_type" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[ex_reply_duration]"
                      dataType="i4"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[ex_reply_duration]"
                      name="ex_reply_duration" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[ex_reply_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[ex_reply_date]"
                      name="ex_reply_date" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[tender_reply_date]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[tender_reply_date]"
                      name="tender_reply_date" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[reply_month]"
                      dataType="i4"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[reply_month]"
                      name="reply_month" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[reply_year]"
                      dataType="i4"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[reply_year]"
                      name="reply_year" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[kp_in_time]"
                      dataType="i4"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[kp_in_time]"
                      name="kp_in_time" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Reload sent replies\Table"
              componentClassID="Microsoft.ManagedComponentHost"
              contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
              description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
              name="Table"
              usesDispositions="true"
              version="2">
              <properties>
                <property
                  dataType="System.String"
                  description="The Destination database table name."
                  expressionType="Notify"
                  name="TableOrViewName"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.ks_sent_replies</property>
                <property
                  dataType="System.Int32"
                  description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                  expressionType="Notify"
                  name="BatchSize">0</property>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                  expressionType="Notify"
                  name="CommandTimeout">30</property>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                  expressionType="Notify"
                  name="UseBulkInsertWhenPossible">true</property>
                <property
                  dataType="System.String"
                  name="UserComponentTypeName">Microsoft.ADONETDestination</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Reload sent replies\Table.Connections[IDbConnection]"
                  connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                  connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                  description="Managed connection manager"
                  name="IDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input]"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="ADO NET Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[deal_id]"
                      cachedDataType="i4"
                      cachedName="deal_id"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[deal_id]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[assigned_code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="assigned_code"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[assigned_code]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[assigned_code]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[responsible_code]"
                      cachedDataType="wstr"
                      cachedLength="10"
                      cachedName="responsible_code"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[responsible_code]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[responsible_code]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[service_type_row]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="service_type_row"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[service_type_row]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[request_type]"
                      cachedDataType="wstr"
                      cachedLength="50"
                      cachedName="request_type"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[request_type]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[client]"
                      cachedDataType="wstr"
                      cachedLength="1000"
                      cachedName="client"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[client]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[client_type]"
                      cachedDataType="wstr"
                      cachedLength="200"
                      cachedName="client_type"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[client_type]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[ex_reply_duration]"
                      cachedDataType="i4"
                      cachedName="ex_reply_duration"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[ex_reply_duration]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[ex_reply_duration]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[ex_reply_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="ex_reply_date"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[ex_reply_date]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[ex_reply_date]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[tender_reply_date]"
                      cachedDataType="dbTimeStamp"
                      cachedName="tender_reply_date"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[tender_reply_date]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[tender_reply_date]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[reply_month]"
                      cachedDataType="i4"
                      cachedName="reply_month"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[reply_month]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[reply_month]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[reply_year]"
                      cachedDataType="i4"
                      cachedName="reply_year"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[reply_year]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[reply_year]" />
                    <inputColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].Columns[kp_in_time]"
                      cachedDataType="i4"
                      cachedName="kp_in_time"
                      externalMetadataColumnId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[kp_in_time]"
                      lineageId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output].Columns[kp_in_time]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[deal_id]"
                      dataType="i4"
                      name="deal_id" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[assigned_code]"
                      dataType="wstr"
                      length="10"
                      name="assigned_code" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[responsible_code]"
                      dataType="wstr"
                      length="10"
                      name="responsible_code" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[service_type_row]"
                      dataType="wstr"
                      length="10"
                      name="service_type_row" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[request_type]"
                      dataType="wstr"
                      length="50"
                      name="request_type" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[client]"
                      dataType="wstr"
                      length="1000"
                      name="client" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[client_type]"
                      dataType="wstr"
                      length="200"
                      name="client_type" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[ex_reply_duration]"
                      dataType="i4"
                      name="ex_reply_duration" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[ex_reply_date]"
                      dataType="dbTimeStamp"
                      name="ex_reply_date" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[reply_month]"
                      dataType="i4"
                      name="reply_month" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[reply_year]"
                      dataType="i4"
                      name="reply_year" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[tender_reply_date]"
                      dataType="dbTimeStamp"
                      name="tender_reply_date" />
                    <externalMetadataColumn
                      refId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input].ExternalColumns[kp_in_time]"
                      dataType="i4"
                      name="kp_in_time" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Reload sent replies\Table.Outputs[ADO NET Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="ADO NET Destination Error Output"
                  synchronousInputId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Reload sent replies\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Reload sent replies\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Reload sent replies\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Reload sent replies\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Reload sent replies.Paths[ADO NET Source Output]"
              endId="Package\Reload sent replies\Table.Inputs[ADO NET Destination Input]"
              name="ADO NET Source Output"
              startId="Package\Reload sent replies\Query.Outputs[ADO NET Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Remove fired"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{01B4BAF3-BA12-466E-A8B6-92F9B049567A}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Remove fired"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="WITH cte AS (&#xA;SELECT w.*&#xA;FROM [motivation].[dbo].ks_workers AS w&#xA;JOIN [motivation].[dbo].[bitrix_users] AS sp ON sp.nav_code = w.code AND sp.active = 'N'&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR(w.date_begin), MONTH(w.date_begin), 10)) AS date)&#xA;AND w.role_type = 1&#xA;AND w.estimate_participant = 1&#xA;AND w.type = 'manager'&#xA;)&#xA;UPDATE cte&#xA;SET estimate_participant = 0" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Set depth"
      DTS:CreationName="Microsoft.ExpressionTask"
      DTS:Description="Expression Task"
      DTS:DTSID="{50124AB5-3431-4123-978A-8920CE50BEF2}"
      DTS:ExecutableType="Microsoft.ExpressionTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Set depth"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ExpressionTask
          Expression="@[User::depth_months] =  @[$Package::depth_months]" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Truncate"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{6C80BCF2-D02D-4324-8D2D-68BF10D6F82B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Truncate"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="DELETE FROM [motivation].[dbo].[ks_requests]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(request_year, request_month, 10)) AS date)&#xA;&#xA;DELETE FROM [motivation].[dbo].[ks_calculations]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(calc_year, calc_month, 10)) AS date)&#xA;&#xA;DELETE FROM [motivation].[dbo].[ks_accepted]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(accept_year, accept_month, 10)) AS date)&#xA;&#xA;DELETE FROM [motivation].[dbo].[ks_rejected]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(accept_year, accept_month, 10)) AS date)&#xA;&#xA;DELETE FROM [motivation].[dbo].[ks_sent_replies]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(reply_year, reply_month, 10)) AS date)&#xA;&#xA;DELETE FROM [motivation].[dbo].[ks_commissions]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(commission_year, commission_month, 10)) AS date)&#xA;&#xA;DELETE FROM [motivation].[dbo].[ks_commissions_close]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(close_year, close_month, 10)) AS date)&#xA;&#xA;DELETE FROM [motivation].[dbo].[ks_main]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(id_year, id_month, 10)) AS date)&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="4"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="5"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="6"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="7"
            SQLTask:DtsVariableName="User::depth_months"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update main roles"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{2248C74F-7E6C-4FC6-8C97-CE7D38A724DE}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update main roles"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="UPDATE [motivation].[dbo].[ks_workers]&#xA;SET [is_archive] = 1&#xA;WHERE [is_archive] = 0 AND [role_type] = 1 AND&#xA;[date_end] &lt; CAST(GETDATE() AS date)&#xA;&#xA;GO&#xA;&#xA;WITH cte_calendar AS (&#xA;&#x9;SELECT id_year, id_month, CASE WHEN id_year = YEAR(GETDATE()) AND id_month = MONTH(GETDATE()) THEN 1 ELSE 0 END AS current_month&#xA;&#x9;FROM [BI].[dbo].[DimCalendar] dc&#xA;&#x9;WHERE id_year &gt;= 2020 &#xA;&#x9;AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))&#xA;&#x9;GROUP BY id_year, id_month&#xA;),&#xA;&#xA;cte_final AS (&#xA;&#x9;SELECT &#xA;&#x9;b.nav_code AS SalespersonCode,&#xA;&#x9;b.[name] AS SalespersonName,&#xA;&#x9;b.bitrix_name AS bitrix_name,&#xA;&#x9;b.[department_name] AS [Dept_ Code]&#xA;&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND group_id IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_declarant&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND COALESCE(group_id, '') NOT IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_sto_spec&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id = '1123' THEN 1 ELSE 0 END AS is_sto_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '52' AND department_id IN ('1044','56','60','64','66','68') THEN 1 ELSE 0 END AS is_stl_spec&#xA;&#x9;,CASE WHEN office_id = '52' AND department_id = '1090' THEN 1 ELSE 0 END AS is_stl_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '628' AND (department_id IN ('1052','1082','22','76') OR (department_id = '1176' AND work_position LIKE '%руковод%')) THEN 1 ELSE 0 END AS is_ks&#xA;&#x9;FROM [motivation].[dbo].[bitrix_users] AS b&#xA;&#x9;WHERE active = 'Y' AND COALESCE(nav_code, '') &lt;&gt; ''&#xA;)&#xA;&#xA;INSERT [motivation].[dbo].[ks_workers] ([name]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[bitrix_name]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[code]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[type]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[schedule]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_begin]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_end]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[is_archive]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[estimate_participant]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[role_type])&#xA;SELECT &#xA;c.SalespersonName AS [name],&#xA;c.bitrix_name AS [bitrix_name],&#xA;c.SalespersonCode AS [code],&#xA;'manager' AS [type],&#xA;NULL AS [schedule],&#x9;&#x9;&#xA;CAST(DATEFROMPARTS(id_year, id_month, 1) AS date) AS [date_begin],&#xA;CAST(EOMONTH(DATEFROMPARTS(id_year, id_month, 1)) AS date) AS [date_end],&#xA;CASE WHEN current_month = 1 THEN 0 ELSE 1 END AS [is_archive],&#xA;1 AS [estimate_participant],&#xA;1 AS [role_type]&#xA;&#xA;FROM cte_final AS c&#xA;CROSS JOIN cte_calendar AS cc&#xA;WHERE is_ks = 1&#xA;AND NOT EXISTS (SELECT 0 FROM [motivation].[dbo].[ks_workers] AS sw &#xA;WHERE cc.id_year = YEAR([date_begin]) AND cc.id_month = MONTH([date_begin]))" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update role_type"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4D87AF9D-1214-4D0D-ACE2-78D77A328241}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update role_type"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="UPDATE main&#xA;SET role_type = CASE oa.role_type WHEN 1 THEN 'Основная' ELSE 'Дополнительная' END&#xA;FROM [motivation].[dbo].[ks_main] AS main&#xA;OUTER APPLY (SELECT TOP (1) role_type&#xA;FROM [motivation].[dbo].[ks_workers] AS w&#xA;WHERE main.code = w.code&#xA;AND DATEFROMPARTS(main.id_year, main.id_month, 15) BETWEEN w.date_begin AND w.date_end) AS oa" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Updated at"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{D373DE08-B77E-4391-80D1-B2BCC9F0DFD9}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Updated at"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="  UPDATE [motivation].[dbo].[updated_at]&#xA;  SET [date_time] = GETDATE()&#xA;  WHERE [department] = 'ks'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение]"
      DTS:CreationName=""
      DTS:DTSID="{4F425949-E3D5-4410-93E4-FCE23E214FAC}"
      DTS:From="Package\Truncate"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение"
      DTS:To="Package\Reload add roles" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 1]"
      DTS:CreationName=""
      DTS:DTSID="{6E88A236-1A21-48F3-A45A-1E95326573DD}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 1"
      DTS:To="Package\Reload requests" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 10]"
      DTS:CreationName=""
      DTS:DTSID="{5E8A3FB0-5C26-43B5-9754-E30DD38AE5A5}"
      DTS:From="Package\Reload rejected"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 10"
      DTS:To="Package\Reload main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 11]"
      DTS:CreationName=""
      DTS:DTSID="{BC360AB8-857A-4DDF-88E2-C039E5D8325F}"
      DTS:From="Package\Reload sent replies"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 11"
      DTS:To="Package\Reload main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 12]"
      DTS:CreationName=""
      DTS:DTSID="{8119F8B3-FD7F-4A3C-B721-5DABB6456178}"
      DTS:From="Package\Reload requests"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 12"
      DTS:To="Package\Reload main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 13]"
      DTS:CreationName=""
      DTS:DTSID="{58B829A6-B251-49F6-A73F-2B75BC84B9C6}"
      DTS:From="Package\Update main roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 13"
      DTS:To="Package\Truncate" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 14]"
      DTS:CreationName=""
      DTS:DTSID="{1DCDC750-61F1-4681-A0B4-8164E101C2A0}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 14"
      DTS:To="Package\Reload commissions close" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 15]"
      DTS:CreationName=""
      DTS:DTSID="{64268466-CEE2-45AA-9A2D-0F29B4A9A272}"
      DTS:From="Package\Reload commissions close"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 15"
      DTS:To="Package\Reload main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 16]"
      DTS:CreationName=""
      DTS:DTSID="{A69EDD8E-CBD6-485D-A672-3C688A6B4933}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 16"
      DTS:To="Package\Reload calculations" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 17]"
      DTS:CreationName=""
      DTS:DTSID="{45AC5FF2-E15F-47D5-9041-3D3B04231FBF}"
      DTS:From="Package\Reload main"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 17"
      DTS:To="Package\Update role_type" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 18]"
      DTS:CreationName=""
      DTS:DTSID="{4FBA62B0-3DAE-43C1-B816-5346F16B4BE4}"
      DTS:From="Package\Delete add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 18"
      DTS:To="Package\Update main roles" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 19]"
      DTS:CreationName=""
      DTS:DTSID="{42535CC5-FF39-4409-BECF-4132A367E575}"
      DTS:From="Package\Remove fired"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 19"
      DTS:To="Package\Delete add roles" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 2]"
      DTS:CreationName=""
      DTS:DTSID="{E5FA6F6F-033C-4BA3-AF65-FE58A6E1CFE5}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 2"
      DTS:To="Package\Reload sent replies" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 20]"
      DTS:CreationName=""
      DTS:DTSID="{9E8D4732-DAA1-4CFF-B118-65DA8134D4A5}"
      DTS:From="Package\Set depth"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 20"
      DTS:To="Package\Remove fired" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 3]"
      DTS:CreationName=""
      DTS:DTSID="{688E783F-70B7-43E1-A201-8FD21BB96FBD}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 3"
      DTS:To="Package\Reload accepted" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 4]"
      DTS:CreationName=""
      DTS:DTSID="{F2B2A8FA-D854-4DFD-B999-A46FC555E658}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 4"
      DTS:To="Package\Reload commissions" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 5]"
      DTS:CreationName=""
      DTS:DTSID="{3043EFA8-2F0A-4CDD-BB3E-885489FB513B}"
      DTS:From="Package\Reload add roles"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 5"
      DTS:To="Package\Reload rejected" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 6]"
      DTS:CreationName=""
      DTS:DTSID="{37E9562A-DA33-4FA1-8AD4-012D213F2946}"
      DTS:From="Package\Reload main"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 6"
      DTS:To="Package\Updated at" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 7]"
      DTS:CreationName=""
      DTS:DTSID="{6177038A-6FBE-4707-B8A7-6E6AF0D29224}"
      DTS:From="Package\Reload calculations"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 7"
      DTS:To="Package\Reload main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 8]"
      DTS:CreationName=""
      DTS:DTSID="{1404C743-7CED-4644-955E-892BF0285761}"
      DTS:From="Package\Reload accepted"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 8"
      DTS:To="Package\Reload main" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 9]"
      DTS:CreationName=""
      DTS:DTSID="{0806EB8E-5518-41B4-904A-B0C1071F8708}"
      DTS:From="Package\Reload commissions"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 9"
      DTS:To="Package\Reload main" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--В данном разделе CDATA содержатся сведения о макете пакета. В данном разделе содержатся сведения о координатах (x,y), ширине и высоте.-->
<!--В случае возникновения ошибки при редактировании этого раздела вручную его можно удалить. -->
<!--Пакет можно загрузить обычным образом, но прежние сведения о макете будут утеряны, и конструктор автоматически перераспределит элементы в области конструктора.-->
<Objects
  Version="8">
  <!--Все приведенные ниже узлы будут содержать свойства, не влияющие на поведение среды выполнения.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="156,42"
          Id="Package\Delete add roles"
          TopLeft="855,7" />
        <NodeLayout
          Size="156,42"
          Id="Package\Reload accepted"
          TopLeft="504,167" />
        <NodeLayout
          Size="157,42"
          Id="Package\Reload add roles"
          TopLeft="388,84" />
        <NodeLayout
          Size="169,42"
          Id="Package\Reload calculations"
          TopLeft="346,213" />
        <NodeLayout
          Size="174,42"
          Id="Package\Reload commissions"
          TopLeft="674,174" />
        <NodeLayout
          Size="201,42"
          Id="Package\Reload commissions close"
          TopLeft="805,219" />
        <NodeLayout
          Size="137,42"
          Id="Package\Reload main"
          TopLeft="413,315" />
        <NodeLayout
          Size="152,42"
          Id="Package\Reload rejected"
          TopLeft="958,162" />
        <NodeLayout
          Size="154,42"
          Id="Package\Reload requests"
          TopLeft="35,168" />
        <NodeLayout
          Size="168,42"
          Id="Package\Reload sent replies"
          TopLeft="210,164" />
        <NodeLayout
          Size="141,42"
          Id="Package\Remove fired"
          TopLeft="956,82" />
        <NodeLayout
          Size="121,42"
          Id="Package\Truncate"
          TopLeft="484,4" />
        <NodeLayout
          Size="165,42"
          Id="Package\Update main roles"
          TopLeft="657,0" />
        <NodeLayout
          Size="160,42"
          Id="Package\Update role_type"
          TopLeft="584,313" />
        <NodeLayout
          Size="131,42"
          Id="Package\Updated at"
          TopLeft="423,387" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение]"
          TopLeft="544.5,46">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-78,38"
              Start="0,0"
              End="-78,30.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15" />
                  <mssgle:CubicBezierSegment
                    Point1="0,15"
                    Point2="0,19"
                    Point3="-4,19" />
                  <mssgle:LineSegment
                    End="-74,19" />
                  <mssgle:CubicBezierSegment
                    Point1="-74,19"
                    Point2="-78,19"
                    Point3="-78,23" />
                  <mssgle:LineSegment
                    End="-78,30.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 1]"
          TopLeft="416.833333333333,126">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-304.833333333333,42"
              Start="0,0"
              End="-304.833333333333,34.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,7.28260869565217" />
                  <mssgle:CubicBezierSegment
                    Point1="0,7.28260869565217"
                    Point2="0,11.2826086956522"
                    Point3="-4,11.2826086956522" />
                  <mssgle:LineSegment
                    End="-300.833333333333,11.2826086956522" />
                  <mssgle:CubicBezierSegment
                    Point1="-300.833333333333,11.2826086956522"
                    Point2="-304.833333333333,11.2826086956522"
                    Point3="-304.833333333333,15.2826086956522" />
                  <mssgle:LineSegment
                    End="-304.833333333333,34.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 10]"
          TopLeft="1034,204">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-504.125,111"
              Start="0,0"
              End="-504.125,103.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,81.7940761636107" />
                  <mssgle:CubicBezierSegment
                    Point1="0,81.7940761636107"
                    Point2="0,85.7940761636107"
                    Point3="-4,85.7940761636107" />
                  <mssgle:LineSegment
                    End="-500.125,85.7940761636107" />
                  <mssgle:CubicBezierSegment
                    Point1="-500.125,85.7940761636107"
                    Point2="-504.125,85.7940761636107"
                    Point3="-504.125,89.7940761636107" />
                  <mssgle:LineSegment
                    End="-504.125,103.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 11]"
          TopLeft="294,206">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="155.25,109"
              Start="0,0"
              End="155.25,101.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,67.2792362768496" />
                  <mssgle:CubicBezierSegment
                    Point1="0,67.2792362768496"
                    Point2="0,71.2792362768496"
                    Point3="4,71.2792362768496" />
                  <mssgle:LineSegment
                    End="151.25,71.2792362768496" />
                  <mssgle:CubicBezierSegment
                    Point1="151.25,71.2792362768496"
                    Point2="155.25,71.2792362768496"
                    Point3="155.25,75.2792362768496" />
                  <mssgle:LineSegment
                    End="155.25,101.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 12]"
          TopLeft="112,210">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="321.125,105"
              Start="0,0"
              End="321.125,97.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,77.1565585331453" />
                  <mssgle:CubicBezierSegment
                    Point1="0,77.1565585331453"
                    Point2="0,81.1565585331453"
                    Point3="4,81.1565585331453" />
                  <mssgle:LineSegment
                    End="317.125,81.1565585331453" />
                  <mssgle:CubicBezierSegment
                    Point1="317.125,81.1565585331453"
                    Point2="321.125,81.1565585331453"
                    Point3="321.125,85.1565585331453" />
                  <mssgle:LineSegment
                    End="321.125,97.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 13]"
          TopLeft="657,23">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-52,0"
              Start="0,0"
              End="-44.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-44.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 14]"
          TopLeft="498.428571428571,126">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="407.071428571429,93"
              Start="0,0"
              End="407.071428571429,85.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.6293546544831" />
                  <mssgle:CubicBezierSegment
                    Point1="0,30.6293546544831"
                    Point2="0,34.6293546544831"
                    Point3="4,34.6293546544831" />
                  <mssgle:LineSegment
                    End="403.071428571429,34.6293546544831" />
                  <mssgle:CubicBezierSegment
                    Point1="403.071428571429,34.6293546544831"
                    Point2="407.071428571429,34.6293546544831"
                    Point3="407.071428571429,38.6293546544831" />
                  <mssgle:LineSegment
                    End="407.071428571429,85.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 15]"
          TopLeft="905.5,261">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-391.75,54"
              Start="0,0"
              End="-391.75,46.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.3126491646778" />
                  <mssgle:CubicBezierSegment
                    Point1="0,31.3126491646778"
                    Point2="0,35.3126491646778"
                    Point3="-4,35.3126491646778" />
                  <mssgle:LineSegment
                    End="-387.75,35.3126491646778" />
                  <mssgle:CubicBezierSegment
                    Point1="-387.75,35.3126491646778"
                    Point2="-391.75,35.3126491646778"
                    Point3="-391.75,39.3126491646778" />
                  <mssgle:LineSegment
                    End="-391.75,46.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 16]"
          TopLeft="447.875,126">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-17.375,87"
              Start="0,0"
              End="-17.375,79.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,33.6449864498645" />
                  <mssgle:CubicBezierSegment
                    Point1="0,33.6449864498645"
                    Point2="0,37.6449864498645"
                    Point3="-4,37.6449864498645" />
                  <mssgle:LineSegment
                    End="-13.375,37.6449864498645" />
                  <mssgle:CubicBezierSegment
                    Point1="-13.375,37.6449864498645"
                    Point2="-17.375,37.6449864498645"
                    Point3="-17.375,41.6449864498645" />
                  <mssgle:LineSegment
                    End="-17.375,79.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 17]"
          TopLeft="550,335">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="34,0"
              Start="0,0"
              End="26.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="26.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 18]"
          TopLeft="855,24.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-33,0"
              Start="0,0"
              End="-25.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-25.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 19]"
          TopLeft="1026.5,82">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-93.5,-33"
              Start="0,0"
              End="-93.5,-25.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-12.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,-12.5"
                    Point2="0,-16.5"
                    Point3="-4,-16.5" />
                  <mssgle:LineSegment
                    End="-89.5,-16.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-89.5,-16.5"
                    Point2="-93.5,-16.5"
                    Point3="-93.5,-20.5" />
                  <mssgle:LineSegment
                    End="-93.5,-25.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 2]"
          TopLeft="441.666666666667,126">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-147.666666666667,38"
              Start="0,0"
              End="-147.666666666667,30.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,11.4300126103405" />
                  <mssgle:CubicBezierSegment
                    Point1="0,11.4300126103405"
                    Point2="0,15.4300126103405"
                    Point3="-4,15.4300126103405" />
                  <mssgle:LineSegment
                    End="-143.666666666667,15.4300126103405" />
                  <mssgle:CubicBezierSegment
                    Point1="-143.666666666667,15.4300126103405"
                    Point2="-147.666666666667,15.4300126103405"
                    Point3="-147.666666666667,19.4300126103405" />
                  <mssgle:LineSegment
                    End="-147.666666666667,30.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 3]"
          TopLeft="466.5,126">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="115.5,41"
              Start="0,0"
              End="115.5,33.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16.5"
                    Point2="0,20.5"
                    Point3="4,20.5" />
                  <mssgle:LineSegment
                    End="111.5,20.5" />
                  <mssgle:CubicBezierSegment
                    Point1="111.5,20.5"
                    Point2="115.5,20.5"
                    Point3="115.5,24.5" />
                  <mssgle:LineSegment
                    End="115.5,33.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 4]"
          TopLeft="477.142857142857,126">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="283.857142857143,48"
              Start="0,0"
              End="283.857142857143,40.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,18.2547584187409" />
                  <mssgle:CubicBezierSegment
                    Point1="0,18.2547584187409"
                    Point2="0,22.2547584187409"
                    Point3="4,22.2547584187409" />
                  <mssgle:LineSegment
                    End="279.857142857143,22.2547584187409" />
                  <mssgle:CubicBezierSegment
                    Point1="279.857142857143,22.2547584187409"
                    Point2="283.857142857143,22.2547584187409"
                    Point3="283.857142857143,26.2547584187409" />
                  <mssgle:LineSegment
                    End="283.857142857143,40.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 5]"
          TopLeft="516.166666666667,126">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="517.833333333333,36"
              Start="0,0"
              End="517.833333333333,28.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,5.67080745341616" />
                  <mssgle:CubicBezierSegment
                    Point1="0,5.67080745341616"
                    Point2="0,9.67080745341616"
                    Point3="4,9.67080745341616" />
                  <mssgle:LineSegment
                    End="513.833333333333,9.67080745341616" />
                  <mssgle:CubicBezierSegment
                    Point1="513.833333333333,9.67080745341616"
                    Point2="517.833333333333,9.67080745341616"
                    Point3="517.833333333333,13.6708074534162" />
                  <mssgle:LineSegment
                    End="517.833333333333,28.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 6]"
          TopLeft="485,357">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,30"
              Start="0,0"
              End="0,22.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 7]"
          TopLeft="430.5,255">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="34.875,60"
              Start="0,0"
              End="34.875,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.0020682523268" />
                  <mssgle:CubicBezierSegment
                    Point1="0,30.0020682523268"
                    Point2="0,34.0020682523268"
                    Point3="4,34.0020682523268" />
                  <mssgle:LineSegment
                    End="30.875,34.0020682523268" />
                  <mssgle:CubicBezierSegment
                    Point1="30.875,34.0020682523268"
                    Point2="34.875,34.0020682523268"
                    Point3="34.875,38.0020682523268" />
                  <mssgle:LineSegment
                    End="34.875,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 8]"
          TopLeft="582,209">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-100.5,106"
              Start="0,0"
              End="-100.5,98.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,49" />
                  <mssgle:CubicBezierSegment
                    Point1="0,49"
                    Point2="0,53"
                    Point3="-4,53" />
                  <mssgle:LineSegment
                    End="-96.5,53" />
                  <mssgle:CubicBezierSegment
                    Point1="-96.5,53"
                    Point2="-100.5,53"
                    Point3="-100.5,57" />
                  <mssgle:LineSegment
                    End="-100.5,98.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 9]"
          TopLeft="761,216">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-263.375,99"
              Start="0,0"
              End="-263.375,91.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.1034126163392" />
                  <mssgle:CubicBezierSegment
                    Point1="0,52.1034126163392"
                    Point2="0,56.1034126163392"
                    Point3="-4,56.1034126163392" />
                  <mssgle:LineSegment
                    End="-259.375,56.1034126163392" />
                  <mssgle:CubicBezierSegment
                    Point1="-259.375,56.1034126163392"
                    Point2="-263.375,56.1034126163392"
                    Point3="-263.375,60.1034126163392" />
                  <mssgle:LineSegment
                    End="-263.375,91.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="124,42"
          Id="Package\Set depth"
          TopLeft="754,83" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 20]"
          TopLeft="878,103.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="78,0"
              Start="0,0"
              End="70.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="70.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Reload accepted">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Reload accepted\Table"
          TopLeft="111,123" />
        <NodeLayout
          Size="107,42"
          Id="Package\Reload accepted\Query"
          TopLeft="115,45" />
        <EdgeLayout
          Id="Package\Reload accepted.Paths[ADO NET Source Output]"
          TopLeft="166,87">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,36"
              Start="0,0"
              End="0,28.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,28.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload accepted\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload accepted\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload calculations">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Reload calculations\Table"
          TopLeft="170,120" />
        <NodeLayout
          Size="107,42"
          Id="Package\Reload calculations\Query"
          TopLeft="171,47" />
        <EdgeLayout
          Id="Package\Reload calculations.Paths[ADO NET Source Output]"
          TopLeft="223.5,89">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,31"
              Start="0,0"
              End="0,23.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload calculations\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload calculations\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload commissions">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="107,42"
          Id="Package\Reload commissions\Query"
          TopLeft="121,50" />
        <NodeLayout
          Size="105,42"
          Id="Package\Reload commissions\Table"
          TopLeft="118,122" />
        <EdgeLayout
          Id="Package\Reload commissions.Paths[ADO NET Source Output]"
          TopLeft="172.5,92">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,30"
              Start="0,0"
              End="0,22.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload commissions\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload commissions\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload commissions close">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="107,42"
          Id="Package\Reload commissions close\Query"
          TopLeft="191,46" />
        <NodeLayout
          Size="105,42"
          Id="Package\Reload commissions close\Table"
          TopLeft="193,121" />
        <EdgeLayout
          Id="Package\Reload commissions close.Paths[ADO NET Source Output]"
          TopLeft="245,88">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33"
              Start="0,0"
              End="0,25.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload commissions close\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload commissions close\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload main">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Reload main\Table"
          TopLeft="137,141" />
        <NodeLayout
          Size="107,42"
          Id="Package\Reload main\Query"
          TopLeft="133,69" />
        <EdgeLayout
          Id="Package\Reload main.Paths[ADO NET Source Output]"
          TopLeft="188,111">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,30"
              Start="0,0"
              End="0,22.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload main\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload main\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload rejected">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Reload rejected\Table"
          TopLeft="123,120" />
        <NodeLayout
          Size="107,42"
          Id="Package\Reload rejected\Query"
          TopLeft="122,48" />
        <EdgeLayout
          Id="Package\Reload rejected.Paths[ADO NET Source Output]"
          TopLeft="175.5,90">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,30"
              Start="0,0"
              End="0,22.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload rejected\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload rejected\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload requests">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Reload requests\Table"
          TopLeft="86,126" />
        <NodeLayout
          Size="107,42"
          Id="Package\Reload requests\Query"
          TopLeft="90,57" />
        <EdgeLayout
          Id="Package\Reload requests.Paths[ADO NET Source Output]"
          TopLeft="141,99">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload requests\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload requests\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Reload sent replies">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Reload sent replies\Table"
          TopLeft="127,123" />
        <NodeLayout
          Size="107,42"
          Id="Package\Reload sent replies\Query"
          TopLeft="125,51" />
        <EdgeLayout
          Id="Package\Reload sent replies.Paths[ADO NET Source Output]"
          TopLeft="179,93">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,30"
              Start="0,0"
              End="0,22.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Reload sent replies\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Reload sent replies\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>