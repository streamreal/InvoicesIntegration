<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="6/15/2020 12:19:38 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="ETP025"
  DTS:CreatorName="ELTRANSPLUS\andreydruzhinin"
  DTS:DTSID="{F9D1FBA2-BDD5-4E05-B999-4B31C2E41707}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.71"
  DTS:LocaleID="1049"
  DTS:ObjectName="Package2"
  DTS:PackageType="5"
  DTS:VersionBuild="195"
  DTS:VersionGUID="{8C9D37E1-5D8B-4908-9AA1-4729D3DCF8E5}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{04EF184D-B171-43FF-B1B8-203422DD51B3}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="decl_filled">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F0337BDB-76D0-4242-92F0-B699071853EC}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="depth_months">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D55093B7-E574-41E7-9972-7F603AC9092C}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="iterator">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4B04E144-F65F-4D4B-BB61-81EEB6F10AF0}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="spec_filled">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Declarant"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Контейнер последовательности"
      DTS:DTSID="{9DE3AD92-87E5-4807-A20D-7BFB36B8E1A9}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Declarant">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Declarant\Reload add roles"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{96C6DD5E-4C04-4C3A-BF2A-7BFA648F85A8}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload add roles"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="DELETE&#xA;FROM [motivation].[dbo].[sto_workers]&#xA;WHERE [type] = 'declarant' AND role_type = 2&#xA;GO&#xA;DECLARE @start [date] = CAST(DATEFROMPARTS(YEAR(DATEADD(MONTH, -2, GETDATE())), MONTH(DATEADD(MONTH, -2, GETDATE())), 1) AS date);&#xA;&#xA;WITH cte_search AS (&#xA;SELECT DISTINCT [dt_year], [dt_month], [declarant_code] &#xA;FROM [motivation].[dbo].[sto_declarant_preparation_details]&#xA;WHERE CAST(DATEFROMPARTS([dt_year], [dt_month], 15) AS date) &gt; @start&#xA;UNION&#xA;SELECT DISTINCT [dt_year], [dt_month], [declarant_code] &#xA;FROM [motivation].[dbo].[sto_declarant_release_details]&#xA;WHERE CAST(DATEFROMPARTS([dt_year], [dt_month], 15) AS date) &gt; @start&#xA;),&#xA;&#xA;cte_insert AS (&#xA;&#xA;SELECT &#xA;sp.[name] AS [name],&#xA;sp.department_name AS [department],&#xA;'declarant' AS [type],&#xA;c.declarant_code AS [code],&#xA;'5_2' AS [schedule],&#xA;CAST(DATEFROMPARTS([dt_year], [dt_month], 1) AS date) AS [date_begin],&#xA;CAST(EOMONTH(DATEFROMPARTS([dt_year], [dt_month], 1)) AS date) AS [date_end],&#xA;'0' AS [is_archive],&#xA;'0' AS [estimate_participant],&#xA;'2' AS [role_type]&#xA;&#xA;FROM cte_search AS c&#xA;JOIN [motivation].[dbo].[bitrix_users] AS sp ON c.declarant_code = sp.nav_code&#xA;WHERE [active] = 'Y'&#xA;AND NOT EXISTS (&#xA;SELECT 0 FROM [motivation].[dbo].[sto_workers] AS w&#xA;WHERE w.[type] = 'declarant' AND w.code = c.declarant_code AND w.[role_type] = 1&#xA;AND CAST(DATEFROMPARTS([dt_year], [dt_month], 15) AS date) &#xA;BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date))&#xA;)&#xA;)&#xA;&#xA;INSERT [motivation].[dbo].[sto_workers]&#xA;([name]&#xA;      ,[department]&#xA;      ,[type]&#xA;      ,[code]&#xA;      ,[schedule]&#xA;      ,[date_begin]&#xA;      ,[date_end]&#xA;      ,[is_archive]&#xA;      ,[estimate_participant]&#xA;      ,[role_type])&#xA;SELECT [name]&#xA;      ,[department]&#xA;      ,[type]&#xA;      ,[code]&#xA;      ,[schedule]&#xA;      ,[date_begin]&#xA;      ,[date_end]&#xA;      ,[is_archive]&#xA;      ,[estimate_participant]&#xA;      ,[role_type]&#xA;&#x9;  FROM cte_insert&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Declarant\Reload main"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Задача потока данных"
          DTS:DTSID="{2A40A345-3C06-4E00-BF49-475FDC5A2418}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload main"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Query].[SqlCommand]">"WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2019 
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code] 
	FROM [motivation].[dbo].[sto_workers] 
	WHERE [type] = 'declarant'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [motivation].[dbo].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt; CAST(GETDATE() AS date) AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [department], 
	
	CASE WHEN oa_participant.not_a_participant IS NOT NULL THEN 0
	ELSE [estimate_participant] END AS [estimate_participant], 
	
	COALESCE([work_days], 0) [work_days]
	
	
	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[sto_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [department], [estimate_participant] FROM [motivation].[dbo].[sto_workers] w
	WHERE w.[type] = 'declarant' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days

	OUTER APPLY (
	SELECT 1 AS not_a_participant
	FROM [motivation].[dbo].[calc_exceptions] AS ce
	WHERE ce.[type] = 'declarant' AND ce.code = cte_distinct_code.code
	) AS oa_participant
),

cte_dt_preparation AS (
	SELECT
	dt_year id_year,
	dt_month id_month,
	ssd.declarant_code declarant_code,
	SUM(ssd.import40) sum_import40,
	SUM(ssd.export10) sum_export10,
	SUM(ssd.other_procedures) sum_other_procedures,
	COUNT(ssd.regnum) sum_dt_prepared,
	SUM(ssd.product_qty) sum_products,
	SUM(ssd.dt_overall_articuls_count) sum_articuls
	FROM [motivation].[dbo].[sto_declarant_preparation_details] ssd
	GROUP BY ssd.declarant_code, ssd.dt_month, ssd.dt_year
),

cte_dt_release AS (
	SELECT
	dt_year id_year,
	dt_month id_month,
	ssd.declarant_code declarant_code,
	COUNT(ssd.regnum) sum_dt_release
	FROM [motivation].[dbo].[sto_declarant_release_details] ssd
	GROUP BY ssd.declarant_code, ssd.dt_month, ssd.dt_year
),

cte_td AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[declarant_code],
	COUNT(*) all_td
	FROM [motivation].[dbo].[sto_td_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [declarant_code]
),

cte_request AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[declarant_code],
	COUNT(*) all_request
	FROM [motivation].[dbo].[sto_app_before_dt_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [declarant_code]
),

cte_extended AS (

SELECT 
cte_base.*
,COALESCE(cte_dt_preparation.sum_import40, 0) sum_import40
,COALESCE(cte_dt_preparation.sum_export10, 0) sum_export10
,COALESCE(cte_dt_preparation.sum_other_procedures, 0) sum_other_procedures
,COALESCE(cte_dt_preparation.sum_dt_prepared, 0) sum_dt_prepared
,COALESCE(cte_dt_release.sum_dt_release, 0) sum_dt_release
,COALESCE(cte_dt_preparation.sum_products, 0) sum_products
,COALESCE(cte_dt_preparation.sum_articuls, 0) sum_articuls
,COALESCE(cte_td.all_td, 0) all_td
,COALESCE(cte_request.all_request, 0) all_request

FROM cte_base
LEFT JOIN cte_dt_preparation 
	ON cte_dt_preparation.id_year = cte_base.id_year 
	AND cte_dt_preparation.id_month = cte_base.id_month
	AND cte_dt_preparation.declarant_code = cte_base.code
LEFT JOIN cte_dt_release
	ON cte_dt_release.id_year = cte_base.id_year 
	AND cte_dt_release.id_month = cte_base.id_month
	AND cte_dt_release.declarant_code = cte_base.code
LEFT JOIN cte_td
	ON cte_td.id_year = cte_base.id_year 
	AND cte_td.id_month = cte_base.id_month
	AND cte_td.declarant_code = cte_base.code
LEFT JOIN cte_request
	ON cte_request.id_year = cte_base.id_year 
	AND cte_request.id_month = cte_base.id_month
	AND cte_request.declarant_code = cte_base.code
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month) [workers_count]
	,f.[decl_preparation]
    ,f.[decl_release]
    ,f.[decl_product]
    ,f.[decl_articul]	
	,f.[decl_td]
    ,f.[decl_request]
	
	,estimate =  ([sum_dt_prepared] * [decl_preparation]
                + [sum_dt_release] * [decl_release] 
				+ [sum_products] * [decl_product]
                + [sum_articuls] * [decl_articul]
				+ [all_td] * [decl_td]
				+ [all_request] * [decl_request])

	FROM cte_extended c
	CROSS JOIN 
	(SELECT TOP (1) * FROM [motivation].[dbo].[sto_factors] WHERE [sign] = 'declarant') AS f
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt; CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
, 0)
) worker_factor

FROM cte_calc_done c
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR,2) @[User::depth_months] + ", DATEFROMPARTS(id_year, id_month, 10)) AS date)"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Declarant\Reload main\Query"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                  description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                  name="Query"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Specifies the SQL statement used by the component to extract data."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2019 
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code] 
	FROM [motivation].[dbo].[sto_workers] 
	WHERE [type] = 'declarant'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [motivation].[dbo].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt; CAST(GETDATE() AS date) AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [department], 
	
	CASE WHEN oa_participant.not_a_participant IS NOT NULL THEN 0
	ELSE [estimate_participant] END AS [estimate_participant], 
	
	COALESCE([work_days], 0) [work_days]
	
	
	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[sto_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [department], [estimate_participant] FROM [motivation].[dbo].[sto_workers] w
	WHERE w.[type] = 'declarant' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days

	OUTER APPLY (
	SELECT 1 AS not_a_participant
	FROM [motivation].[dbo].[calc_exceptions] AS ce
	WHERE ce.[type] = 'declarant' AND ce.code = cte_distinct_code.code
	) AS oa_participant
),

cte_dt_preparation AS (
	SELECT
	dt_year id_year,
	dt_month id_month,
	ssd.declarant_code declarant_code,
	SUM(ssd.import40) sum_import40,
	SUM(ssd.export10) sum_export10,
	SUM(ssd.other_procedures) sum_other_procedures,
	COUNT(ssd.regnum) sum_dt_prepared,
	SUM(ssd.product_qty) sum_products,
	SUM(ssd.dt_overall_articuls_count) sum_articuls
	FROM [motivation].[dbo].[sto_declarant_preparation_details] ssd
	GROUP BY ssd.declarant_code, ssd.dt_month, ssd.dt_year
),

cte_dt_release AS (
	SELECT
	dt_year id_year,
	dt_month id_month,
	ssd.declarant_code declarant_code,
	COUNT(ssd.regnum) sum_dt_release
	FROM [motivation].[dbo].[sto_declarant_release_details] ssd
	GROUP BY ssd.declarant_code, ssd.dt_month, ssd.dt_year
),

cte_td AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[declarant_code],
	COUNT(*) all_td
	FROM [motivation].[dbo].[sto_td_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [declarant_code]
),

cte_request AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[declarant_code],
	COUNT(*) all_request
	FROM [motivation].[dbo].[sto_app_before_dt_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [declarant_code]
),

cte_extended AS (

SELECT 
cte_base.*
,COALESCE(cte_dt_preparation.sum_import40, 0) sum_import40
,COALESCE(cte_dt_preparation.sum_export10, 0) sum_export10
,COALESCE(cte_dt_preparation.sum_other_procedures, 0) sum_other_procedures
,COALESCE(cte_dt_preparation.sum_dt_prepared, 0) sum_dt_prepared
,COALESCE(cte_dt_release.sum_dt_release, 0) sum_dt_release
,COALESCE(cte_dt_preparation.sum_products, 0) sum_products
,COALESCE(cte_dt_preparation.sum_articuls, 0) sum_articuls
,COALESCE(cte_td.all_td, 0) all_td
,COALESCE(cte_request.all_request, 0) all_request

FROM cte_base
LEFT JOIN cte_dt_preparation 
	ON cte_dt_preparation.id_year = cte_base.id_year 
	AND cte_dt_preparation.id_month = cte_base.id_month
	AND cte_dt_preparation.declarant_code = cte_base.code
LEFT JOIN cte_dt_release
	ON cte_dt_release.id_year = cte_base.id_year 
	AND cte_dt_release.id_month = cte_base.id_month
	AND cte_dt_release.declarant_code = cte_base.code
LEFT JOIN cte_td
	ON cte_td.id_year = cte_base.id_year 
	AND cte_td.id_month = cte_base.id_month
	AND cte_td.declarant_code = cte_base.code
LEFT JOIN cte_request
	ON cte_request.id_year = cte_base.id_year 
	AND cte_request.id_month = cte_base.id_month
	AND cte_request.declarant_code = cte_base.code
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month) [workers_count]
	,f.[decl_preparation]
    ,f.[decl_release]
    ,f.[decl_product]
    ,f.[decl_articul]	
	,f.[decl_td]
    ,f.[decl_request]
	
	,estimate =  ([sum_dt_prepared] * [decl_preparation]
                + [sum_dt_release] * [decl_release] 
				+ [sum_products] * [decl_product]
                + [sum_articuls] * [decl_articul]
				+ [all_td] * [decl_td]
				+ [all_request] * [decl_request])

	FROM cte_extended c
	CROSS JOIN 
	(SELECT TOP (1) * FROM [motivation].[dbo].[sto_factors] WHERE [sign] = 'declarant') AS f
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt; CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
, 0)
) worker_factor

FROM cte_calc_done c
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(id_year, id_month, 10)) AS date)</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="The Source database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Specify the mode to retrieve external column information"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Declarant\Reload main\Query.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output]"
                      name="ADO NET Source Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                          name="id_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                          name="id_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                          name="work_days_in_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                          length="300"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                          name="name"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                          length="100"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                          name="code"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                          length="300"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]"
                          name="department"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                          name="estimate_participant"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                          name="work_days"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_import40]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]"
                          name="sum_import40"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_export10]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]"
                          name="sum_export10"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_other_procedures]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]"
                          name="sum_other_procedures"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_prepared]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_dt_prepared]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_prepared]"
                          name="sum_dt_prepared"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_release]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_dt_release]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_release]"
                          name="sum_dt_release"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_products]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]"
                          name="sum_products"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_articuls]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]"
                          name="sum_articuls"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_td]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]"
                          name="all_td"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_request]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]"
                          name="all_request"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                          name="workers_count"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_preparation]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_preparation]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_preparation]"
                          name="decl_preparation"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_release]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_release]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_release]"
                          name="decl_release"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_product]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_product]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_product]"
                          name="decl_product"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_articul]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_articul]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_articul]"
                          name="decl_articul"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_td]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_td]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_td]"
                          name="decl_td"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_request]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_request]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_request]"
                          name="decl_request"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                          name="estimate"
                          precision="34"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                          name="overall_estimate"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                          name="average_group_estimate"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                          name="worker_factor"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                          dataType="i4"
                          name="id_year" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                          dataType="i4"
                          name="id_month" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                          dataType="i4"
                          name="work_days_in_month" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                          dataType="wstr"
                          length="300"
                          name="name" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                          dataType="wstr"
                          length="100"
                          name="code" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                          dataType="wstr"
                          length="300"
                          name="department" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                          dataType="i4"
                          name="estimate_participant" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                          dataType="i4"
                          name="work_days" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_import40]"
                          dataType="i4"
                          name="sum_import40" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_export10]"
                          dataType="i4"
                          name="sum_export10" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_other_procedures]"
                          dataType="i4"
                          name="sum_other_procedures" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_dt_prepared]"
                          dataType="i4"
                          name="sum_dt_prepared" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_dt_release]"
                          dataType="i4"
                          name="sum_dt_release" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_products]"
                          dataType="i4"
                          name="sum_products" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_articuls]"
                          dataType="i4"
                          name="sum_articuls" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_td]"
                          dataType="i4"
                          name="all_td" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_request]"
                          dataType="i4"
                          name="all_request" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                          dataType="i4"
                          name="workers_count" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_preparation]"
                          dataType="numeric"
                          name="decl_preparation"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_release]"
                          dataType="numeric"
                          name="decl_release"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_product]"
                          dataType="numeric"
                          name="decl_product"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_articul]"
                          dataType="numeric"
                          name="decl_articul"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_td]"
                          dataType="numeric"
                          name="decl_td"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_request]"
                          dataType="numeric"
                          name="decl_request"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                          dataType="numeric"
                          name="estimate"
                          precision="34"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                          dataType="numeric"
                          name="overall_estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                          dataType="numeric"
                          name="average_group_estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                          dataType="numeric"
                          name="worker_factor"
                          precision="18"
                          scale="2" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output]"
                      isErrorOut="true"
                      name="ADO NET Source Error Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                          name="id_year" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                          name="id_month" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                          name="work_days_in_month" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                          dataType="wstr"
                          length="300"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                          name="name" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                          dataType="wstr"
                          length="100"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                          name="code" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                          dataType="wstr"
                          length="300"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                          name="department" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                          name="estimate_participant" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                          name="work_days" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_import40]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_import40]"
                          name="sum_import40" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_export10]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_export10]"
                          name="sum_export10" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_other_procedures]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_other_procedures]"
                          name="sum_other_procedures" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_dt_prepared]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_dt_prepared]"
                          name="sum_dt_prepared" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_dt_release]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_dt_release]"
                          name="sum_dt_release" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_products]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_products]"
                          name="sum_products" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_articuls]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_articuls]"
                          name="sum_articuls" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_td]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_td]"
                          name="all_td" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_request]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_request]"
                          name="all_request" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                          name="workers_count" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_preparation]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_preparation]"
                          name="decl_preparation"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_release]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_release]"
                          name="decl_release"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_product]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_product]"
                          name="decl_product"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_articul]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_articul]"
                          name="decl_articul"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_td]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_td]"
                          name="decl_td"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_request]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_request]"
                          name="decl_request"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                          name="estimate"
                          precision="34"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                          name="overall_estimate"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                          name="average_group_estimate"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                          dataType="numeric"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                          name="worker_factor"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Declarant\Reload main\Table"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                  description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                  name="Table"
                  usesDispositions="true"
                  version="2">
                  <properties>
                    <property
                      dataType="System.String"
                      description="The Destination database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_declarant_main</property>
                    <property
                      dataType="System.Int32"
                      description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                      expressionType="Notify"
                      name="BatchSize">0</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                      expressionType="Notify"
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                      expressionType="Notify"
                      name="UseBulkInsertWhenPossible">true</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Declarant\Reload main\Table.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input]"
                      errorRowDisposition="FailComponent"
                      hasSideEffects="true"
                      name="ADO NET Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_year]"
                          cachedDataType="i4"
                          cachedName="id_year"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_month]"
                          cachedDataType="i4"
                          cachedName="id_month"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days_in_month]"
                          cachedDataType="i4"
                          cachedName="work_days_in_month"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[name]"
                          cachedDataType="wstr"
                          cachedLength="300"
                          cachedName="name"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[code]"
                          cachedDataType="wstr"
                          cachedLength="100"
                          cachedName="code"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[department]"
                          cachedDataType="wstr"
                          cachedLength="300"
                          cachedName="department"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate_participant]"
                          cachedDataType="i4"
                          cachedName="estimate_participant"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days]"
                          cachedDataType="i4"
                          cachedName="work_days"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_import40]"
                          cachedDataType="i4"
                          cachedName="sum_import40"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_import40]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_export10]"
                          cachedDataType="i4"
                          cachedName="sum_export10"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_export10]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_other_procedures]"
                          cachedDataType="i4"
                          cachedName="sum_other_procedures"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_other_procedures]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_dt_prepared]"
                          cachedDataType="i4"
                          cachedName="sum_dt_prepared"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_dt_prepared]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_prepared]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_dt_release]"
                          cachedDataType="i4"
                          cachedName="sum_dt_release"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_dt_release]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_release]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_products]"
                          cachedDataType="i4"
                          cachedName="sum_products"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_products]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_articuls]"
                          cachedDataType="i4"
                          cachedName="sum_articuls"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_articuls]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_td]"
                          cachedDataType="i4"
                          cachedName="all_td"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_td]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_request]"
                          cachedDataType="i4"
                          cachedName="all_request"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_request]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[workers_count]"
                          cachedDataType="i4"
                          cachedName="workers_count"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[decl_preparation]"
                          cachedDataType="numeric"
                          cachedName="decl_preparation"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_preparation]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_preparation]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[decl_release]"
                          cachedDataType="numeric"
                          cachedName="decl_release"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_release]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_release]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[decl_product]"
                          cachedDataType="numeric"
                          cachedName="decl_product"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_product]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_product]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[decl_articul]"
                          cachedDataType="numeric"
                          cachedName="decl_articul"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_articul]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_articul]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate]"
                          cachedDataType="numeric"
                          cachedName="estimate"
                          cachedPrecision="34"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[overall_estimate]"
                          cachedDataType="numeric"
                          cachedName="overall_estimate"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[average_group_estimate]"
                          cachedDataType="numeric"
                          cachedName="average_group_estimate"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]" />
                        <inputColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[worker_factor]"
                          cachedDataType="numeric"
                          cachedName="worker_factor"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                          lineageId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                          dataType="i4"
                          name="id_year" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                          dataType="i4"
                          name="id_month" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                          dataType="i4"
                          name="work_days_in_month" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                          dataType="wstr"
                          length="300"
                          name="name" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                          dataType="wstr"
                          length="100"
                          name="code" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                          dataType="wstr"
                          length="300"
                          name="department" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                          dataType="i4"
                          name="estimate_participant" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                          dataType="i4"
                          name="work_days" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_import40]"
                          dataType="i4"
                          name="sum_import40" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_export10]"
                          dataType="i4"
                          name="sum_export10" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_other_procedures]"
                          dataType="i4"
                          name="sum_other_procedures" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_dt_prepared]"
                          dataType="i4"
                          name="sum_dt_prepared" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_dt_release]"
                          dataType="i4"
                          name="sum_dt_release" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_products]"
                          dataType="i4"
                          name="sum_products" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_articuls]"
                          dataType="i4"
                          name="sum_articuls" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                          dataType="i4"
                          name="workers_count" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_preparation]"
                          dataType="numeric"
                          name="decl_preparation"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_release]"
                          dataType="numeric"
                          name="decl_release"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_product]"
                          dataType="numeric"
                          name="decl_product"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_articul]"
                          dataType="numeric"
                          name="decl_articul"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                          dataType="numeric"
                          name="estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                          dataType="numeric"
                          name="overall_estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                          dataType="numeric"
                          name="average_group_estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                          dataType="numeric"
                          name="worker_factor"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_td]"
                          dataType="i4"
                          name="all_td" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_request]"
                          dataType="i4"
                          name="all_request" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[role_type]"
                          dataType="wstr"
                          length="50"
                          name="role_type" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                  <outputs>
                    <output
                      refId="Package\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output]"
                      exclusionGroup="1"
                      isErrorOut="true"
                      name="ADO NET Destination Error Output"
                      synchronousInputId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input]">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Declarant\Reload main.Paths[ADO NET Source Output]"
                  endId="Package\Declarant\Reload main\Table.Inputs[ADO NET Destination Input]"
                  name="ADO NET Source Output"
                  startId="Package\Declarant\Reload main\Query.Outputs[ADO NET Source Output]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Declarant\Reload preparation"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Задача потока данных"
          DTS:DTSID="{FA85FABB-2F05-45D4-B2AC-BD0654EE2F74}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload preparation"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Query].[SqlCommand]">"WITH cte_auto_dt AS (   
    SELECT DISTINCT REGNUM
	FROM gtd.dbo.Docs AS docs WITH (NOLOCK)
	WHERE docs.[DOCTYP] = 'GTD'
	AND docs.EDSTAT IS NOT NULL
	AND COALESCE(docs.REGNUM, '') &lt;&gt; ''
	AND docs.[PARENTGID] IN 
	(SELECT alta_guid
	FROM [automation].[dbo].[request_created_documents] AS r WITH (NOLOCK)
	WHERE r.[doctype] = 'INV'
	) 
)

SELECT 

base_dt.YYYY dt_year,
base_dt.MM dt_month,
base_dt.[DeclarationNo_] regnum,
oa.code declarant_code,
COALESCE(web_other.all_count, 0) dt_overall_articuls_count,
COALESCE(CAST(gtd.[5_1] AS int), 0) product_qty,
(CASE WHEN gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40' THEN 1 ELSE 0 END) import40,
(CASE WHEN gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10' THEN 1 ELSE 0 END) export10,
(CASE 
WHEN (gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40') OR (gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10') THEN 0 
WHEN (COALESCE(gtd.[1_1], '') = '' OR COALESCE(gtd.[1_2], '') = '') THEN 0
ELSE 1 END) other_procedures,
CASE WHEN cte_auto_dt.REGNUM IS NULL THEN 0 ELSE 1 END AS auto_dt

FROM 

(SELECT d.[DeclarationNo_], d.[YYYY], d.[MM]
,ROW_NUMBER() OVER (PARTITION BY d.[DeclarationNo_] ORDER BY (SELECT NULL)) base_rownum
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
WHERE DTCountДТ = 1 AND isDeclaration = 1) AS base_dt

LEFT JOIN (SELECT g.*, ROW_NUMBER() OVER (PARTITION BY [RegNum] ORDER BY (SELECT NULL)) gtd_rownum 
FROM [gtd].[dbo].[GTDList] g) AS gtd
ON base_dt.[DeclarationNo_] = gtd.RegNum AND gtd.gtd_rownum = 1

LEFT JOIN
(SELECT DocNum AS reg_num, COUNT(*) AS all_count
FROM [Docs2SQL].[dbo].[DBRTOVG] WITH (NOLOCK)
GROUP BY DocNum) AS web_other
ON web_other.reg_num = base_dt.[DeclarationNo_]

LEFT JOIN 
(SELECT a.*, ROW_NUMBER() OVER (PARTITION BY [RegNum] 
ORDER BY COALESCE([REGNUM_DT_DATE_TIME], [REGNUM_PTD_DATE_TIME]) ASC) rownum 
FROM [BI].[dwh].[AltaRegNum] a) AS alta
ON alta.RegNum = base_dt.[DeclarationNo_] AND alta.rownum = 1

LEFT JOIN cte_auto_dt ON base_dt.[DeclarationNo_] = cte_auto_dt.REGNUM

OUTER APPLY (
SELECT TOP (1) dd.[SalespersonCode] [code]
FROM [BI].[dwh].[vDimDeclarant] dd
WHERE dd.Declarant_Key = alta.ExecutorUSERNAMEKey
AND COALESCE(dd.[SalespersonCode], '') &lt;&gt; '') AS oa

--одни LEFT JOIN, поэтому base_rownum через фильтр
WHERE base_dt.base_rownum = 1 AND base_dt.YYYY &gt;= 2020
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " +  (DT_WSTR,2)@[User::depth_months] + ", DATEFROMPARTS(YYYY, MM, 10)) AS date)"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Declarant\Reload preparation\Query"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                  description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                  name="Query"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Specifies the SQL statement used by the component to extract data."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_auto_dt AS (   
    SELECT DISTINCT REGNUM
	FROM gtd.dbo.Docs AS docs WITH (NOLOCK)
	WHERE docs.[DOCTYP] = 'GTD'
	AND docs.EDSTAT IS NOT NULL
	AND COALESCE(docs.REGNUM, '') &lt;&gt; ''
	AND docs.[PARENTGID] IN 
	(SELECT alta_guid
	FROM [automation].[dbo].[request_created_documents] AS r WITH (NOLOCK)
	WHERE r.[doctype] = 'INV'
	) 
)

SELECT 

base_dt.YYYY dt_year,
base_dt.MM dt_month,
base_dt.[DeclarationNo_] regnum,
oa.code declarant_code,
COALESCE(web_other.all_count, 0) dt_overall_articuls_count,
COALESCE(CAST(gtd.[5_1] AS int), 0) product_qty,
(CASE WHEN gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40' THEN 1 ELSE 0 END) import40,
(CASE WHEN gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10' THEN 1 ELSE 0 END) export10,
(CASE 
WHEN (gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40') OR (gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10') THEN 0 
WHEN (COALESCE(gtd.[1_1], '') = '' OR COALESCE(gtd.[1_2], '') = '') THEN 0
ELSE 1 END) other_procedures,
CASE WHEN cte_auto_dt.REGNUM IS NULL THEN 0 ELSE 1 END AS auto_dt

FROM 

(SELECT d.[DeclarationNo_], d.[YYYY], d.[MM]
,ROW_NUMBER() OVER (PARTITION BY d.[DeclarationNo_] ORDER BY (SELECT NULL)) base_rownum
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
WHERE DTCountДТ = 1 AND isDeclaration = 1) AS base_dt

LEFT JOIN (SELECT g.*, ROW_NUMBER() OVER (PARTITION BY [RegNum] ORDER BY (SELECT NULL)) gtd_rownum 
FROM [gtd].[dbo].[GTDList] g) AS gtd
ON base_dt.[DeclarationNo_] = gtd.RegNum AND gtd.gtd_rownum = 1

LEFT JOIN
(SELECT DocNum AS reg_num, COUNT(*) AS all_count
FROM [Docs2SQL].[dbo].[DBRTOVG] WITH (NOLOCK)
GROUP BY DocNum) AS web_other
ON web_other.reg_num = base_dt.[DeclarationNo_]

LEFT JOIN 
(SELECT a.*, ROW_NUMBER() OVER (PARTITION BY [RegNum] 
ORDER BY COALESCE([REGNUM_DT_DATE_TIME], [REGNUM_PTD_DATE_TIME]) ASC) rownum 
FROM [BI].[dwh].[AltaRegNum] a) AS alta
ON alta.RegNum = base_dt.[DeclarationNo_] AND alta.rownum = 1

LEFT JOIN cte_auto_dt ON base_dt.[DeclarationNo_] = cte_auto_dt.REGNUM

OUTER APPLY (
SELECT TOP (1) dd.[SalespersonCode] [code]
FROM [BI].[dwh].[vDimDeclarant] dd
WHERE dd.Declarant_Key = alta.ExecutorUSERNAMEKey
AND COALESCE(dd.[SalespersonCode], '') &lt;&gt; '') AS oa

--одни LEFT JOIN, поэтому base_rownum через фильтр
WHERE base_dt.base_rownum = 1 AND base_dt.YYYY &gt;= 2020
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YYYY, MM, 10)) AS date)</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="The Source database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Specify the mode to retrieve external column information"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Declarant\Reload preparation\Query.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output]"
                      name="ADO NET Source Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                          name="dt_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                          name="dt_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                          length="30"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                          name="regnum"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                          length="20"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                          name="declarant_code"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_overall_articuls_count]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]"
                          name="dt_overall_articuls_count"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[product_qty]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[product_qty]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[product_qty]"
                          name="product_qty"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[import40]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[import40]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[import40]"
                          name="import40"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[export10]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[export10]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[export10]"
                          name="export10"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[other_procedures]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[other_procedures]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[other_procedures]"
                          name="other_procedures"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[auto_dt]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[auto_dt]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[auto_dt]"
                          name="auto_dt"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                          dataType="i4"
                          name="dt_year" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                          dataType="i4"
                          name="dt_month" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                          dataType="wstr"
                          length="30"
                          name="regnum" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          name="declarant_code" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_overall_articuls_count]"
                          dataType="i4"
                          name="dt_overall_articuls_count" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[product_qty]"
                          dataType="i4"
                          name="product_qty" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[import40]"
                          dataType="i4"
                          name="import40" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[export10]"
                          dataType="i4"
                          name="export10" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[other_procedures]"
                          dataType="i4"
                          name="other_procedures" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[auto_dt]"
                          dataType="i4"
                          name="auto_dt" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output]"
                      isErrorOut="true"
                      name="ADO NET Source Error Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                          name="dt_year" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                          name="dt_month" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                          dataType="wstr"
                          length="30"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                          name="regnum" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                          name="declarant_code" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_overall_articuls_count]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_overall_articuls_count]"
                          name="dt_overall_articuls_count" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[product_qty]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[product_qty]"
                          name="product_qty" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[import40]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[import40]"
                          name="import40" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[export10]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[export10]"
                          name="export10" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[other_procedures]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[other_procedures]"
                          name="other_procedures" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[auto_dt]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[auto_dt]"
                          name="auto_dt" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Declarant\Reload preparation\Table"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                  description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                  name="Table"
                  usesDispositions="true"
                  version="2">
                  <properties>
                    <property
                      dataType="System.String"
                      description="The Destination database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_declarant_preparation_details</property>
                    <property
                      dataType="System.Int32"
                      description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                      expressionType="Notify"
                      name="BatchSize">0</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                      expressionType="Notify"
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                      expressionType="Notify"
                      name="UseBulkInsertWhenPossible">true</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Declarant\Reload preparation\Table.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input]"
                      errorRowDisposition="FailComponent"
                      hasSideEffects="true"
                      name="ADO NET Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[dt_year]"
                          cachedDataType="i4"
                          cachedName="dt_year"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_year]" />
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[dt_month]"
                          cachedDataType="i4"
                          cachedName="dt_month"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_month]" />
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[regnum]"
                          cachedDataType="wstr"
                          cachedLength="30"
                          cachedName="regnum"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[regnum]" />
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[declarant_code]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="declarant_code"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[declarant_code]" />
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[dt_overall_articuls_count]"
                          cachedDataType="i4"
                          cachedName="dt_overall_articuls_count"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_overall_articuls_count]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]" />
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[product_qty]"
                          cachedDataType="i4"
                          cachedName="product_qty"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[product_qty]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[product_qty]" />
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[import40]"
                          cachedDataType="i4"
                          cachedName="import40"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[import40]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[import40]" />
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[export10]"
                          cachedDataType="i4"
                          cachedName="export10"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[export10]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[export10]" />
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[other_procedures]"
                          cachedDataType="i4"
                          cachedName="other_procedures"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[other_procedures]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[other_procedures]" />
                        <inputColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[auto_dt]"
                          cachedDataType="i4"
                          cachedName="auto_dt"
                          externalMetadataColumnId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[auto_dt]"
                          lineageId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[auto_dt]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                          dataType="i4"
                          name="dt_year" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                          dataType="i4"
                          name="dt_month" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                          dataType="wstr"
                          length="30"
                          name="regnum" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          name="declarant_code" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_overall_articuls_count]"
                          dataType="i4"
                          name="dt_overall_articuls_count" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[product_qty]"
                          dataType="i4"
                          name="product_qty" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[import40]"
                          dataType="i4"
                          name="import40" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[export10]"
                          dataType="i4"
                          name="export10" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[other_procedures]"
                          dataType="i4"
                          name="other_procedures" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[auto_dt]"
                          dataType="i4"
                          name="auto_dt" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                  <outputs>
                    <output
                      refId="Package\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output]"
                      exclusionGroup="1"
                      isErrorOut="true"
                      name="ADO NET Destination Error Output"
                      synchronousInputId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input]">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Declarant\Reload preparation.Paths[ADO NET Source Output]"
                  endId="Package\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input]"
                  name="ADO NET Source Output"
                  startId="Package\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Declarant\Reload release"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Задача потока данных"
          DTS:DTSID="{C0A19F93-889C-4CA9-8997-65F0DB3085C4}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload release"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Query].[SqlCommand]">"WITH cte_declarants_no_ecp AS (
	SELECT ca.[code], [key]
	FROM [BI].[dwh].[DeclarantsWithoutAnECP] d
	CROSS APPLY (SELECT TOP (1) SalespersonCode [code], dd.Declarant_Key [key]
	FROM [BI].[dwh].[DimDeclarant] dd
	WHERE d.[Name] = dd.Declarant AND COALESCE(SalespersonCode, '') &lt;&gt; '') AS ca
),

--все ДТ, сделанные сотрудникам без ЭЦП считаются
--за ними как поданные
cte_without_ecp AS (
	SELECT
	base_dt.dt_year,
	base_dt.dt_month,
	base_dt.regnum,
	base_dt.declarant_code
	FROM 
	[motivation].[dbo].[sto_declarant_preparation_details] AS base_dt
	JOIN cte_declarants_no_ecp AS c ON c.code = base_dt.declarant_code
),

cte_release AS (
SELECT
base_dt.YYYY dt_year,
base_dt.MM dt_month,
base_dt.[DeclarationNo_] regnum,
oa.code declarant_code
FROM 

(SELECT d.[DeclarationNo_], d.[YYYY], d.[MM]
,ROW_NUMBER() OVER (PARTITION BY d.[DeclarationNo_] ORDER BY (SELECT NULL)) base_rownum
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
WHERE DTCountДТ = 1 AND isDeclaration = 1) AS base_dt

LEFT JOIN 
(SELECT a.*, ROW_NUMBER() OVER (PARTITION BY [RegNum] 
ORDER BY COALESCE([REGNUM_DT_DATE_TIME], [REGNUM_PTD_DATE_TIME]) ASC) rownum 
FROM [BI].[dwh].[AltaRegNum] a) AS alta
ON alta.RegNum = base_dt.[DeclarationNo_] AND alta.rownum = 1

OUTER APPLY (
SELECT TOP (1) dd.[SalespersonCode] [code]
FROM [BI].[dwh].[vDimDeclarant] dd
WHERE dd.Declarant_Key = alta.ReleaserUSERNAMEKey
AND COALESCE(dd.[SalespersonCode], '') &lt;&gt; '') AS oa

--одни LEFT JOIN, поэтому base_rownum через фильтр
--убираем ДТ, сделанные сотрудниками без ЭЦП
WHERE base_dt.base_rownum = 1 AND base_dt.YYYY &gt;= 2019
AND NOT EXISTS (SELECT 0 FROM cte_without_ecp c WHERE c.regnum = base_dt.[DeclarationNo_])
)

SELECT 
dt_year,
dt_month,
regnum,
declarant_code 
FROM cte_release
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(dt_year, dt_month, 10)) AS date)

UNION 

SELECT 
dt_year,
dt_month,
regnum,
declarant_code 
FROM cte_without_ecp
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(dt_year, dt_month, 10)) AS date)"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Declarant\Reload release\Query"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                  description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                  name="Query"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Specifies the SQL statement used by the component to extract data."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_declarants_no_ecp AS (
	SELECT ca.[code], [key]
	FROM [BI].[dwh].[DeclarantsWithoutAnECP] d
	CROSS APPLY (SELECT TOP (1) SalespersonCode [code], dd.Declarant_Key [key]
	FROM [BI].[dwh].[DimDeclarant] dd
	WHERE d.[Name] = dd.Declarant AND COALESCE(SalespersonCode, '') &lt;&gt; '') AS ca
),

--все ДТ, сделанные сотрудникам без ЭЦП считаются
--за ними как поданные
cte_without_ecp AS (
	SELECT
	base_dt.dt_year,
	base_dt.dt_month,
	base_dt.regnum,
	base_dt.declarant_code
	FROM 
	[motivation].[dbo].[sto_declarant_preparation_details] AS base_dt
	JOIN cte_declarants_no_ecp AS c ON c.code = base_dt.declarant_code
),

cte_release AS (
SELECT
base_dt.YYYY dt_year,
base_dt.MM dt_month,
base_dt.[DeclarationNo_] regnum,
oa.code declarant_code
FROM 

(SELECT d.[DeclarationNo_], d.[YYYY], d.[MM]
,ROW_NUMBER() OVER (PARTITION BY d.[DeclarationNo_] ORDER BY (SELECT NULL)) base_rownum
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
WHERE DTCountДТ = 1 AND isDeclaration = 1) AS base_dt

LEFT JOIN 
(SELECT a.*, ROW_NUMBER() OVER (PARTITION BY [RegNum] 
ORDER BY COALESCE([REGNUM_DT_DATE_TIME], [REGNUM_PTD_DATE_TIME]) ASC) rownum 
FROM [BI].[dwh].[AltaRegNum] a) AS alta
ON alta.RegNum = base_dt.[DeclarationNo_] AND alta.rownum = 1

OUTER APPLY (
SELECT TOP (1) dd.[SalespersonCode] [code]
FROM [BI].[dwh].[vDimDeclarant] dd
WHERE dd.Declarant_Key = alta.ReleaserUSERNAMEKey
AND COALESCE(dd.[SalespersonCode], '') &lt;&gt; '') AS oa

--одни LEFT JOIN, поэтому base_rownum через фильтр
--убираем ДТ, сделанные сотрудниками без ЭЦП
WHERE base_dt.base_rownum = 1 AND base_dt.YYYY &gt;= 2019
AND NOT EXISTS (SELECT 0 FROM cte_without_ecp c WHERE c.regnum = base_dt.[DeclarationNo_])
)

SELECT 
dt_year,
dt_month,
regnum,
declarant_code 
FROM cte_release
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(dt_year, dt_month, 10)) AS date)

UNION 

SELECT 
dt_year,
dt_month,
regnum,
declarant_code 
FROM cte_without_ecp
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(dt_year, dt_month, 10)) AS date)</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="The Source database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Specify the mode to retrieve external column information"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Declarant\Reload release\Query.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output]"
                      name="ADO NET Source Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                          name="dt_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                          name="dt_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                          length="30"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                          name="regnum"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                          length="20"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                          name="declarant_code"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                          dataType="i4"
                          name="dt_year" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                          dataType="i4"
                          name="dt_month" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                          dataType="wstr"
                          length="30"
                          name="regnum" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          name="declarant_code" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output]"
                      isErrorOut="true"
                      name="ADO NET Source Error Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                          name="dt_year" />
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                          name="dt_month" />
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                          dataType="wstr"
                          length="30"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                          name="regnum" />
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                          name="declarant_code" />
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Declarant\Reload release\Table"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                  description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                  name="Table"
                  usesDispositions="true"
                  version="2">
                  <properties>
                    <property
                      dataType="System.String"
                      description="The Destination database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_declarant_release_details</property>
                    <property
                      dataType="System.Int32"
                      description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                      expressionType="Notify"
                      name="BatchSize">0</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                      expressionType="Notify"
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                      expressionType="Notify"
                      name="UseBulkInsertWhenPossible">true</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Declarant\Reload release\Table.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input]"
                      errorRowDisposition="FailComponent"
                      hasSideEffects="true"
                      name="ADO NET Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].Columns[dt_year]"
                          cachedDataType="i4"
                          cachedName="dt_year"
                          externalMetadataColumnId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_year]" />
                        <inputColumn
                          refId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].Columns[dt_month]"
                          cachedDataType="i4"
                          cachedName="dt_month"
                          externalMetadataColumnId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_month]" />
                        <inputColumn
                          refId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].Columns[regnum]"
                          cachedDataType="wstr"
                          cachedLength="30"
                          cachedName="regnum"
                          externalMetadataColumnId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[regnum]" />
                        <inputColumn
                          refId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].Columns[declarant_code]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="declarant_code"
                          externalMetadataColumnId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                          lineageId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[declarant_code]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                          dataType="i4"
                          name="dt_year" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                          dataType="i4"
                          name="dt_month" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                          dataType="wstr"
                          length="30"
                          name="regnum" />
                        <externalMetadataColumn
                          refId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          name="declarant_code" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                  <outputs>
                    <output
                      refId="Package\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output]"
                      exclusionGroup="1"
                      isErrorOut="true"
                      name="ADO NET Destination Error Output"
                      synchronousInputId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input]">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Declarant\Reload release.Paths[ADO NET Source Output]"
                  endId="Package\Declarant\Reload release\Table.Inputs[ADO NET Destination Input]"
                  name="ADO NET Source Output"
                  startId="Package\Declarant\Reload release\Query.Outputs[ADO NET Source Output]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Declarant\Truncate"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{55AE5F43-842D-4496-934B-F0C960239A4A}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Truncate"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="DELETE FROM [motivation].[dbo].[sto_declarant_preparation_details]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(dt_year, dt_month, 10)) AS date)&#xA;DELETE FROM [motivation].[dbo].[sto_declarant_release_details]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(dt_year, dt_month, 10)) AS date)&#xA;DELETE FROM [motivation].[dbo].[sto_declarant_main]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(id_year, id_month, 10)) AS date)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::depth_months"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::depth_months"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::depth_months"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Declarant\Update release declarant"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{6BF255E0-A57E-4D46-8032-02C0874295E3}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Update release declarant"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="UPDATE rd&#xA;SET rd.declarant_code = pd.declarant_code&#xA;FROM [motivation].[dbo].[sto_declarant_release_details] AS rd&#xA;JOIN [motivation].[dbo].[sto_declarant_preparation_details] AS pd&#xA;ON rd.regnum = pd.regnum&#xA;WHERE &#xA;(rd.declarant_code IS NULL OR rd.declarant_code = 'N/A')&#xA;AND pd.declarant_code IS NOT NULL &#xA;AND pd.declarant_code &lt;&gt; 'N/A' &#x9;  " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Declarant\Update role_type"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{12AF308F-BCAB-47E8-979E-2156794470F3}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Update role_type"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="UPDATE main&#xA;SET role_type = CASE oa.role_type WHEN 1 THEN 'Основная' ELSE 'Дополнительная' END&#xA;FROM [motivation].[dbo].[sto_declarant_main] AS main&#xA;OUTER APPLY (SELECT TOP (1) role_type&#xA;FROM [motivation].[dbo].[sto_workers] AS w&#xA;WHERE main.code = w.code AND w.type = 'declarant'&#xA;AND DATEFROMPARTS(main.id_year, main.id_month, 15) BETWEEN w.date_begin AND w.date_end) AS oa" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Declarant.PrecedenceConstraints[Ограничение]"
          DTS:CreationName=""
          DTS:DTSID="{7A76479C-EDAB-4666-8905-DB07098EA759}"
          DTS:From="Package\Declarant\Truncate"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение"
          DTS:To="Package\Declarant\Reload preparation" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Declarant.PrecedenceConstraints[Ограничение 1]"
          DTS:CreationName=""
          DTS:DTSID="{B38513E8-1D46-41E8-B464-84A2CE0AF23A}"
          DTS:From="Package\Declarant\Reload preparation"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 1"
          DTS:To="Package\Declarant\Reload release" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Declarant.PrecedenceConstraints[Ограничение 2]"
          DTS:CreationName=""
          DTS:DTSID="{F370D9B1-1EE1-44F7-818C-2AA6692ADB33}"
          DTS:From="Package\Declarant\Reload release"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 2"
          DTS:To="Package\Declarant\Update release declarant" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Declarant.PrecedenceConstraints[Ограничение 3]"
          DTS:CreationName=""
          DTS:DTSID="{C0534016-45F5-417F-ABD2-F98117DBFA10}"
          DTS:From="Package\Declarant\Reload main"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 3"
          DTS:To="Package\Declarant\Update role_type" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Declarant.PrecedenceConstraints[Ограничение 4]"
          DTS:CreationName=""
          DTS:DTSID="{018EF418-39C6-48D8-800B-9161FDC897B6}"
          DTS:From="Package\Declarant\Update release declarant"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 4"
          DTS:To="Package\Declarant\Reload add roles" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Declarant.PrecedenceConstraints[Ограничение 5]"
          DTS:CreationName=""
          DTS:DTSID="{4F0032E2-431E-45C1-8B6F-C02FF5BB14F9}"
          DTS:From="Package\Declarant\Reload add roles"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 5"
          DTS:To="Package\Declarant\Reload main" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Remove fired"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E4099DB1-BEA9-4098-AE80-143DA1FF3203}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Remove fired"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="WITH cte AS (&#xA;SELECT w.*&#xA;FROM [motivation].[dbo].sto_workers AS w&#xA;JOIN [motivation].[dbo].[bitrix_users] AS sp ON sp.nav_code = w.code AND sp.active = 'N'&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YEAR(w.date_begin), MONTH(w.date_begin), 10)) AS date)&#xA;AND w.role_type = 1&#xA;AND w.estimate_participant = 1&#xA;AND (w.type = 'declarant' OR w.type = 'specialist')&#xA;)&#xA;UPDATE cte&#xA;SET estimate_participant = 0" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Specialist"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Контейнер последовательности"
      DTS:DTSID="{B3664964-60AD-459A-B891-F35AED89A6C5}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Specialist">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Specialist\Reload add roles"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{A67EB278-4356-400A-B42C-F11F47B4E2A6}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload add roles"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="DELETE&#xA;FROM [motivation].[dbo].[sto_workers]&#xA;WHERE [type] = 'specialist' AND role_type = 2&#xA;GO&#xA;DECLARE @start [date] = CAST(DATEFROMPARTS(YEAR(DATEADD(MONTH, -2, GETDATE())), MONTH(DATEADD(MONTH, -2, GETDATE())), 1) AS date);&#xA;&#xA;WITH cte_search AS (&#xA;SELECT DISTINCT [dt_year], [dt_month], [specialist_code]&#xA;FROM [motivation].[dbo].[sto_spec_dt_details]&#xA;WHERE CAST(DATEFROMPARTS([dt_year], [dt_month], 15) AS date) &gt; @start&#xA;UNION&#xA;SELECT DISTINCT [stat_year] AS [dt_year], [stat_month] AS [dt_month], [specialist_code]&#xA;FROM [motivation].[dbo].[sto_stat_details]&#xA;WHERE CAST(DATEFROMPARTS([stat_year], [stat_month], 15) AS date) &gt; @start&#xA;UNION&#xA;SELECT DISTINCT [release_year] AS [dt_year], [release_month] AS [dt_month], [specialist] AS [specialist_code]&#xA;FROM [motivation].[dbo].[sto_td_details]&#xA;WHERE CAST(DATEFROMPARTS([release_year], [release_month], 15) AS date) &gt; @start&#xA;UNION&#xA;SELECT DISTINCT [release_year] AS [dt_year], [release_month] AS [dt_month], [specialist] AS [specialist_code]&#xA;FROM [motivation].[dbo].[sto_app_before_dt_details]&#xA;WHERE CAST(DATEFROMPARTS([release_year], [release_month], 15) AS date) &gt; @start&#xA;),&#xA;&#xA;cte_insert AS (&#xA;&#xA;SELECT &#xA;sp.[name] AS [name],&#xA;sp.department_name AS [department],&#xA;'specialist' AS [type],&#xA;c.specialist_code AS [code],&#xA;'5_2' AS [schedule],&#xA;CAST(DATEFROMPARTS([dt_year], [dt_month], 1) AS date) AS [date_begin],&#xA;CAST(EOMONTH(DATEFROMPARTS([dt_year], [dt_month], 1)) AS date) AS [date_end],&#xA;'0' AS [is_archive],&#xA;'0' AS [estimate_participant],&#xA;'2' AS [role_type]&#xA;&#xA;FROM cte_search AS c&#xA;JOIN [motivation].[dbo].[bitrix_users] AS sp ON c.specialist_code = sp.nav_code&#xA;WHERE [active] = 'Y'&#xA;AND NOT EXISTS (&#xA;SELECT 0 FROM [motivation].[dbo].[sto_workers] AS w&#xA;WHERE w.[type] = 'specialist' AND w.code = c.specialist_code AND w.[role_type] = 1&#xA;AND CAST(DATEFROMPARTS([dt_year], [dt_month], 15) AS date) &#xA;BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date))&#xA;)&#xA;)&#xA;&#xA;INSERT [motivation].[dbo].[sto_workers]&#xA;([name]&#xA;      ,[department]&#xA;      ,[type]&#xA;      ,[code]&#xA;      ,[schedule]&#xA;      ,[date_begin]&#xA;      ,[date_end]&#xA;      ,[is_archive]&#xA;      ,[estimate_participant]&#xA;      ,[role_type])&#xA;SELECT [name]&#xA;      ,[department]&#xA;      ,[type]&#xA;      ,[code]&#xA;      ,[schedule]&#xA;      ,[date_begin]&#xA;      ,[date_end]&#xA;      ,[is_archive]&#xA;      ,[estimate_participant]&#xA;      ,[role_type]&#xA;&#x9;  FROM cte_insert&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Specialist\Reload apps before DT details"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Задача потока данных"
          DTS:DTSID="{A743CE1B-DB9A-4266-B6E7-17F43FF017A4}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload apps before DT details"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Query].[SqlCommand]">"WITH cte AS (
   SELECT  
   sd.[Declarant Code] specialist
  ,LEFT(list.[&amp;&amp;PRIM], 7) AS delivery_number
  ,ed_reg.reg_num
  ,ed_reg.reg_datetime
  ,ed_reg.reg_year
  ,ed_reg.reg_month  
  ,ed_release.release_datetime
  ,ed_release.release_year
  ,ed_release.release_month
  ,oa.declarant_code

FROM [gtd].[dbo].[AppReleaseGoodsBeforeDTList] list

JOIN [BI].[dwh].[ETP$SQL_Delivery] sd ON sd.No_ = LEFT(list.[&amp;&amp;PRIM], 7)
 
 LEFT JOIN [gtd].[dbo].[Docs] d ON d.GID = list.DOCGID
 
 LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) reg_year
	,MONTH([InOutDateTime]) reg_month
	,[InOutDateTime] reg_datetime
	,[Result] reg_num
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.11273' AND [Incoming] = 1) AS ed_reg ON list.docgid = ed_reg.gid AND ed_reg.row_num = 1
  
    LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) release_year
	,MONTH([InOutDateTime]) release_month
	,[InOutDateTime] release_datetime
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.11264' AND [Incoming] = 1) AS ed_release ON list.docgid = ed_release.gid AND ed_release.row_num = 1

	OUTER APPLY (SELECT TOP (1) [SalespersonCode] declarant_code 
				FROM [BI].[dwh].[vDimDeclarant] dd
				WHERE UPPER(LTRIM(RTRIM(dd.USERNAME)))= UPPER(LTRIM(RTRIM(d.EDSENDER)))
				) AS oa
),

cte_report AS (
	SELECT 
	sp.SalespersonCode AS specialist,
	DeliveryNo_ AS delivery_number,
	DeclarationNo_ AS reg_num,
    DATEFROMPARTS(d.YYYY, d.MM, 15) AS reg_datetime,
	d.YYYY AS reg_year,
	d.MM AS reg_month,
	DATEFROMPARTS(d.YYYY, d.MM, 15) AS release_datetime,
	d.YYYY AS release_year,
	d.MM AS release_month,
	NULL declarant_code
	
	FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] sp ON sp.SalespersonKey = d.DeclarantKey
	WHERE [isDeclaration] = 1 AND [DTCountЗаявление] = 1
	AND NOT EXISTS(SELECT 0 FROM cte WHERE 
	cte.reg_num = REPLACE(d.DeclarationNo_, 'В', '')
	AND cte.release_datetime IS NOT NULL
	)
)

SELECT * FROM cte
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(release_year, release_month, 10)) AS date)
UNION ALL
SELECT * FROM cte_report
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(release_year, release_month, 10)) AS date)"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Specialist\Reload apps before DT details\Query"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                  description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                  name="Query"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Specifies the SQL statement used by the component to extract data."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte AS (
   SELECT  
   sd.[Declarant Code] specialist
  ,LEFT(list.[&amp;&amp;PRIM], 7) AS delivery_number
  ,ed_reg.reg_num
  ,ed_reg.reg_datetime
  ,ed_reg.reg_year
  ,ed_reg.reg_month  
  ,ed_release.release_datetime
  ,ed_release.release_year
  ,ed_release.release_month
  ,oa.declarant_code

FROM [gtd].[dbo].[AppReleaseGoodsBeforeDTList] list

JOIN [BI].[dwh].[ETP$SQL_Delivery] sd ON sd.No_ = LEFT(list.[&amp;&amp;PRIM], 7)
 
 LEFT JOIN [gtd].[dbo].[Docs] d ON d.GID = list.DOCGID
 
 LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) reg_year
	,MONTH([InOutDateTime]) reg_month
	,[InOutDateTime] reg_datetime
	,[Result] reg_num
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.11273' AND [Incoming] = 1) AS ed_reg ON list.docgid = ed_reg.gid AND ed_reg.row_num = 1
  
    LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) release_year
	,MONTH([InOutDateTime]) release_month
	,[InOutDateTime] release_datetime
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.11264' AND [Incoming] = 1) AS ed_release ON list.docgid = ed_release.gid AND ed_release.row_num = 1

	OUTER APPLY (SELECT TOP (1) [SalespersonCode] declarant_code 
				FROM [BI].[dwh].[vDimDeclarant] dd
				WHERE UPPER(LTRIM(RTRIM(dd.USERNAME)))= UPPER(LTRIM(RTRIM(d.EDSENDER)))
				) AS oa
),

cte_report AS (
	SELECT 
	sp.SalespersonCode AS specialist,
	DeliveryNo_ AS delivery_number,
	DeclarationNo_ AS reg_num,
    DATEFROMPARTS(d.YYYY, d.MM, 15) AS reg_datetime,
	d.YYYY AS reg_year,
	d.MM AS reg_month,
	DATEFROMPARTS(d.YYYY, d.MM, 15) AS release_datetime,
	d.YYYY AS release_year,
	d.MM AS release_month,
	NULL declarant_code
	
	FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] sp ON sp.SalespersonKey = d.DeclarantKey
	WHERE [isDeclaration] = 1 AND [DTCountЗаявление] = 1
	AND NOT EXISTS(SELECT 0 FROM cte WHERE 
	cte.reg_num = REPLACE(d.DeclarationNo_, 'В', '')
	AND cte.release_datetime IS NOT NULL
	)
)

SELECT * FROM cte
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(release_year, release_month, 10)) AS date)
UNION ALL
SELECT * FROM cte_report
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(release_year, release_month, 10)) AS date)</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="The Source database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Specify the mode to retrieve external column information"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload apps before DT details\Query.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output]"
                      name="ADO NET Source Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                          length="20"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                          name="specialist"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                          length="20"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                          name="delivery_number"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_num]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_num]"
                          length="250"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_num]"
                          name="reg_num"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]"
                          dataType="dbTimeStamp"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_datetime]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]"
                          name="reg_datetime"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_year]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_year]"
                          name="reg_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_month]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_month]"
                          name="reg_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]"
                          dataType="dbTimeStamp"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_datetime]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]"
                          name="release_datetime"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_year]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_year]"
                          name="release_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_month]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_month]"
                          name="release_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                          length="20"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                          name="declarant_code"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                          dataType="wstr"
                          length="20"
                          name="specialist" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                          dataType="wstr"
                          length="20"
                          name="delivery_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_num]"
                          dataType="wstr"
                          length="250"
                          name="reg_num" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_datetime]"
                          dataType="dbTimeStamp"
                          name="reg_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_year]"
                          dataType="i4"
                          name="reg_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_month]"
                          dataType="i4"
                          name="reg_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_datetime]"
                          dataType="dbTimeStamp"
                          name="release_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_year]"
                          dataType="i4"
                          name="release_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_month]"
                          dataType="i4"
                          name="release_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          name="declarant_code" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output]"
                      isErrorOut="true"
                      name="ADO NET Source Error Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                          name="specialist" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                          name="delivery_number" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_num]"
                          dataType="wstr"
                          length="250"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_num]"
                          name="reg_num" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_datetime]"
                          dataType="dbTimeStamp"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_datetime]"
                          name="reg_datetime" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_year]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_year]"
                          name="reg_year" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_month]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_month]"
                          name="reg_month" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_datetime]"
                          dataType="dbTimeStamp"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_datetime]"
                          name="release_datetime" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_year]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_year]"
                          name="release_year" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_month]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_month]"
                          name="release_month" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                          name="declarant_code" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Specialist\Reload apps before DT details\Table"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                  description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                  name="Table"
                  usesDispositions="true"
                  version="2">
                  <properties>
                    <property
                      dataType="System.String"
                      description="The Destination database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_app_before_dt_details</property>
                    <property
                      dataType="System.Int32"
                      description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                      expressionType="Notify"
                      name="BatchSize">0</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                      expressionType="Notify"
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                      expressionType="Notify"
                      name="UseBulkInsertWhenPossible">true</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload apps before DT details\Table.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input]"
                      errorRowDisposition="FailComponent"
                      hasSideEffects="true"
                      name="ADO NET Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[specialist]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="specialist"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]" />
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[delivery_number]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="delivery_number"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]" />
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[reg_num]"
                          cachedDataType="wstr"
                          cachedLength="250"
                          cachedName="reg_num"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_num]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_num]" />
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[reg_datetime]"
                          cachedDataType="dbTimeStamp"
                          cachedName="reg_datetime"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_datetime]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]" />
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[reg_year]"
                          cachedDataType="i4"
                          cachedName="reg_year"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_year]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_year]" />
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[reg_month]"
                          cachedDataType="i4"
                          cachedName="reg_month"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_month]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_month]" />
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[release_datetime]"
                          cachedDataType="dbTimeStamp"
                          cachedName="release_datetime"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_datetime]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]" />
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[release_year]"
                          cachedDataType="i4"
                          cachedName="release_year"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_year]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_year]" />
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[release_month]"
                          cachedDataType="i4"
                          cachedName="release_month"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_month]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_month]" />
                        <inputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[declarant_code]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="declarant_code"
                          externalMetadataColumnId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                          lineageId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                          dataType="wstr"
                          length="50"
                          name="delivery_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_num]"
                          dataType="wstr"
                          length="250"
                          name="reg_num" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_datetime]"
                          dataType="dbTimeStamp"
                          name="reg_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_year]"
                          dataType="i4"
                          name="reg_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_month]"
                          dataType="i4"
                          name="reg_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_datetime]"
                          dataType="dbTimeStamp"
                          name="release_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_year]"
                          dataType="i4"
                          name="release_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_month]"
                          dataType="i4"
                          name="release_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                          dataType="wstr"
                          length="50"
                          name="specialist" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                          dataType="wstr"
                          length="30"
                          name="declarant_code" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output]"
                      exclusionGroup="1"
                      isErrorOut="true"
                      name="ADO NET Destination Error Output"
                      synchronousInputId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input]">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Specialist\Reload apps before DT details.Paths[ADO NET Source Output]"
                  endId="Package\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input]"
                  name="ADO NET Source Output"
                  startId="Package\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Specialist\Reload DT details"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Задача потока данных"
          DTS:DTSID="{B4644D1B-0A9B-484F-A8B0-DACB89EE8416}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload DT details"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Query].[SqlCommand]">"WITH cte_process_queue AS (
	SELECT DISTINCT RegNumDT
    FROM [webproject].[dbo].[process_queue_log] AS p WITH (NOLOCK) 
	JOIN [BI].[dwh].[MonitorsDatamart] AS md WITH (NOLOCK) 
	ON p.cargo = md.CargoID
	WHERE md.isConcat = 0 
	AND md.isMonitorSTOData = 1 
	AND COALESCE(md.RegNumDT, '') &lt;&gt; ''
),
    
cte_auto_dt AS (   
    SELECT DISTINCT REGNUM
	FROM gtd.dbo.Docs AS docs WITH (NOLOCK)
	WHERE docs.[DOCTYP] = 'GTD'
	AND docs.EDSTAT IS NOT NULL
	AND COALESCE(docs.REGNUM, '') &lt;&gt; ''
	AND docs.[PARENTGID] IN 
	(SELECT alta_guid
	FROM [automation].[dbo].[request_created_documents] AS r WITH (NOLOCK)
	WHERE r.[doctype] = 'INV'
	) 
)

SELECT 
base_dt.YYYY dt_year,
base_dt.MM dt_month,
NULL department,
fact_dt.[Custom Declaration No_] regnum,
(CASE WHEN gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40' THEN 1 ELSE 0 END) import40,
(CASE WHEN gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10' THEN 1 ELSE 0 END) export10,
(CASE 
WHEN (gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40') OR (gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10') THEN 0 
WHEN (COALESCE(gtd.[1_1], '') = '' OR COALESCE(gtd.[1_2], '') = '') THEN 0
ELSE 1 END) other_procedures,
cust.[No_] customer_id,
cust.[Name] customer_name,
sto_person.SalespersonName specialist,
sto_person.SalespersonCode specialist_code,
COALESCE(CAST(gtd.[5_1] AS int), 0) product_qty,
(CASE WHEN gtd.[51_5] = 2 THEN 1 ELSE 0 END) broker_payment_sign,
(CASE WHEN docs.[ID] = docs_min.id THEN 1 ELSE 0 END) new_contract_sign,
COALESCE(web.sum_new, 0) dt_new_articuls_count,
COALESCE(web_other.all_count, 0) dt_overall_articuls_count,
(CASE WHEN ISNUMERIC(gtd.[21_0]) = 1 THEN CONVERT(int, gtd.[21_0]) ELSE 1 END) dt_transport_qty,
COALESCE(LEN(gtd.[BLOCK\\1\\@44_!_04021]) - LEN(REPLACE(gtd.[BLOCK\\1\\@44_!_04021], ',', '')), '0') + 1 dt_inv_qty,
CASE WHEN cte_process_queue.RegNumDT IS NULL THEN 0 ELSE 1 END AS task_process,
CASE WHEN cte_auto_dt.REGNUM IS NULL THEN 0 ELSE 1 END AS auto_dt

FROM 

(SELECT d.[DeclarationNo_], d.[YYYY], d.[MM]
,ROW_NUMBER() OVER (PARTITION BY d.[DeclarationNo_] ORDER BY (SELECT NULL)) base_rownum
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] AS d WITH (NOLOCK)
WHERE DTCountДТ = 1 AND isDeclaration = 1) AS base_dt

JOIN

(SELECT f.*, 
ROW_NUMBER() OVER (PARTITION BY [Custom Declaration No_] ORDER BY (SELECT NULL)) fact_rownum 
FROM [BI].[olap].[FactReleaseRateSTO] AS f WITH (NOLOCK)) AS fact_dt 
ON base_dt.[DeclarationNo_] = fact_dt.[Custom Declaration No_]
AND base_dt.base_rownum = 1 
AND fact_dt.fact_rownum = 1

JOIN [BI].[dwh].[ETP$Customer] cust on cust.CustomerKey = fact_dt.CustomerKey
JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] sto_person ON sto_person.[SalespersonKey] = fact_dt.[SalespersonKey]

LEFT JOIN (SELECT g.*, 
CASE 
WHEN CHARINDEX('/', g.[14_4]) &gt; 0 
THEN SUBSTRING(g.[14_4], 1, CHARINDEX('/', g.[14_4]) - 1) 
ELSE g.[14_4] END vat,
ROW_NUMBER() OVER (PARTITION BY [RegNum] ORDER BY (SELECT NULL)) gtd_rownum 
FROM [gtd].[dbo].[GTDList] AS g WITH (NOLOCK)) AS gtd
ON fact_dt.[Custom Declaration No_] = gtd.RegNum AND gtd.gtd_rownum = 1

LEFT JOIN [gtd].[dbo].[Docs] docs on docs.[GID] = gtd.[DOCGID]

LEFT JOIN
(SELECT docs.ID, gtdlist.[BLOCK\\1\\@44_!_03011], gtdlist.vat,
ROW_NUMBER() OVER (PARTITION BY gtdlist.vat, gtdlist.[BLOCK\\1\\@44_!_03011] ORDER BY docs.ID ASC) rownum
FROM [gtd].[dbo].[Docs] AS docs WITH (NOLOCK)
JOIN (SELECT g.*, CASE WHEN CHARINDEX('/', g.[14_4]) &gt; 0 THEN SUBSTRING(g.[14_4], 1, CHARINDEX('/', g.[14_4]) - 1) 
ELSE g.[14_4] END vat FROM [gtd].[dbo].[GTDList] AS g WITH (NOLOCK)) AS gtdlist ON docs.[GID] = gtdlist.[DOCGID] 
WHERE LEFT(gtdlist.[C_1], 4) IN ('2-10', '2-11', '2-12', '2-13', '2-14', '2-20', '2-**') 
) AS docs_min
ON docs_min.rownum = 1 
AND gtd.[BLOCK\\1\\@44_!_03011] = docs_min.[BLOCK\\1\\@44_!_03011]
AND gtd.vat = docs_min.vat
AND COALESCE(gtd.[BLOCK\\1\\@44_!_03011], '') &lt;&gt; ''
AND COALESCE(gtd.vat, '') &lt;&gt; ''

LEFT JOIN 
(SELECT reg_num, COUNT(*) all_count, SUM(CASE WHEN isNewItem = 1 AND isUnknown = 0 THEN 1 ELSE 0 END) sum_new
FROM [BI].[dwh].[WebProjectItems] WITH (NOLOCK)
GROUP BY [reg_num]) AS web
ON web.reg_num = fact_dt.[Custom Declaration No_]

LEFT JOIN
(SELECT DocNum AS reg_num, COUNT(*) AS all_count
FROM [Docs2SQL].[dbo].[DBRTOVG] WITH (NOLOCK)
GROUP BY DocNum) AS web_other
ON web_other.reg_num = fact_dt.[Custom Declaration No_]

LEFT JOIN cte_process_queue ON fact_dt.[Custom Declaration No_] = cte_process_queue.RegNumDT
LEFT JOIN cte_auto_dt ON fact_dt.[Custom Declaration No_] = cte_auto_dt.REGNUM

WHERE base_dt.YYYY &gt;= 2020 
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YYYY, MM, 10)) AS date)"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Specialist\Reload DT details\Query"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                  description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                  name="Query"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Specifies the SQL statement used by the component to extract data."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_process_queue AS (
	SELECT DISTINCT RegNumDT
    FROM [webproject].[dbo].[process_queue_log] AS p WITH (NOLOCK) 
	JOIN [BI].[dwh].[MonitorsDatamart] AS md WITH (NOLOCK) 
	ON p.cargo = md.CargoID
	WHERE md.isConcat = 0 
	AND md.isMonitorSTOData = 1 
	AND COALESCE(md.RegNumDT, '') &lt;&gt; ''
),
    
cte_auto_dt AS (   
    SELECT DISTINCT REGNUM
	FROM gtd.dbo.Docs AS docs WITH (NOLOCK)
	WHERE docs.[DOCTYP] = 'GTD'
	AND docs.EDSTAT IS NOT NULL
	AND COALESCE(docs.REGNUM, '') &lt;&gt; ''
	AND docs.[PARENTGID] IN 
	(SELECT alta_guid
	FROM [automation].[dbo].[request_created_documents] AS r WITH (NOLOCK)
	WHERE r.[doctype] = 'INV'
	) 
)

SELECT 
base_dt.YYYY dt_year,
base_dt.MM dt_month,
NULL department,
fact_dt.[Custom Declaration No_] regnum,
(CASE WHEN gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40' THEN 1 ELSE 0 END) import40,
(CASE WHEN gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10' THEN 1 ELSE 0 END) export10,
(CASE 
WHEN (gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40') OR (gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10') THEN 0 
WHEN (COALESCE(gtd.[1_1], '') = '' OR COALESCE(gtd.[1_2], '') = '') THEN 0
ELSE 1 END) other_procedures,
cust.[No_] customer_id,
cust.[Name] customer_name,
sto_person.SalespersonName specialist,
sto_person.SalespersonCode specialist_code,
COALESCE(CAST(gtd.[5_1] AS int), 0) product_qty,
(CASE WHEN gtd.[51_5] = 2 THEN 1 ELSE 0 END) broker_payment_sign,
(CASE WHEN docs.[ID] = docs_min.id THEN 1 ELSE 0 END) new_contract_sign,
COALESCE(web.sum_new, 0) dt_new_articuls_count,
COALESCE(web_other.all_count, 0) dt_overall_articuls_count,
(CASE WHEN ISNUMERIC(gtd.[21_0]) = 1 THEN CONVERT(int, gtd.[21_0]) ELSE 1 END) dt_transport_qty,
COALESCE(LEN(gtd.[BLOCK\1\@44_!_04021]) - LEN(REPLACE(gtd.[BLOCK\1\@44_!_04021], ',', '')), '0') + 1 dt_inv_qty,
CASE WHEN cte_process_queue.RegNumDT IS NULL THEN 0 ELSE 1 END AS task_process,
CASE WHEN cte_auto_dt.REGNUM IS NULL THEN 0 ELSE 1 END AS auto_dt

FROM 

(SELECT d.[DeclarationNo_], d.[YYYY], d.[MM]
,ROW_NUMBER() OVER (PARTITION BY d.[DeclarationNo_] ORDER BY (SELECT NULL)) base_rownum
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] AS d WITH (NOLOCK)
WHERE DTCountДТ = 1 AND isDeclaration = 1) AS base_dt

JOIN

(SELECT f.*, 
ROW_NUMBER() OVER (PARTITION BY [Custom Declaration No_] ORDER BY (SELECT NULL)) fact_rownum 
FROM [BI].[olap].[FactReleaseRateSTO] AS f WITH (NOLOCK)) AS fact_dt 
ON base_dt.[DeclarationNo_] = fact_dt.[Custom Declaration No_]
AND base_dt.base_rownum = 1 
AND fact_dt.fact_rownum = 1

JOIN [BI].[dwh].[ETP$Customer] cust on cust.CustomerKey = fact_dt.CustomerKey
JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] sto_person ON sto_person.[SalespersonKey] = fact_dt.[SalespersonKey]

LEFT JOIN (SELECT g.*, 
CASE 
WHEN CHARINDEX('/', g.[14_4]) &gt; 0 
THEN SUBSTRING(g.[14_4], 1, CHARINDEX('/', g.[14_4]) - 1) 
ELSE g.[14_4] END vat,
ROW_NUMBER() OVER (PARTITION BY [RegNum] ORDER BY (SELECT NULL)) gtd_rownum 
FROM [gtd].[dbo].[GTDList] AS g WITH (NOLOCK)) AS gtd
ON fact_dt.[Custom Declaration No_] = gtd.RegNum AND gtd.gtd_rownum = 1

LEFT JOIN [gtd].[dbo].[Docs] docs on docs.[GID] = gtd.[DOCGID]

LEFT JOIN
(SELECT docs.ID, gtdlist.[BLOCK\1\@44_!_03011], gtdlist.vat,
ROW_NUMBER() OVER (PARTITION BY gtdlist.vat, gtdlist.[BLOCK\1\@44_!_03011] ORDER BY docs.ID ASC) rownum
FROM [gtd].[dbo].[Docs] AS docs WITH (NOLOCK)
JOIN (SELECT g.*, CASE WHEN CHARINDEX('/', g.[14_4]) &gt; 0 THEN SUBSTRING(g.[14_4], 1, CHARINDEX('/', g.[14_4]) - 1) 
ELSE g.[14_4] END vat FROM [gtd].[dbo].[GTDList] AS g WITH (NOLOCK)) AS gtdlist ON docs.[GID] = gtdlist.[DOCGID] 
WHERE LEFT(gtdlist.[C_1], 4) IN ('2-10', '2-11', '2-12', '2-13', '2-14', '2-20', '2-**') 
) AS docs_min
ON docs_min.rownum = 1 
AND gtd.[BLOCK\1\@44_!_03011] = docs_min.[BLOCK\1\@44_!_03011]
AND gtd.vat = docs_min.vat
AND COALESCE(gtd.[BLOCK\1\@44_!_03011], '') &lt;&gt; ''
AND COALESCE(gtd.vat, '') &lt;&gt; ''

LEFT JOIN 
(SELECT reg_num, COUNT(*) all_count, SUM(CASE WHEN isNewItem = 1 AND isUnknown = 0 THEN 1 ELSE 0 END) sum_new
FROM [BI].[dwh].[WebProjectItems] WITH (NOLOCK)
GROUP BY [reg_num]) AS web
ON web.reg_num = fact_dt.[Custom Declaration No_]

LEFT JOIN
(SELECT DocNum AS reg_num, COUNT(*) AS all_count
FROM [Docs2SQL].[dbo].[DBRTOVG] WITH (NOLOCK)
GROUP BY DocNum) AS web_other
ON web_other.reg_num = fact_dt.[Custom Declaration No_]

LEFT JOIN cte_process_queue ON fact_dt.[Custom Declaration No_] = cte_process_queue.RegNumDT
LEFT JOIN cte_auto_dt ON fact_dt.[Custom Declaration No_] = cte_auto_dt.REGNUM

WHERE base_dt.YYYY &gt;= 2020 
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YYYY, MM, 10)) AS date)</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="The Source database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Specify the mode to retrieve external column information"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload DT details\Query.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output]"
                      name="ADO NET Source Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                          name="dt_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                          name="dt_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[department]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[department]"
                          name="department"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                          length="30"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                          name="regnum"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[import40]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[import40]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[import40]"
                          name="import40"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[export10]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[export10]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[export10]"
                          name="export10"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[other_procedures]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[other_procedures]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[other_procedures]"
                          name="other_procedures"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_id]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[customer_id]"
                          length="20"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_id]"
                          name="customer_id"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_name]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[customer_name]"
                          length="50"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_name]"
                          name="customer_name"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                          length="200"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                          name="specialist"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist_code]"
                          length="20"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]"
                          name="specialist_code"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[product_qty]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[product_qty]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[product_qty]"
                          name="product_qty"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[broker_payment_sign]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[broker_payment_sign]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[broker_payment_sign]"
                          name="broker_payment_sign"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[new_contract_sign]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[new_contract_sign]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[new_contract_sign]"
                          name="new_contract_sign"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_new_articuls_count]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_new_articuls_count]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_new_articuls_count]"
                          name="dt_new_articuls_count"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_overall_articuls_count]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]"
                          name="dt_overall_articuls_count"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_transport_qty]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_transport_qty]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_transport_qty]"
                          name="dt_transport_qty"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_inv_qty]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_inv_qty]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_inv_qty]"
                          name="dt_inv_qty"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[task_process]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[task_process]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[task_process]"
                          name="task_process"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[auto_dt]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[auto_dt]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[auto_dt]"
                          name="auto_dt"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                          dataType="i4"
                          name="dt_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                          dataType="i4"
                          name="dt_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                          dataType="i4"
                          name="department" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                          dataType="wstr"
                          length="30"
                          name="regnum" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[import40]"
                          dataType="i4"
                          name="import40" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[export10]"
                          dataType="i4"
                          name="export10" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[other_procedures]"
                          dataType="i4"
                          name="other_procedures" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[customer_id]"
                          dataType="wstr"
                          length="20"
                          name="customer_id" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[customer_name]"
                          dataType="wstr"
                          length="50"
                          name="customer_name" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                          dataType="wstr"
                          length="200"
                          name="specialist" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist_code]"
                          dataType="wstr"
                          length="20"
                          name="specialist_code" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[product_qty]"
                          dataType="i4"
                          name="product_qty" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[broker_payment_sign]"
                          dataType="i4"
                          name="broker_payment_sign" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[new_contract_sign]"
                          dataType="i4"
                          name="new_contract_sign" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_new_articuls_count]"
                          dataType="i4"
                          name="dt_new_articuls_count" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_overall_articuls_count]"
                          dataType="i4"
                          name="dt_overall_articuls_count" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_transport_qty]"
                          dataType="i4"
                          name="dt_transport_qty" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_inv_qty]"
                          dataType="i4"
                          name="dt_inv_qty" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[task_process]"
                          dataType="i4"
                          name="task_process" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[auto_dt]"
                          dataType="i4"
                          name="auto_dt" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output]"
                      isErrorOut="true"
                      name="ADO NET Source Error Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                          name="dt_year" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                          name="dt_month" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                          name="department" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                          dataType="wstr"
                          length="30"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                          name="regnum" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[import40]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[import40]"
                          name="import40" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[export10]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[export10]"
                          name="export10" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[other_procedures]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[other_procedures]"
                          name="other_procedures" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[customer_id]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[customer_id]"
                          name="customer_id" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[customer_name]"
                          dataType="wstr"
                          length="50"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[customer_name]"
                          name="customer_name" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                          dataType="wstr"
                          length="200"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                          name="specialist" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist_code]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist_code]"
                          name="specialist_code" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[product_qty]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[product_qty]"
                          name="product_qty" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[broker_payment_sign]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[broker_payment_sign]"
                          name="broker_payment_sign" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[new_contract_sign]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[new_contract_sign]"
                          name="new_contract_sign" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_new_articuls_count]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_new_articuls_count]"
                          name="dt_new_articuls_count" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_overall_articuls_count]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_overall_articuls_count]"
                          name="dt_overall_articuls_count" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_transport_qty]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_transport_qty]"
                          name="dt_transport_qty" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_inv_qty]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_inv_qty]"
                          name="dt_inv_qty" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[task_process]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[task_process]"
                          name="task_process" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[auto_dt]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[auto_dt]"
                          name="auto_dt" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Specialist\Reload DT details\Table"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                  description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                  name="Table"
                  usesDispositions="true"
                  version="2">
                  <properties>
                    <property
                      dataType="System.String"
                      description="The Destination database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_spec_dt_details</property>
                    <property
                      dataType="System.Int32"
                      description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                      expressionType="Notify"
                      name="BatchSize">0</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                      expressionType="Notify"
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                      expressionType="Notify"
                      name="UseBulkInsertWhenPossible">true</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload DT details\Table.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input]"
                      errorRowDisposition="FailComponent"
                      hasSideEffects="true"
                      name="ADO NET Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_year]"
                          cachedDataType="i4"
                          cachedName="dt_year"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_year]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_month]"
                          cachedDataType="i4"
                          cachedName="dt_month"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_month]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[department]"
                          cachedDataType="i4"
                          cachedName="department"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[department]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[regnum]"
                          cachedDataType="wstr"
                          cachedLength="30"
                          cachedName="regnum"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[regnum]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[import40]"
                          cachedDataType="i4"
                          cachedName="import40"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[import40]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[import40]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[export10]"
                          cachedDataType="i4"
                          cachedName="export10"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[export10]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[export10]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[other_procedures]"
                          cachedDataType="i4"
                          cachedName="other_procedures"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[other_procedures]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[other_procedures]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[customer_id]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="customer_id"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[customer_id]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_id]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[customer_name]"
                          cachedDataType="wstr"
                          cachedLength="50"
                          cachedName="customer_name"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[customer_name]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_name]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[specialist]"
                          cachedDataType="wstr"
                          cachedLength="200"
                          cachedName="specialist"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[specialist_code]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="specialist_code"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist_code]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[product_qty]"
                          cachedDataType="i4"
                          cachedName="product_qty"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[product_qty]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[product_qty]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[broker_payment_sign]"
                          cachedDataType="i4"
                          cachedName="broker_payment_sign"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[broker_payment_sign]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[broker_payment_sign]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[new_contract_sign]"
                          cachedDataType="i4"
                          cachedName="new_contract_sign"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[new_contract_sign]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[new_contract_sign]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_new_articuls_count]"
                          cachedDataType="i4"
                          cachedName="dt_new_articuls_count"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_new_articuls_count]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_new_articuls_count]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_overall_articuls_count]"
                          cachedDataType="i4"
                          cachedName="dt_overall_articuls_count"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_overall_articuls_count]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_transport_qty]"
                          cachedDataType="i4"
                          cachedName="dt_transport_qty"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_transport_qty]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_transport_qty]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_inv_qty]"
                          cachedDataType="i4"
                          cachedName="dt_inv_qty"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_inv_qty]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_inv_qty]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[task_process]"
                          cachedDataType="i4"
                          cachedName="task_process"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[task_process]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[task_process]" />
                        <inputColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[auto_dt]"
                          cachedDataType="i4"
                          cachedName="auto_dt"
                          externalMetadataColumnId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[auto_dt]"
                          lineageId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[auto_dt]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                          dataType="i4"
                          name="dt_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                          dataType="i4"
                          name="dt_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                          dataType="wstr"
                          length="300"
                          name="department" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                          dataType="wstr"
                          length="30"
                          name="regnum" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[import40]"
                          dataType="i4"
                          name="import40" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[export10]"
                          dataType="i4"
                          name="export10" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[other_procedures]"
                          dataType="i4"
                          name="other_procedures" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[customer_id]"
                          dataType="wstr"
                          length="20"
                          name="customer_id" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[customer_name]"
                          dataType="wstr"
                          length="50"
                          name="customer_name" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                          dataType="wstr"
                          length="200"
                          name="specialist" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist_code]"
                          dataType="wstr"
                          length="20"
                          name="specialist_code" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[product_qty]"
                          dataType="i4"
                          name="product_qty" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[broker_payment_sign]"
                          dataType="i4"
                          name="broker_payment_sign" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[new_contract_sign]"
                          dataType="i4"
                          name="new_contract_sign" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_new_articuls_count]"
                          dataType="i4"
                          name="dt_new_articuls_count" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_overall_articuls_count]"
                          dataType="i4"
                          name="dt_overall_articuls_count" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_transport_qty]"
                          dataType="i4"
                          name="dt_transport_qty" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_inv_qty]"
                          dataType="i4"
                          name="dt_inv_qty" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[task_process]"
                          dataType="i4"
                          name="task_process" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[auto_dt]"
                          dataType="i4"
                          name="auto_dt" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output]"
                      exclusionGroup="1"
                      isErrorOut="true"
                      name="ADO NET Destination Error Output"
                      synchronousInputId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input]">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Specialist\Reload DT details.Paths[ADO NET Source Output]"
                  endId="Package\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input]"
                  name="ADO NET Source Output"
                  startId="Package\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Specialist\Reload main"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Задача потока данных"
          DTS:DTSID="{CE930A1B-D1BC-4E29-BE83-9D169E82FE28}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload main"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Query].[SqlCommand]">"WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2019 
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code] 
	FROM [motivation].[dbo].[sto_workers] 
	WHERE [type] = 'specialist'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [motivation].[dbo].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt; CAST(GETDATE() AS date) AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [department], [estimate_participant], COALESCE([work_days], 0) [work_days]
	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[sto_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [department], [estimate_participant] FROM [motivation].[dbo].[sto_workers] w
	WHERE w.[type] = 'specialist' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days
),

cte_dt AS (
	SELECT
	dt_year id_year,
	dt_month id_month,
	ssd.specialist_code specialist_code,
	SUM(ssd.import40) sum_import40,
	SUM(ssd.export10) sum_export10,
	SUM(ssd.other_procedures) sum_other_procedures,
	SUM(ssd.broker_payment_sign) sum_broker_payment,
	COUNT(DISTINCT ssd.customer_id) unique_customers,
	COUNT(ssd.regnum) dt_count,
	SUM(ssd.product_qty) sum_products,
	SUM(ssd.new_contract_sign) sum_new_contracts,
	SUM(ssd.dt_overall_articuls_count) sum_articuls,
	SUM(ssd.dt_new_articuls_count) sum_new_articuls,
	SUM(ssd.dt_transport_qty) sum_transport,
	SUM(ssd.dt_inv_qty) sum_invoices
	FROM [motivation].[dbo].[sto_spec_dt_details] ssd
	GROUP BY ssd.specialist_code, ssd.dt_month, ssd.dt_year
),

cte_td AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[specialist] code,
	COUNT(*) all_td
	FROM [motivation].[dbo].[sto_td_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [specialist]
),

cte_request AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[specialist] code,
	COUNT(*) all_request
	FROM [motivation].[dbo].[sto_app_before_dt_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [specialist]
),

cte_stat AS (
	SELECT 
	[stat_year] id_year
	,[stat_month] id_month
	,[specialist_code] code
	,COUNT(*) all_stat
	FROM [motivation].[dbo].[sto_stat_details]
	GROUP BY [stat_year], [stat_month], [specialist_code]
),

cte_extended AS (

SELECT 
cte_base.*
,COALESCE(cte_dt.sum_import40, 0) sum_import40
,COALESCE(cte_dt.sum_export10, 0) sum_export10
,COALESCE(cte_dt.sum_other_procedures, 0) sum_other_procedures
,COALESCE(cte_dt.sum_broker_payment, 0) sum_broker_payment
,COALESCE(cte_dt.unique_customers, 0) unique_customers
,COALESCE(cte_dt.dt_count, 0) dt_count
,COALESCE(cte_dt.sum_products, 0) sum_products
,COALESCE(cte_dt.sum_new_contracts, 0) sum_new_contracts
,COALESCE(cte_dt.sum_articuls, 0) sum_articuls
,COALESCE(cte_dt.sum_new_articuls, 0) sum_new_articuls
,COALESCE(cte_dt.sum_transport, 0) sum_transport
,COALESCE(cte_dt.sum_invoices, 0) sum_invoices
,COALESCE(cte_td.all_td, 0) all_td
,COALESCE(cte_request.all_request, 0) all_request
,COALESCE(cte_stat.all_stat, 0) all_stat

FROM cte_base
LEFT JOIN cte_dt 
	ON cte_dt.id_year = cte_base.id_year 
	AND cte_dt.id_month = cte_base.id_month
	AND cte_dt.specialist_code = cte_base.code
LEFT JOIN cte_td
	ON cte_td.id_year = cte_base.id_year 
	AND cte_td.id_month = cte_base.id_month
	AND cte_td.code = cte_base.code
LEFT JOIN cte_request
	ON cte_request.id_year = cte_base.id_year 
	AND cte_request.id_month = cte_base.id_month
	AND cte_request.code = cte_base.code
LEFT JOIN cte_stat
	ON cte_stat.id_year = cte_base.id_year 
	AND cte_stat.id_month = cte_base.id_month
	AND cte_stat.code = cte_base.code
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month) [workers_count]
	,f.[spec_broker_payment]
	,f.[spec_dt]
	,f.[spec_new_contract]
	,f.[spec_articul]
	,f.[spec_new_articul]
	,f.[spec_product]
	,f.[spec_ts]
	,f.[spec_other_procedures]
	,f.[spec_stat_forms]
	,f.[spec_td]
	,f.[spec_request]	
	
	,estimate = ([sum_broker_payment] * [spec_broker_payment]
				+ [dt_count] * [spec_dt]
				+ [sum_new_contracts] * [spec_new_contract]
				+ ([sum_articuls] - [sum_new_articuls]) * [spec_articul]
				+ CASE
				WHEN [sum_new_articuls] &gt; 2000 THEN [sum_new_articuls] * 0.3
				WHEN [sum_new_articuls] &gt; 1000 THEN [sum_new_articuls] * 0.5
				ELSE [sum_new_articuls] END * [spec_new_articul]
				+ [sum_products] * [spec_product]
				+ [spec_ts] * [sum_transport]
				+ [spec_other_procedures] * [sum_other_procedures]
				+ [spec_stat_forms] * [all_stat]
				+ [spec_td] * [all_td]
				+ [spec_request] * [all_request])

	FROM cte_extended c
	CROSS JOIN 
	(SELECT TOP (1) * FROM [motivation].[dbo].[sto_factors] WHERE [sign] = 'specialist') AS f
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt; CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
, 0)
) worker_factor

FROM cte_calc_done c
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(id_year, id_month, 10)) AS date)"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Specialist\Reload main\Query"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                  description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                  name="Query"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Specifies the SQL statement used by the component to extract data."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2019 
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code] 
	FROM [motivation].[dbo].[sto_workers] 
	WHERE [type] = 'specialist'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [motivation].[dbo].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt; CAST(GETDATE() AS date) AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [department], [estimate_participant], COALESCE([work_days], 0) [work_days]
	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[sto_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [department], [estimate_participant] FROM [motivation].[dbo].[sto_workers] w
	WHERE w.[type] = 'specialist' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days
),

cte_dt AS (
	SELECT
	dt_year id_year,
	dt_month id_month,
	ssd.specialist_code specialist_code,
	SUM(ssd.import40) sum_import40,
	SUM(ssd.export10) sum_export10,
	SUM(ssd.other_procedures) sum_other_procedures,
	SUM(ssd.broker_payment_sign) sum_broker_payment,
	COUNT(DISTINCT ssd.customer_id) unique_customers,
	COUNT(ssd.regnum) dt_count,
	SUM(ssd.product_qty) sum_products,
	SUM(ssd.new_contract_sign) sum_new_contracts,
	SUM(ssd.dt_overall_articuls_count) sum_articuls,
	SUM(ssd.dt_new_articuls_count) sum_new_articuls,
	SUM(ssd.dt_transport_qty) sum_transport,
	SUM(ssd.dt_inv_qty) sum_invoices
	FROM [motivation].[dbo].[sto_spec_dt_details] ssd
	GROUP BY ssd.specialist_code, ssd.dt_month, ssd.dt_year
),

cte_td AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[specialist] code,
	COUNT(*) all_td
	FROM [motivation].[dbo].[sto_td_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [specialist]
),

cte_request AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[specialist] code,
	COUNT(*) all_request
	FROM [motivation].[dbo].[sto_app_before_dt_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [specialist]
),

cte_stat AS (
	SELECT 
	[stat_year] id_year
	,[stat_month] id_month
	,[specialist_code] code
	,COUNT(*) all_stat
	FROM [motivation].[dbo].[sto_stat_details]
	GROUP BY [stat_year], [stat_month], [specialist_code]
),

cte_extended AS (

SELECT 
cte_base.*
,COALESCE(cte_dt.sum_import40, 0) sum_import40
,COALESCE(cte_dt.sum_export10, 0) sum_export10
,COALESCE(cte_dt.sum_other_procedures, 0) sum_other_procedures
,COALESCE(cte_dt.sum_broker_payment, 0) sum_broker_payment
,COALESCE(cte_dt.unique_customers, 0) unique_customers
,COALESCE(cte_dt.dt_count, 0) dt_count
,COALESCE(cte_dt.sum_products, 0) sum_products
,COALESCE(cte_dt.sum_new_contracts, 0) sum_new_contracts
,COALESCE(cte_dt.sum_articuls, 0) sum_articuls
,COALESCE(cte_dt.sum_new_articuls, 0) sum_new_articuls
,COALESCE(cte_dt.sum_transport, 0) sum_transport
,COALESCE(cte_dt.sum_invoices, 0) sum_invoices
,COALESCE(cte_td.all_td, 0) all_td
,COALESCE(cte_request.all_request, 0) all_request
,COALESCE(cte_stat.all_stat, 0) all_stat

FROM cte_base
LEFT JOIN cte_dt 
	ON cte_dt.id_year = cte_base.id_year 
	AND cte_dt.id_month = cte_base.id_month
	AND cte_dt.specialist_code = cte_base.code
LEFT JOIN cte_td
	ON cte_td.id_year = cte_base.id_year 
	AND cte_td.id_month = cte_base.id_month
	AND cte_td.code = cte_base.code
LEFT JOIN cte_request
	ON cte_request.id_year = cte_base.id_year 
	AND cte_request.id_month = cte_base.id_month
	AND cte_request.code = cte_base.code
LEFT JOIN cte_stat
	ON cte_stat.id_year = cte_base.id_year 
	AND cte_stat.id_month = cte_base.id_month
	AND cte_stat.code = cte_base.code
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month) [workers_count]
	,f.[spec_broker_payment]
	,f.[spec_dt]
	,f.[spec_new_contract]
	,f.[spec_articul]
	,f.[spec_new_articul]
	,f.[spec_product]
	,f.[spec_ts]
	,f.[spec_other_procedures]
	,f.[spec_stat_forms]
	,f.[spec_td]
	,f.[spec_request]	
	
	,estimate = ([sum_broker_payment] * [spec_broker_payment]
				+ [dt_count] * [spec_dt]
				+ [sum_new_contracts] * [spec_new_contract]
				+ ([sum_articuls] - [sum_new_articuls]) * [spec_articul]
				+ CASE
				WHEN [sum_new_articuls] &gt; 2000 THEN [sum_new_articuls] * 0.3
				WHEN [sum_new_articuls] &gt; 1000 THEN [sum_new_articuls] * 0.5
				ELSE [sum_new_articuls] END * [spec_new_articul]
				+ [sum_products] * [spec_product]
				+ [spec_ts] * [sum_transport]
				+ [spec_other_procedures] * [sum_other_procedures]
				+ [spec_stat_forms] * [all_stat]
				+ [spec_td] * [all_td]
				+ [spec_request] * [all_request])

	FROM cte_extended c
	CROSS JOIN 
	(SELECT TOP (1) * FROM [motivation].[dbo].[sto_factors] WHERE [sign] = 'specialist') AS f
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt; CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
, 0)
) worker_factor

FROM cte_calc_done c
WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(id_year, id_month, 10)) AS date)</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="The Source database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Specify the mode to retrieve external column information"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload main\Query.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output]"
                      name="ADO NET Source Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                          name="id_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                          name="id_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                          name="work_days_in_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                          length="300"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                          name="name"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                          length="100"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                          name="code"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                          length="300"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]"
                          name="department"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                          name="estimate_participant"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                          name="work_days"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_import40]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]"
                          name="sum_import40"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_export10]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]"
                          name="sum_export10"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_other_procedures]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]"
                          name="sum_other_procedures"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_broker_payment]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_broker_payment]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_broker_payment]"
                          name="sum_broker_payment"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[unique_customers]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[unique_customers]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[unique_customers]"
                          name="unique_customers"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[dt_count]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_count]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[dt_count]"
                          name="dt_count"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_products]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]"
                          name="sum_products"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_contracts]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_new_contracts]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_contracts]"
                          name="sum_new_contracts"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_articuls]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]"
                          name="sum_articuls"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_articuls]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_new_articuls]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_articuls]"
                          name="sum_new_articuls"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_transport]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_transport]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_transport]"
                          name="sum_transport"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_invoices]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_invoices]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_invoices]"
                          name="sum_invoices"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_td]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]"
                          name="all_td"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_request]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]"
                          name="all_request"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_stat]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_stat]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_stat]"
                          name="all_stat"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                          name="workers_count"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_broker_payment]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_broker_payment]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_broker_payment]"
                          name="spec_broker_payment"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_dt]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_dt]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_dt]"
                          name="spec_dt"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_contract]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_new_contract]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_contract]"
                          name="spec_new_contract"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_articul]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_articul]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_articul]"
                          name="spec_articul"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_articul]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_new_articul]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_articul]"
                          name="spec_new_articul"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_product]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_product]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_product]"
                          name="spec_product"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_ts]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_ts]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_ts]"
                          name="spec_ts"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_other_procedures]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_other_procedures]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_other_procedures]"
                          name="spec_other_procedures"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_stat_forms]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_stat_forms]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_stat_forms]"
                          name="spec_stat_forms"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_td]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_td]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_td]"
                          name="spec_td"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_request]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_request]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_request]"
                          name="spec_request"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                          name="estimate"
                          precision="38"
                          scale="3"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                          name="overall_estimate"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                          name="average_group_estimate"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                          dataType="numeric"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                          name="worker_factor"
                          precision="18"
                          scale="2"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                          dataType="i4"
                          name="id_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                          dataType="i4"
                          name="id_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                          dataType="i4"
                          name="work_days_in_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                          dataType="wstr"
                          length="300"
                          name="name" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                          dataType="wstr"
                          length="100"
                          name="code" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                          dataType="wstr"
                          length="300"
                          name="department" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                          dataType="i4"
                          name="estimate_participant" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                          dataType="i4"
                          name="work_days" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_import40]"
                          dataType="i4"
                          name="sum_import40" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_export10]"
                          dataType="i4"
                          name="sum_export10" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_other_procedures]"
                          dataType="i4"
                          name="sum_other_procedures" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_broker_payment]"
                          dataType="i4"
                          name="sum_broker_payment" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[unique_customers]"
                          dataType="i4"
                          name="unique_customers" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_count]"
                          dataType="i4"
                          name="dt_count" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_products]"
                          dataType="i4"
                          name="sum_products" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_new_contracts]"
                          dataType="i4"
                          name="sum_new_contracts" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_articuls]"
                          dataType="i4"
                          name="sum_articuls" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_new_articuls]"
                          dataType="i4"
                          name="sum_new_articuls" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_transport]"
                          dataType="i4"
                          name="sum_transport" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_invoices]"
                          dataType="i4"
                          name="sum_invoices" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_td]"
                          dataType="i4"
                          name="all_td" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_request]"
                          dataType="i4"
                          name="all_request" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_stat]"
                          dataType="i4"
                          name="all_stat" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                          dataType="i4"
                          name="workers_count" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_broker_payment]"
                          dataType="numeric"
                          name="spec_broker_payment"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_dt]"
                          dataType="numeric"
                          name="spec_dt"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_new_contract]"
                          dataType="numeric"
                          name="spec_new_contract"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_articul]"
                          dataType="numeric"
                          name="spec_articul"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_new_articul]"
                          dataType="numeric"
                          name="spec_new_articul"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_product]"
                          dataType="numeric"
                          name="spec_product"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_ts]"
                          dataType="numeric"
                          name="spec_ts"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_other_procedures]"
                          dataType="numeric"
                          name="spec_other_procedures"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_stat_forms]"
                          dataType="numeric"
                          name="spec_stat_forms"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_td]"
                          dataType="numeric"
                          name="spec_td"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_request]"
                          dataType="numeric"
                          name="spec_request"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                          dataType="numeric"
                          name="estimate"
                          precision="38"
                          scale="3" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                          dataType="numeric"
                          name="overall_estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                          dataType="numeric"
                          name="average_group_estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                          dataType="numeric"
                          name="worker_factor"
                          precision="18"
                          scale="2" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output]"
                      isErrorOut="true"
                      name="ADO NET Source Error Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                          name="id_year" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                          name="id_month" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                          name="work_days_in_month" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                          dataType="wstr"
                          length="300"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                          name="name" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                          dataType="wstr"
                          length="100"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                          name="code" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                          dataType="wstr"
                          length="300"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                          name="department" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                          name="estimate_participant" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                          name="work_days" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_import40]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_import40]"
                          name="sum_import40" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_export10]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_export10]"
                          name="sum_export10" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_other_procedures]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_other_procedures]"
                          name="sum_other_procedures" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_broker_payment]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_broker_payment]"
                          name="sum_broker_payment" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[unique_customers]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[unique_customers]"
                          name="unique_customers" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[dt_count]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[dt_count]"
                          name="dt_count" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_products]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_products]"
                          name="sum_products" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_new_contracts]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_new_contracts]"
                          name="sum_new_contracts" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_articuls]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_articuls]"
                          name="sum_articuls" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_new_articuls]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_new_articuls]"
                          name="sum_new_articuls" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_transport]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_transport]"
                          name="sum_transport" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_invoices]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_invoices]"
                          name="sum_invoices" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_td]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_td]"
                          name="all_td" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_request]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_request]"
                          name="all_request" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_stat]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_stat]"
                          name="all_stat" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                          name="workers_count" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_broker_payment]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_broker_payment]"
                          name="spec_broker_payment"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_dt]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_dt]"
                          name="spec_dt"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_new_contract]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_new_contract]"
                          name="spec_new_contract"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_articul]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_articul]"
                          name="spec_articul"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_new_articul]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_new_articul]"
                          name="spec_new_articul"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_product]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_product]"
                          name="spec_product"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_ts]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_ts]"
                          name="spec_ts"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_other_procedures]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_other_procedures]"
                          name="spec_other_procedures"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_stat_forms]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_stat_forms]"
                          name="spec_stat_forms"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_td]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_td]"
                          name="spec_td"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_request]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_request]"
                          name="spec_request"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                          name="estimate"
                          precision="38"
                          scale="3" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                          name="overall_estimate"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                          name="average_group_estimate"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                          dataType="numeric"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                          name="worker_factor"
                          precision="18"
                          scale="2" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Specialist\Reload main\Table"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                  description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                  name="Table"
                  usesDispositions="true"
                  version="2">
                  <properties>
                    <property
                      dataType="System.String"
                      description="The Destination database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_specialist_main</property>
                    <property
                      dataType="System.Int32"
                      description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                      expressionType="Notify"
                      name="BatchSize">0</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                      expressionType="Notify"
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                      expressionType="Notify"
                      name="UseBulkInsertWhenPossible">true</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload main\Table.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input]"
                      errorRowDisposition="FailComponent"
                      hasSideEffects="true"
                      name="ADO NET Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_year]"
                          cachedDataType="i4"
                          cachedName="id_year"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_month]"
                          cachedDataType="i4"
                          cachedName="id_month"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days_in_month]"
                          cachedDataType="i4"
                          cachedName="work_days_in_month"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[name]"
                          cachedDataType="wstr"
                          cachedLength="300"
                          cachedName="name"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[code]"
                          cachedDataType="wstr"
                          cachedLength="100"
                          cachedName="code"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[department]"
                          cachedDataType="wstr"
                          cachedLength="300"
                          cachedName="department"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate_participant]"
                          cachedDataType="i4"
                          cachedName="estimate_participant"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days]"
                          cachedDataType="i4"
                          cachedName="work_days"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_import40]"
                          cachedDataType="i4"
                          cachedName="sum_import40"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_import40]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_export10]"
                          cachedDataType="i4"
                          cachedName="sum_export10"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_export10]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_other_procedures]"
                          cachedDataType="i4"
                          cachedName="sum_other_procedures"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_other_procedures]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_broker_payment]"
                          cachedDataType="i4"
                          cachedName="sum_broker_payment"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_broker_payment]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_broker_payment]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[unique_customers]"
                          cachedDataType="i4"
                          cachedName="unique_customers"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[unique_customers]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[unique_customers]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[dt_count]"
                          cachedDataType="i4"
                          cachedName="dt_count"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_count]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[dt_count]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_products]"
                          cachedDataType="i4"
                          cachedName="sum_products"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_products]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_new_contracts]"
                          cachedDataType="i4"
                          cachedName="sum_new_contracts"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_new_contracts]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_contracts]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_articuls]"
                          cachedDataType="i4"
                          cachedName="sum_articuls"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_articuls]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_new_articuls]"
                          cachedDataType="i4"
                          cachedName="sum_new_articuls"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_new_articuls]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_articuls]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_transport]"
                          cachedDataType="i4"
                          cachedName="sum_transport"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_transport]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_transport]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_invoices]"
                          cachedDataType="i4"
                          cachedName="sum_invoices"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_invoices]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_invoices]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_td]"
                          cachedDataType="i4"
                          cachedName="all_td"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_td]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_request]"
                          cachedDataType="i4"
                          cachedName="all_request"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_request]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_stat]"
                          cachedDataType="i4"
                          cachedName="all_stat"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_stat]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_stat]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[workers_count]"
                          cachedDataType="i4"
                          cachedName="workers_count"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_broker_payment]"
                          cachedDataType="numeric"
                          cachedName="spec_broker_payment"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_broker_payment]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_broker_payment]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_dt]"
                          cachedDataType="numeric"
                          cachedName="spec_dt"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_dt]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_dt]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_new_contract]"
                          cachedDataType="numeric"
                          cachedName="spec_new_contract"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_new_contract]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_contract]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_articul]"
                          cachedDataType="numeric"
                          cachedName="spec_articul"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_articul]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_articul]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_new_articul]"
                          cachedDataType="numeric"
                          cachedName="spec_new_articul"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_new_articul]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_articul]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_product]"
                          cachedDataType="numeric"
                          cachedName="spec_product"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_product]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_product]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_ts]"
                          cachedDataType="numeric"
                          cachedName="spec_ts"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_ts]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_ts]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_other_procedures]"
                          cachedDataType="numeric"
                          cachedName="spec_other_procedures"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_other_procedures]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_other_procedures]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_stat_forms]"
                          cachedDataType="numeric"
                          cachedName="spec_stat_forms"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_stat_forms]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_stat_forms]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_td]"
                          cachedDataType="numeric"
                          cachedName="spec_td"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_td]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_td]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_request]"
                          cachedDataType="numeric"
                          cachedName="spec_request"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_request]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_request]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate]"
                          cachedDataType="numeric"
                          cachedName="estimate"
                          cachedPrecision="38"
                          cachedScale="3"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[overall_estimate]"
                          cachedDataType="numeric"
                          cachedName="overall_estimate"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[average_group_estimate]"
                          cachedDataType="numeric"
                          cachedName="average_group_estimate"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]" />
                        <inputColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[worker_factor]"
                          cachedDataType="numeric"
                          cachedName="worker_factor"
                          cachedPrecision="18"
                          cachedScale="2"
                          externalMetadataColumnId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                          lineageId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                          dataType="i4"
                          name="id_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                          dataType="i4"
                          name="id_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                          dataType="i4"
                          name="work_days_in_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                          dataType="wstr"
                          length="300"
                          name="name" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                          dataType="wstr"
                          length="100"
                          name="code" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                          dataType="wstr"
                          length="300"
                          name="department" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                          dataType="i4"
                          name="estimate_participant" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                          dataType="i4"
                          name="work_days" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_import40]"
                          dataType="i4"
                          name="sum_import40" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_export10]"
                          dataType="i4"
                          name="sum_export10" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_other_procedures]"
                          dataType="i4"
                          name="sum_other_procedures" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_broker_payment]"
                          dataType="i4"
                          name="sum_broker_payment" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[unique_customers]"
                          dataType="i4"
                          name="unique_customers" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_count]"
                          dataType="i4"
                          name="dt_count" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_products]"
                          dataType="i4"
                          name="sum_products" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_new_contracts]"
                          dataType="i4"
                          name="sum_new_contracts" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_articuls]"
                          dataType="i4"
                          name="sum_articuls" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_new_articuls]"
                          dataType="i4"
                          name="sum_new_articuls" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_transport]"
                          dataType="i4"
                          name="sum_transport" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_invoices]"
                          dataType="i4"
                          name="sum_invoices" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_td]"
                          dataType="i4"
                          name="all_td" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_request]"
                          dataType="i4"
                          name="all_request" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_stat]"
                          dataType="i4"
                          name="all_stat" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                          dataType="i4"
                          name="workers_count" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_broker_payment]"
                          dataType="numeric"
                          name="spec_broker_payment"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_dt]"
                          dataType="numeric"
                          name="spec_dt"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_new_contract]"
                          dataType="numeric"
                          name="spec_new_contract"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_articul]"
                          dataType="numeric"
                          name="spec_articul"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_new_articul]"
                          dataType="numeric"
                          name="spec_new_articul"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_product]"
                          dataType="numeric"
                          name="spec_product"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_ts]"
                          dataType="numeric"
                          name="spec_ts"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_other_procedures]"
                          dataType="numeric"
                          name="spec_other_procedures"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_stat_forms]"
                          dataType="numeric"
                          name="spec_stat_forms"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_td]"
                          dataType="numeric"
                          name="spec_td"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_request]"
                          dataType="numeric"
                          name="spec_request"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                          dataType="numeric"
                          name="estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                          dataType="numeric"
                          name="overall_estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                          dataType="numeric"
                          name="average_group_estimate"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                          dataType="numeric"
                          name="worker_factor"
                          precision="18"
                          scale="2" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[role_type]"
                          dataType="wstr"
                          length="50"
                          name="role_type" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output]"
                      exclusionGroup="1"
                      isErrorOut="true"
                      name="ADO NET Destination Error Output"
                      synchronousInputId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input]">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Specialist\Reload main.Paths[ADO NET Source Output]"
                  endId="Package\Specialist\Reload main\Table.Inputs[ADO NET Destination Input]"
                  name="ADO NET Source Output"
                  startId="Package\Specialist\Reload main\Query.Outputs[ADO NET Source Output]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Specialist\Reload stat details"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Задача потока данных"
          DTS:DTSID="{00C96574-552F-4A5F-8ED2-584A5A5FD45B}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload stat details"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Query].[SqlCommand]">"SELECT 
YYYY stat_year,
MM stat_month,
DeliveryNo_ delivery_number,
DeclarationNo_ stat_number,
sp.SalespersonCode specialist_code
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] sp ON sp.SalespersonKey = d.DeclarantKey
WHERE [isDeclaration] = 1 AND [DTCountStatisticalForms] = 1
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(YYYY, MM, 10)) AS date)"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Specialist\Reload stat details\Query"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                  description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                  name="Query"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Specifies the SQL statement used by the component to extract data."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT 
YYYY stat_year,
MM stat_month,
DeliveryNo_ delivery_number,
DeclarationNo_ stat_number,
sp.SalespersonCode specialist_code
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] sp ON sp.SalespersonKey = d.DeclarantKey
WHERE [isDeclaration] = 1 AND [DTCountStatisticalForms] = 1
AND CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(YYYY, MM, 10)) AS date)</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="The Source database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Specify the mode to retrieve external column information"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload stat details\Query.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output]"
                      name="ADO NET Source Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_year]"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_year]"
                          name="stat_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_month]"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_month]"
                          name="stat_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                          length="20"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                          name="delivery_number"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_number]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_number]"
                          length="30"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_number]"
                          name="stat_number"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist_code]"
                          length="20"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]"
                          name="specialist_code"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_year]"
                          dataType="i4"
                          name="stat_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_month]"
                          dataType="i4"
                          name="stat_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                          dataType="wstr"
                          length="20"
                          name="delivery_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_number]"
                          dataType="wstr"
                          length="30"
                          name="stat_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist_code]"
                          dataType="wstr"
                          length="20"
                          name="specialist_code" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output]"
                      isErrorOut="true"
                      name="ADO NET Source Error Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_year]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_year]"
                          name="stat_year" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_month]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_month]"
                          name="stat_month" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                          name="delivery_number" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_number]"
                          dataType="wstr"
                          length="30"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_number]"
                          name="stat_number" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[specialist_code]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[specialist_code]"
                          name="specialist_code" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Specialist\Reload stat details\Table"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                  description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                  name="Table"
                  usesDispositions="true"
                  version="2">
                  <properties>
                    <property
                      dataType="System.String"
                      description="The Destination database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_stat_details</property>
                    <property
                      dataType="System.Int32"
                      description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                      expressionType="Notify"
                      name="BatchSize">0</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                      expressionType="Notify"
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                      expressionType="Notify"
                      name="UseBulkInsertWhenPossible">true</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload stat details\Table.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input]"
                      errorRowDisposition="FailComponent"
                      hasSideEffects="true"
                      name="ADO NET Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[stat_year]"
                          cachedDataType="i4"
                          cachedName="stat_year"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_year]"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_year]" />
                        <inputColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[stat_month]"
                          cachedDataType="i4"
                          cachedName="stat_month"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_month]"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_month]" />
                        <inputColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[delivery_number]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="delivery_number"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]" />
                        <inputColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[stat_number]"
                          cachedDataType="wstr"
                          cachedLength="30"
                          cachedName="stat_number"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_number]"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_number]" />
                        <inputColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[specialist_code]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="specialist_code"
                          externalMetadataColumnId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist_code]"
                          lineageId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_year]"
                          dataType="i4"
                          name="stat_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_month]"
                          dataType="i4"
                          name="stat_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                          dataType="wstr"
                          length="20"
                          name="delivery_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_number]"
                          dataType="wstr"
                          length="30"
                          name="stat_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist_code]"
                          dataType="wstr"
                          length="20"
                          name="specialist_code" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output]"
                      exclusionGroup="1"
                      isErrorOut="true"
                      name="ADO NET Destination Error Output"
                      synchronousInputId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input]">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Specialist\Reload stat details.Paths[ADO NET Source Output]"
                  endId="Package\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input]"
                  name="ADO NET Source Output"
                  startId="Package\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Specialist\Reload TD details"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Задача потока данных"
          DTS:DTSID="{97E9B588-C7BF-46EE-9EB6-BABAD931E5EB}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reload TD details"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="[Query].[SqlCommand]">"SELECT 
  ca.[Declarant Code] specialist
  ,td.[7_1] alta_number
  ,td.[TD_TYPE] td_type
  ,td.delivery_number
  ,ed_reg.reg_num
  ,ed_reg.reg_datetime
  ,ed_reg.reg_year
  ,ed_reg.reg_month  
  ,ed_release.release_datetime
  ,ed_release.release_year
  ,ed_release.release_month
  ,ed_closure.closure_datetime
  ,ed_closure.closure_year
  ,ed_closure.closure_month  
  ,oa.declarant_code

  FROM (SELECT t.[7_1], 
		t.DOCGID, 
		t.[TD_TYPE], 
		functions.dbo.GetDeliveryNumber(t.[&amp;&amp;PRIM]) delivery_number 
		FROM [gtd].[dbo].[TD1List] t 
		WHERE [TD_TYPE] IN ('ТД','ПТД') AND t.[&amp;&amp;PRIM] LIKE '%D[0-9][0-9][0-9][0-9][0-9][0-9]%'	
		) AS td  
  
  LEFT JOIN [gtd].[dbo].[Docs] d ON d.GID = td.DOCGID
  
  LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) reg_year
	,MONTH([InOutDateTime]) reg_month
	,[InOutDateTime] reg_datetime
	,[Result] reg_num
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.15005' AND [Incoming] = 1) AS ed_reg ON td.docgid = ed_reg.gid AND ed_reg.row_num = 1
  
    LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) release_year
	,MONTH([InOutDateTime]) release_month
	,[InOutDateTime] release_datetime
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.15007' AND [Incoming] = 1) AS ed_release ON td.docgid = ed_release.gid AND ed_release.row_num = 1
  
    LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) closure_year
	,MONTH([InOutDateTime]) closure_month
	,[InOutDateTime] closure_datetime
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.15016' AND [Incoming] = 1) AS ed_closure ON td.docgid = ed_closure.gid AND ed_closure.row_num = 1
  
	CROSS APPLY (SELECT TOP (1) sd.[Declarant Code] FROM [BI].[dwh].[ETP$SQL_Delivery] sd 
				 WHERE sd.[No_] = td.delivery_number) AS ca

	OUTER APPLY (SELECT TOP (1) [SalespersonCode] declarant_code 
				FROM [BI].[dwh].[vDimDeclarant] dd
				WHERE UPPER(LTRIM(RTRIM(dd.USERNAME)))= UPPER(LTRIM(RTRIM(d.EDSENDER)))
				) AS oa

	WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, " + (DT_WSTR, 2) @[User::depth_months] + ", DATEFROMPARTS(release_year, release_month, 10)) AS date)"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Specialist\Reload TD details\Query"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                  description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                  name="Query"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Specifies the SQL statement used by the component to extract data."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT 
  ca.[Declarant Code] specialist
  ,td.[7_1] alta_number
  ,td.[TD_TYPE] td_type
  ,td.delivery_number
  ,ed_reg.reg_num
  ,ed_reg.reg_datetime
  ,ed_reg.reg_year
  ,ed_reg.reg_month  
  ,ed_release.release_datetime
  ,ed_release.release_year
  ,ed_release.release_month
  ,ed_closure.closure_datetime
  ,ed_closure.closure_year
  ,ed_closure.closure_month  
  ,oa.declarant_code

  FROM (SELECT t.[7_1], 
		t.DOCGID, 
		t.[TD_TYPE], 
		functions.dbo.GetDeliveryNumber(t.[&amp;&amp;PRIM]) delivery_number 
		FROM [gtd].[dbo].[TD1List] t 
		WHERE [TD_TYPE] IN ('ТД','ПТД') AND t.[&amp;&amp;PRIM] LIKE '%D[0-9][0-9][0-9][0-9][0-9][0-9]%'	
		) AS td  
  
  LEFT JOIN [gtd].[dbo].[Docs] d ON d.GID = td.DOCGID
  
  LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) reg_year
	,MONTH([InOutDateTime]) reg_month
	,[InOutDateTime] reg_datetime
	,[Result] reg_num
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.15005' AND [Incoming] = 1) AS ed_reg ON td.docgid = ed_reg.gid AND ed_reg.row_num = 1
  
    LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) release_year
	,MONTH([InOutDateTime]) release_month
	,[InOutDateTime] release_datetime
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.15007' AND [Incoming] = 1) AS ed_release ON td.docgid = ed_release.gid AND ed_release.row_num = 1
  
    LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) closure_year
	,MONTH([InOutDateTime]) closure_month
	,[InOutDateTime] closure_datetime
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.15016' AND [Incoming] = 1) AS ed_closure ON td.docgid = ed_closure.gid AND ed_closure.row_num = 1
  
	CROSS APPLY (SELECT TOP (1) sd.[Declarant Code] FROM [BI].[dwh].[ETP$SQL_Delivery] sd 
				 WHERE sd.[No_] = td.delivery_number) AS ca

	OUTER APPLY (SELECT TOP (1) [SalespersonCode] declarant_code 
				FROM [BI].[dwh].[vDimDeclarant] dd
				WHERE UPPER(LTRIM(RTRIM(dd.USERNAME)))= UPPER(LTRIM(RTRIM(d.EDSENDER)))
				) AS oa

	WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, 1, DATEFROMPARTS(release_year, release_month, 10)) AS date)</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="The Source database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Specify the mode to retrieve external column information"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload TD details\Query.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output]"
                      name="ADO NET Source Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                          length="10"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                          name="specialist"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[alta_number]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[alta_number]"
                          length="23"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[alta_number]"
                          name="alta_number"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[td_type]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[td_type]"
                          length="4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[td_type]"
                          name="td_type"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                          dataType="nText"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                          name="delivery_number"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_num]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_num]"
                          length="250"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_num]"
                          name="reg_num"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]"
                          dataType="dbTimeStamp"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_datetime]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]"
                          name="reg_datetime"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_year]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_year]"
                          name="reg_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_month]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_month]"
                          name="reg_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]"
                          dataType="dbTimeStamp"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_datetime]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]"
                          name="release_datetime"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_year]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_year]"
                          name="release_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_month]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_month]"
                          name="release_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_datetime]"
                          dataType="dbTimeStamp"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_datetime]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_datetime]"
                          name="closure_datetime"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_year]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_year]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_year]"
                          name="closure_year"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_month]"
                          dataType="i4"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_month]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_month]"
                          name="closure_month"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                          dataType="wstr"
                          errorOrTruncationOperation="Conversion"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                          length="20"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                          name="declarant_code"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                          dataType="wstr"
                          length="10"
                          name="specialist" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[alta_number]"
                          dataType="wstr"
                          length="23"
                          name="alta_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[td_type]"
                          dataType="wstr"
                          length="4"
                          name="td_type" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                          dataType="nText"
                          name="delivery_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_num]"
                          dataType="wstr"
                          length="250"
                          name="reg_num" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_datetime]"
                          dataType="dbTimeStamp"
                          name="reg_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_year]"
                          dataType="i4"
                          name="reg_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_month]"
                          dataType="i4"
                          name="reg_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_datetime]"
                          dataType="dbTimeStamp"
                          name="release_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_year]"
                          dataType="i4"
                          name="release_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_month]"
                          dataType="i4"
                          name="release_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_datetime]"
                          dataType="dbTimeStamp"
                          name="closure_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_year]"
                          dataType="i4"
                          name="closure_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_month]"
                          dataType="i4"
                          name="closure_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          name="declarant_code" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output]"
                      isErrorOut="true"
                      name="ADO NET Source Error Output">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                          dataType="wstr"
                          length="10"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                          name="specialist" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[alta_number]"
                          dataType="wstr"
                          length="23"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[alta_number]"
                          name="alta_number" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[td_type]"
                          dataType="wstr"
                          length="4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[td_type]"
                          name="td_type" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                          dataType="nText"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                          name="delivery_number" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_num]"
                          dataType="wstr"
                          length="250"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_num]"
                          name="reg_num" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_datetime]"
                          dataType="dbTimeStamp"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_datetime]"
                          name="reg_datetime" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_year]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_year]"
                          name="reg_year" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_month]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_month]"
                          name="reg_month" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_datetime]"
                          dataType="dbTimeStamp"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_datetime]"
                          name="release_datetime" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_year]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_year]"
                          name="release_year" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_month]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_month]"
                          name="release_month" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_datetime]"
                          dataType="dbTimeStamp"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_datetime]"
                          name="closure_datetime" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_year]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_year]"
                          name="closure_year" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_month]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_month]"
                          name="closure_month" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                          name="declarant_code" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Specialist\Reload TD details\Table"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                  description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                  name="Table"
                  usesDispositions="true"
                  version="2">
                  <properties>
                    <property
                      dataType="System.String"
                      description="The Destination database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_td_details</property>
                    <property
                      dataType="System.Int32"
                      description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                      expressionType="Notify"
                      name="BatchSize">0</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                      expressionType="Notify"
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                      expressionType="Notify"
                      name="UseBulkInsertWhenPossible">true</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Specialist\Reload TD details\Table.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input]"
                      errorRowDisposition="FailComponent"
                      hasSideEffects="true"
                      name="ADO NET Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[specialist]"
                          cachedDataType="wstr"
                          cachedLength="10"
                          cachedName="specialist"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[specialist]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[alta_number]"
                          cachedDataType="wstr"
                          cachedLength="23"
                          cachedName="alta_number"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[alta_number]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[alta_number]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[td_type]"
                          cachedDataType="wstr"
                          cachedLength="4"
                          cachedName="td_type"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[td_type]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[td_type]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[delivery_number]"
                          cachedDataType="nText"
                          cachedName="delivery_number"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[reg_num]"
                          cachedDataType="wstr"
                          cachedLength="250"
                          cachedName="reg_num"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_num]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_num]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[reg_datetime]"
                          cachedDataType="dbTimeStamp"
                          cachedName="reg_datetime"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_datetime]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[reg_year]"
                          cachedDataType="i4"
                          cachedName="reg_year"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_year]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_year]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[reg_month]"
                          cachedDataType="i4"
                          cachedName="reg_month"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_month]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_month]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[release_datetime]"
                          cachedDataType="dbTimeStamp"
                          cachedName="release_datetime"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_datetime]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[release_year]"
                          cachedDataType="i4"
                          cachedName="release_year"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_year]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_year]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[release_month]"
                          cachedDataType="i4"
                          cachedName="release_month"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_month]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_month]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[closure_datetime]"
                          cachedDataType="dbTimeStamp"
                          cachedName="closure_datetime"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_datetime]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_datetime]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[closure_year]"
                          cachedDataType="i4"
                          cachedName="closure_year"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_year]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_year]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[closure_month]"
                          cachedDataType="i4"
                          cachedName="closure_month"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_month]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_month]" />
                        <inputColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[declarant_code]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="declarant_code"
                          externalMetadataColumnId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                          lineageId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[alta_number]"
                          dataType="wstr"
                          length="23"
                          name="alta_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[td_type]"
                          dataType="wstr"
                          length="4"
                          name="td_type" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                          dataType="wstr"
                          length="2147483647"
                          name="delivery_number" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_num]"
                          dataType="wstr"
                          length="250"
                          name="reg_num" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_datetime]"
                          dataType="dbTimeStamp"
                          name="reg_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_year]"
                          dataType="i4"
                          name="reg_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_month]"
                          dataType="i4"
                          name="reg_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_datetime]"
                          dataType="dbTimeStamp"
                          name="release_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_year]"
                          dataType="i4"
                          name="release_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_month]"
                          dataType="i4"
                          name="release_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_datetime]"
                          dataType="dbTimeStamp"
                          name="closure_datetime" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_year]"
                          dataType="i4"
                          name="closure_year" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_month]"
                          dataType="i4"
                          name="closure_month" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                          dataType="wstr"
                          length="50"
                          name="specialist" />
                        <externalMetadataColumn
                          refId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                          dataType="wstr"
                          length="30"
                          name="declarant_code" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                  <outputs>
                    <output
                      refId="Package\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output]"
                      exclusionGroup="1"
                      isErrorOut="true"
                      name="ADO NET Destination Error Output"
                      synchronousInputId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input]">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Specialist\Reload TD details.Paths[ADO NET Source Output]"
                  endId="Package\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input]"
                  name="ADO NET Source Output"
                  startId="Package\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Specialist\Timesheet merge"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{8CE038F0-21B8-4550-BA46-D06FEBB96368}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Timesheet merge"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="MERGE [motivation].[dbo].[timesheet] AS targ&#xA;USING [BI].[etl].[TimeSheet] AS src      &#xA;ON (targ.[Person_number] = src.[Person_number] AND &#xA;targ.[Person] = src.[Person] AND &#xA;targ.[Date] = src.[Date])  &#x9;&#xA;WHEN MATCHED &#xA;AND targ.[Letter_code] &lt;&gt; src.[Letter_code] &#xA;AND targ.[manual_sign] = 0&#xA;--при ручном редактировании по сотруднику в течение месяца далее не перенакатываем&#xA;AND NOT EXISTS (SELECT 0 FROM [motivation].[dbo].[timesheet] t &#xA;WHERE t.[manual_sign] = 1 &#xA;AND t.[Person] = targ.[Person]&#xA;AND MONTH(targ.[Date]) = MONTH(t.[Date]))    &#xA;&#x9;THEN UPDATE SET targ.[Letter_code] = src.[Letter_code]&#xA;WHEN NOT MATCHED BY TARGET AND src.[Date] &gt;= '2019-01-01 00:00:00.000'&#xA;&#x9;THEN INSERT&#xA;&#x9;&#x9;&#x9;  ([Base_name]&#xA;&#x9;&#x9;&#x9;  ,[Person_number]&#xA;&#x9;&#x9;&#x9;  ,[Person]&#xA;&#x9;&#x9;&#x9;  ,[Time_view]&#xA;&#x9;&#x9;&#x9;  ,[Letter_code]&#xA;&#x9;&#x9;&#x9;  ,[Date]&#xA;&#x9;&#x9;&#x9;  ,[Day]&#xA;&#x9;&#x9;&#x9;  ,[Value]&#xA;&#x9;&#x9;&#x9;  ,[position]&#xA;&#x9;&#x9;&#x9;  ,[Department]&#xA;&#x9;&#x9;&#x9;  ,[manual_sign])&#xA;&#x9;   VALUES (src.[Base_name]&#xA;&#x9;&#x9;&#x9;  ,src.[Person_number]&#xA;&#x9;&#x9;&#x9;  ,src.[Person]&#xA;&#x9;&#x9;&#x9;  ,src.[Time_view]&#xA;&#x9;&#x9;&#x9;  ,src.[Letter_code]&#xA;&#x9;&#x9;&#x9;  ,src.[Date]&#xA;&#x9;&#x9;&#x9;  ,src.[Day]&#xA;&#x9;&#x9;&#x9;  ,src.[Value]&#xA;&#x9;&#x9;&#x9;  ,src.[position]&#xA;&#x9;&#x9;&#x9;  ,src.[Department]&#xA;&#x9;&#x9;&#x9;  ,DEFAULT);" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Specialist\Truncate"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{CD32C1C0-ADD8-460C-BC1E-62AA40FA4FEB}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Truncate"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="DELETE FROM [motivation].[dbo].[sto_td_details]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(release_year, release_month, 10)) AS date)&#xA;DELETE FROM [motivation].[dbo].[sto_app_before_dt_details]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(release_year, release_month, 10)) AS date)&#xA;DELETE FROM [motivation].[dbo].[sto_stat_details]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(stat_year, stat_month, 10)) AS date)&#xA;DELETE FROM [motivation].[dbo].[sto_spec_dt_details]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(dt_year, dt_month, 10)) AS date)&#xA;DELETE FROM [motivation].[dbo].[sto_specialist_main]&#xA;WHERE CAST(GETDATE() AS date) &lt; CAST(DATEADD(month, ?, DATEFROMPARTS(id_year, id_month, 10)) AS date)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::depth_months"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::depth_months"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::depth_months"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="User::depth_months"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="4"
                SQLTask:DtsVariableName="User::depth_months"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Specialist\Update role_type"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{9277826C-BEFF-4C77-9E1F-DCE8CFAEDEAF}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Update role_type"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="UPDATE main&#xA;SET role_type = CASE oa.role_type WHEN 1 THEN 'Основная' ELSE 'Дополнительная' END&#xA;FROM [motivation].[dbo].[sto_specialist_main] AS main&#xA;OUTER APPLY (SELECT TOP (1) role_type&#xA;FROM [motivation].[dbo].[sto_workers] AS w&#xA;WHERE main.code = w.code AND w.type = 'specialist'&#xA;AND DATEFROMPARTS(main.id_year, main.id_month, 15) BETWEEN w.date_begin AND w.date_end) AS oa" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение]"
          DTS:CreationName=""
          DTS:DTSID="{BFF74C53-6078-4E26-A749-13943F63EB45}"
          DTS:From="Package\Specialist\Truncate"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение"
          DTS:To="Package\Specialist\Reload TD details" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 1]"
          DTS:CreationName=""
          DTS:DTSID="{CD511111-5F6D-4796-8568-07AD6C1E9FB6}"
          DTS:From="Package\Specialist\Truncate"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 1"
          DTS:To="Package\Specialist\Reload apps before DT details" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 10]"
          DTS:CreationName=""
          DTS:DTSID="{56292075-C18D-429A-BC75-723CD468552C}"
          DTS:From="Package\Specialist\Reload main"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 10"
          DTS:To="Package\Specialist\Update role_type" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 11]"
          DTS:CreationName=""
          DTS:DTSID="{EB9D0B5B-25C3-47FA-8128-6330F4EFA6B8}"
          DTS:From="Package\Specialist\Reload add roles"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 11"
          DTS:To="Package\Specialist\Reload main" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 2]"
          DTS:CreationName=""
          DTS:DTSID="{088B561F-1304-4B2B-B91A-11E4E48C8E77}"
          DTS:From="Package\Specialist\Truncate"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 2"
          DTS:To="Package\Specialist\Reload stat details" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 3]"
          DTS:CreationName=""
          DTS:DTSID="{551EE4E3-4884-4872-8CC6-F6C5B5907F3B}"
          DTS:From="Package\Specialist\Truncate"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 3"
          DTS:To="Package\Specialist\Reload DT details" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 4]"
          DTS:CreationName=""
          DTS:DTSID="{633A8D38-1D71-4C33-89F0-08BBB754660B}"
          DTS:From="Package\Specialist\Reload TD details"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 4"
          DTS:To="Package\Specialist\Reload add roles" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 5]"
          DTS:CreationName=""
          DTS:DTSID="{6282515C-1C48-4E55-BF13-11F222E00909}"
          DTS:From="Package\Specialist\Reload DT details"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 5"
          DTS:To="Package\Specialist\Reload add roles" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 6]"
          DTS:CreationName=""
          DTS:DTSID="{F7D68A25-5274-4C16-9E03-1B7456D5B20D}"
          DTS:From="Package\Specialist\Timesheet merge"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 6"
          DTS:To="Package\Specialist\Reload add roles" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 7]"
          DTS:CreationName=""
          DTS:DTSID="{9CDC1324-9323-40E5-8677-CED17EB60C00}"
          DTS:From="Package\Specialist\Reload apps before DT details"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 7"
          DTS:To="Package\Specialist\Reload add roles" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 8]"
          DTS:CreationName=""
          DTS:DTSID="{659AA71C-5E24-41BC-8CB2-ACF75F6DAF44}"
          DTS:From="Package\Specialist\Truncate"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 8"
          DTS:To="Package\Specialist\Timesheet merge" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Specialist.PrecedenceConstraints[Ограничение 9]"
          DTS:CreationName=""
          DTS:DTSID="{FED33A88-ED49-4F87-95BC-093DF1DB1FF4}"
          DTS:From="Package\Specialist\Reload stat details"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 9"
          DTS:To="Package\Specialist\Reload add roles" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update main roles decl"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{12A24EA0-B442-4DB0-9F9B-963C6FBA5CCB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update main roles decl"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="UPDATE [motivation].[dbo].[sto_workers]&#xA;SET [is_archive] = 1&#xA;WHERE [is_archive] = 0 AND [role_type] = 1 AND [type] = 'declarant' AND&#xA;[date_end] &lt; CAST(GETDATE() AS date)&#xA;&#xA;GO&#xA;&#xA;WITH cte_calendar AS (&#xA;&#x9;SELECT id_year, id_month, CASE WHEN id_year = YEAR(GETDATE()) AND id_month = MONTH(GETDATE()) THEN 1 ELSE 0 END AS current_month&#xA;&#x9;FROM [BI].[dbo].[DimCalendar] dc&#xA;&#x9;WHERE id_year &gt;= 2020 &#xA;&#x9;AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))&#xA;&#x9;GROUP BY id_year, id_month&#xA;),&#xA;&#xA;cte_final AS (&#xA;&#x9;SELECT &#xA;&#x9;b.nav_code AS SalespersonCode,&#xA;&#x9;b.[name] AS SalespersonName,&#xA;&#x9;b.[name] AS bitrix_name,&#xA;&#x9;b.[department_name] AS [Dept_ Code]&#xA;&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND group_id IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_declarant&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND COALESCE(group_id, '') NOT IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_sto_spec&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id = '1123' THEN 1 ELSE 0 END AS is_sto_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '52' AND department_id IN ('1044','56','60','64','66','68') THEN 1 ELSE 0 END AS is_stl_spec&#xA;&#x9;,CASE WHEN office_id = '52' AND department_id = '1090' THEN 1 ELSE 0 END AS is_stl_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '628' AND department_id IN ('1052','1082','22','76') THEN 1 ELSE 0 END AS is_ks&#xA;&#x9;FROM [motivation].[dbo].[bitrix_users] AS b&#xA;&#x9;WHERE active = 'Y' AND COALESCE(nav_code, '') &lt;&gt; ''&#xA;)&#xA;&#xA;INSERT [motivation].[dbo].[sto_workers] ([name]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[department]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[type]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[code]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[schedule]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_begin]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_end]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[is_archive]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[estimate_participant]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[role_type])&#xA;SELECT &#xA;c.SalespersonName AS [name],&#xA;c.[Dept_ Code] AS [department],&#xA;'declarant' AS [type],&#xA;c.SalespersonCode AS [code],&#xA;NULL AS [schedule],&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;CAST(DATEFROMPARTS(id_year, id_month, 1) AS date) AS [date_begin],&#xA;CAST(EOMONTH(DATEFROMPARTS(id_year, id_month, 1)) AS date) AS [date_end],&#xA;CASE WHEN current_month = 1 THEN 0 ELSE 1 END AS [is_archive],&#xA;1 AS [estimate_participant],&#xA;1 AS [role_type]&#xA;&#xA;FROM cte_final AS c&#xA;CROSS JOIN cte_calendar AS cc&#xA;WHERE is_declarant = 1&#xA;AND NOT EXISTS (SELECT 0 FROM [motivation].[dbo].[sto_workers] AS sw &#xA;WHERE sw.[type] = 'declarant' AND cc.id_year = YEAR([date_begin]) AND cc.id_month = MONTH([date_begin]))" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update main roles spec"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{6768BE7C-CF87-4A19-863C-365A9E749A21}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update main roles spec"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="UPDATE [motivation].[dbo].[sto_workers]&#xA;SET [is_archive] = 1&#xA;WHERE [is_archive] = 0 AND [role_type] = 1 AND [type] = 'specialist' AND&#xA;[date_end] &lt; CAST(GETDATE() AS date)&#xA;&#xA;GO&#xA;&#xA;WITH cte_calendar AS (&#xA;&#x9;SELECT id_year, id_month, CASE WHEN id_year = YEAR(GETDATE()) AND id_month = MONTH(GETDATE()) THEN 1 ELSE 0 END AS current_month&#xA;&#x9;FROM [BI].[dbo].[DimCalendar] dc&#xA;&#x9;WHERE id_year &gt;= 2020 &#xA;&#x9;AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))&#xA;&#x9;GROUP BY id_year, id_month&#xA;),&#xA;&#xA;cte_final AS (&#xA;&#x9;SELECT &#xA;&#x9;b.nav_code AS SalespersonCode,&#xA;&#x9;b.[name] AS SalespersonName,&#xA;&#x9;b.[name] AS bitrix_name,&#xA;&#x9;b.[department_name] AS [Dept_ Code]&#xA;&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND group_id IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_declarant&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id IN ('1068','1069','1070') AND COALESCE(group_id, '') NOT IN ('1083','1094','1095') THEN 1 ELSE 0 END AS is_sto_spec&#xA;&#x9;,CASE WHEN office_id = '34' AND department_id = '1123' THEN 1 ELSE 0 END AS is_sto_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '52' AND department_id IN ('1044','56','60','64','66','68') THEN 1 ELSE 0 END AS is_stl_spec&#xA;&#x9;,CASE WHEN office_id = '52' AND department_id = '1090' THEN 1 ELSE 0 END AS is_stl_ttr&#x9;&#xA;&#x9;,CASE WHEN office_id = '628' AND department_id IN ('1052','1082','22','76') THEN 1 ELSE 0 END AS is_ks&#xA;&#x9;FROM [motivation].[dbo].[bitrix_users] AS b&#xA;&#x9;WHERE active = 'Y' AND COALESCE(nav_code, '') &lt;&gt; ''&#xA;)&#xA;&#xA;INSERT [motivation].[dbo].[sto_workers] ([name]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[department]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[type]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[code]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[schedule]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_begin]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[date_end]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[is_archive]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[estimate_participant]&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  ,[role_type])&#xA;SELECT &#xA;c.SalespersonName AS [name],&#xA;c.[Dept_ Code] AS [department],&#xA;'specialist' AS [type],&#xA;c.SalespersonCode AS [code],&#xA;NULL AS [schedule],&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;CAST(DATEFROMPARTS(id_year, id_month, 1) AS date) AS [date_begin],&#xA;CAST(EOMONTH(DATEFROMPARTS(id_year, id_month, 1)) AS date) AS [date_end],&#xA;CASE WHEN current_month = 1 THEN 0 ELSE 1 END AS [is_archive],&#xA;1 AS [estimate_participant],&#xA;1 AS [role_type]&#xA;FROM cte_final AS c&#xA;CROSS JOIN cte_calendar AS cc&#xA;WHERE is_sto_spec = 1 AND is_sto_ttr = 0&#xA;AND NOT EXISTS (SELECT 0 FROM [motivation].[dbo].[sto_workers] AS sw &#xA;WHERE sw.[type] = 'specialist' AND cc.id_year = YEAR([date_begin]) AND cc.id_month = MONTH([date_begin]))" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\update time"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{7A01C0BD-8462-44D6-BE5C-E9AEB99199DA}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="update time"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="UPDATE [motivation].[dbo].[updated_at]&#xA;SET [date_time] = GETDATE()&#xA;WHERE [department] = 'sto'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение]"
      DTS:CreationName=""
      DTS:DTSID="{E3E8AA0E-6FF3-459F-994A-4F44A6B100A4}"
      DTS:From="Package\Update main roles decl"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение"
      DTS:To="Package\Update main roles spec" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 1]"
      DTS:CreationName=""
      DTS:DTSID="{9C2F2337-5121-4083-A9E7-A2E1EB5EB31C}"
      DTS:From="Package\Update main roles spec"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 1"
      DTS:To="Package\Specialist" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 2]"
      DTS:CreationName=""
      DTS:DTSID="{0FDCC077-A83D-4B8E-9A12-E9884211990A}"
      DTS:From="Package\Update main roles spec"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 2"
      DTS:To="Package\Declarant" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 3]"
      DTS:CreationName=""
      DTS:DTSID="{A310D21A-42AA-4C95-B8BB-D95375721C87}"
      DTS:From="Package\Declarant"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 3"
      DTS:To="Package\update time" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 4]"
      DTS:CreationName=""
      DTS:DTSID="{76DD9898-FFA5-41F1-998A-AC20CF3850B0}"
      DTS:From="Package\Specialist"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 4"
      DTS:To="Package\update time" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение 5]"
      DTS:CreationName=""
      DTS:DTSID="{B95A5638-0565-45ED-9F55-EFBA002871DA}"
      DTS:From="Package\Remove fired"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение 5"
      DTS:To="Package\Update main roles decl" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--В данном разделе CDATA содержатся сведения о макете пакета. В данном разделе содержатся сведения о координатах (x,y), ширине и высоте.-->
<!--В случае возникновения ошибки при редактировании этого раздела вручную его можно удалить. -->
<!--Пакет можно загрузить обычным образом, но прежние сведения о макете будут утеряны, и конструктор автоматически перераспределит элементы в области конструктора.-->
<Objects
  Version="8">
  <!--Все приведенные ниже узлы будут содержать свойства, не влияющие на поведение среды выполнения.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="157,42"
          Id="Package\Declarant\Reload add roles"
          TopLeft="209,104" />
        <NodeLayout
          Size="137,42"
          Id="Package\Declarant\Reload main"
          TopLeft="272.012987012987,190.402597402598" />
        <NodeLayout
          Size="168,42"
          Id="Package\Declarant\Reload preparation"
          TopLeft="20.2727272727273,94.6363636363637" />
        <NodeLayout
          Size="148,42"
          Id="Package\Declarant\Reload release"
          TopLeft="10.5454545454545,176.636363636363" />
        <NodeLayout
          Size="121,42"
          Id="Package\Declarant\Truncate"
          TopLeft="45,23" />
        <NodeLayout
          Size="196,42"
          Id="Package\Declarant\Update release declarant"
          TopLeft="24,273" />
        <NodeLayout
          Size="160,42"
          Id="Package\Declarant\Update role_type"
          TopLeft="262,270" />
        <EdgeLayout
          Id="Package\Declarant.PrecedenceConstraints[Ограничение]"
          TopLeft="104.886363636364,65">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,29.6363636363637"
              Start="0,0"
              End="0,22.1363636363637">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.1363636363637" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Declarant.PrecedenceConstraints[Ограничение 1]"
          TopLeft="104.272727272727,136.636363636364">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-19.7272727272728,39.9999999999994"
              Start="0,0"
              End="-19.7272727272728,32.4999999999994">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.9999999999997" />
                  <mssgle:CubicBezierSegment
                    Point1="0,15.9999999999997"
                    Point2="0,19.9999999999997"
                    Point3="-4,19.9999999999997" />
                  <mssgle:LineSegment
                    End="-15.7272727272728,19.9999999999997" />
                  <mssgle:CubicBezierSegment
                    Point1="-15.7272727272728,19.9999999999997"
                    Point2="-19.7272727272728,19.9999999999997"
                    Point3="-19.7272727272728,23.9999999999997" />
                  <mssgle:LineSegment
                    End="-19.7272727272728,32.4999999999994" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Declarant.PrecedenceConstraints[Ограничение 2]"
          TopLeft="87.6060606060606,218.636363636363">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,54.3636363636369"
              Start="0,0"
              End="0,46.8636363636369">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,46.8636363636369" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Declarant.PrecedenceConstraints[Ограничение 3]"
          TopLeft="341.256493506493,232.402597402598">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,37.597402597402"
              Start="0,0"
              End="0,30.097402597402">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.097402597402" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Declarant.PrecedenceConstraints[Ограничение 4]"
          TopLeft="153.333333333333,273">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="109.333333333333,-127"
              Start="0,0"
              End="109.333333333333,-119.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-59.3426520109283" />
                  <mssgle:CubicBezierSegment
                    Point1="0,-59.3426520109283"
                    Point2="0,-63.3426520109283"
                    Point3="4,-63.3426520109283" />
                  <mssgle:LineSegment
                    End="105.333333333333,-63.3426520109283" />
                  <mssgle:CubicBezierSegment
                    Point1="105.333333333333,-63.3426520109283"
                    Point2="109.333333333333,-63.3426520109283"
                    Point3="109.333333333333,-67.3426520109282" />
                  <mssgle:LineSegment
                    End="109.333333333333,-119.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Declarant.PrecedenceConstraints[Ограничение 5]"
          TopLeft="312.333333333333,146">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="28.1796536796537,44.402597402598"
              Start="0,0"
              End="28.1796536796537,36.902597402598">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,14.0298062593147" />
                  <mssgle:CubicBezierSegment
                    Point1="0,14.0298062593147"
                    Point2="0,18.0298062593147"
                    Point3="4,18.0298062593147" />
                  <mssgle:LineSegment
                    End="24.1796536796537,18.0298062593147" />
                  <mssgle:CubicBezierSegment
                    Point1="24.1796536796537,18.0298062593147"
                    Point2="28.1796536796537,18.0298062593147"
                    Point3="28.1796536796537,22.0298062593147" />
                  <mssgle:LineSegment
                    End="28.1796536796537,36.902597402598" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="455,376"
          Size="455,419"
          Id="Package\Declarant"
          TopLeft="148.444444444444,426.777777777778" />
        <NodeLayout
          Size="141,42"
          Id="Package\Remove fired"
          TopLeft="485,303" />
        <NodeLayout
          Size="157,42"
          Id="Package\Specialist\Reload add roles"
          TopLeft="188,283.333333333333" />
        <NodeLayout
          Size="220,42"
          Id="Package\Specialist\Reload apps before DT details"
          TopLeft="492.5,93.5" />
        <NodeLayout
          Size="161,42"
          Id="Package\Specialist\Reload DT details"
          TopLeft="120.5,141.5" />
        <NodeLayout
          Size="137,42"
          Id="Package\Specialist\Reload main"
          TopLeft="355.5,353.166666666667" />
        <NodeLayout
          Size="165,42"
          Id="Package\Specialist\Reload stat details"
          TopLeft="728.5,83.5" />
        <NodeLayout
          Size="161,42"
          Id="Package\Specialist\Reload TD details"
          TopLeft="5.5,81.5" />
        <NodeLayout
          Size="161,42"
          Id="Package\Specialist\Timesheet merge"
          TopLeft="301.5,116.5" />
        <NodeLayout
          Size="121,42"
          Id="Package\Specialist\Truncate"
          TopLeft="288.5,5.5" />
        <NodeLayout
          Size="160,42"
          Id="Package\Specialist\Update role_type"
          TopLeft="523,351" />
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение]"
          TopLeft="315.1,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-229.1,34"
              Start="0,0"
              End="-229.1,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,6.38346727898971" />
                  <mssgle:CubicBezierSegment
                    Point1="0,6.38346727898971"
                    Point2="0,10.3834672789897"
                    Point3="-4,10.3834672789897" />
                  <mssgle:LineSegment
                    End="-225.1,10.3834672789897" />
                  <mssgle:CubicBezierSegment
                    Point1="-225.1,10.3834672789897"
                    Point2="-229.1,10.3834672789897"
                    Point3="-229.1,14.3834672789897" />
                  <mssgle:LineSegment
                    End="-229.1,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 1]"
          TopLeft="360.3,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="242.2,46"
              Start="0,0"
              End="242.2,38.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.6308113035552" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16.6308113035552"
                    Point2="0,20.6308113035552"
                    Point3="4,20.6308113035552" />
                  <mssgle:LineSegment
                    End="238.2,20.6308113035552" />
                  <mssgle:CubicBezierSegment
                    Point1="238.2,20.6308113035552"
                    Point2="242.2,20.6308113035552"
                    Point3="242.2,24.6308113035552" />
                  <mssgle:LineSegment
                    End="242.2,38.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 10]"
          TopLeft="492.5,373.083333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="30.5,0"
              Start="0,0"
              End="23,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="23,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 11]"
          TopLeft="266.5,325.333333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="157.5,27.833333333334"
              Start="0,0"
              End="157.5,20.333333333334">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,9.916666666667" />
                  <mssgle:CubicBezierSegment
                    Point1="0,9.916666666667"
                    Point2="0,13.916666666667"
                    Point3="4,13.916666666667" />
                  <mssgle:LineSegment
                    End="153.5,13.916666666667" />
                  <mssgle:CubicBezierSegment
                    Point1="153.5,13.916666666667"
                    Point2="157.5,13.916666666667"
                    Point3="157.5,17.916666666667" />
                  <mssgle:LineSegment
                    End="157.5,20.333333333334" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 2]"
          TopLeft="382.9,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="428.1,36"
              Start="0,0"
              End="428.1,28.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,6.99425947187137" />
                  <mssgle:CubicBezierSegment
                    Point1="0,6.99425947187137"
                    Point2="0,10.9942594718714"
                    Point3="4,10.9942594718714" />
                  <mssgle:LineSegment
                    End="424.1,10.9942594718714" />
                  <mssgle:CubicBezierSegment
                    Point1="424.1,10.9942594718714"
                    Point2="428.1,10.9942594718714"
                    Point3="428.1,14.9942594718714" />
                  <mssgle:LineSegment
                    End="428.1,28.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 3]"
          TopLeft="330.166666666667,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-129.166666666667,94"
              Start="0,0"
              End="-129.166666666667,86.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.3360522022839" />
                  <mssgle:CubicBezierSegment
                    Point1="0,34.3360522022839"
                    Point2="0,38.3360522022839"
                    Point3="-4,38.3360522022839" />
                  <mssgle:LineSegment
                    End="-125.166666666667,38.3360522022839" />
                  <mssgle:CubicBezierSegment
                    Point1="-125.166666666667,38.3360522022839"
                    Point2="-129.166666666667,38.3360522022839"
                    Point3="-129.166666666667,42.3360522022839" />
                  <mssgle:LineSegment
                    End="-129.166666666667,86.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 4]"
          TopLeft="86,123.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="130.833333333333,159.833333333333"
              Start="0,0"
              End="130.833333333333,152.333333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,112.896739130435" />
                  <mssgle:CubicBezierSegment
                    Point1="0,112.896739130435"
                    Point2="0,116.896739130435"
                    Point3="4,116.896739130435" />
                  <mssgle:LineSegment
                    End="126.833333333333,116.896739130435" />
                  <mssgle:CubicBezierSegment
                    Point1="126.833333333333,116.896739130435"
                    Point2="130.833333333333,116.896739130435"
                    Point3="130.833333333333,120.896739130435" />
                  <mssgle:LineSegment
                    End="130.833333333333,152.333333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 5]"
          TopLeft="201,183.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="40.6666666666667,99.833333333333"
              Start="0,0"
              End="40.6666666666667,92.333333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,55.2957124842369" />
                  <mssgle:CubicBezierSegment
                    Point1="0,55.2957124842369"
                    Point2="0,59.2957124842369"
                    Point3="4,59.2957124842369" />
                  <mssgle:LineSegment
                    End="36.6666666666667,59.2957124842369" />
                  <mssgle:CubicBezierSegment
                    Point1="36.6666666666667,59.2957124842369"
                    Point2="40.6666666666667,59.2957124842369"
                    Point3="40.6666666666667,63.2957124842369" />
                  <mssgle:LineSegment
                    End="40.6666666666667,92.333333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 6]"
          TopLeft="382,158.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-115.5,124.833333333333"
              Start="0,0"
              End="-115.5,117.333333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,58.4166666666665" />
                  <mssgle:CubicBezierSegment
                    Point1="0,58.4166666666665"
                    Point2="0,62.4166666666665"
                    Point3="-4,62.4166666666665" />
                  <mssgle:LineSegment
                    End="-111.5,62.4166666666665" />
                  <mssgle:CubicBezierSegment
                    Point1="-111.5,62.4166666666665"
                    Point2="-115.5,62.4166666666665"
                    Point3="-115.5,66.4166666666665" />
                  <mssgle:LineSegment
                    End="-115.5,117.333333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 7]"
          TopLeft="602.5,135.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-311.166666666667,147.833333333333"
              Start="0,0"
              End="-311.166666666667,140.333333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,83.8051702395963" />
                  <mssgle:CubicBezierSegment
                    Point1="0,83.8051702395963"
                    Point2="0,87.8051702395963"
                    Point3="-4,87.8051702395963" />
                  <mssgle:LineSegment
                    End="-307.166666666667,87.8051702395963" />
                  <mssgle:CubicBezierSegment
                    Point1="-307.166666666667,87.8051702395963"
                    Point2="-311.166666666667,87.8051702395963"
                    Point3="-311.166666666667,91.8051702395963" />
                  <mssgle:LineSegment
                    End="-311.166666666667,140.333333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 8]"
          TopLeft="349,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="33,69"
              Start="0,0"
              End="33,61.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,30.5"
                    Point2="0,34.5"
                    Point3="4,34.5" />
                  <mssgle:LineSegment
                    End="29,34.5" />
                  <mssgle:CubicBezierSegment
                    Point1="29,34.5"
                    Point2="33,34.5"
                    Point3="33,38.5" />
                  <mssgle:LineSegment
                    End="33,61.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Specialist.PrecedenceConstraints[Ограничение 9]"
          TopLeft="811,125.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-494.833333333333,157.833333333333"
              Start="0,0"
              End="-494.833333333333,150.333333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,111.43400621118" />
                  <mssgle:CubicBezierSegment
                    Point1="0,111.43400621118"
                    Point2="0,115.43400621118"
                    Point3="-4,115.43400621118" />
                  <mssgle:LineSegment
                    End="-490.833333333333,115.43400621118" />
                  <mssgle:CubicBezierSegment
                    Point1="-490.833333333333,115.43400621118"
                    Point2="-494.833333333333,115.43400621118"
                    Point3="-494.833333333333,119.43400621118" />
                  <mssgle:LineSegment
                    End="-494.833333333333,150.333333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="899,468"
          Size="899,511"
          Id="Package\Specialist"
          TopLeft="628,411" />
        <NodeLayout
          Size="187,42"
          Id="Package\Update main roles decl"
          TopLeft="689.333333333333,302.666666666667" />
        <NodeLayout
          Size="189,42"
          Id="Package\Update main roles spec"
          TopLeft="922.333333333333,297.666666666667" />
        <NodeLayout
          Size="135,42"
          Id="Package\update time"
          TopLeft="720.000000000007,981.555555555553" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение]"
          TopLeft="876.333333333333,321.166666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="46,0"
              Start="0,0"
              End="38.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="38.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 1]"
          TopLeft="1047,339.666666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="30.5000000000002,71.333333333333"
              Start="0,0"
              End="30.5000000000002,63.833333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.8926197971317" />
                  <mssgle:CubicBezierSegment
                    Point1="0,24.8926197971317"
                    Point2="0,28.8926197971317"
                    Point3="4,28.8926197971317" />
                  <mssgle:LineSegment
                    End="26.5000000000002,28.8926197971317" />
                  <mssgle:CubicBezierSegment
                    Point1="26.5000000000002,28.8926197971317"
                    Point2="30.5000000000002,28.8926197971317"
                    Point3="30.5000000000002,32.8926197971317" />
                  <mssgle:LineSegment
                    End="30.5000000000002,63.833333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 2]"
          TopLeft="986.666666666666,339.666666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-610.722222222222,87.111111111111"
              Start="0,0"
              End="-610.722222222222,79.611111111111">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.2831992538183" />
                  <mssgle:CubicBezierSegment
                    Point1="0,31.2831992538183"
                    Point2="0,35.2831992538183"
                    Point3="-4,35.2831992538183" />
                  <mssgle:LineSegment
                    End="-606.722222222222,35.2831992538183" />
                  <mssgle:CubicBezierSegment
                    Point1="-606.722222222222,35.2831992538183"
                    Point2="-610.722222222222,35.2831992538183"
                    Point3="-610.722222222222,39.2831992538183" />
                  <mssgle:LineSegment
                    End="-610.722222222222,79.611111111111" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 3]"
          TopLeft="375.944444444444,845.777777777778">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="390.388888888896,135.777777777775"
              Start="0,0"
              End="390.388888888896,128.277777777775">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,76.5124450951667" />
                  <mssgle:CubicBezierSegment
                    Point1="0,76.5124450951667"
                    Point2="0,80.5124450951667"
                    Point3="4,80.5124450951667" />
                  <mssgle:LineSegment
                    End="386.388888888896,80.5124450951667" />
                  <mssgle:CubicBezierSegment
                    Point1="386.388888888896,80.5124450951667"
                    Point2="390.388888888896,80.5124450951667"
                    Point3="390.388888888896,84.5124450951667" />
                  <mssgle:LineSegment
                    End="390.388888888896,128.277777777775" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 4]"
          TopLeft="1077.5,922">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-268.833333333326,59.555555555553"
              Start="0,0"
              End="-268.833333333326,52.055555555553">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.3147877013162" />
                  <mssgle:CubicBezierSegment
                    Point1="0,31.3147877013162"
                    Point2="0,35.3147877013162"
                    Point3="-4,35.3147877013162" />
                  <mssgle:LineSegment
                    End="-264.833333333326,35.3147877013162" />
                  <mssgle:CubicBezierSegment
                    Point1="-264.833333333326,35.3147877013162"
                    Point2="-268.833333333326,35.3147877013162"
                    Point3="-268.833333333326,39.3147877013162" />
                  <mssgle:LineSegment
                    End="-268.833333333326,52.055555555553" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение 5]"
          TopLeft="626,323.833333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="63.333333333333,0"
              Start="0,0"
              End="55.833333333333,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="55.833333333333,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Declarant\Reload main">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="107,42"
          Id="Package\Declarant\Reload main\Query"
          TopLeft="135,54" />
        <NodeLayout
          Size="105,42"
          Id="Package\Declarant\Reload main\Table"
          TopLeft="136,125" />
        <EdgeLayout
          Id="Package\Declarant\Reload main.Paths[ADO NET Source Output]"
          TopLeft="188.5,96">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,29"
              Start="0,0"
              End="0,21.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Declarant\Reload main\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Declarant\Reload main\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Declarant\Reload preparation">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Declarant\Reload preparation\Table"
          TopLeft="132,146" />
        <NodeLayout
          Size="107,42"
          Id="Package\Declarant\Reload preparation\Query"
          TopLeft="131,75" />
        <EdgeLayout
          Id="Package\Declarant\Reload preparation.Paths[ADO NET Source Output]"
          TopLeft="184.5,117">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,29"
              Start="0,0"
              End="0,21.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Declarant\Reload preparation\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Declarant\Reload preparation\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Declarant\Reload release">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Declarant\Reload release\Table"
          TopLeft="139,123" />
        <NodeLayout
          Size="107,42"
          Id="Package\Declarant\Reload release\Query"
          TopLeft="130,54" />
        <EdgeLayout
          Id="Package\Declarant\Reload release.Paths[ADO NET Source Output]"
          TopLeft="183.5,96">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8,27"
              Start="0,0"
              End="8,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,9.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,9.5"
                    Point2="0,13.5"
                    Point3="4,13.5" />
                  <mssgle:LineSegment
                    End="4,13.5" />
                  <mssgle:CubicBezierSegment
                    Point1="4,13.5"
                    Point2="8,13.5"
                    Point3="8,17.5" />
                  <mssgle:LineSegment
                    End="8,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Declarant\Reload release\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Declarant\Reload release\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Specialist\Reload apps before DT details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Specialist\Reload apps before DT details\Table"
          TopLeft="175,126" />
        <NodeLayout
          Size="107,42"
          Id="Package\Specialist\Reload apps before DT details\Query"
          TopLeft="173,50" />
        <EdgeLayout
          Id="Package\Specialist\Reload apps before DT details.Paths[ADO NET Source Output]"
          TopLeft="227,92">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload apps before DT details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload apps before DT details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Specialist\Reload DT details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Specialist\Reload DT details\Table"
          TopLeft="155,112" />
        <NodeLayout
          Size="107,42"
          Id="Package\Specialist\Reload DT details\Query"
          TopLeft="154,45" />
        <EdgeLayout
          Id="Package\Specialist\Reload DT details.Paths[ADO NET Source Output]"
          TopLeft="207.5,87">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload DT details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload DT details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Specialist\Reload main">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Specialist\Reload main\Table"
          TopLeft="164,155" />
        <NodeLayout
          Size="107,42"
          Id="Package\Specialist\Reload main\Query"
          TopLeft="161,78" />
        <EdgeLayout
          Id="Package\Specialist\Reload main.Paths[ADO NET Source Output]"
          TopLeft="215.5,120">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,35"
              Start="0,0"
              End="0,27.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,27.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload main\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload main\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Specialist\Reload stat details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="107,42"
          Id="Package\Specialist\Reload stat details\Query"
          TopLeft="130,64" />
        <NodeLayout
          Size="105,42"
          Id="Package\Specialist\Reload stat details\Table"
          TopLeft="129,133" />
        <EdgeLayout
          Id="Package\Specialist\Reload stat details.Paths[ADO NET Source Output]"
          TopLeft="182.5,106">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload stat details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload stat details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Specialist\Reload TD details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Specialist\Reload TD details\Table"
          TopLeft="207,148" />
        <NodeLayout
          Size="107,42"
          Id="Package\Specialist\Reload TD details\Query"
          TopLeft="207,79" />
        <EdgeLayout
          Id="Package\Specialist\Reload TD details.Paths[ADO NET Source Output]"
          TopLeft="260,121">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload TD details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Specialist\Reload TD details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>