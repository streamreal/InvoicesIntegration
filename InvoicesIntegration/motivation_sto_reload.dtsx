<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="6/15/2020 12:19:38 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="ETP025"
  DTS:CreatorName="ELTRANSPLUS\andreydruzhinin"
  DTS:DTSID="{F9D1FBA2-BDD5-4E05-B999-4B31C2E41707}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.71"
  DTS:LocaleID="1049"
  DTS:ObjectName="Package2"
  DTS:PackageType="5"
  DTS:VersionBuild="68"
  DTS:VersionGUID="{D627F04D-2065-49CD-AC59-EEC7BA444540}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{04EF184D-B171-43FF-B1B8-203422DD51B3}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="decl_filled">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D55093B7-E574-41E7-9972-7F603AC9092C}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="iterator">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4B04E144-F65F-4D4B-BB61-81EEB6F10AF0}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="spec_filled">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Check tables for empty"
      DTS:AssignExpression="@[User::iterator] = @[User::iterator] + 1"
      DTS:CreationName="STOCK:FORLOOP"
      DTS:Description="Контейнер &quot;Цикл по элементам&quot;"
      DTS:DTSID="{3375114D-D55C-4DD1-8BEA-72EB435D8189}"
      DTS:EvalExpression="(@[User::spec_filled] == 0 || @[User::decl_filled] == 0) &amp;&amp; @[User::iterator] &lt;= 10"
      DTS:ExecutableType="STOCK:FORLOOP"
      DTS:LocaleID="-1"
      DTS:MaxConcurrent="1"
      DTS:ObjectName="Check tables for empty">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Check tables for empty\Declarant"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{9DE3AD92-87E5-4807-A20D-7BFB36B8E1A9}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Declarant">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Declarant\Check for empty decl"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{400F3AB0-F546-4234-8D3E-D7AFBF52350A}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Check for empty decl"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
                  SQLTask:SqlStatementSource="SELECT COUNT(*) AS cnt FROM [motivation].[dbo].[sto_declarant_main]"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="cnt"
                    SQLTask:DtsVariableName="User::decl_filled" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Declarant\Reload main"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{2A40A345-3C06-4E00-BF49-475FDC5A2418}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Reload main"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Check tables for empty\Declarant\Reload main\Query"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                      name="Query"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2019 
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code] 
	FROM [motivation].[dbo].[sto_workers] 
	WHERE [type] = 'declarant'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [motivation].[dbo].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt;= GETDATE() AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [department], [estimate_participant], COALESCE([work_days], 0) [work_days]
	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[sto_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [department], [estimate_participant] FROM [motivation].[dbo].[sto_workers] w
	WHERE w.[type] = 'declarant' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days
),

cte_dt_preparation AS (
	SELECT
	dt_year id_year,
	dt_month id_month,
	ssd.declarant_code declarant_code,
	SUM(ssd.import40) sum_import40,
	SUM(ssd.export10) sum_export10,
	SUM(ssd.other_procedures) sum_other_procedures,
	COUNT(ssd.regnum) sum_dt_prepared,
	SUM(ssd.product_qty) sum_products,
	SUM(ssd.dt_overall_articuls_count) sum_articuls
	FROM [motivation].[dbo].[sto_declarant_preparation_details] ssd
	GROUP BY ssd.declarant_code, ssd.dt_month, ssd.dt_year
),

cte_dt_release AS (
	SELECT
	dt_year id_year,
	dt_month id_month,
	ssd.declarant_code declarant_code,
	COUNT(ssd.regnum) sum_dt_release
	FROM [motivation].[dbo].[sto_declarant_release_details] ssd
	GROUP BY ssd.declarant_code, ssd.dt_month, ssd.dt_year
),

cte_td AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[declarant_code],
	COUNT(*) all_td
	FROM [motivation].[dbo].[sto_td_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [declarant_code]
),

cte_request AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[declarant_code],
	COUNT(*) all_request
	FROM [motivation].[dbo].[sto_app_before_dt_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [declarant_code]
),

cte_extended AS (

SELECT 
cte_base.*
,COALESCE(cte_dt_preparation.sum_import40, 0) sum_import40
,COALESCE(cte_dt_preparation.sum_export10, 0) sum_export10
,COALESCE(cte_dt_preparation.sum_other_procedures, 0) sum_other_procedures
,COALESCE(cte_dt_preparation.sum_dt_prepared, 0) sum_dt_prepared
,COALESCE(cte_dt_release.sum_dt_release, 0) sum_dt_release
,COALESCE(cte_dt_preparation.sum_products, 0) sum_products
,COALESCE(cte_dt_preparation.sum_articuls, 0) sum_articuls
,COALESCE(cte_td.all_td, 0) all_td
,COALESCE(cte_request.all_request, 0) all_request

FROM cte_base
LEFT JOIN cte_dt_preparation 
	ON cte_dt_preparation.id_year = cte_base.id_year 
	AND cte_dt_preparation.id_month = cte_base.id_month
	AND cte_dt_preparation.declarant_code = cte_base.code
LEFT JOIN cte_dt_release
	ON cte_dt_release.id_year = cte_base.id_year 
	AND cte_dt_release.id_month = cte_base.id_month
	AND cte_dt_release.declarant_code = cte_base.code
LEFT JOIN cte_td
	ON cte_td.id_year = cte_base.id_year 
	AND cte_td.id_month = cte_base.id_month
	AND cte_td.declarant_code = cte_base.code
LEFT JOIN cte_request
	ON cte_request.id_year = cte_base.id_year 
	AND cte_request.id_month = cte_base.id_month
	AND cte_request.declarant_code = cte_base.code
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month) [workers_count]
	,f.[decl_preparation]
    ,f.[decl_release]
    ,f.[decl_product]
    ,f.[decl_articul]	
	,f.[decl_td]
    ,f.[decl_request]
	
	,estimate =  ([sum_dt_prepared] * [decl_preparation]
                + [sum_dt_release] * [decl_release] 
				+ [sum_products] * [decl_product]
                + [sum_articuls] * [decl_articul]
				+ [all_td] * [decl_td]
				+ [all_request] * [decl_request])

	FROM cte_extended c
	JOIN [motivation].[dbo].[sto_factors] f ON f.department = c.department AND f.[sign] = 'declarant'
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt;= CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
, 0)
) worker_factor

FROM cte_calc_done c</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Source database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Declarant\Reload main\Query.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                              name="id_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                              name="id_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                              name="work_days_in_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                              length="300"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                              name="name"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                              length="100"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                              name="code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                              length="300"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]"
                              name="department"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                              name="estimate_participant"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                              name="work_days"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_import40]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]"
                              name="sum_import40"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_export10]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]"
                              name="sum_export10"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_other_procedures]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]"
                              name="sum_other_procedures"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_prepared]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_dt_prepared]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_prepared]"
                              name="sum_dt_prepared"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_release]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_dt_release]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_release]"
                              name="sum_dt_release"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_products]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]"
                              name="sum_products"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_articuls]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]"
                              name="sum_articuls"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_td]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]"
                              name="all_td"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_request]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]"
                              name="all_request"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                              name="workers_count"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_preparation]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_preparation]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_preparation]"
                              name="decl_preparation"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_release]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_release]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_release]"
                              name="decl_release"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_product]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_product]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_product]"
                              name="decl_product"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_articul]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_articul]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_articul]"
                              name="decl_articul"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_td]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_td]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_td]"
                              name="decl_td"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_request]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_request]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_request]"
                              name="decl_request"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                              name="estimate"
                              precision="34"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                              name="overall_estimate"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                              name="average_group_estimate"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                              name="worker_factor"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                              dataType="i4"
                              name="id_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                              dataType="i4"
                              name="id_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                              dataType="i4"
                              name="work_days_in_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                              dataType="wstr"
                              length="300"
                              name="name" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                              dataType="wstr"
                              length="100"
                              name="code" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                              dataType="wstr"
                              length="300"
                              name="department" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                              dataType="i4"
                              name="estimate_participant" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                              dataType="i4"
                              name="work_days" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_import40]"
                              dataType="i4"
                              name="sum_import40" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_export10]"
                              dataType="i4"
                              name="sum_export10" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_other_procedures]"
                              dataType="i4"
                              name="sum_other_procedures" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_dt_prepared]"
                              dataType="i4"
                              name="sum_dt_prepared" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_dt_release]"
                              dataType="i4"
                              name="sum_dt_release" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_products]"
                              dataType="i4"
                              name="sum_products" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_articuls]"
                              dataType="i4"
                              name="sum_articuls" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_td]"
                              dataType="i4"
                              name="all_td" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_request]"
                              dataType="i4"
                              name="all_request" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                              dataType="i4"
                              name="workers_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_preparation]"
                              dataType="numeric"
                              name="decl_preparation"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_release]"
                              dataType="numeric"
                              name="decl_release"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_product]"
                              dataType="numeric"
                              name="decl_product"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_articul]"
                              dataType="numeric"
                              name="decl_articul"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_td]"
                              dataType="numeric"
                              name="decl_td"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[decl_request]"
                              dataType="numeric"
                              name="decl_request"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                              dataType="numeric"
                              name="estimate"
                              precision="34"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                              dataType="numeric"
                              name="overall_estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                              dataType="numeric"
                              name="average_group_estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                              dataType="numeric"
                              name="worker_factor"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                              name="id_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                              name="id_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                              name="work_days_in_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                              dataType="wstr"
                              length="300"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                              name="name" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                              dataType="wstr"
                              length="100"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                              name="code" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                              dataType="wstr"
                              length="300"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                              name="department" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                              name="estimate_participant" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                              name="work_days" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_import40]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_import40]"
                              name="sum_import40" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_export10]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_export10]"
                              name="sum_export10" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_other_procedures]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_other_procedures]"
                              name="sum_other_procedures" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_dt_prepared]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_dt_prepared]"
                              name="sum_dt_prepared" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_dt_release]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_dt_release]"
                              name="sum_dt_release" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_products]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_products]"
                              name="sum_products" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_articuls]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_articuls]"
                              name="sum_articuls" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_td]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_td]"
                              name="all_td" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_request]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_request]"
                              name="all_request" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                              name="workers_count" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_preparation]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_preparation]"
                              name="decl_preparation"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_release]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_release]"
                              name="decl_release"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_product]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_product]"
                              name="decl_product"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_articul]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_articul]"
                              name="decl_articul"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_td]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_td]"
                              name="decl_td"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_request]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[decl_request]"
                              name="decl_request"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                              name="estimate"
                              precision="34"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                              name="overall_estimate"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                              name="average_group_estimate"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                              name="worker_factor"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Check tables for empty\Declarant\Reload main\Table"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                      description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                      name="Table"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_declarant_main</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Declarant\Reload main\Table.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_year]"
                              cachedDataType="i4"
                              cachedName="id_year"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_month]"
                              cachedDataType="i4"
                              cachedName="id_month"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days_in_month]"
                              cachedDataType="i4"
                              cachedName="work_days_in_month"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[name]"
                              cachedDataType="wstr"
                              cachedLength="300"
                              cachedName="name"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[code]"
                              cachedDataType="wstr"
                              cachedLength="100"
                              cachedName="code"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[department]"
                              cachedDataType="wstr"
                              cachedLength="300"
                              cachedName="department"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate_participant]"
                              cachedDataType="i4"
                              cachedName="estimate_participant"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days]"
                              cachedDataType="i4"
                              cachedName="work_days"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_import40]"
                              cachedDataType="i4"
                              cachedName="sum_import40"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_import40]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_export10]"
                              cachedDataType="i4"
                              cachedName="sum_export10"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_export10]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_other_procedures]"
                              cachedDataType="i4"
                              cachedName="sum_other_procedures"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_other_procedures]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_dt_prepared]"
                              cachedDataType="i4"
                              cachedName="sum_dt_prepared"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_dt_prepared]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_prepared]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_dt_release]"
                              cachedDataType="i4"
                              cachedName="sum_dt_release"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_dt_release]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_dt_release]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_products]"
                              cachedDataType="i4"
                              cachedName="sum_products"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_products]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_articuls]"
                              cachedDataType="i4"
                              cachedName="sum_articuls"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_articuls]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[workers_count]"
                              cachedDataType="i4"
                              cachedName="workers_count"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[decl_preparation]"
                              cachedDataType="numeric"
                              cachedName="decl_preparation"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_preparation]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_preparation]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[decl_release]"
                              cachedDataType="numeric"
                              cachedName="decl_release"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_release]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_release]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[decl_product]"
                              cachedDataType="numeric"
                              cachedName="decl_product"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_product]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_product]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[decl_articul]"
                              cachedDataType="numeric"
                              cachedName="decl_articul"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_articul]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[decl_articul]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate]"
                              cachedDataType="numeric"
                              cachedName="estimate"
                              cachedPrecision="34"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[overall_estimate]"
                              cachedDataType="numeric"
                              cachedName="overall_estimate"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[average_group_estimate]"
                              cachedDataType="numeric"
                              cachedName="average_group_estimate"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[worker_factor]"
                              cachedDataType="numeric"
                              cachedName="worker_factor"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_td]"
                              cachedDataType="i4"
                              cachedName="all_td"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_td]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_request]"
                              cachedDataType="i4"
                              cachedName="all_request"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_request]"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                              dataType="i4"
                              name="id_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                              dataType="i4"
                              name="id_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                              dataType="i4"
                              name="work_days_in_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                              dataType="wstr"
                              length="300"
                              name="name" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                              dataType="wstr"
                              length="100"
                              name="code" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                              dataType="wstr"
                              length="300"
                              name="department" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                              dataType="i4"
                              name="estimate_participant" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                              dataType="i4"
                              name="work_days" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_import40]"
                              dataType="i4"
                              name="sum_import40" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_export10]"
                              dataType="i4"
                              name="sum_export10" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_other_procedures]"
                              dataType="i4"
                              name="sum_other_procedures" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_dt_prepared]"
                              dataType="i4"
                              name="sum_dt_prepared" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_dt_release]"
                              dataType="i4"
                              name="sum_dt_release" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_products]"
                              dataType="i4"
                              name="sum_products" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_articuls]"
                              dataType="i4"
                              name="sum_articuls" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                              dataType="i4"
                              name="workers_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_preparation]"
                              dataType="numeric"
                              name="decl_preparation"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_release]"
                              dataType="numeric"
                              name="decl_release"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_product]"
                              dataType="numeric"
                              name="decl_product"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[decl_articul]"
                              dataType="numeric"
                              name="decl_articul"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                              dataType="numeric"
                              name="estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                              dataType="numeric"
                              name="overall_estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                              dataType="numeric"
                              name="average_group_estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                              dataType="numeric"
                              name="worker_factor"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_td]"
                              dataType="i4"
                              name="all_td" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_request]"
                              dataType="i4"
                              name="all_request" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Check tables for empty\Declarant\Reload main.Paths[ADO NET Source Output]"
                      endId="Package\Check tables for empty\Declarant\Reload main\Table.Inputs[ADO NET Destination Input]"
                      name="ADO NET Source Output"
                      startId="Package\Check tables for empty\Declarant\Reload main\Query.Outputs[ADO NET Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Declarant\Reload preparation"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{FA85FABB-2F05-45D4-B2AC-BD0654EE2F74}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Reload preparation"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Check tables for empty\Declarant\Reload preparation\Query"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                      name="Query"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT 

base_dt.YYYY dt_year,
base_dt.MM dt_month,
base_dt.[DeclarationNo_] regnum,
oa.code declarant_code,
COALESCE(web_other.all_count, 0) dt_overall_articuls_count,
COALESCE(CAST(gtd.[5_1] AS int), 0) product_qty,
(CASE WHEN gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40' THEN 1 ELSE 0 END) import40,
(CASE WHEN gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10' THEN 1 ELSE 0 END) export10,
(CASE 
WHEN (gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40') OR (gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10') THEN 0 
WHEN (COALESCE(gtd.[1_1], '') = '' OR COALESCE(gtd.[1_2], '') = '') THEN 0
ELSE 1 END) other_procedures

FROM 

(SELECT d.[DeclarationNo_], d.[YYYY], d.[MM]
,ROW_NUMBER() OVER (PARTITION BY d.[DeclarationNo_] ORDER BY (SELECT NULL)) base_rownum
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
WHERE DTCountДТ = 1 AND isDeclaration = 1) AS base_dt

LEFT JOIN (SELECT g.*, ROW_NUMBER() OVER (PARTITION BY [RegNum] ORDER BY (SELECT NULL)) gtd_rownum 
FROM [gtd].[dbo].[GTDList] g) AS gtd
ON base_dt.[DeclarationNo_] = gtd.RegNum AND gtd.gtd_rownum = 1

LEFT JOIN
(SELECT d.reg_num, COUNT(*) all_count
FROM [BI].[etl].[webproject_articuls] a JOIN [BI].[etl].[webproject_declarations] d ON a.declaration_id = d.id
GROUP BY d.reg_num) AS web_other
ON web_other.reg_num = base_dt.[DeclarationNo_]

LEFT JOIN 
(SELECT a.*, ROW_NUMBER() OVER (PARTITION BY [RegNum] 
ORDER BY COALESCE([REGNUM_DT_DATE_TIME], [REGNUM_PTD_DATE_TIME]) ASC) rownum 
FROM [BI].[dwh].[AltaRegNum] a) AS alta
ON alta.RegNum = base_dt.[DeclarationNo_] AND alta.rownum = 1

OUTER APPLY (
SELECT TOP (1) dd.[SalespersonCode] [code]
FROM [BI].[dwh].[vDimDeclarant] dd
WHERE dd.Declarant_Key = alta.ExecutorUSERNAMEKey
AND COALESCE(dd.[SalespersonCode], '') &lt;&gt; '') AS oa

--одни LEFT JOIN, поэтому base_rownum через фильтр
WHERE base_dt.base_rownum = 1 AND base_dt.YYYY &gt;= 2019</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Source database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                              name="dt_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                              name="dt_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                              length="30"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                              name="regnum"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                              length="20"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                              name="declarant_code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_overall_articuls_count]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]"
                              name="dt_overall_articuls_count"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[product_qty]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[product_qty]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[product_qty]"
                              name="product_qty"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[import40]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[import40]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[import40]"
                              name="import40"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[export10]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[export10]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[export10]"
                              name="export10"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[other_procedures]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[other_procedures]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[other_procedures]"
                              name="other_procedures"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                              dataType="i4"
                              name="dt_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                              dataType="i4"
                              name="dt_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                              dataType="wstr"
                              length="30"
                              name="regnum" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              name="declarant_code" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_overall_articuls_count]"
                              dataType="i4"
                              name="dt_overall_articuls_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[product_qty]"
                              dataType="i4"
                              name="product_qty" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[import40]"
                              dataType="i4"
                              name="import40" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[export10]"
                              dataType="i4"
                              name="export10" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].ExternalColumns[other_procedures]"
                              dataType="i4"
                              name="other_procedures" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                              name="dt_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                              name="dt_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                              dataType="wstr"
                              length="30"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                              name="regnum" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                              name="declarant_code" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_overall_articuls_count]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[dt_overall_articuls_count]"
                              name="dt_overall_articuls_count" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[product_qty]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[product_qty]"
                              name="product_qty" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[import40]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[import40]"
                              name="import40" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[export10]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[export10]"
                              name="export10" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[other_procedures]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[other_procedures]"
                              name="other_procedures" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Check tables for empty\Declarant\Reload preparation\Table"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                      description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                      name="Table"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_declarant_preparation_details</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[dt_year]"
                              cachedDataType="i4"
                              cachedName="dt_year"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[dt_month]"
                              cachedDataType="i4"
                              cachedName="dt_month"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[regnum]"
                              cachedDataType="wstr"
                              cachedLength="30"
                              cachedName="regnum"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[regnum]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[declarant_code]"
                              cachedDataType="wstr"
                              cachedLength="20"
                              cachedName="declarant_code"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[declarant_code]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[dt_overall_articuls_count]"
                              cachedDataType="i4"
                              cachedName="dt_overall_articuls_count"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_overall_articuls_count]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[product_qty]"
                              cachedDataType="i4"
                              cachedName="product_qty"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[product_qty]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[product_qty]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[import40]"
                              cachedDataType="i4"
                              cachedName="import40"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[import40]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[import40]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[export10]"
                              cachedDataType="i4"
                              cachedName="export10"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[export10]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[export10]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].Columns[other_procedures]"
                              cachedDataType="i4"
                              cachedName="other_procedures"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[other_procedures]"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output].Columns[other_procedures]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                              dataType="i4"
                              name="dt_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                              dataType="i4"
                              name="dt_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                              dataType="wstr"
                              length="30"
                              name="regnum" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              name="declarant_code" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_overall_articuls_count]"
                              dataType="i4"
                              name="dt_overall_articuls_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[product_qty]"
                              dataType="i4"
                              name="product_qty" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[import40]"
                              dataType="i4"
                              name="import40" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[export10]"
                              dataType="i4"
                              name="export10" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input].ExternalColumns[other_procedures]"
                              dataType="i4"
                              name="other_procedures" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload preparation\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Check tables for empty\Declarant\Reload preparation.Paths[ADO NET Source Output]"
                      endId="Package\Check tables for empty\Declarant\Reload preparation\Table.Inputs[ADO NET Destination Input]"
                      name="ADO NET Source Output"
                      startId="Package\Check tables for empty\Declarant\Reload preparation\Query.Outputs[ADO NET Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Declarant\Reload release"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{C0A19F93-889C-4CA9-8997-65F0DB3085C4}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Reload release"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Check tables for empty\Declarant\Reload release\Query"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                      name="Query"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_declarants_no_ecp AS (
	SELECT ca.[code], [key]
	FROM [BI].[dwh].[DeclarantsWithoutAnECP] d
	CROSS APPLY (SELECT TOP (1) SalespersonCode [code], dd.Declarant_Key [key]
	FROM [BI].[dwh].[DimDeclarant] dd
	WHERE d.[Name] = dd.Declarant AND COALESCE(SalespersonCode, '') &lt;&gt; '') AS ca
),

--все ДТ, сделанные сотрудникам без ЭЦП считаются
--за ними как поданные
cte_without_ecp AS (
	SELECT
	base_dt.dt_year,
	base_dt.dt_month,
	base_dt.regnum,
	base_dt.declarant_code
	FROM 
	[motivation].[dbo].[sto_declarant_preparation_details] AS base_dt
	JOIN cte_declarants_no_ecp AS c ON c.code = base_dt.declarant_code
),

cte_release AS (
SELECT
base_dt.YYYY dt_year,
base_dt.MM dt_month,
base_dt.[DeclarationNo_] regnum,
oa.code declarant_code
FROM 

(SELECT d.[DeclarationNo_], d.[YYYY], d.[MM]
,ROW_NUMBER() OVER (PARTITION BY d.[DeclarationNo_] ORDER BY (SELECT NULL)) base_rownum
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
WHERE DTCountДТ = 1 AND isDeclaration = 1) AS base_dt

LEFT JOIN 
(SELECT a.*, ROW_NUMBER() OVER (PARTITION BY [RegNum] 
ORDER BY COALESCE([REGNUM_DT_DATE_TIME], [REGNUM_PTD_DATE_TIME]) ASC) rownum 
FROM [BI].[dwh].[AltaRegNum] a) AS alta
ON alta.RegNum = base_dt.[DeclarationNo_] AND alta.rownum = 1

OUTER APPLY (
SELECT TOP (1) dd.[SalespersonCode] [code]
FROM [BI].[dwh].[vDimDeclarant] dd
WHERE dd.Declarant_Key = alta.ReleaserUSERNAMEKey
AND COALESCE(dd.[SalespersonCode], '') &lt;&gt; '') AS oa

--одни LEFT JOIN, поэтому base_rownum через фильтр
--убираем ДТ, сделанные сотрудниками без ЭЦП
WHERE base_dt.base_rownum = 1 AND base_dt.YYYY &gt;= 2019
AND NOT EXISTS (SELECT 0 FROM cte_without_ecp c WHERE c.regnum = base_dt.[DeclarationNo_])
)

SELECT 
dt_year,
dt_month,
regnum,
declarant_code 
FROM cte_release

UNION 

SELECT 
dt_year,
dt_month,
regnum,
declarant_code FROM cte_without_ecp</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Source database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Declarant\Reload release\Query.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                              name="dt_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                              name="dt_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                              length="30"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                              name="regnum"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                              length="20"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                              name="declarant_code"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                              dataType="i4"
                              name="dt_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                              dataType="i4"
                              name="dt_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                              dataType="wstr"
                              length="30"
                              name="regnum" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              name="declarant_code" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                              name="dt_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                              name="dt_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                              dataType="wstr"
                              length="30"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                              name="regnum" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                              name="declarant_code" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Check tables for empty\Declarant\Reload release\Table"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                      description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                      name="Table"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_declarant_release_details</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Declarant\Reload release\Table.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].Columns[dt_year]"
                              cachedDataType="i4"
                              cachedName="dt_year"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].Columns[dt_month]"
                              cachedDataType="i4"
                              cachedName="dt_month"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[dt_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].Columns[regnum]"
                              cachedDataType="wstr"
                              cachedLength="30"
                              cachedName="regnum"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[regnum]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].Columns[declarant_code]"
                              cachedDataType="wstr"
                              cachedLength="20"
                              cachedName="declarant_code"
                              externalMetadataColumnId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output].Columns[declarant_code]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                              dataType="i4"
                              name="dt_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                              dataType="i4"
                              name="dt_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                              dataType="wstr"
                              length="30"
                              name="regnum" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              name="declarant_code" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Declarant\Reload release\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Check tables for empty\Declarant\Reload release.Paths[ADO NET Source Output]"
                      endId="Package\Check tables for empty\Declarant\Reload release\Table.Inputs[ADO NET Destination Input]"
                      name="ADO NET Source Output"
                      startId="Package\Check tables for empty\Declarant\Reload release\Query.Outputs[ADO NET Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Declarant\Truncate"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{55AE5F43-842D-4496-934B-F0C960239A4A}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Truncate"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
                  SQLTask:SqlStatementSource="TRUNCATE TABLE [motivation].[dbo].[sto_declarant_preparation_details]&#xA;TRUNCATE TABLE [motivation].[dbo].[sto_declarant_release_details]&#xA;TRUNCATE TABLE [motivation].[dbo].[sto_declarant_main]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Declarant.PrecedenceConstraints[Ограничение]"
              DTS:CreationName=""
              DTS:DTSID="{7A76479C-EDAB-4666-8905-DB07098EA759}"
              DTS:From="Package\Check tables for empty\Declarant\Truncate"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение"
              DTS:To="Package\Check tables for empty\Declarant\Reload preparation" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Declarant.PrecedenceConstraints[Ограничение 1]"
              DTS:CreationName=""
              DTS:DTSID="{B38513E8-1D46-41E8-B464-84A2CE0AF23A}"
              DTS:From="Package\Check tables for empty\Declarant\Reload preparation"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 1"
              DTS:To="Package\Check tables for empty\Declarant\Reload release" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Declarant.PrecedenceConstraints[Ограничение 2]"
              DTS:CreationName=""
              DTS:DTSID="{BEE0CA02-D76E-4F38-96F6-F71111989274}"
              DTS:From="Package\Check tables for empty\Declarant\Reload release"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 2"
              DTS:To="Package\Check tables for empty\Declarant\Reload main" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Declarant.PrecedenceConstraints[Ограничение 3]"
              DTS:CreationName=""
              DTS:DTSID="{8714B47C-31C7-4566-8C81-8522DC266984}"
              DTS:From="Package\Check tables for empty\Declarant\Reload main"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 3"
              DTS:To="Package\Check tables for empty\Declarant\Check for empty decl" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Check tables for empty\Specialist"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{B3664964-60AD-459A-B891-F35AED89A6C5}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Specialist">
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Specialist\Check for empty spec"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{09EBFF6D-D314-493C-B5A2-5CCF121E850C}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Check for empty spec"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
                  SQLTask:SqlStatementSource="SELECT COUNT(*) AS cnt FROM [motivation].[dbo].[sto_specialist_main]"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="cnt"
                    SQLTask:DtsVariableName="User::spec_filled" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Specialist\Reload apps before DT details"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{A743CE1B-DB9A-4266-B6E7-17F43FF017A4}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Reload apps before DT details"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                      name="Query"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT  
   sd.[Declarant Code] specialist
  ,list.[&amp;&amp;PRIM] delivery_number
  ,ed_reg.reg_num
  ,ed_reg.reg_datetime
  ,ed_reg.reg_year
  ,ed_reg.reg_month  
  ,ed_release.release_datetime
  ,ed_release.release_year
  ,ed_release.release_month
  ,oa.declarant_code

FROM [gtd].[dbo].[AppReleaseGoodsBeforeDTList] list

JOIN [BI].[dwh].[ETP$SQL_Delivery] sd ON sd.No_ = list.[&amp;&amp;PRIM]
 
 LEFT JOIN [gtd].[dbo].[Docs] d ON d.GID = list.DOCGID
 
 LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) reg_year
	,MONTH([InOutDateTime]) reg_month
	,[InOutDateTime] reg_datetime
	,[Result] reg_num
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.11273' AND [Incoming] = 1) AS ed_reg ON list.docgid = ed_reg.gid AND ed_reg.row_num = 1
  
    LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) release_year
	,MONTH([InOutDateTime]) release_month
	,[InOutDateTime] release_datetime
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.11264' AND [Incoming] = 1) AS ed_release ON list.docgid = ed_release.gid AND ed_release.row_num = 1

	OUTER APPLY (SELECT TOP (1) [SalespersonCode] declarant_code 
				FROM [BI].[dwh].[vDimDeclarant] dd
				WHERE UPPER(LTRIM(RTRIM(dd.USERNAME)))= UPPER(LTRIM(RTRIM(d.EDSENDER)))
				) AS oa</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Source database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                              length="10"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                              name="specialist"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                              length="50"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                              name="delivery_number"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_num]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_num]"
                              length="250"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_num]"
                              name="reg_num"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]"
                              dataType="dbTimeStamp"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]"
                              name="reg_datetime"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_year]"
                              name="reg_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_month]"
                              name="reg_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]"
                              dataType="dbTimeStamp"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]"
                              name="release_datetime"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_year]"
                              name="release_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_month]"
                              name="release_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                              name="declarant_code"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                              dataType="wstr"
                              length="10"
                              name="specialist" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                              dataType="wstr"
                              length="50"
                              name="delivery_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_num]"
                              dataType="wstr"
                              length="250"
                              name="reg_num" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_datetime]"
                              dataType="dbTimeStamp"
                              name="reg_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_year]"
                              dataType="i4"
                              name="reg_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_month]"
                              dataType="i4"
                              name="reg_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_datetime]"
                              dataType="dbTimeStamp"
                              name="release_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_year]"
                              dataType="i4"
                              name="release_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_month]"
                              dataType="i4"
                              name="release_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              name="declarant_code" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                              dataType="wstr"
                              length="10"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                              name="specialist" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                              dataType="wstr"
                              length="50"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                              name="delivery_number" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_num]"
                              dataType="wstr"
                              length="250"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_num]"
                              name="reg_num" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_datetime]"
                              dataType="dbTimeStamp"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_datetime]"
                              name="reg_datetime" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_year]"
                              name="reg_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[reg_month]"
                              name="reg_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_datetime]"
                              dataType="dbTimeStamp"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_datetime]"
                              name="release_datetime" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_year]"
                              name="release_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[release_month]"
                              name="release_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                              name="declarant_code" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                      description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                      name="Table"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_app_before_dt_details</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[specialist]"
                              cachedDataType="wstr"
                              cachedLength="10"
                              cachedName="specialist"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[delivery_number]"
                              cachedDataType="wstr"
                              cachedLength="50"
                              cachedName="delivery_number"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[reg_num]"
                              cachedDataType="wstr"
                              cachedLength="250"
                              cachedName="reg_num"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_num]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_num]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[reg_datetime]"
                              cachedDataType="dbTimeStamp"
                              cachedName="reg_datetime"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[reg_year]"
                              cachedDataType="i4"
                              cachedName="reg_year"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[reg_month]"
                              cachedDataType="i4"
                              cachedName="reg_month"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[reg_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[release_datetime]"
                              cachedDataType="dbTimeStamp"
                              cachedName="release_datetime"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[release_year]"
                              cachedDataType="i4"
                              cachedName="release_year"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[release_month]"
                              cachedDataType="i4"
                              cachedName="release_month"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[release_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].Columns[declarant_code]"
                              cachedDataType="wstr"
                              cachedLength="20"
                              cachedName="declarant_code"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                              dataType="wstr"
                              length="50"
                              name="delivery_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_num]"
                              dataType="wstr"
                              length="250"
                              name="reg_num" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_datetime]"
                              dataType="dbTimeStamp"
                              name="reg_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_year]"
                              dataType="i4"
                              name="reg_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_month]"
                              dataType="i4"
                              name="reg_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_datetime]"
                              dataType="dbTimeStamp"
                              name="release_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_year]"
                              dataType="i4"
                              name="release_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_month]"
                              dataType="i4"
                              name="release_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                              dataType="wstr"
                              length="50"
                              name="specialist" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                              dataType="wstr"
                              length="30"
                              name="declarant_code" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Check tables for empty\Specialist\Reload apps before DT details.Paths[ADO NET Source Output]"
                      endId="Package\Check tables for empty\Specialist\Reload apps before DT details\Table.Inputs[ADO NET Destination Input]"
                      name="ADO NET Source Output"
                      startId="Package\Check tables for empty\Specialist\Reload apps before DT details\Query.Outputs[ADO NET Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Specialist\Reload DT details"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{B4644D1B-0A9B-484F-A8B0-DACB89EE8416}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Reload DT details"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload DT details\Query"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                      name="Query"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT 
base_dt.YYYY dt_year,
base_dt.MM dt_month,
NULL department,
fact_dt.[Custom Declaration No_] regnum,
(CASE WHEN gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40' THEN 1 ELSE 0 END) import40,
(CASE WHEN gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10' THEN 1 ELSE 0 END) export10,
(CASE 
WHEN (gtd.[1_1] = 'ИМ' AND gtd.[1_2] = '40') OR (gtd.[1_1] = 'ЭК' AND gtd.[1_2] = '10') THEN 0 
WHEN (COALESCE(gtd.[1_1], '') = '' OR COALESCE(gtd.[1_2], '') = '') THEN 0
ELSE 1 END) other_procedures,
cust.[No_] customer_id,
cust.[Name] customer_name,
sto_person.SalespersonName specialist,
sto_person.SalespersonCode specialist_code,
COALESCE(CAST(gtd.[5_1] AS int), 0) product_qty,
(CASE WHEN gtd.[51_5] = 2 THEN 1 ELSE 0 END) broker_payment_sign,
(CASE WHEN docs.[ID] = docs_min.id THEN 1 ELSE 0 END) new_contract_sign,
COALESCE(web.sum_new, 0) dt_new_articuls_count,
COALESCE(web_other.all_count, 0) dt_overall_articuls_count,
(CASE WHEN ISNUMERIC(gtd.[21_0]) = 1 THEN CONVERT(int, gtd.[21_0]) ELSE 1 END) dt_transport_qty,
COALESCE(LEN(gtd.[BLOCK\1\@44_!_04021]) - LEN(REPLACE(gtd.[BLOCK\1\@44_!_04021], ',', '')), '0') + 1 dt_inv_qty

FROM 

(SELECT d.[DeclarationNo_], d.[YYYY], d.[MM]
,ROW_NUMBER() OVER (PARTITION BY d.[DeclarationNo_] ORDER BY (SELECT NULL)) base_rownum
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
WHERE DTCountДТ = 1 AND isDeclaration = 1) AS base_dt

JOIN

(SELECT f.*, 
ROW_NUMBER() OVER (PARTITION BY [Custom Declaration No_] ORDER BY (SELECT NULL)) fact_rownum 
FROM [BI].[olap].[FactReleaseRateSTO] f) AS fact_dt
ON base_dt.[DeclarationNo_] = fact_dt.[Custom Declaration No_]
AND base_dt.base_rownum = 1 
AND fact_dt.fact_rownum = 1

JOIN [BI].[dwh].[ETP$Customer] cust on cust.CustomerKey = fact_dt.CustomerKey
JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] sto_person ON sto_person.[SalespersonKey] = fact_dt.[SalespersonKey]

LEFT JOIN (SELECT g.*, 
CASE 
WHEN CHARINDEX('/', g.[14_4]) &gt; 0 
THEN SUBSTRING(g.[14_4], 1, CHARINDEX('/', g.[14_4]) - 1) 
ELSE g.[14_4] END vat,
ROW_NUMBER() OVER (PARTITION BY [RegNum] ORDER BY (SELECT NULL)) gtd_rownum 
FROM [gtd].[dbo].[GTDList] g) AS gtd
ON fact_dt.[Custom Declaration No_] = gtd.RegNum AND gtd.gtd_rownum = 1

LEFT JOIN [gtd].[dbo].[Docs] docs on docs.[GID] = gtd.[DOCGID]

LEFT JOIN
(SELECT docs.ID, gtdlist.[BLOCK\1\@44_!_03011], gtdlist.vat,
ROW_NUMBER() OVER (PARTITION BY gtdlist.vat, gtdlist.[BLOCK\1\@44_!_03011] ORDER BY docs.ID ASC) rownum
FROM [gtd].[dbo].[Docs] docs 
JOIN (SELECT g.*, CASE WHEN CHARINDEX('/', g.[14_4]) &gt; 0 THEN SUBSTRING(g.[14_4], 1, CHARINDEX('/', g.[14_4]) - 1) 
ELSE g.[14_4] END vat FROM [gtd].[dbo].[GTDList] g) AS gtdlist ON docs.[GID] = gtdlist.[DOCGID] 
WHERE LEFT(gtdlist.[C_1], 4) IN ('2-10', '2-11', '2-12', '2-13', '2-14', '2-20', '2-**') 
) AS docs_min
ON docs_min.rownum = 1 
AND gtd.[BLOCK\1\@44_!_03011] = docs_min.[BLOCK\1\@44_!_03011]
AND gtd.vat = docs_min.vat
AND COALESCE(gtd.[BLOCK\1\@44_!_03011], '') &lt;&gt; ''
AND COALESCE(gtd.vat, '') &lt;&gt; ''

LEFT JOIN 
(SELECT reg_num, COUNT(*) all_count, SUM(CASE WHEN isNewItem = 1 AND isUnknown = 0 THEN 1 ELSE 0 END) sum_new
FROM [BI].[dwh].[WebProjectItems]
GROUP BY [reg_num]) AS web
ON web.reg_num = fact_dt.[Custom Declaration No_]

LEFT JOIN
(SELECT d.reg_num, COUNT(*) all_count
FROM [BI].[etl].[webproject_articuls] a JOIN [BI].[etl].[webproject_declarations] d ON a.declaration_id = d.id
GROUP BY d.reg_num) AS web_other
ON web_other.reg_num = fact_dt.[Custom Declaration No_]

WHERE base_dt.YYYY &gt;= 2019</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Source database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_year]"
                              name="dt_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_month]"
                              name="dt_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[department]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[department]"
                              name="department"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                              length="30"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[regnum]"
                              name="regnum"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[import40]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[import40]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[import40]"
                              name="import40"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[export10]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[export10]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[export10]"
                              name="export10"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[other_procedures]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[other_procedures]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[other_procedures]"
                              name="other_procedures"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_id]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[customer_id]"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_id]"
                              name="customer_id"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_name]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[customer_name]"
                              length="50"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_name]"
                              name="customer_name"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                              length="200"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                              name="specialist"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist_code]"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]"
                              name="specialist_code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[product_qty]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[product_qty]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[product_qty]"
                              name="product_qty"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[broker_payment_sign]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[broker_payment_sign]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[broker_payment_sign]"
                              name="broker_payment_sign"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[new_contract_sign]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[new_contract_sign]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[new_contract_sign]"
                              name="new_contract_sign"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_new_articuls_count]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_new_articuls_count]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_new_articuls_count]"
                              name="dt_new_articuls_count"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_overall_articuls_count]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]"
                              name="dt_overall_articuls_count"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_transport_qty]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_transport_qty]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_transport_qty]"
                              name="dt_transport_qty"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_inv_qty]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_inv_qty]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_inv_qty]"
                              name="dt_inv_qty"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_year]"
                              dataType="i4"
                              name="dt_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_month]"
                              dataType="i4"
                              name="dt_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                              dataType="i4"
                              name="department" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[regnum]"
                              dataType="wstr"
                              length="30"
                              name="regnum" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[import40]"
                              dataType="i4"
                              name="import40" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[export10]"
                              dataType="i4"
                              name="export10" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[other_procedures]"
                              dataType="i4"
                              name="other_procedures" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[customer_id]"
                              dataType="wstr"
                              length="20"
                              name="customer_id" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[customer_name]"
                              dataType="wstr"
                              length="50"
                              name="customer_name" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                              dataType="wstr"
                              length="200"
                              name="specialist" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist_code]"
                              dataType="wstr"
                              length="20"
                              name="specialist_code" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[product_qty]"
                              dataType="i4"
                              name="product_qty" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[broker_payment_sign]"
                              dataType="i4"
                              name="broker_payment_sign" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[new_contract_sign]"
                              dataType="i4"
                              name="new_contract_sign" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_new_articuls_count]"
                              dataType="i4"
                              name="dt_new_articuls_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_overall_articuls_count]"
                              dataType="i4"
                              name="dt_overall_articuls_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_transport_qty]"
                              dataType="i4"
                              name="dt_transport_qty" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_inv_qty]"
                              dataType="i4"
                              name="dt_inv_qty" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_year]"
                              name="dt_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_month]"
                              name="dt_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                              name="department" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                              dataType="wstr"
                              length="30"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[regnum]"
                              name="regnum" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[import40]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[import40]"
                              name="import40" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[export10]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[export10]"
                              name="export10" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[other_procedures]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[other_procedures]"
                              name="other_procedures" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[customer_id]"
                              dataType="wstr"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[customer_id]"
                              name="customer_id" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[customer_name]"
                              dataType="wstr"
                              length="50"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[customer_name]"
                              name="customer_name" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                              dataType="wstr"
                              length="200"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                              name="specialist" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist_code]"
                              dataType="wstr"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[specialist_code]"
                              name="specialist_code" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[product_qty]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[product_qty]"
                              name="product_qty" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[broker_payment_sign]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[broker_payment_sign]"
                              name="broker_payment_sign" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[new_contract_sign]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[new_contract_sign]"
                              name="new_contract_sign" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_new_articuls_count]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_new_articuls_count]"
                              name="dt_new_articuls_count" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_overall_articuls_count]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_overall_articuls_count]"
                              name="dt_overall_articuls_count" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_transport_qty]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_transport_qty]"
                              name="dt_transport_qty" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_inv_qty]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[dt_inv_qty]"
                              name="dt_inv_qty" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload DT details\Table"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                      description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                      name="Table"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_spec_dt_details</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_year]"
                              cachedDataType="i4"
                              cachedName="dt_year"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_month]"
                              cachedDataType="i4"
                              cachedName="dt_month"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[department]"
                              cachedDataType="i4"
                              cachedName="department"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[department]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[regnum]"
                              cachedDataType="wstr"
                              cachedLength="30"
                              cachedName="regnum"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[regnum]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[import40]"
                              cachedDataType="i4"
                              cachedName="import40"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[import40]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[import40]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[export10]"
                              cachedDataType="i4"
                              cachedName="export10"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[export10]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[export10]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[other_procedures]"
                              cachedDataType="i4"
                              cachedName="other_procedures"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[other_procedures]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[other_procedures]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[customer_id]"
                              cachedDataType="wstr"
                              cachedLength="20"
                              cachedName="customer_id"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[customer_id]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_id]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[customer_name]"
                              cachedDataType="wstr"
                              cachedLength="50"
                              cachedName="customer_name"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[customer_name]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[customer_name]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[specialist]"
                              cachedDataType="wstr"
                              cachedLength="200"
                              cachedName="specialist"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[specialist_code]"
                              cachedDataType="wstr"
                              cachedLength="20"
                              cachedName="specialist_code"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist_code]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[product_qty]"
                              cachedDataType="i4"
                              cachedName="product_qty"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[product_qty]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[product_qty]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[broker_payment_sign]"
                              cachedDataType="i4"
                              cachedName="broker_payment_sign"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[broker_payment_sign]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[broker_payment_sign]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[new_contract_sign]"
                              cachedDataType="i4"
                              cachedName="new_contract_sign"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[new_contract_sign]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[new_contract_sign]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_new_articuls_count]"
                              cachedDataType="i4"
                              cachedName="dt_new_articuls_count"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_new_articuls_count]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_new_articuls_count]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_overall_articuls_count]"
                              cachedDataType="i4"
                              cachedName="dt_overall_articuls_count"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_overall_articuls_count]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_overall_articuls_count]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_transport_qty]"
                              cachedDataType="i4"
                              cachedName="dt_transport_qty"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_transport_qty]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_transport_qty]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].Columns[dt_inv_qty]"
                              cachedDataType="i4"
                              cachedName="dt_inv_qty"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_inv_qty]"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output].Columns[dt_inv_qty]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_year]"
                              dataType="i4"
                              name="dt_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_month]"
                              dataType="i4"
                              name="dt_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                              dataType="wstr"
                              length="300"
                              name="department" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[regnum]"
                              dataType="wstr"
                              length="30"
                              name="regnum" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[import40]"
                              dataType="i4"
                              name="import40" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[export10]"
                              dataType="i4"
                              name="export10" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[other_procedures]"
                              dataType="i4"
                              name="other_procedures" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[customer_id]"
                              dataType="wstr"
                              length="20"
                              name="customer_id" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[customer_name]"
                              dataType="wstr"
                              length="50"
                              name="customer_name" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                              dataType="wstr"
                              length="200"
                              name="specialist" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist_code]"
                              dataType="wstr"
                              length="20"
                              name="specialist_code" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[product_qty]"
                              dataType="i4"
                              name="product_qty" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[broker_payment_sign]"
                              dataType="i4"
                              name="broker_payment_sign" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[new_contract_sign]"
                              dataType="i4"
                              name="new_contract_sign" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_new_articuls_count]"
                              dataType="i4"
                              name="dt_new_articuls_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_overall_articuls_count]"
                              dataType="i4"
                              name="dt_overall_articuls_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_transport_qty]"
                              dataType="i4"
                              name="dt_transport_qty" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_inv_qty]"
                              dataType="i4"
                              name="dt_inv_qty" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload DT details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Check tables for empty\Specialist\Reload DT details.Paths[ADO NET Source Output]"
                      endId="Package\Check tables for empty\Specialist\Reload DT details\Table.Inputs[ADO NET Destination Input]"
                      name="ADO NET Source Output"
                      startId="Package\Check tables for empty\Specialist\Reload DT details\Query.Outputs[ADO NET Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Specialist\Reload main"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{CE930A1B-D1BC-4E29-BE83-9D169E82FE28}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Reload main"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload main\Query"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                      name="Query"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">WITH cte_calendar AS (
	SELECT id_year, id_month, SUM(CAST([WorkDay] AS int)) work_days_in_month
	FROM [BI].[dbo].[DimCalendar] dc
	WHERE id_year &gt;= 2019 
	AND (id_year &lt; YEAR(GETDATE()) OR (id_year = YEAR(GETDATE()) AND id_month &lt;= MONTH(GETDATE())))
	GROUP BY id_year, id_month
),

cte_distinct_code AS (
	SELECT DISTINCT [code] 
	FROM [motivation].[dbo].[sto_workers] 
	WHERE [type] = 'specialist'
),

cte_work_days AS (
	SELECT 
	YEAR([Date]) id_year, 
	MONTH([Date]) id_month, 
	esp.SalespersonCode code,
	COUNT(0) work_days
	FROM (SELECT tt.*, ROW_NUMBER() OVER (PARTITION BY [Person], [Date] ORDER BY (SELECT NULL)) rownum FROM [motivation].[dbo].[timesheet] tt) AS t
	JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] AS esp ON esp.[SalespersonName] = t.[Person]
	WHERE t.[Letter_code] = 'Я' AND t.[Date] &lt;= GETDATE() AND t.rownum = 1
	GROUP BY YEAR([Date]), MONTH([Date]), esp.SalespersonCode
),

cte_base AS (
	SELECT [id_year], [id_month], [work_days_in_month], [name], [code], [department], [estimate_participant], COALESCE([work_days], 0) [work_days]
	FROM cte_calendar c
	
	CROSS JOIN cte_distinct_code 
	
	--[sto_workers] содержит записи с полями [date_begin] [date_end]
	--которые определяют (!) непересекающиеся интервалы времени и предоставляют данные для расчета
	--[date_end] NULL означает текущую активную запись если сотрудник работает
	--отсутствие записи с [date_end] NULL = был уволен
	--на случай ошибок при внесении данных в таблицу оставляем TOP (1) и ORDER BY
	CROSS APPLY (
	SELECT TOP (1) [name], [department], [estimate_participant] FROM [motivation].[dbo].[sto_workers] w
	WHERE w.[type] = 'specialist' 
	AND w.[code] = cte_distinct_code.code
	AND CAST(DATEFROMPARTS(id_year, id_month, 15) AS date) 
	BETWEEN w.[date_begin] AND COALESCE(w.[date_end], CAST(EOMONTH(GETDATE()) AS date)) 
	ORDER BY CASE WHEN w.[date_end] IS NULL THEN 1 ELSE 0 END ASC	
	) AS ca_workers_data

	OUTER APPLY (
	SELECT work_days 
	FROM cte_work_days cte 
	WHERE cte.id_year = c.id_year AND cte.id_month = c.id_month AND cte.code = cte_distinct_code.code) as oa_work_days
),

cte_dt AS (
	SELECT
	dt_year id_year,
	dt_month id_month,
	ssd.specialist_code specialist_code,
	SUM(ssd.import40) sum_import40,
	SUM(ssd.export10) sum_export10,
	SUM(ssd.other_procedures) sum_other_procedures,
	SUM(ssd.broker_payment_sign) sum_broker_payment,
	COUNT(DISTINCT ssd.customer_id) unique_customers,
	COUNT(ssd.regnum) dt_count,
	SUM(ssd.product_qty) sum_products,
	SUM(ssd.new_contract_sign) sum_new_contracts,
	SUM(ssd.dt_overall_articuls_count) sum_articuls,
	SUM(ssd.dt_new_articuls_count) sum_new_articuls,
	SUM(ssd.dt_transport_qty) sum_transport,
	SUM(ssd.dt_inv_qty) sum_invoices
	FROM [motivation].[dbo].[sto_spec_dt_details] ssd
	GROUP BY ssd.specialist_code, ssd.dt_month, ssd.dt_year
),

cte_td AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[specialist] code,
	COUNT(*) all_td
	FROM [motivation].[dbo].[sto_td_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [specialist]
),

cte_request AS (
	SELECT 
	YEAR([release_datetime]) id_year, 
	MONTH([release_datetime]) id_month, 
	[specialist] code,
	COUNT(*) all_request
	FROM [motivation].[dbo].[sto_app_before_dt_details]
	WHERE [release_datetime] IS NOT NULL
	GROUP BY YEAR([release_datetime]), MONTH([release_datetime]), [specialist]
),

cte_stat AS (
	SELECT 
	[stat_year] id_year
	,[stat_month] id_month
	,[specialist_code] code
	,COUNT(*) all_stat
	FROM [motivation].[dbo].[sto_stat_details]
	GROUP BY [stat_year], [stat_month], [specialist_code]
),

cte_extended AS (

SELECT 
cte_base.*
,COALESCE(cte_dt.sum_import40, 0) sum_import40
,COALESCE(cte_dt.sum_export10, 0) sum_export10
,COALESCE(cte_dt.sum_other_procedures, 0) sum_other_procedures
,COALESCE(cte_dt.sum_broker_payment, 0) sum_broker_payment
,COALESCE(cte_dt.unique_customers, 0) unique_customers
,COALESCE(cte_dt.dt_count, 0) dt_count
,COALESCE(cte_dt.sum_products, 0) sum_products
,COALESCE(cte_dt.sum_new_contracts, 0) sum_new_contracts
,COALESCE(cte_dt.sum_articuls, 0) sum_articuls
,COALESCE(cte_dt.sum_new_articuls, 0) sum_new_articuls
,COALESCE(cte_dt.sum_transport, 0) sum_transport
,COALESCE(cte_dt.sum_invoices, 0) sum_invoices
,COALESCE(cte_td.all_td, 0) all_td
,COALESCE(cte_request.all_request, 0) all_request
,COALESCE(cte_stat.all_stat, 0) all_stat

FROM cte_base
LEFT JOIN cte_dt 
	ON cte_dt.id_year = cte_base.id_year 
	AND cte_dt.id_month = cte_base.id_month
	AND cte_dt.specialist_code = cte_base.code
LEFT JOIN cte_td
	ON cte_td.id_year = cte_base.id_year 
	AND cte_td.id_month = cte_base.id_month
	AND cte_td.code = cte_base.code
LEFT JOIN cte_request
	ON cte_request.id_year = cte_base.id_year 
	AND cte_request.id_month = cte_base.id_month
	AND cte_request.code = cte_base.code
LEFT JOIN cte_stat
	ON cte_stat.id_year = cte_base.id_year 
	AND cte_stat.id_month = cte_base.id_month
	AND cte_stat.code = cte_base.code
),

cte_pre_calc AS (
	SELECT c.* 
	,COUNT(CASE WHEN estimate_participant = 1 THEN 1 END) OVER (PARTITION BY id_year, id_month) [workers_count]
	,f.[spec_broker_payment]
	,f.[spec_dt]
	,f.[spec_new_contract]
	,f.[spec_articul]
	,f.[spec_new_articul]
	,f.[spec_product]
	,f.[spec_ts]
	,f.[spec_other_procedures]
	,f.[spec_stat_forms]
	,f.[spec_td]
	,f.[spec_request]	
	
	,estimate = ([sum_broker_payment] * [spec_broker_payment]
				+ [dt_count] * [spec_dt]
				+ [sum_new_contracts] * [spec_new_contract]
				+ ([sum_articuls] - [sum_new_articuls]) * [spec_articul]
				+ CASE
				WHEN [sum_new_articuls] &gt; 2000 THEN [sum_new_articuls] * 0.3
				WHEN [sum_new_articuls] &gt; 1000 THEN [sum_new_articuls] * 0.5
				ELSE [sum_new_articuls] END * [spec_new_articul]
				+ [sum_products] * [spec_product]
				+ [spec_ts] * [sum_transport]
				+ [spec_other_procedures] * [sum_other_procedures]
				+ [spec_stat_forms] * [all_stat]
				+ [spec_td] * [all_td]
				+ [spec_request] * [all_request])

	FROM cte_extended c
	JOIN [motivation].[dbo].[sto_factors] f ON f.department = c.department AND f.[sign] = 'specialist'
),

cte_calc_done AS (

SELECT c.*,
overall_estimate =
CONVERT(decimal(18,2), CASE 
	--начало месяца с нерабочих дней - учитывается один рабочий день
	WHEN COALESCE(work_days, 0) = 0 AND calendar_now.work_days_in_month_now = 0
	THEN (estimate / (1.00 / work_days_in_month))	
	--прочее условие если сотрудник не отработал ни одного дня
	WHEN COALESCE(work_days, 0) = 0 THEN 0.00	
	--общий случай, обычный расчет
	ELSE (estimate / (CONVERT(decimal(18, 10), work_days) / work_days_in_month))
END)
FROM cte_pre_calc c
CROSS APPLY
(SELECT COUNT(0) work_days_in_month_now 
FROM [BI].[dbo].[DimCalendar] dc
WHERE dc.DT &lt;= CAST(GETDATE() AS date)
AND dc.id_year = c.id_year
AND dc.id_month = c.id_month
AND dc.WorkDay = 1) AS calendar_now
)

SELECT c.*,

CONVERT(decimal(18,2), 
COALESCE(
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
) average_group_estimate,

CONVERT(decimal(18,2), 
COALESCE(
overall_estimate / 
NULLIF (
AVG(CASE WHEN estimate_participant = 1 THEN overall_estimate ELSE NULL END) 
OVER (PARTITION BY id_year, id_month)
, 0)
, 0)
) worker_factor

FROM cte_calc_done c</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Source database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload main\Query.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]"
                              name="id_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]"
                              name="id_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]"
                              name="work_days_in_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                              length="300"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]"
                              name="name"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                              length="100"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]"
                              name="code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                              length="300"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]"
                              name="department"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]"
                              name="estimate_participant"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]"
                              name="work_days"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_import40]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]"
                              name="sum_import40"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_export10]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]"
                              name="sum_export10"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_other_procedures]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]"
                              name="sum_other_procedures"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_broker_payment]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_broker_payment]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_broker_payment]"
                              name="sum_broker_payment"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[unique_customers]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[unique_customers]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[unique_customers]"
                              name="unique_customers"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[dt_count]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_count]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[dt_count]"
                              name="dt_count"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_products]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]"
                              name="sum_products"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_contracts]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_new_contracts]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_contracts]"
                              name="sum_new_contracts"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_articuls]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]"
                              name="sum_articuls"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_articuls]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_new_articuls]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_articuls]"
                              name="sum_new_articuls"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_transport]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_transport]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_transport]"
                              name="sum_transport"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_invoices]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_invoices]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_invoices]"
                              name="sum_invoices"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_td]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]"
                              name="all_td"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_request]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]"
                              name="all_request"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_stat]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_stat]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_stat]"
                              name="all_stat"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]"
                              name="workers_count"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_broker_payment]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_broker_payment]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_broker_payment]"
                              name="spec_broker_payment"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_dt]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_dt]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_dt]"
                              name="spec_dt"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_contract]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_new_contract]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_contract]"
                              name="spec_new_contract"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_articul]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_articul]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_articul]"
                              name="spec_articul"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_articul]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_new_articul]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_articul]"
                              name="spec_new_articul"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_product]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_product]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_product]"
                              name="spec_product"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_ts]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_ts]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_ts]"
                              name="spec_ts"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_other_procedures]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_other_procedures]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_other_procedures]"
                              name="spec_other_procedures"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_stat_forms]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_stat_forms]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_stat_forms]"
                              name="spec_stat_forms"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_td]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_td]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_td]"
                              name="spec_td"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_request]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_request]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_request]"
                              name="spec_request"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]"
                              name="estimate"
                              precision="38"
                              scale="3"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]"
                              name="overall_estimate"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]"
                              name="average_group_estimate"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]"
                              name="worker_factor"
                              precision="18"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_year]"
                              dataType="i4"
                              name="id_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[id_month]"
                              dataType="i4"
                              name="id_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days_in_month]"
                              dataType="i4"
                              name="work_days_in_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[name]"
                              dataType="wstr"
                              length="300"
                              name="name" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[code]"
                              dataType="wstr"
                              length="100"
                              name="code" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[department]"
                              dataType="wstr"
                              length="300"
                              name="department" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate_participant]"
                              dataType="i4"
                              name="estimate_participant" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[work_days]"
                              dataType="i4"
                              name="work_days" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_import40]"
                              dataType="i4"
                              name="sum_import40" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_export10]"
                              dataType="i4"
                              name="sum_export10" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_other_procedures]"
                              dataType="i4"
                              name="sum_other_procedures" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_broker_payment]"
                              dataType="i4"
                              name="sum_broker_payment" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[unique_customers]"
                              dataType="i4"
                              name="unique_customers" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[dt_count]"
                              dataType="i4"
                              name="dt_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_products]"
                              dataType="i4"
                              name="sum_products" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_new_contracts]"
                              dataType="i4"
                              name="sum_new_contracts" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_articuls]"
                              dataType="i4"
                              name="sum_articuls" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_new_articuls]"
                              dataType="i4"
                              name="sum_new_articuls" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_transport]"
                              dataType="i4"
                              name="sum_transport" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[sum_invoices]"
                              dataType="i4"
                              name="sum_invoices" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_td]"
                              dataType="i4"
                              name="all_td" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_request]"
                              dataType="i4"
                              name="all_request" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[all_stat]"
                              dataType="i4"
                              name="all_stat" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[workers_count]"
                              dataType="i4"
                              name="workers_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_broker_payment]"
                              dataType="numeric"
                              name="spec_broker_payment"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_dt]"
                              dataType="numeric"
                              name="spec_dt"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_new_contract]"
                              dataType="numeric"
                              name="spec_new_contract"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_articul]"
                              dataType="numeric"
                              name="spec_articul"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_new_articul]"
                              dataType="numeric"
                              name="spec_new_articul"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_product]"
                              dataType="numeric"
                              name="spec_product"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_ts]"
                              dataType="numeric"
                              name="spec_ts"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_other_procedures]"
                              dataType="numeric"
                              name="spec_other_procedures"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_stat_forms]"
                              dataType="numeric"
                              name="spec_stat_forms"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_td]"
                              dataType="numeric"
                              name="spec_td"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[spec_request]"
                              dataType="numeric"
                              name="spec_request"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[estimate]"
                              dataType="numeric"
                              name="estimate"
                              precision="38"
                              scale="3" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[overall_estimate]"
                              dataType="numeric"
                              name="overall_estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[average_group_estimate]"
                              dataType="numeric"
                              name="average_group_estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].ExternalColumns[worker_factor]"
                              dataType="numeric"
                              name="worker_factor"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_year]"
                              name="id_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[id_month]"
                              name="id_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days_in_month]"
                              name="work_days_in_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                              dataType="wstr"
                              length="300"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[name]"
                              name="name" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                              dataType="wstr"
                              length="100"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[code]"
                              name="code" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                              dataType="wstr"
                              length="300"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[department]"
                              name="department" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate_participant]"
                              name="estimate_participant" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[work_days]"
                              name="work_days" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_import40]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_import40]"
                              name="sum_import40" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_export10]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_export10]"
                              name="sum_export10" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_other_procedures]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_other_procedures]"
                              name="sum_other_procedures" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_broker_payment]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_broker_payment]"
                              name="sum_broker_payment" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[unique_customers]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[unique_customers]"
                              name="unique_customers" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[dt_count]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[dt_count]"
                              name="dt_count" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_products]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_products]"
                              name="sum_products" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_new_contracts]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_new_contracts]"
                              name="sum_new_contracts" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_articuls]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_articuls]"
                              name="sum_articuls" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_new_articuls]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_new_articuls]"
                              name="sum_new_articuls" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_transport]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_transport]"
                              name="sum_transport" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_invoices]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[sum_invoices]"
                              name="sum_invoices" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_td]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_td]"
                              name="all_td" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_request]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_request]"
                              name="all_request" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_stat]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[all_stat]"
                              name="all_stat" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[workers_count]"
                              name="workers_count" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_broker_payment]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_broker_payment]"
                              name="spec_broker_payment"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_dt]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_dt]"
                              name="spec_dt"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_new_contract]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_new_contract]"
                              name="spec_new_contract"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_articul]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_articul]"
                              name="spec_articul"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_new_articul]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_new_articul]"
                              name="spec_new_articul"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_product]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_product]"
                              name="spec_product"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_ts]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_ts]"
                              name="spec_ts"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_other_procedures]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_other_procedures]"
                              name="spec_other_procedures"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_stat_forms]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_stat_forms]"
                              name="spec_stat_forms"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_td]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_td]"
                              name="spec_td"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_request]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[spec_request]"
                              name="spec_request"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[estimate]"
                              name="estimate"
                              precision="38"
                              scale="3" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[overall_estimate]"
                              name="overall_estimate"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[average_group_estimate]"
                              name="average_group_estimate"
                              precision="18"
                              scale="2" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                              dataType="numeric"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Error Output].Columns[worker_factor]"
                              name="worker_factor"
                              precision="18"
                              scale="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload main\Table"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                      description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                      name="Table"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_specialist_main</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload main\Table.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_year]"
                              cachedDataType="i4"
                              cachedName="id_year"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[id_month]"
                              cachedDataType="i4"
                              cachedName="id_month"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[id_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days_in_month]"
                              cachedDataType="i4"
                              cachedName="work_days_in_month"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days_in_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[name]"
                              cachedDataType="wstr"
                              cachedLength="300"
                              cachedName="name"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[name]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[code]"
                              cachedDataType="wstr"
                              cachedLength="100"
                              cachedName="code"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[code]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[department]"
                              cachedDataType="wstr"
                              cachedLength="300"
                              cachedName="department"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[department]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate_participant]"
                              cachedDataType="i4"
                              cachedName="estimate_participant"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate_participant]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[work_days]"
                              cachedDataType="i4"
                              cachedName="work_days"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[work_days]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_import40]"
                              cachedDataType="i4"
                              cachedName="sum_import40"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_import40]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_import40]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_export10]"
                              cachedDataType="i4"
                              cachedName="sum_export10"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_export10]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_export10]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_other_procedures]"
                              cachedDataType="i4"
                              cachedName="sum_other_procedures"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_other_procedures]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_other_procedures]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_broker_payment]"
                              cachedDataType="i4"
                              cachedName="sum_broker_payment"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_broker_payment]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_broker_payment]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[unique_customers]"
                              cachedDataType="i4"
                              cachedName="unique_customers"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[unique_customers]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[unique_customers]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[dt_count]"
                              cachedDataType="i4"
                              cachedName="dt_count"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_count]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[dt_count]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_products]"
                              cachedDataType="i4"
                              cachedName="sum_products"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_products]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_products]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_new_contracts]"
                              cachedDataType="i4"
                              cachedName="sum_new_contracts"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_new_contracts]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_contracts]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_articuls]"
                              cachedDataType="i4"
                              cachedName="sum_articuls"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_articuls]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_articuls]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_new_articuls]"
                              cachedDataType="i4"
                              cachedName="sum_new_articuls"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_new_articuls]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_new_articuls]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_transport]"
                              cachedDataType="i4"
                              cachedName="sum_transport"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_transport]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_transport]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[sum_invoices]"
                              cachedDataType="i4"
                              cachedName="sum_invoices"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_invoices]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[sum_invoices]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_td]"
                              cachedDataType="i4"
                              cachedName="all_td"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_td]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_td]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_request]"
                              cachedDataType="i4"
                              cachedName="all_request"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_request]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_request]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[all_stat]"
                              cachedDataType="i4"
                              cachedName="all_stat"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_stat]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[all_stat]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[workers_count]"
                              cachedDataType="i4"
                              cachedName="workers_count"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[workers_count]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_broker_payment]"
                              cachedDataType="numeric"
                              cachedName="spec_broker_payment"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_broker_payment]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_broker_payment]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_dt]"
                              cachedDataType="numeric"
                              cachedName="spec_dt"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_dt]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_dt]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_new_contract]"
                              cachedDataType="numeric"
                              cachedName="spec_new_contract"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_new_contract]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_contract]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_articul]"
                              cachedDataType="numeric"
                              cachedName="spec_articul"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_articul]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_articul]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_new_articul]"
                              cachedDataType="numeric"
                              cachedName="spec_new_articul"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_new_articul]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_new_articul]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_product]"
                              cachedDataType="numeric"
                              cachedName="spec_product"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_product]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_product]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_ts]"
                              cachedDataType="numeric"
                              cachedName="spec_ts"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_ts]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_ts]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_other_procedures]"
                              cachedDataType="numeric"
                              cachedName="spec_other_procedures"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_other_procedures]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_other_procedures]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_stat_forms]"
                              cachedDataType="numeric"
                              cachedName="spec_stat_forms"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_stat_forms]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_stat_forms]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_td]"
                              cachedDataType="numeric"
                              cachedName="spec_td"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_td]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_td]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[spec_request]"
                              cachedDataType="numeric"
                              cachedName="spec_request"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_request]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[spec_request]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[estimate]"
                              cachedDataType="numeric"
                              cachedName="estimate"
                              cachedPrecision="38"
                              cachedScale="3"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[estimate]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[overall_estimate]"
                              cachedDataType="numeric"
                              cachedName="overall_estimate"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[overall_estimate]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[average_group_estimate]"
                              cachedDataType="numeric"
                              cachedName="average_group_estimate"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[average_group_estimate]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].Columns[worker_factor]"
                              cachedDataType="numeric"
                              cachedName="worker_factor"
                              cachedPrecision="18"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output].Columns[worker_factor]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_year]"
                              dataType="i4"
                              name="id_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[id_month]"
                              dataType="i4"
                              name="id_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days_in_month]"
                              dataType="i4"
                              name="work_days_in_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[name]"
                              dataType="wstr"
                              length="300"
                              name="name" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[code]"
                              dataType="wstr"
                              length="100"
                              name="code" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[department]"
                              dataType="wstr"
                              length="300"
                              name="department" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate_participant]"
                              dataType="i4"
                              name="estimate_participant" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[work_days]"
                              dataType="i4"
                              name="work_days" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_import40]"
                              dataType="i4"
                              name="sum_import40" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_export10]"
                              dataType="i4"
                              name="sum_export10" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_other_procedures]"
                              dataType="i4"
                              name="sum_other_procedures" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_broker_payment]"
                              dataType="i4"
                              name="sum_broker_payment" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[unique_customers]"
                              dataType="i4"
                              name="unique_customers" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[dt_count]"
                              dataType="i4"
                              name="dt_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_products]"
                              dataType="i4"
                              name="sum_products" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_new_contracts]"
                              dataType="i4"
                              name="sum_new_contracts" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_articuls]"
                              dataType="i4"
                              name="sum_articuls" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_new_articuls]"
                              dataType="i4"
                              name="sum_new_articuls" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_transport]"
                              dataType="i4"
                              name="sum_transport" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[sum_invoices]"
                              dataType="i4"
                              name="sum_invoices" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_td]"
                              dataType="i4"
                              name="all_td" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_request]"
                              dataType="i4"
                              name="all_request" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[all_stat]"
                              dataType="i4"
                              name="all_stat" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[workers_count]"
                              dataType="i4"
                              name="workers_count" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_broker_payment]"
                              dataType="numeric"
                              name="spec_broker_payment"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_dt]"
                              dataType="numeric"
                              name="spec_dt"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_new_contract]"
                              dataType="numeric"
                              name="spec_new_contract"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_articul]"
                              dataType="numeric"
                              name="spec_articul"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_new_articul]"
                              dataType="numeric"
                              name="spec_new_articul"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_product]"
                              dataType="numeric"
                              name="spec_product"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_ts]"
                              dataType="numeric"
                              name="spec_ts"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_other_procedures]"
                              dataType="numeric"
                              name="spec_other_procedures"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_stat_forms]"
                              dataType="numeric"
                              name="spec_stat_forms"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_td]"
                              dataType="numeric"
                              name="spec_td"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[spec_request]"
                              dataType="numeric"
                              name="spec_request"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[estimate]"
                              dataType="numeric"
                              name="estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[overall_estimate]"
                              dataType="numeric"
                              name="overall_estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[average_group_estimate]"
                              dataType="numeric"
                              name="average_group_estimate"
                              precision="18"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input].ExternalColumns[worker_factor]"
                              dataType="numeric"
                              name="worker_factor"
                              precision="18"
                              scale="2" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload main\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Check tables for empty\Specialist\Reload main.Paths[ADO NET Source Output]"
                      endId="Package\Check tables for empty\Specialist\Reload main\Table.Inputs[ADO NET Destination Input]"
                      name="ADO NET Source Output"
                      startId="Package\Check tables for empty\Specialist\Reload main\Query.Outputs[ADO NET Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Specialist\Reload stat details"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{00C96574-552F-4A5F-8ED2-584A5A5FD45B}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Reload stat details"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload stat details\Query"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                      name="Query"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT 
YYYY stat_year,
MM stat_month,
DeliveryNo_ delivery_number,
DeclarationNo_ stat_number,
sp.SalespersonCode specialist_code
FROM [BI].[olap].[FactDeliveryDeclarationsSTODetail] d
JOIN [BI].[dwh].[ETP$Salesperson_Purchaser] sp ON sp.SalespersonKey = d.DeclarantKey
WHERE [isDeclaration] = 1 AND [DTCountStatisticalForms] = 1</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Source database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_year]"
                              name="stat_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_month]"
                              name="stat_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                              name="delivery_number"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_number]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_number]"
                              length="30"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_number]"
                              name="stat_number"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist_code]"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]"
                              name="specialist_code"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_year]"
                              dataType="i4"
                              name="stat_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_month]"
                              dataType="i4"
                              name="stat_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                              dataType="wstr"
                              length="20"
                              name="delivery_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[stat_number]"
                              dataType="wstr"
                              length="30"
                              name="stat_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist_code]"
                              dataType="wstr"
                              length="20"
                              name="specialist_code" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_year]"
                              name="stat_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_month]"
                              name="stat_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                              dataType="wstr"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                              name="delivery_number" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_number]"
                              dataType="wstr"
                              length="30"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[stat_number]"
                              name="stat_number" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[specialist_code]"
                              dataType="wstr"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[specialist_code]"
                              name="specialist_code" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload stat details\Table"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                      description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                      name="Table"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_stat_details</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[stat_year]"
                              cachedDataType="i4"
                              cachedName="stat_year"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[stat_month]"
                              cachedDataType="i4"
                              cachedName="stat_month"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[delivery_number]"
                              cachedDataType="wstr"
                              cachedLength="20"
                              cachedName="delivery_number"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[stat_number]"
                              cachedDataType="wstr"
                              cachedLength="30"
                              cachedName="stat_number"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_number]"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[stat_number]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].Columns[specialist_code]"
                              cachedDataType="wstr"
                              cachedLength="20"
                              cachedName="specialist_code"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist_code]"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output].Columns[specialist_code]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_year]"
                              dataType="i4"
                              name="stat_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_month]"
                              dataType="i4"
                              name="stat_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                              dataType="wstr"
                              length="20"
                              name="delivery_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[stat_number]"
                              dataType="wstr"
                              length="30"
                              name="stat_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist_code]"
                              dataType="wstr"
                              length="20"
                              name="specialist_code" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload stat details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Check tables for empty\Specialist\Reload stat details.Paths[ADO NET Source Output]"
                      endId="Package\Check tables for empty\Specialist\Reload stat details\Table.Inputs[ADO NET Destination Input]"
                      name="ADO NET Source Output"
                      startId="Package\Check tables for empty\Specialist\Reload stat details\Query.Outputs[ADO NET Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Specialist\Reload TD details"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Задача потока данных"
              DTS:DTSID="{97E9B588-C7BF-46EE-9EB6-BABAD931E5EB}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Reload TD details"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload TD details\Query"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="Consumes data from SQL Server, OLE DB, ODBC, or Oracle, using the corresponding .NET Framework data provider. Use a Transact-SQL statement to define the result set. For example, extract data from SQL Server with the .NET Framework data provider for SQL Server."
                      name="Query"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the SQL statement used by the component to extract data."
                          expressionType="Notify"
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">SELECT 
  ca.[Declarant Code] specialist
  ,td.[7_1] alta_number
  ,td.[TD_TYPE] td_type
  ,td.delivery_number
  ,ed_reg.reg_num
  ,ed_reg.reg_datetime
  ,ed_reg.reg_year
  ,ed_reg.reg_month  
  ,ed_release.release_datetime
  ,ed_release.release_year
  ,ed_release.release_month
  ,ed_closure.closure_datetime
  ,ed_closure.closure_year
  ,ed_closure.closure_month  
  ,oa.declarant_code

  FROM (SELECT t.[7_1], 
		t.DOCGID, 
		t.[TD_TYPE], 
		functions.dbo.GetDeliveryNumber(t.[&amp;&amp;PRIM]) delivery_number 
		FROM [gtd].[dbo].[TD1List] t 
		WHERE [TD_TYPE] IN ('ТД','ПТД') AND t.[&amp;&amp;PRIM] LIKE '%D[0-9][0-9][0-9][0-9][0-9][0-9]%'	
		) AS td  
  
  LEFT JOIN [gtd].[dbo].[Docs] d ON d.GID = td.DOCGID
  
  LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) reg_year
	,MONTH([InOutDateTime]) reg_month
	,[InOutDateTime] reg_datetime
	,[Result] reg_num
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.15005' AND [Incoming] = 1) AS ed_reg ON td.docgid = ed_reg.gid AND ed_reg.row_num = 1
  
    LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) release_year
	,MONTH([InOutDateTime]) release_month
	,[InOutDateTime] release_datetime
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.15007' AND [Incoming] = 1) AS ed_release ON td.docgid = ed_release.gid AND ed_release.row_num = 1
  
    LEFT JOIN (SELECT 
	YEAR([InOutDateTime]) closure_year
	,MONTH([InOutDateTime]) closure_month
	,[InOutDateTime] closure_datetime
	,[DocGuid] gid
	,ROW_NUMBER() OVER (PARTITION BY [DocGuid], [MessageType] ORDER BY [InOutDateTime] ASC) row_num
	FROM [gtd].[dbo].[EDMsgs]
	WHERE MessageType = 'CMN.15016' AND [Incoming] = 1) AS ed_closure ON td.docgid = ed_closure.gid AND ed_closure.row_num = 1
  
	CROSS APPLY (SELECT TOP (1) sd.[Declarant Code] FROM [BI].[dwh].[ETP$SQL_Delivery] sd 
				 WHERE sd.[No_] = td.delivery_number) AS ca

	OUTER APPLY (SELECT TOP (1) [SalespersonCode] declarant_code 
				FROM [BI].[dwh].[vDimDeclarant] dd
				WHERE UPPER(LTRIM(RTRIM(dd.USERNAME)))= UPPER(LTRIM(RTRIM(d.EDSENDER)))
				) AS oa</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether to allow non-string external columns to be implicitly converted to strings at the output columns."
                          name="AllowImplicitStringConversion">true</property>
                        <property
                          dataType="System.String"
                          description="The Source database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                        <property
                          dataType="System.Int32"
                          description="Specify the mode to retrieve external column information"
                          name="AccessMode"
                          typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output]"
                          name="ADO NET Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                              length="10"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[specialist]"
                              name="specialist"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[alta_number]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[alta_number]"
                              length="23"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[alta_number]"
                              name="alta_number"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[td_type]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[td_type]"
                              length="4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[td_type]"
                              name="td_type"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                              dataType="nText"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]"
                              name="delivery_number"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_num]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_num]"
                              length="250"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_num]"
                              name="reg_num"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]"
                              dataType="dbTimeStamp"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]"
                              name="reg_datetime"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_year]"
                              name="reg_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_month]"
                              name="reg_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]"
                              dataType="dbTimeStamp"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]"
                              name="release_datetime"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_year]"
                              name="release_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_month]"
                              name="release_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_datetime]"
                              dataType="dbTimeStamp"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_datetime]"
                              name="closure_datetime"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_year]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_year]"
                              name="closure_year"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_month]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_month]"
                              name="closure_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]"
                              name="declarant_code"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[specialist]"
                              dataType="wstr"
                              length="10"
                              name="specialist" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[alta_number]"
                              dataType="wstr"
                              length="23"
                              name="alta_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[td_type]"
                              dataType="wstr"
                              length="4"
                              name="td_type" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[delivery_number]"
                              dataType="nText"
                              name="delivery_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_num]"
                              dataType="wstr"
                              length="250"
                              name="reg_num" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_datetime]"
                              dataType="dbTimeStamp"
                              name="reg_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_year]"
                              dataType="i4"
                              name="reg_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[reg_month]"
                              dataType="i4"
                              name="reg_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_datetime]"
                              dataType="dbTimeStamp"
                              name="release_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_year]"
                              dataType="i4"
                              name="release_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[release_month]"
                              dataType="i4"
                              name="release_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_datetime]"
                              dataType="dbTimeStamp"
                              name="closure_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_year]"
                              dataType="i4"
                              name="closure_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[closure_month]"
                              dataType="i4"
                              name="closure_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].ExternalColumns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              name="declarant_code" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output]"
                          isErrorOut="true"
                          name="ADO NET Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                              dataType="wstr"
                              length="10"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[specialist]"
                              name="specialist" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[alta_number]"
                              dataType="wstr"
                              length="23"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[alta_number]"
                              name="alta_number" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[td_type]"
                              dataType="wstr"
                              length="4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[td_type]"
                              name="td_type" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                              dataType="nText"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[delivery_number]"
                              name="delivery_number" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_num]"
                              dataType="wstr"
                              length="250"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_num]"
                              name="reg_num" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_datetime]"
                              dataType="dbTimeStamp"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_datetime]"
                              name="reg_datetime" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_year]"
                              name="reg_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[reg_month]"
                              name="reg_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_datetime]"
                              dataType="dbTimeStamp"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_datetime]"
                              name="release_datetime" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_year]"
                              name="release_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[release_month]"
                              name="release_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_datetime]"
                              dataType="dbTimeStamp"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_datetime]"
                              name="closure_datetime" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_year]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_year]"
                              name="closure_year" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_month]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[closure_month]"
                              name="closure_month" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                              dataType="wstr"
                              length="20"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[declarant_code]"
                              name="declarant_code" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Check tables for empty\Specialist\Reload TD details\Table"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                      description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                      name="Table"
                      usesDispositions="true"
                      version="2">
                      <properties>
                        <property
                          dataType="System.String"
                          description="The Destination database table name."
                          expressionType="Notify"
                          name="TableOrViewName"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">motivation.dbo.sto_td_details</property>
                        <property
                          dataType="System.Int32"
                          description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                          expressionType="Notify"
                          name="BatchSize">0</property>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                          expressionType="Notify"
                          name="CommandTimeout">30</property>
                        <property
                          dataType="System.Boolean"
                          description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                          expressionType="Notify"
                          name="UseBulkInsertWhenPossible">true</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Connections[IDbConnection]"
                          connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                          connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                          description="Managed connection manager"
                          name="IDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input]"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="ADO NET Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[specialist]"
                              cachedDataType="wstr"
                              cachedLength="10"
                              cachedName="specialist"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[specialist]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[alta_number]"
                              cachedDataType="wstr"
                              cachedLength="23"
                              cachedName="alta_number"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[alta_number]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[alta_number]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[td_type]"
                              cachedDataType="wstr"
                              cachedLength="4"
                              cachedName="td_type"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[td_type]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[td_type]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[delivery_number]"
                              cachedDataType="nText"
                              cachedName="delivery_number"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[delivery_number]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[reg_num]"
                              cachedDataType="wstr"
                              cachedLength="250"
                              cachedName="reg_num"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_num]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_num]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[reg_datetime]"
                              cachedDataType="dbTimeStamp"
                              cachedName="reg_datetime"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_datetime]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[reg_year]"
                              cachedDataType="i4"
                              cachedName="reg_year"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[reg_month]"
                              cachedDataType="i4"
                              cachedName="reg_month"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[reg_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[release_datetime]"
                              cachedDataType="dbTimeStamp"
                              cachedName="release_datetime"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_datetime]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[release_year]"
                              cachedDataType="i4"
                              cachedName="release_year"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[release_month]"
                              cachedDataType="i4"
                              cachedName="release_month"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[release_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[closure_datetime]"
                              cachedDataType="dbTimeStamp"
                              cachedName="closure_datetime"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_datetime]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_datetime]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[closure_year]"
                              cachedDataType="i4"
                              cachedName="closure_year"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_year]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_year]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[closure_month]"
                              cachedDataType="i4"
                              cachedName="closure_month"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_month]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[closure_month]" />
                            <inputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].Columns[declarant_code]"
                              cachedDataType="wstr"
                              cachedLength="20"
                              cachedName="declarant_code"
                              externalMetadataColumnId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output].Columns[declarant_code]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[alta_number]"
                              dataType="wstr"
                              length="23"
                              name="alta_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[td_type]"
                              dataType="wstr"
                              length="4"
                              name="td_type" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[delivery_number]"
                              dataType="wstr"
                              length="2147483647"
                              name="delivery_number" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_num]"
                              dataType="wstr"
                              length="250"
                              name="reg_num" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_datetime]"
                              dataType="dbTimeStamp"
                              name="reg_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_year]"
                              dataType="i4"
                              name="reg_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[reg_month]"
                              dataType="i4"
                              name="reg_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_datetime]"
                              dataType="dbTimeStamp"
                              name="release_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_year]"
                              dataType="i4"
                              name="release_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[release_month]"
                              dataType="i4"
                              name="release_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_datetime]"
                              dataType="dbTimeStamp"
                              name="closure_datetime" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_year]"
                              dataType="i4"
                              name="closure_year" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[closure_month]"
                              dataType="i4"
                              name="closure_month" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[specialist]"
                              dataType="wstr"
                              length="50"
                              name="specialist" />
                            <externalMetadataColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input].ExternalColumns[declarant_code]"
                              dataType="wstr"
                              length="30"
                              name="declarant_code" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="ADO NET Destination Error Output"
                          synchronousInputId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Check tables for empty\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Check tables for empty\Specialist\Reload TD details\Table.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Check tables for empty\Specialist\Reload TD details.Paths[ADO NET Source Output]"
                      endId="Package\Check tables for empty\Specialist\Reload TD details\Table.Inputs[ADO NET Destination Input]"
                      name="ADO NET Source Output"
                      startId="Package\Check tables for empty\Specialist\Reload TD details\Query.Outputs[ADO NET Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Specialist\Timesheet merge"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{8CE038F0-21B8-4550-BA46-D06FEBB96368}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Timesheet merge"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
                  SQLTask:SqlStatementSource="MERGE [motivation].[dbo].[timesheet] AS targ&#xA;USING [BI].[etl].[TimeSheet] AS src      &#xA;ON (targ.[Person_number] = src.[Person_number] AND &#xA;targ.[Person] = src.[Person] AND &#xA;targ.[Date] = src.[Date])  &#x9;&#xA;WHEN MATCHED &#xA;AND targ.[Letter_code] &lt;&gt; src.[Letter_code] &#xA;AND targ.[manual_sign] = 0&#xA;--при ручном редактировании по сотруднику в течение месяца далее не перенакатываем&#xA;AND NOT EXISTS (SELECT 0 FROM [motivation].[dbo].[timesheet] t &#xA;WHERE t.[manual_sign] = 1 &#xA;AND t.[Person] = targ.[Person]&#xA;AND MONTH(targ.[Date]) = MONTH(t.[Date]))    &#xA;&#x9;THEN UPDATE SET targ.[Letter_code] = src.[Letter_code]&#xA;WHEN NOT MATCHED BY TARGET AND src.[Date] &gt;= '2019-01-01 00:00:00.000'&#xA;&#x9;THEN INSERT&#xA;&#x9;&#x9;&#x9;  ([Base_name]&#xA;&#x9;&#x9;&#x9;  ,[Person_number]&#xA;&#x9;&#x9;&#x9;  ,[Person]&#xA;&#x9;&#x9;&#x9;  ,[Time_view]&#xA;&#x9;&#x9;&#x9;  ,[Letter_code]&#xA;&#x9;&#x9;&#x9;  ,[Date]&#xA;&#x9;&#x9;&#x9;  ,[Day]&#xA;&#x9;&#x9;&#x9;  ,[Value]&#xA;&#x9;&#x9;&#x9;  ,[position]&#xA;&#x9;&#x9;&#x9;  ,[Department]&#xA;&#x9;&#x9;&#x9;  ,[manual_sign])&#xA;&#x9;   VALUES (src.[Base_name]&#xA;&#x9;&#x9;&#x9;  ,src.[Person_number]&#xA;&#x9;&#x9;&#x9;  ,src.[Person]&#xA;&#x9;&#x9;&#x9;  ,src.[Time_view]&#xA;&#x9;&#x9;&#x9;  ,src.[Letter_code]&#xA;&#x9;&#x9;&#x9;  ,src.[Date]&#xA;&#x9;&#x9;&#x9;  ,src.[Day]&#xA;&#x9;&#x9;&#x9;  ,src.[Value]&#xA;&#x9;&#x9;&#x9;  ,src.[position]&#xA;&#x9;&#x9;&#x9;  ,src.[Department]&#xA;&#x9;&#x9;&#x9;  ,DEFAULT);" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Check tables for empty\Specialist\Truncate"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{CD32C1C0-ADD8-460C-BC1E-62AA40FA4FEB}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Truncate"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
                  SQLTask:SqlStatementSource="TRUNCATE TABLE [motivation].[dbo].[sto_td_details]&#xA;TRUNCATE TABLE [motivation].[dbo].[sto_app_before_dt_details]&#xA;TRUNCATE TABLE [motivation].[dbo].[sto_stat_details]&#xA;TRUNCATE TABLE [motivation].[dbo].[sto_spec_dt_details]&#xA;TRUNCATE TABLE [motivation].[dbo].[sto_specialist_main]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение]"
              DTS:CreationName=""
              DTS:DTSID="{BFF74C53-6078-4E26-A749-13943F63EB45}"
              DTS:From="Package\Check tables for empty\Specialist\Truncate"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение"
              DTS:To="Package\Check tables for empty\Specialist\Reload TD details" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 1]"
              DTS:CreationName=""
              DTS:DTSID="{CD511111-5F6D-4796-8568-07AD6C1E9FB6}"
              DTS:From="Package\Check tables for empty\Specialist\Truncate"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 1"
              DTS:To="Package\Check tables for empty\Specialist\Reload apps before DT details" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 10]"
              DTS:CreationName=""
              DTS:DTSID="{C9533FB3-5AF8-4546-8CE1-84F6DFF48719}"
              DTS:From="Package\Check tables for empty\Specialist\Reload main"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 10"
              DTS:To="Package\Check tables for empty\Specialist\Check for empty spec" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 2]"
              DTS:CreationName=""
              DTS:DTSID="{088B561F-1304-4B2B-B91A-11E4E48C8E77}"
              DTS:From="Package\Check tables for empty\Specialist\Truncate"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 2"
              DTS:To="Package\Check tables for empty\Specialist\Reload stat details" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 3]"
              DTS:CreationName=""
              DTS:DTSID="{551EE4E3-4884-4872-8CC6-F6C5B5907F3B}"
              DTS:From="Package\Check tables for empty\Specialist\Truncate"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 3"
              DTS:To="Package\Check tables for empty\Specialist\Reload DT details" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 4]"
              DTS:CreationName=""
              DTS:DTSID="{D4298F36-4690-467E-9D63-432F4B525E05}"
              DTS:From="Package\Check tables for empty\Specialist\Reload TD details"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 4"
              DTS:To="Package\Check tables for empty\Specialist\Reload main" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 5]"
              DTS:CreationName=""
              DTS:DTSID="{B01467FB-8CD1-4098-9CB5-10D567B671A8}"
              DTS:From="Package\Check tables for empty\Specialist\Reload DT details"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 5"
              DTS:To="Package\Check tables for empty\Specialist\Reload main" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 6]"
              DTS:CreationName=""
              DTS:DTSID="{F406E50E-E9C2-4D9D-902A-52F51FEDBC32}"
              DTS:From="Package\Check tables for empty\Specialist\Reload apps before DT details"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 6"
              DTS:To="Package\Check tables for empty\Specialist\Reload main" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 7]"
              DTS:CreationName=""
              DTS:DTSID="{12F9C4CB-4123-4F1C-8809-CB540E330AEC}"
              DTS:From="Package\Check tables for empty\Specialist\Reload stat details"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 7"
              DTS:To="Package\Check tables for empty\Specialist\Reload main" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 8]"
              DTS:CreationName=""
              DTS:DTSID="{659AA71C-5E24-41BC-8CB2-ACF75F6DAF44}"
              DTS:From="Package\Check tables for empty\Specialist\Truncate"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 8"
              DTS:To="Package\Check tables for empty\Specialist\Timesheet merge" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 9]"
              DTS:CreationName=""
              DTS:DTSID="{A18745B4-06D9-4AAA-B2E1-A9D826CC1D30}"
              DTS:From="Package\Check tables for empty\Specialist\Timesheet merge"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 9"
              DTS:To="Package\Check tables for empty\Specialist\Reload main" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\update time"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{7A01C0BD-8462-44D6-BE5C-E9AEB99199DA}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="update time"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
          SQLTask:SqlStatementSource="UPDATE [motivation].[dbo].[updated_at]&#xA;SET [date_time] = GETDATE()&#xA;WHERE [department] = 'sto'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Ограничение]"
      DTS:CreationName=""
      DTS:DTSID="{91B7ECF9-BF20-45AB-BABE-60F3B784BA3C}"
      DTS:From="Package\Check tables for empty"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Ограничение"
      DTS:To="Package\update time" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--В данном разделе CDATA содержатся сведения о макете пакета. В данном разделе содержатся сведения о координатах (x,y), ширине и высоте.-->
<!--В случае возникновения ошибки при редактировании этого раздела вручную его можно удалить. -->
<!--Пакет можно загрузить обычным образом, но прежние сведения о макете будут утеряны, и конструктор автоматически перераспределит элементы в области конструктора.-->
<Objects
  Version="8">
  <!--Все приведенные ниже узлы будут содержать свойства, не влияющие на поведение среды выполнения.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="135,42"
          Id="Package\update time"
          TopLeft="734.33333333334,1232.22222222222" />
        <NodeLayout
          Size="137,42"
          Id="Package\Check tables for empty\Declarant\Reload main"
          TopLeft="225.727272727273,95.5454545454545" />
        <NodeLayout
          Size="168,42"
          Id="Package\Check tables for empty\Declarant\Reload preparation"
          TopLeft="20.2727272727273,94.6363636363637" />
        <NodeLayout
          Size="148,42"
          Id="Package\Check tables for empty\Declarant\Reload release"
          TopLeft="27.5454545454545,164.636363636363" />
        <NodeLayout
          Size="121,42"
          Id="Package\Check tables for empty\Declarant\Truncate"
          TopLeft="45,23" />
        <EdgeLayout
          Id="Package\Check tables for empty\Declarant.PrecedenceConstraints[Ограничение]"
          TopLeft="104.886363636364,65">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,29.6363636363637"
              Start="0,0"
              End="0,22.1363636363637">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,22.1363636363637" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Declarant.PrecedenceConstraints[Ограничение 1]"
          TopLeft="102.909090909091,136.636363636364">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27.9999999999995"
              Start="0,0"
              End="0,20.4999999999995">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,20.4999999999995" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Declarant.PrecedenceConstraints[Ограничение 2]"
          TopLeft="124.878787878788,164.636363636363">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="169.348484848485,-27.0909090909088"
              Start="0,0"
              End="169.348484848485,-19.5909090909088">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-7.01020904229448" />
                  <mssgle:CubicBezierSegment
                    Point1="0,-7.01020904229448"
                    Point2="0,-11.0102090422945"
                    Point3="4,-11.0102090422945" />
                  <mssgle:LineSegment
                    End="165.348484848485,-11.0102090422945" />
                  <mssgle:CubicBezierSegment
                    Point1="165.348484848485,-11.0102090422945"
                    Point2="169.348484848485,-11.0102090422945"
                    Point3="169.348484848485,-15.0102090422945" />
                  <mssgle:LineSegment
                    End="169.348484848485,-19.5909090909088" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="178,42"
          Id="Package\Check tables for empty\Declarant\Check for empty decl"
          TopLeft="211,170" />
        <EdgeLayout
          Id="Package\Check tables for empty\Declarant.PrecedenceConstraints[Ограничение 3]"
          TopLeft="315.727272727273,137.545454545455">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-15.727272727273,32.4545454545455"
              Start="0,0"
              End="-15.727272727273,24.9545454545455">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,9.20661157024795" />
                  <mssgle:CubicBezierSegment
                    Point1="0,9.20661157024795"
                    Point2="0,13.206611570248"
                    Point3="-4,13.206611570248" />
                  <mssgle:LineSegment
                    End="-11.727272727273,13.206611570248" />
                  <mssgle:CubicBezierSegment
                    Point1="-11.727272727273,13.206611570248"
                    Point2="-15.727272727273,13.206611570248"
                    Point3="-15.727272727273,17.206611570248" />
                  <mssgle:LineSegment
                    End="-15.727272727273,24.9545454545455" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="455,284"
          Size="455,327"
          Id="Package\Check tables for empty\Declarant"
          TopLeft="32.111111111111,21.111111111111" />
        <NodeLayout
          Size="220,42"
          Id="Package\Check tables for empty\Specialist\Reload apps before DT details"
          TopLeft="492.5,93.5" />
        <NodeLayout
          Size="161,42"
          Id="Package\Check tables for empty\Specialist\Reload DT details"
          TopLeft="120.5,141.5" />
        <NodeLayout
          Size="137,42"
          Id="Package\Check tables for empty\Specialist\Reload main"
          TopLeft="195.5,331.5" />
        <NodeLayout
          Size="165,42"
          Id="Package\Check tables for empty\Specialist\Reload stat details"
          TopLeft="728.5,83.5" />
        <NodeLayout
          Size="161,42"
          Id="Package\Check tables for empty\Specialist\Reload TD details"
          TopLeft="5.5,81.5" />
        <NodeLayout
          Size="161,42"
          Id="Package\Check tables for empty\Specialist\Timesheet merge"
          TopLeft="301.5,116.5" />
        <NodeLayout
          Size="121,42"
          Id="Package\Check tables for empty\Specialist\Truncate"
          TopLeft="288.5,5.5" />
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение]"
          TopLeft="315.1,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-229.1,34"
              Start="0,0"
              End="-229.1,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,6.38346727898971" />
                  <mssgle:CubicBezierSegment
                    Point1="0,6.38346727898971"
                    Point2="0,10.3834672789897"
                    Point3="-4,10.3834672789897" />
                  <mssgle:LineSegment
                    End="-225.1,10.3834672789897" />
                  <mssgle:CubicBezierSegment
                    Point1="-225.1,10.3834672789897"
                    Point2="-229.1,10.3834672789897"
                    Point3="-229.1,14.3834672789897" />
                  <mssgle:LineSegment
                    End="-229.1,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 1]"
          TopLeft="360.3,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="242.2,46"
              Start="0,0"
              End="242.2,38.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.6308113035552" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16.6308113035552"
                    Point2="0,20.6308113035552"
                    Point3="4,20.6308113035552" />
                  <mssgle:LineSegment
                    End="238.2,20.6308113035552" />
                  <mssgle:CubicBezierSegment
                    Point1="238.2,20.6308113035552"
                    Point2="242.2,20.6308113035552"
                    Point3="242.2,24.6308113035552" />
                  <mssgle:LineSegment
                    End="242.2,38.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 2]"
          TopLeft="382.9,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="428.1,36"
              Start="0,0"
              End="428.1,28.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,6.99425947187137" />
                  <mssgle:CubicBezierSegment
                    Point1="0,6.99425947187137"
                    Point2="0,10.9942594718714"
                    Point3="4,10.9942594718714" />
                  <mssgle:LineSegment
                    End="424.1,10.9942594718714" />
                  <mssgle:CubicBezierSegment
                    Point1="424.1,10.9942594718714"
                    Point2="428.1,10.9942594718714"
                    Point3="428.1,14.9942594718714" />
                  <mssgle:LineSegment
                    End="428.1,28.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 3]"
          TopLeft="330.166666666667,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-129.166666666667,94"
              Start="0,0"
              End="-129.166666666667,86.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.3360522022839" />
                  <mssgle:CubicBezierSegment
                    Point1="0,34.3360522022839"
                    Point2="0,38.3360522022839"
                    Point3="-4,38.3360522022839" />
                  <mssgle:LineSegment
                    End="-125.166666666667,38.3360522022839" />
                  <mssgle:CubicBezierSegment
                    Point1="-125.166666666667,38.3360522022839"
                    Point2="-129.166666666667,38.3360522022839"
                    Point3="-129.166666666667,42.3360522022839" />
                  <mssgle:LineSegment
                    End="-129.166666666667,86.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 4]"
          TopLeft="86,123.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="135,208"
              Start="0,0"
              End="135,200.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,147.574468085106" />
                  <mssgle:CubicBezierSegment
                    Point1="0,147.574468085106"
                    Point2="0,151.574468085106"
                    Point3="4,151.574468085106" />
                  <mssgle:LineSegment
                    End="131,151.574468085106" />
                  <mssgle:CubicBezierSegment
                    Point1="131,151.574468085106"
                    Point2="135,151.574468085106"
                    Point3="135,155.574468085106" />
                  <mssgle:LineSegment
                    End="135,200.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 5]"
          TopLeft="201,183.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="41.5,148"
              Start="0,0"
              End="41.5,140.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,83.7748917748918" />
                  <mssgle:CubicBezierSegment
                    Point1="0,83.7748917748918"
                    Point2="0,87.7748917748918"
                    Point3="4,87.7748917748918" />
                  <mssgle:LineSegment
                    End="37.5,87.7748917748918" />
                  <mssgle:CubicBezierSegment
                    Point1="37.5,87.7748917748918"
                    Point2="41.5,87.7748917748918"
                    Point3="41.5,91.7748917748918" />
                  <mssgle:LineSegment
                    End="41.5,140.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 6]"
          TopLeft="602.5,135.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-317,196"
              Start="0,0"
              End="-317,188.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,112.242424242424" />
                  <mssgle:CubicBezierSegment
                    Point1="0,112.242424242424"
                    Point2="0,116.242424242424"
                    Point3="-4,116.242424242424" />
                  <mssgle:LineSegment
                    End="-313,116.242424242424" />
                  <mssgle:CubicBezierSegment
                    Point1="-313,116.242424242424"
                    Point2="-317,116.242424242424"
                    Point3="-317,120.242424242424" />
                  <mssgle:LineSegment
                    End="-317,188.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 7]"
          TopLeft="811,125.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-504,206"
              Start="0,0"
              End="-504,198.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,146.117021276596" />
                  <mssgle:CubicBezierSegment
                    Point1="0,146.117021276596"
                    Point2="0,150.117021276596"
                    Point3="-4,150.117021276596" />
                  <mssgle:LineSegment
                    End="-500,150.117021276596" />
                  <mssgle:CubicBezierSegment
                    Point1="-500,150.117021276596"
                    Point2="-504,150.117021276596"
                    Point3="-504,154.117021276596" />
                  <mssgle:LineSegment
                    End="-504,198.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 8]"
          TopLeft="349,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="33,69"
              Start="0,0"
              End="33,61.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,30.5"
                    Point2="0,34.5"
                    Point3="4,34.5" />
                  <mssgle:LineSegment
                    End="29,34.5" />
                  <mssgle:CubicBezierSegment
                    Point1="29,34.5"
                    Point2="33,34.5"
                    Point3="33,38.5" />
                  <mssgle:LineSegment
                    End="33,61.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 9]"
          TopLeft="382,158.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-118,173"
              Start="0,0"
              End="-118,165.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,82.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,82.5"
                    Point2="0,86.5"
                    Point3="-4,86.5" />
                  <mssgle:LineSegment
                    End="-114,86.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-114,86.5"
                    Point2="-118,86.5"
                    Point3="-118,90.5" />
                  <mssgle:LineSegment
                    End="-118,165.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="181,42"
          Id="Package\Check tables for empty\Specialist\Check for empty spec"
          TopLeft="360,328" />
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist.PrecedenceConstraints[Ограничение 10]"
          TopLeft="332.5,350.75">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="27.5,0"
              Start="0,0"
              End="20,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="20,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="899,467"
          Size="899,510"
          Id="Package\Check tables for empty\Specialist"
          TopLeft="499.333333333333,19.3333333333333" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="1419,557"
          Size="1419,600"
          Id="Package\Check tables for empty"
          TopLeft="98,593" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Ограничение]"
          TopLeft="804.66666666667,1193">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,39.2222222222219"
              Start="0,0"
              End="0,31.7222222222219">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.7222222222219" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Check tables for empty\Declarant\Reload main">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="107,42"
          Id="Package\Check tables for empty\Declarant\Reload main\Query"
          TopLeft="135,54" />
        <NodeLayout
          Size="105,42"
          Id="Package\Check tables for empty\Declarant\Reload main\Table"
          TopLeft="136,125" />
        <EdgeLayout
          Id="Package\Check tables for empty\Declarant\Reload main.Paths[ADO NET Source Output]"
          TopLeft="188.5,96">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,29"
              Start="0,0"
              End="0,21.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Declarant\Reload main\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Declarant\Reload main\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Check tables for empty\Declarant\Reload preparation">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Check tables for empty\Declarant\Reload preparation\Table"
          TopLeft="132,146" />
        <NodeLayout
          Size="107,42"
          Id="Package\Check tables for empty\Declarant\Reload preparation\Query"
          TopLeft="131,75" />
        <EdgeLayout
          Id="Package\Check tables for empty\Declarant\Reload preparation.Paths[ADO NET Source Output]"
          TopLeft="184.5,117">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,29"
              Start="0,0"
              End="0,21.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Declarant\Reload preparation\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Declarant\Reload preparation\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Check tables for empty\Declarant\Reload release">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Check tables for empty\Declarant\Reload release\Table"
          TopLeft="139,123" />
        <NodeLayout
          Size="107,42"
          Id="Package\Check tables for empty\Declarant\Reload release\Query"
          TopLeft="130,54" />
        <EdgeLayout
          Id="Package\Check tables for empty\Declarant\Reload release.Paths[ADO NET Source Output]"
          TopLeft="183.5,96">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8,27"
              Start="0,0"
              End="8,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,9.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,9.5"
                    Point2="0,13.5"
                    Point3="4,13.5" />
                  <mssgle:LineSegment
                    End="4,13.5" />
                  <mssgle:CubicBezierSegment
                    Point1="4,13.5"
                    Point2="8,13.5"
                    Point3="8,17.5" />
                  <mssgle:LineSegment
                    End="8,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Declarant\Reload release\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Declarant\Reload release\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Check tables for empty\Specialist\Reload apps before DT details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Check tables for empty\Specialist\Reload apps before DT details\Table"
          TopLeft="175,126" />
        <NodeLayout
          Size="107,42"
          Id="Package\Check tables for empty\Specialist\Reload apps before DT details\Query"
          TopLeft="173,50" />
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist\Reload apps before DT details.Paths[ADO NET Source Output]"
          TopLeft="227,92">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34"
              Start="0,0"
              End="0,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload apps before DT details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload apps before DT details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Check tables for empty\Specialist\Reload DT details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Check tables for empty\Specialist\Reload DT details\Table"
          TopLeft="155,112" />
        <NodeLayout
          Size="107,42"
          Id="Package\Check tables for empty\Specialist\Reload DT details\Query"
          TopLeft="154,45" />
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist\Reload DT details.Paths[ADO NET Source Output]"
          TopLeft="207.5,87">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload DT details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload DT details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Check tables for empty\Specialist\Reload main">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Check tables for empty\Specialist\Reload main\Table"
          TopLeft="164,155" />
        <NodeLayout
          Size="107,42"
          Id="Package\Check tables for empty\Specialist\Reload main\Query"
          TopLeft="161,78" />
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist\Reload main.Paths[ADO NET Source Output]"
          TopLeft="215.5,120">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,35"
              Start="0,0"
              End="0,27.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,27.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload main\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload main\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Check tables for empty\Specialist\Reload stat details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="107,42"
          Id="Package\Check tables for empty\Specialist\Reload stat details\Query"
          TopLeft="130,64" />
        <NodeLayout
          Size="105,42"
          Id="Package\Check tables for empty\Specialist\Reload stat details\Table"
          TopLeft="129,133" />
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist\Reload stat details.Paths[ADO NET Source Output]"
          TopLeft="182.5,106">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload stat details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload stat details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Check tables for empty\Specialist\Reload TD details">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="105,42"
          Id="Package\Check tables for empty\Specialist\Reload TD details\Table"
          TopLeft="207,148" />
        <NodeLayout
          Size="107,42"
          Id="Package\Check tables for empty\Specialist\Reload TD details\Query"
          TopLeft="207,79" />
        <EdgeLayout
          Id="Package\Check tables for empty\Specialist\Reload TD details.Paths[ADO NET Source Output]"
          TopLeft="260,121">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload TD details\Query">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Check tables for empty\Specialist\Reload TD details\Table">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>