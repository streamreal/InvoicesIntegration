<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="2/11/2020 4:15:12 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="ETP025"
  DTS:CreatorName="ELTRANSPLUS\andreydruzhinin"
  DTS:DTSID="{5B901DA5-2002-44A9-B648-60F5EE9F460C}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.71"
  DTS:LocaleID="1049"
  DTS:ObjectName="Package1"
  DTS:PackageType="5"
  DTS:VersionBuild="68"
  DTS:VersionGUID="{CC8E9B2A-5C34-471A-A69C-67669889A54E}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[10.0.0.33.phpuser]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{05A45027-6DC5-4586-BE50-2C8321354659}"
      DTS:ObjectName="10.0.0.33.phpuser">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=10.0.0.33;User ID=phpuser;Persist Security Info=True;Application Name=SSIS-Package1-{05A45027-6DC5-4586-BE50-2C8321354659}10.0.0.33.phpuser;">
          <DTS:Password
            DTS:Name="Password"
            Sensitive="1"
            Encrypted="1">AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAoIVwaEVm2E6gHAmG2U5aTgAAAAAIAAAARABUAFMAAAADZgAAwAAAABAAAAB6H0bxVee5f3tM5RNDo69lAAAAAASAAACgAAAAEAAAAMV1QZnlBB07x4Gyff5GKwcYAAAAg/4mmrqZmAPEgFk6iqQRjK2+dCu4FUNeFAAAACijMbs/f6oPQgGcKVQz2FUHL4xd</DTS:Password>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[SMTP Eltransplus]"
      DTS:CreationName="SMTP"
      DTS:DTSID="{403970C5-EC92-4000-9E2B-5AD29D5787C6}"
      DTS:ObjectName="SMTP Eltransplus">
      <DTS:ObjectData>
        <SmtpConnectionManager
          ConnectionString="SmtpServer=10.10.0.50;UseWindowsAuthentication=True;EnableSsl=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{BAFE48BD-0DF6-4170-97D8-ECA82C9DA0B3}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="file_vbd">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3E204CE9-5C1A-4597-879B-270725B91712}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="id">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C44581B3-8161-4E50-A3F0-6414C00D531F}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Message">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{92F03803-14C0-4658-A841-38C514D1526D}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Obj">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{20922264-4164-45D5-A36A-2ABE4515CB91}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Obj_pari">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{61BC6C84-7466-46B3-A24C-B55ECB9AEFB8}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Subject">
      <DTS:VariableValue
        DTS:DataType="8">тест</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{0A501CE3-71FA-46F4-AC4A-ACE2962D49F2}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ToLine">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Система уведомлений"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Контейнер последовательности"
      DTS:DTSID="{80B0E964-D1D6-471A-B170-A1DF22FA024A}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Система уведомлений">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\Container_FOR"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:Description="Контейнер &quot;Цикл по каждому элементу&quot;"
          DTS:DTSID="{7dadf09b-2058-4d4b-a64a-4bee81f1c51e}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:ObjectName="Container_FOR">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{9a42b26e-0812-40c4-930c-44f5d7c7cdc3}"
            DTS:ObjectName="{82E40C60-FDD8-410C-9F79-3AB5436911ED}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::Obj" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Container_FOR\MessageSent"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Задача &quot;Выполнение SQL&quot;"
              DTS:DTSID="{3ef0d32e-badd-44da-a8e5-e96e8b3e953f}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="MessageSent"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
                  SQLTask:SqlStatementSource="DECLARE @VarID VARCHAR(50) = ?&#xA;UPDATE webproject.dbo.notices_msg&#xA;SET MessageSent = 1&#xA;WHERE id = @VarID" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="@VarID"
                    SQLTask:DtsVariableName="User::id"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="20"
                    SQLTask:ParameterSize="0" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Container_FOR\Задача &quot;Отправка почты&quot;"
              DTS:CreationName="Microsoft.SendMailTask"
              DTS:Description="Задача &quot;Отправка почты&quot;"
              DTS:DTSID="{6f008a6c-fa1b-4903-9524-46e138d4a8f7}"
              DTS:ExecutableType="Microsoft.SendMailTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Задача &quot;Отправка почты&quot;"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Subject">@[User::Subject]</DTS:PropertyExpression>
              <DTS:PropertyExpression
                DTS:Name="ToLine">@[User::ToLine]</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SendMailTask:SendMailTaskData
                  SendMailTask:SMTPServer="{403970C5-EC92-4000-9E2B-5AD29D5787C6}"
                  SendMailTask:From="info@eltransplus.ru"
                  SendMailTask:BCC="mailing@eltransplus.ru"
                  SendMailTask:Subject="тест"
                  SendMailTask:MessageSourceType="Variable"
                  SendMailTask:MessageSource="User::Message" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Система уведомлений\Container_FOR.PrecedenceConstraints[Ограничение]"
              DTS:CreationName=""
              DTS:DTSID="{2c368c74-65db-4c05-9dd6-3e20aeda3d5c}"
              DTS:From="Package\Система уведомлений\Container_FOR\Задача &quot;Отправка почты&quot;"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение"
              DTS:To="Package\Система уведомлений\Container_FOR\MessageSent"
              DTS:Value="2" />
          </DTS:PrecedenceConstraints>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{197CE6F3-3C2E-459B-ADAA-23323DFAAD0B}"
              DTS:ObjectName="{197CE6F3-3C2E-459B-ADAA-23323DFAAD0B}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::Subject" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{28357F4D-82A6-42B9-BD9C-F3FC47C4696F}"
              DTS:ObjectName="{28357F4D-82A6-42B9-BD9C-F3FC47C4696F}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::ToLine" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{BD8AFCBD-BE73-4B5D-A6C4-27615EA6041B}"
              DTS:ObjectName="{BD8AFCBD-BE73-4B5D-A6C4-27615EA6041B}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::id" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{567197E3-90A8-41A9-BCC9-EE48DF046AFD}"
              DTS:ObjectName="{567197E3-90A8-41A9-BCC9-EE48DF046AFD}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::Message" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT досмотр"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{D1441B4E-F608-4787-8221-62504F17F3B1}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT досмотр"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [webproject].[dbo].[notices_msg]&#xA;           ([Username]&#xA;           ,[CargoID]&#xA;           ,[event_name]&#xA;           ,[msg_sent]&#xA;           ,[No_]&#xA;           ,[CustomerName]&#xA;           ,[MessageSent]&#xA;           ,[event_datetime]&#xA;&#x9;&#x9;   ,[message_text])&#xA;     SELECT &#x9;&#xA;&#x9;&#x9;x.[UserName]&#xA;&#x9;&#x9;,x.[CargoID]&#xA;&#x9;&#x9;,x.[event_name]&#xA;&#x9;&#x9;,x.[msg_sent]&#xA;&#x9;&#x9;,x.[No_]&#xA;&#x9;&#x9;,x.[CustomerName]&#xA;&#x9;&#x9;,x.[MessageSent]&#xA;&#x9;&#x9;,x.[event_datetime]&#x9;&#xA;&#x9;&#x9;,'Транспортное средство: ' + x.transport &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Номер ДТ: ' + x.regnum &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + CASE WHEN x.is_lk_user = 1 OR COALESCE(x.regnum, '') = '' THEN '' ELSE 'Ссылка на ЭД-обмен: https://mon.eltransplus.ru/portal/messages-by-dt-number/' + x.regnum END&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Отправитель: ' + x.sender&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Инвойс: ' + x.inv&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Терминал: ' + x.terminal_name&#xA;&#x9;&#x9;+ CASE WHEN x.is_lk_user = 1 THEN CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + &#xA;'Copyright © 2020 ООО &quot;Елтранс+&quot; | 117218, Россия, Москва, ул. Б. Черемушкинская, д. 40, корп. 3. | +7 495 411-99-39&#xA;Вы получили это письмо потому что заполнили форму получения уведомлений в личном кабинете федерального логистического оператора Елтранс+ . Если вы не хотите больше получать рассылку, зайдите в веб форму личного кабинета cabinet.eltransplus.ru либо напишите об этом на bizline@eltransplus.ru'&#xA;+ CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + 'Письмо создано автоматически, отвечать на него не нужно' ELSE '' END&#xA;&#x9;&#x9;FROM&#xA;&#x9;&#x9;(SELECT &#xA;&#x9;&#x9;cr.UserName&#xA;&#x9;&#x9;,n.[CargoID]&#xA;&#x9;&#x9;,'Уведомление о досмотре' [event_name]&#xA;&#x9;&#x9;,0 [msg_sent]&#xA;&#x9;&#x9;,n.[&amp;&amp;PRIM] [No_]&#xA;&#x9;&#x9;,n.[Name] [CustomerName]&#xA;&#x9;&#x9;,0 [MessageSent]&#xA;&#x9;&#x9;,n.InOutDateTime [event_datetime]&#x9;&#x9;&#xA;&#x9;&#x9;,n.regnum&#xA;&#x9;&#x9;,n.transport&#xA;&#x9;&#x9;,n.sender&#xA;&#x9;&#x9;,n.inv&#xA;&#x9;&#x9;,cr.is_lk_user&#xA;&#x9;&#x9;,n.terminal_name&#xA;&#x9;&#x9;FROM [webproject].[dbo].[alta_notices] n&#xA;&#x9;&#x9;CROSS APPLY &#xA;&#x9;&#x9;(SELECT * FROM&#xA;&#x9;&#x9;(SELECT s.[CargoID],s.[UserName],s.[is_lk_user]    &#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send] s JOIN [webproject].[dbo].[notices_user_events] ev&#xA;&#x9;&#x9;ON s.[UserName] = ev.Username AND s.[is_lk_user] = ev.[is_lk_user] AND ev.customs_examination_flag = 1&#xA;&#x9;&#x9;UNION&#xA;&#x9;&#x9;SELECT man.CargoID, man.UserName, '0'&#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send_manual] man&#xA;&#x9;&#x9;WHERE man.customs_examination_flag = 1) cm&#xA;&#x9;&#x9;WHERE cm.CargoID = n.[CargoID]&#xA;&#x9;&#x9;) AS cr&#xA;&#x9;&#x9;WHERE dosmotr = 1 AND old = 0 &#xA;&#x9;&#x9;) x&#xA;GO&#xA;UPDATE [webproject].[dbo].[alta_notices]&#xA;SET [old] = 1&#xA;FROM [webproject].[dbo].[alta_notices] n&#xA;WHERE [old] = 0 AND dosmotr = 1 AND EXISTS &#xA;(SELECT 0 FROM [webproject].[dbo].[notices_msg] ms WHERE ms.[MessageSent] = 0 &#xA;AND n.CargoID = ms.CargoID AND ms.event_name = 'Уведомление о досмотре')&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT закрытие ТТ"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{2ddbfa53-07a3-4ec6-b507-0175f312d2dd}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT закрытие ТТ"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [webproject].[dbo].[notices_msg]&#xA;           ([Username]&#xA;           ,[CargoID]&#xA;           ,[event_name]&#xA;           ,[msg_sent]&#xA;           ,[No_]&#xA;           ,[CustomerName]&#xA;           ,[MessageSent]&#xA;           ,[event_datetime]&#xA;&#x9;&#x9;   ,[message_text])&#xA;     SELECT &#xA;&#x9;&#x9;cr.UserName&#xA;&#x9;&#x9;,n.[CargoID]&#xA;&#x9;&#x9;,'Завершение транзита' [event_name]&#xA;&#x9;&#x9;,0 [msg_sent]&#xA;&#x9;&#x9;,cd.DeliveryNo_ [No_]&#xA;&#x9;&#x9;,cust.[Name] [CustomerName]&#xA;&#x9;&#x9;,0 [MessageSent]&#xA;&#x9;&#x9;,n.man_TransportDeliveryCloseDateTimeCaption [event_datetime]&#xA;&#x9;&#x9;,'Транспортное средство: ' + n.transport &#xA;&#x9;&#x9;+ CASE WHEN cr.is_lk_user = 1 THEN CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + &#xA;'Copyright © 2020 ООО &quot;Елтранс+&quot; | 117218, Россия, Москва, ул. Б. Черемушкинская, д. 40, корп. 3. | +7 495 411-99-39&#xA;Вы получили это письмо потому что заполнили форму получения уведомлений в личном кабинете федерального логистического оператора Елтранс+ . Если вы не хотите больше получать рассылку, зайдите в веб форму личного кабинета cabinet.eltransplus.ru либо напишите об этом на bizline@eltransplus.ru'&#xA;+ CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + 'Письмо создано автоматически, отвечать на него не нужно' ELSE '' END&#xA;&#x9;&#x9;FROM [webproject].[dbo].[manual_notices] n&#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[CargoDelivery] cd ON cd.CargoID = n.CargoID&#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[ETP$SQL_Cargo] c ON c.[Cargo ID] = n.CargoID  &#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[ETP$Customer] cust ON cust.[No_] = c.[Customer No_]  &#xA;&#x9;&#x9;CROSS APPLY &#xA;&#x9;&#x9;(SELECT * FROM&#xA;&#x9;&#x9;(SELECT s.[CargoID],s.[UserName],s.[is_lk_user]      &#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send] s JOIN [webproject].[dbo].[notices_user_events] ev&#xA;&#x9;&#x9;ON s.[UserName] = ev.Username AND s.[is_lk_user] = ev.[is_lk_user] AND ev.transit_closure_flag = 1&#xA;&#x9;&#x9;UNION&#xA;&#x9;&#x9;SELECT man.CargoID, man.UserName, '0'&#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send_manual] man&#xA;&#x9;&#x9;WHERE man.transit_closure_flag = 1) cm&#xA;&#x9;&#x9;WHERE cm.CargoID = n.[CargoID]) AS cr&#xA;&#x9;&#x9;WHERE man_TransportDeliveryCloseDateTimeCaption IS NOT NULL AND old = 0&#xA;GO&#xA;UPDATE [webproject].[dbo].[manual_notices]&#xA;SET [old] = 1&#xA;FROM [webproject].[dbo].[manual_notices] n&#xA;WHERE [old] = 0 AND man_TransportDeliveryCloseDateTimeCaption IS NOT NULL AND EXISTS &#xA;(SELECT 0 FROM [webproject].[dbo].[notices_msg] ms WHERE ms.[MessageSent] = 0 &#xA;AND n.CargoID = ms.CargoID AND ms.event_name = 'Завершение транзита')&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT новых записей ED Main"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{C6073918-C39B-4A11-978B-F432803C3FA1}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT новых записей ED Main"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="USE [webproject]&#xA;GO&#xA;INSERT INTO [dbo].[alta_notices]           &#xA;&#x9;&#x9;   ([EnvelopeID]&#xA;           ,[InOutDateTime]&#xA;           ,[MessageType]&#xA;           ,[CustomsCode]&#xA;           ,[Result]&#xA;           ,[DocGuid]&#xA;           ,[&amp;&amp;PRIM]&#xA;           ,[VAT]&#xA;&#x9;&#x9;   ,[regnum]&#xA;&#x9;&#x9;   ,[transport]&#xA;&#x9;&#x9;   ,[ptd_sign]&#xA;&#x9;&#x9;   ,[sender]&#xA;&#x9;&#x9;   ,[inv]&#xA;           ,[decision]&#xA;           ,[open_ed]&#xA;           ,[reg]&#xA;           ,[dosmotr]&#xA;           ,[ptd_notice]&#xA;           ,[CargoID]&#xA;&#x9;&#x9;   ,[Name]&#xA;&#x9;&#x9;   ,[terminal_name])     &#xA;&#x9; SELECT [EnvelopeID]      &#xA;      ,[InOutDateTime]      &#xA;      ,[MessageType]     &#xA;      ,[CustomsCode] &#xA;      ,[Result]&#xA;      ,[DocGuid]&#xA;&#x9;  ,[&amp;&amp;PRIM]&#xA;&#x9;  ,[VAT]&#xA;&#x9;  ,[RegNum]&#xA;&#x9;  ,[transport]&#xA;&#x9;  ,[ptd_sign]&#xA;&#x9;  ,[sender]&#xA;&#x9;  ,[inv]&#xA;&#x9;  ,[decision]&#xA;      ,[open_ed]&#xA;      ,[reg]&#xA;      ,[dosmotr]&#xA;      ,[ptd_notice]&#xA;      ,ca1.[CargoID]&#xA;&#x9;  ,ca1.[Name]&#xA;&#x9;  ,COALESCE(oa1.TERMINAL_NAME, '-')&#xA;&#x9; FROM (&#xA;     SELECT [EnvelopeID]      &#xA;      ,[InOutDateTime]      &#xA;      ,[MessageType]     &#xA;      ,[CustomsCode] &#xA;      ,[Result]&#xA;      ,[DocGuid]&#xA;&#x9;  ,ca.[&amp;&amp;PRIM]&#xA;&#x9;  ,ca.VAT&#xA;&#x9;  ,ca.RegNum&#xA;&#x9;  ,ca.transport&#xA;&#x9;  ,ca.ptd_sign&#xA;&#x9;  ,ca.sender&#xA;&#x9;  ,ca.inv&#x9;  &#xA;&#x9;,CASE&#xA;&#x9;WHEN [MessageType] IN &#xA;&#x9;    ('CMN.11089',&#xA;         'CMN.11264',&#xA;         'CMN.11101',&#xA;         'CMN.11117',&#xA;         'CMN.11118',&#xA;         'CMN.11124',&#xA;         'CMN.11163',&#xA;         'CMN.11010',&#xA;         'CMN.11012',&#xA;         'CMN.11033',&#xA;         'CMN.11034',&#xA;         'CMN.11042',&#xA;         'CMN.11043',&#xA;         'CMN.11124') AND NOT EXISTS &#xA;&#x9;&#x9;(SELECT 0 FROM [gtd].[dbo].[EDMsgs] e &#xA;&#x9;&#x9;WHERE e.DocGuid = ed.DocGuid AND e.MessageType IN &#xA;&#x9;    ('CMN.11089',&#xA;         'CMN.11264',&#xA;         'CMN.11101',&#xA;         'CMN.11117',&#xA;         'CMN.11118',&#xA;         'CMN.11124',&#xA;         'CMN.11163',&#xA;         'CMN.11010',&#xA;         'CMN.11012',&#xA;         'CMN.11033',&#xA;         'CMN.11034',&#xA;         'CMN.11042',&#xA;         'CMN.11043',&#xA;         'CMN.11124') AND e.EnvelopeID &lt;&gt; ed.EnvelopeID)&#xA;&#x9;&#x9; THEN 1&#xA;&#x9;&#x9; ELSE 0&#xA;&#x9;END decision&#xA;&#x9;,CASE &#xA;&#x9;WHEN [MessageType] = 'ED.11002' AND NOT EXISTS &#xA;&#x9;(SELECT 0 FROM [gtd].[dbo].[EDMsgs] e &#xA;&#x9;WHERE e.DocGuid = ed.DocGuid AND e.MessageType = 'ED.11002' AND e.EnvelopeID &lt;&gt; ed.EnvelopeID)&#xA;&#x9;THEN 1&#xA;&#x9;ELSE 0&#xA;&#x9;END open_ed&#xA;&#x9;,CASE&#xA;&#x9;WHEN [MessageType] = 'CMN.11001' THEN 1&#xA;&#x9;ELSE 0&#xA;&#x9;END reg&#xA;&#x9;,CASE &#xA;&#x9;WHEN [MessageType] = 'CMN.11005' THEN 1 &#xA;&#x9;ELSE 0&#xA;&#x9;END dosmotr&#xA;&#x9;,CASE &#xA;&#x9;WHEN [MessageType] = 'CMN.11049' THEN 1 &#xA;&#x9;ELSE 0&#xA;&#x9;END ptd_notice&#x9;&#xA;  FROM [gtd].[dbo].[EDMsgs] ed&#xA;  CROSS APPLY &#xA;  (SELECT COALESCE([&amp;&amp;PRIM], '') [&amp;&amp;PRIM], &#xA;  CASE WHEN CHARINDEX('/', [14_4]) &gt; 0 THEN SUBSTRING([14_4], 1, CHARINDEX('/', [14_4]) - 1)&#xA;  ELSE COALESCE([14_4], '')&#xA;  END VAT,&#xA;  COALESCE(g.RegNum, '') RegNum,&#xA;  COALESCE(NULLIF(COALESCE(g.[18], ''), ''), NULLIF(COALESCE(g.[21], ''), ''),'-') transport,&#xA;  COALESCE(g.[1_3], '') ptd_sign,&#xA;  COALESCE(NULLIF(COALESCE(g.[2_NAM], ''), ''), NULLIF(COALESCE(g.[2], ''), ''),'-') sender,&#xA;  COALESCE(g.[BLOCK\1\@44_!_04021], '') inv&#xA;  FROM gtd.dbo.GTDList g WHERE g.DOCGID = ed.[DocGuid]) AS ca&#xA;  WHERE InOutDateTime BETWEEN DATEADD(day, -1, GETDATE()) AND DATEADD(day, 1, GETDATE())&#xA;  ) x&#xA;  CROSS APPLY (SELECT TOP (1) cd.[CargoID], cust.[Name]&#xA;  FROM [BI].[dwh].[CargoDelivery] cd&#xA;  JOIN [BI].[dwh].[ETP$SQL_Cargo] sc ON cd.CargoID = sc.[Cargo ID]&#xA;  JOIN [BI].[dwh].[ETP$Customer] cust ON sc.[Customer No_] = cust.[No_]&#xA;  WHERE cd.[DeliveryNo_] = x.[&amp;&amp;PRIM] AND cust.[VAT Registration No_] = x.VAT) AS ca1&#xA;  OUTER APPLY (SELECT TOP (1) TERMINAL_NAME&#xA;  FROM [BI].[dwh].[MonitorsDatamart] md&#xA;  WHERE md.DOCGID = x.DocGuid&#xA;  ) AS oa1   &#xA;  WHERE &#xA;  NOT EXISTS(SELECT 0 FROM [dbo].[alta_notices] n WHERE n.[EnvelopeID] = x.EnvelopeID)&#xA;  AND (decision = 1 OR open_ed = 1 OR reg = 1 OR dosmotr = 1 OR ptd_notice = 1)&#xA;  GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT новых записей ED TNP"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{07ce3597-ddc9-48a9-9511-26d8f3c4fef5}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT новых записей ED TNP"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="USE [webproject]&#xA;GO&#xA;INSERT INTO [dbo].[alta_notices]           &#xA;     ([EnvelopeID]&#xA;           ,[InOutDateTime]&#xA;           ,[MessageType]&#xA;           ,[CustomsCode]&#xA;           ,[Result]&#xA;           ,[DocGuid]&#xA;           ,[&amp;&amp;PRIM]&#xA;           ,[VAT]&#xA;&#x9;&#x9;&#x9; ,[regnum]&#xA;&#x9;&#x9;&#x9; ,[transport]&#xA;&#x9;&#x9;&#x9; ,[ptd_sign]&#xA;&#x9;&#x9;&#x9; ,[sender]&#xA;&#x9;&#x9;&#x9;,[inv]&#xA;           ,[decision]&#xA;           ,[open_ed]&#xA;           ,[reg]&#xA;           ,[dosmotr]&#xA;           ,[ptd_notice]&#xA;           ,[CargoID]&#xA;     ,[Name]&#xA;&#x9; ,[terminal_name])&#xA;  SELECT [EnvelopeID]&#xA;           ,[InOutDateTime]&#xA;           ,[MessageType]&#xA;           ,[CustomsCode]&#xA;           ,[Result]&#xA;           ,[DocGuid]&#xA;           ,[&amp;&amp;PRIM]&#xA;           ,[VAT]&#xA;&#x9;&#x9;&#x9;,[regnum]&#xA;&#x9;&#x9;&#x9;,[transport]&#xA;&#x9;&#x9;&#x9;,[ptd_sign]&#xA;&#x9;&#x9;&#x9;,[sender]&#xA;&#x9;&#x9;&#x9;,[inv]&#xA;           ,[decision]&#xA;           ,[open_ed]&#xA;           ,[reg]&#xA;           ,[dosmotr]&#xA;           ,[ptd_notice]&#xA;           ,ca1.[CargoID]&#xA;&#x9;&#x9;&#x9;,ca1.[Name]  &#xA;&#x9;&#x9;&#x9;,COALESCE(oa1.TERMINAL_NAME, '-') TERMINAL_NAME&#xA;  FROM (&#xA;     SELECT [EnvelopeID]      &#xA;      ,[InOutDateTime]      &#xA;      ,[MessageType]     &#xA;      ,[CustomsCode] &#xA;      ,[Result]&#xA;      ,[DocGuid]&#xA;&#x9;   ,ca.[&amp;&amp;PRIM]&#xA;&#x9;   ,ca.VAT&#xA;&#x9;   ,ca.RegNum&#xA;&#x9;   ,ca.transport&#xA;&#x9;   ,ca.ptd_sign&#xA;&#x9;    ,ca.sender&#xA;&#x9;  ,ca.inv&#xA; ,CASE&#xA; WHEN [MessageType] IN &#xA;     ('CMN.11089',&#xA;         'CMN.11264',&#xA;         'CMN.11101',&#xA;         'CMN.11117',&#xA;         'CMN.11118',&#xA;         'CMN.11124',&#xA;         'CMN.11163',&#xA;         'CMN.11010',&#xA;         'CMN.11012',&#xA;         'CMN.11033',&#xA;         'CMN.11034',&#xA;         'CMN.11042',&#xA;         'CMN.11043',&#xA;         'CMN.11124') AND NOT EXISTS &#xA;&#x9;&#x9;&#x9;(SELECT 0 FROM [gtd].[dbo].[EDMsgs] e &#xA;&#x9;&#x9;&#x9;WHERE e.DocGuid = ed.DocGuid AND e.MessageType IN &#xA;     ('CMN.11089',&#xA;         'CMN.11264',&#xA;         'CMN.11101',&#xA;         'CMN.11117',&#xA;         'CMN.11118',&#xA;         'CMN.11124',&#xA;         'CMN.11163',&#xA;         'CMN.11010',&#xA;         'CMN.11012',&#xA;         'CMN.11033',&#xA;         'CMN.11034',&#xA;         'CMN.11042',&#xA;         'CMN.11043',&#xA;         'CMN.11124') AND e.EnvelopeID &lt;&gt; ed.EnvelopeID)&#xA;   THEN 1&#xA;   ELSE 0&#xA; END decision&#xA; ,CASE &#xA; WHEN [MessageType] = 'ED.11002' AND NOT EXISTS &#xA; (SELECT 0 FROM [gtd].[dbo].[EDMsgs] e &#xA; WHERE e.DocGuid = ed.DocGuid AND e.MessageType = 'ED.11002' AND e.EnvelopeID &lt;&gt; ed.EnvelopeID)&#xA; THEN 1&#xA; ELSE 0&#xA; END open_ed&#xA; ,CASE&#xA; WHEN [MessageType] = 'CMN.11001' THEN 1&#xA; ELSE 0&#xA; END reg&#xA; ,CASE &#xA; WHEN [MessageType] = 'CMN.11005' THEN 1 &#xA; ELSE 0&#xA; END dosmotr&#xA; ,CASE &#xA; WHEN [MessageType] = 'CMN.11049' THEN 1 &#xA; ELSE 0&#xA; END ptd_notice &#xA;  FROM [gtd_tnp].[dbo].[EDMsgs] ed&#xA;  CROSS APPLY &#xA;  (SELECT COALESCE([&amp;&amp;PRIM], '') [&amp;&amp;PRIM], &#xA;  CASE WHEN CHARINDEX('/', [14_4]) &gt; 0 THEN SUBSTRING([14_4], 1, CHARINDEX('/', [14_4]) - 1)&#xA;  ELSE COALESCE([14_4], '')&#xA;  END VAT,&#xA;  COALESCE(g.RegNum, '') RegNum,&#xA;  COALESCE(NULLIF(COALESCE(g.[18], ''), ''), NULLIF(COALESCE(g.[21], ''), ''),'-') transport&#xA;  ,COALESCE(g.[1_3], '') ptd_sign,&#xA;  COALESCE(NULLIF(COALESCE(g.[2_NAM], ''), ''), NULLIF(COALESCE(g.[2], ''), ''),'-') sender,&#xA;  COALESCE(g.[BLOCK\1\@44_!_04021], '') inv&#xA;  FROM gtd_tnp.dbo.GTDList g WHERE g.DOCGID = ed.[DocGuid]) AS ca&#xA;  WHERE InOutDateTime BETWEEN DATEADD(day, -1, GETDATE()) AND DATEADD(day, 1, GETDATE())&#xA;  ) x&#xA;  CROSS APPLY (SELECT TOP (1) cd.[CargoID], cust.[Name]&#xA;  FROM [BI].[dwh].[CargoDelivery] cd&#xA;  JOIN [BI].[dwh].[ETP$SQL_Cargo] sc ON cd.CargoID = sc.[Cargo ID]&#xA;  JOIN [BI].[dwh].[ETP$Customer] cust ON sc.[Customer No_] = cust.[No_]&#xA;  WHERE cd.[DeliveryNo_] = x.[&amp;&amp;PRIM] AND cust.[VAT Registration No_] = x.VAT) AS ca1&#xA;  OUTER APPLY (SELECT TOP (1) TERMINAL_NAME&#xA;  FROM [BI].[dwh].[MonitorsDatamart] md&#xA;  WHERE md.DOCGID = x.DocGuid&#xA;  ) AS oa1&#xA;  WHERE &#xA;  NOT EXISTS(SELECT 0 FROM [dbo].[alta_notices] n WHERE n.[EnvelopeID] = x.EnvelopeID)&#xA;  AND (decision = 1 OR open_ed = 1 OR reg = 1 OR dosmotr = 1 OR ptd_notice = 1)&#xA;  GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT отправка уведомления ПТД"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{3D48D3DC-6A1A-4245-B818-26FD12950082}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT отправка уведомления ПТД"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [webproject].[dbo].[notices_msg]&#xA;           ([Username]&#xA;           ,[CargoID]&#xA;           ,[event_name]&#xA;           ,[msg_sent]&#xA;           ,[No_]&#xA;           ,[CustomerName]&#xA;           ,[MessageSent]&#xA;           ,[event_datetime]&#xA;&#x9;&#x9;   ,[message_text])&#xA;     SELECT &#x9;&#xA;&#x9;&#x9;x.[UserName]&#xA;&#x9;&#x9;,x.[CargoID]&#xA;&#x9;&#x9;,x.[event_name]&#xA;&#x9;&#x9;,x.[msg_sent]&#xA;&#x9;&#x9;,x.[No_]&#xA;&#x9;&#x9;,x.[CustomerName]&#xA;&#x9;&#x9;,x.[MessageSent]&#xA;&#x9;&#x9;,x.[event_datetime]&#x9;&#x9;&#xA;&#x9;&#x9;,'Транспортное средство: ' + x.transport &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Номер ДТ: ' + x.regnum &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + CASE WHEN x.is_lk_user = 1 OR COALESCE(x.regnum, '') = '' THEN '' ELSE 'Ссылка на ЭД-обмен: https://mon.eltransplus.ru/portal/messages-by-dt-number/' + x.regnum END&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Отправитель: ' + x.sender&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Инвойс: ' + x.inv&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Терминал: ' + x.terminal_name&#xA;&#x9;&#x9;+ CASE WHEN x.is_lk_user = 1 THEN CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + &#xA;'Copyright © 2020 ООО &quot;Елтранс+&quot; | 117218, Россия, Москва, ул. Б. Черемушкинская, д. 40, корп. 3. | +7 495 411-99-39&#xA;Вы получили это письмо потому что заполнили форму получения уведомлений в личном кабинете федерального логистического оператора Елтранс+ . Если вы не хотите больше получать рассылку, зайдите в веб форму личного кабинета cabinet.eltransplus.ru либо напишите об этом на bizline@eltransplus.ru'&#xA;+ CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + 'Письмо создано автоматически, отвечать на него не нужно' ELSE '' END&#xA;&#x9;&#x9;FROM&#xA;&#x9;&#x9;(SELECT &#xA;&#x9;&#x9;cr.UserName&#xA;&#x9;&#x9;,n.[CargoID]&#xA;&#x9;&#x9;,'Отправка уведомления о прибытии (ПТД)' [event_name]&#xA;&#x9;&#x9;,0 [msg_sent]&#xA;&#x9;&#x9;,n.[&amp;&amp;PRIM] [No_]&#xA;&#x9;&#x9;,n.[Name] [CustomerName]&#xA;&#x9;&#x9;,0 [MessageSent]&#xA;&#x9;&#x9;,n.InOutDateTime [event_datetime]&#xA;&#x9;&#x9;,n.regnum&#xA;&#x9;&#x9;,n.transport&#xA;&#x9;&#x9;,n.sender&#xA;&#x9;&#x9;,n.inv&#xA;&#x9;&#x9;,cr.is_lk_user&#xA;&#x9;&#x9;,n.terminal_name&#xA;&#x9;&#x9;FROM [webproject].[dbo].[alta_notices] n&#xA;&#x9;&#x9;CROSS APPLY &#xA;&#x9;&#x9;(SELECT * FROM&#xA;&#x9;&#x9;(SELECT s.[CargoID],s.[UserName],s.[is_lk_user]      &#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send] s JOIN [webproject].[dbo].[notices_user_events] ev&#xA;&#x9;&#x9;ON s.[UserName] = ev.Username AND s.[is_lk_user] = ev.[is_lk_user] AND ev.ptd_arrival_notice_flag = 1&#xA;&#x9;&#x9;UNION&#xA;&#x9;&#x9;SELECT man.CargoID, man.UserName, '0'&#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send_manual] man&#xA;&#x9;&#x9;WHERE man.ptd_arrival_notice_flag = 1) cm&#xA;&#x9;&#x9;WHERE cm.CargoID = n.[CargoID]&#xA;&#x9;&#x9;) AS cr&#xA;&#x9;&#x9;WHERE ptd_notice = 1 AND old = 0 &#xA;&#x9;&#x9;) x&#xA;GO&#xA;UPDATE [webproject].[dbo].[alta_notices]&#xA;SET [old] = 1&#xA;FROM [webproject].[dbo].[alta_notices] n&#xA;WHERE [old] = 0 AND ptd_notice = 1 AND EXISTS &#xA;(SELECT 0 FROM [webproject].[dbo].[notices_msg] ms WHERE ms.[MessageSent] = 0 &#xA;AND n.CargoID = ms.CargoID AND ms.event_name = 'Отправка уведомления о прибытии (ПТД)')&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT подача ДТ"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{1551B988-D2D1-431F-BBAD-56856DD6B809}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT подача ДТ"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [webproject].[dbo].[notices_msg]&#xA;           ([Username]&#xA;           ,[CargoID]&#xA;           ,[event_name]&#xA;           ,[msg_sent]&#xA;           ,[No_]&#xA;           ,[CustomerName]&#xA;           ,[MessageSent]&#xA;           ,[event_datetime]&#xA;&#x9;&#x9;   ,[message_text])&#xA;SELECT &#x9;&#xA;&#x9;&#x9;x.[UserName]&#xA;&#x9;&#x9;,x.[CargoID]&#xA;&#x9;&#x9;,x.[event_name]&#xA;&#x9;&#x9;,x.[msg_sent]&#xA;&#x9;&#x9;,x.[No_]&#xA;&#x9;&#x9;,x.[CustomerName]&#xA;&#x9;&#x9;,x.[MessageSent]&#xA;&#x9;&#x9;,x.[event_datetime]&#x9;&#xA;&#x9;&#x9;,'Особенности декларирования: ' + (CASE WHEN COALESCE(x.ptd_sign, '') = '' THEN '-' ELSE x.ptd_sign END) &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Транспортное средство: ' + x.transport&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Отправитель: ' + x.sender&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Инвойс: ' + x.inv&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Терминал: ' + x.terminal_name&#xA;&#x9;&#x9;+ CASE WHEN x.is_lk_user = 1 THEN CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + &#xA;'Copyright © 2020 ООО &quot;Елтранс+&quot; | 117218, Россия, Москва, ул. Б. Черемушкинская, д. 40, корп. 3. | +7 495 411-99-39&#xA;Вы получили это письмо потому что заполнили форму получения уведомлений в личном кабинете федерального логистического оператора Елтранс+ . Если вы не хотите больше получать рассылку, зайдите в веб форму личного кабинета cabinet.eltransplus.ru либо напишите об этом на bizline@eltransplus.ru'&#xA;+ CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + 'Письмо создано автоматически, отвечать на него не нужно' ELSE '' END&#xA;&#x9;&#x9;FROM&#xA;&#x9;&#x9;(SELECT&#x9;&#x9;&#xA;&#x9;&#x9;cr.UserName&#xA;&#x9;&#x9;,n.[CargoID]&#xA;&#x9;&#x9;,'Подача ДТ' [event_name]&#xA;&#x9;&#x9;,0 [msg_sent]&#xA;&#x9;&#x9;,n.[&amp;&amp;PRIM] [No_]&#xA;&#x9;&#x9;,n.[Name] [CustomerName]&#xA;&#x9;&#x9;,0 [MessageSent]&#xA;&#x9;&#x9;,n.InOutDateTime [event_datetime]&#x9;&#x9;&#xA;&#x9;&#x9;,n.transport&#x9;&#xA;&#x9;&#x9;,n.ptd_sign&#xA;&#x9;&#x9;,n.sender&#xA;&#x9;&#x9;,n.inv&#xA;&#x9;&#x9;,cr.is_lk_user&#xA;&#x9;&#x9;,n.terminal_name&#xA;&#x9;&#x9;FROM [webproject].[dbo].[alta_notices] n&#xA;&#x9;&#x9;CROSS APPLY &#xA;&#x9;&#x9;(SELECT * FROM&#xA;&#x9;&#x9;(SELECT s.[CargoID],s.[UserName],s.[is_lk_user]    &#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send] s JOIN [webproject].[dbo].[notices_user_events] ev&#xA;&#x9;&#x9;ON s.[UserName] = ev.Username AND s.[is_lk_user] = ev.[is_lk_user] AND ev.dt_submit_flag = 1&#xA;&#x9;&#x9;UNION&#xA;&#x9;&#x9;SELECT man.CargoID, man.UserName, '0'&#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send_manual] man&#xA;&#x9;&#x9;WHERE man.dt_submit_flag = 1) cm&#xA;&#x9;&#x9;WHERE cm.CargoID = n.[CargoID]&#xA;&#x9;&#x9;) AS cr&#xA;&#x9;&#x9;WHERE open_ed = 1 AND old = 0 &#xA;&#x9;&#x9;) x&#xA;GO&#xA;UPDATE [webproject].[dbo].[alta_notices]&#xA;SET [old] = 1&#xA;FROM [webproject].[dbo].[alta_notices] n&#xA;WHERE [old] = 0 AND [open_ed] = 1 AND EXISTS &#xA;(SELECT 0 FROM [webproject].[dbo].[notices_msg] ms WHERE ms.[MessageSent] = 0 &#xA;AND n.CargoID = ms.CargoID AND ms.event_name = 'Подача ДТ')&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT получение ТСД"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{7c8b69d7-ebeb-46ea-98f4-720d23cee9fc}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT получение ТСД"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [webproject].[dbo].[notices_msg]&#xA;           ([Username]&#xA;           ,[CargoID]&#xA;           ,[event_name]&#xA;           ,[msg_sent]&#xA;           ,[No_]&#xA;           ,[CustomerName]&#xA;           ,[MessageSent]&#xA;           ,[event_datetime]&#xA;&#x9;&#x9;   ,[message_text])&#xA;     SELECT &#xA;&#x9;&#x9;cr.UserName&#xA;&#x9;&#x9;,n.[CargoID]&#xA;&#x9;&#x9;,'Получение ТСД' [event_name]&#xA;&#x9;&#x9;,0 [msg_sent]&#xA;&#x9;&#x9;,cd.DeliveryNo_ [No_]&#xA;&#x9;&#x9;,cust.[Name] [CustomerName]&#xA;&#x9;&#x9;,0 [MessageSent]&#xA;&#x9;&#x9;,n.man_TCD_DATE_TIME [event_datetime]&#xA;&#x9;&#x9;,'Транспортное средство: ' + n.transport &#xA;&#x9;&#x9;+ CASE WHEN cr.is_lk_user = 1 THEN CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + &#xA;'Copyright © 2020 ООО &quot;Елтранс+&quot; | 117218, Россия, Москва, ул. Б. Черемушкинская, д. 40, корп. 3. | +7 495 411-99-39&#xA;Вы получили это письмо потому что заполнили форму получения уведомлений в личном кабинете федерального логистического оператора Елтранс+ . Если вы не хотите больше получать рассылку, зайдите в веб форму личного кабинета cabinet.eltransplus.ru либо напишите об этом на bizline@eltransplus.ru'&#xA;+ CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + 'Письмо создано автоматически, отвечать на него не нужно' ELSE '' END&#xA;&#x9;&#x9;FROM [webproject].[dbo].[manual_notices] n&#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[CargoDelivery] cd ON cd.CargoID = n.CargoID&#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[ETP$SQL_Cargo] c ON c.[Cargo ID] = n.CargoID  &#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[ETP$Customer] cust ON cust.[No_] = c.[Customer No_]  &#xA;&#x9;&#x9;CROSS APPLY &#xA;&#x9;&#x9;(SELECT * FROM&#xA;&#x9;&#x9;(SELECT s.[CargoID],s.[UserName],s.[is_lk_user]  &#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send] s JOIN [webproject].[dbo].[notices_user_events] ev&#xA;&#x9;&#x9;ON s.[UserName] = ev.Username AND s.[is_lk_user] = ev.[is_lk_user] AND ev.tcd_reception_flag = 1&#xA;&#x9;&#x9;UNION&#xA;&#x9;&#x9;SELECT man.CargoID, man.UserName, '0'&#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send_manual] man&#xA;&#x9;&#x9;WHERE man.tcd_reception_flag = 1) cm&#xA;&#x9;&#x9;WHERE cm.CargoID = n.[CargoID]) AS cr&#xA;&#x9;&#x9;WHERE man_TCD_DATE_TIME IS NOT NULL AND old = 0&#xA;GO&#xA;UPDATE [webproject].[dbo].[manual_notices]&#xA;SET [old] = 1&#xA;FROM [webproject].[dbo].[manual_notices] n&#xA;WHERE [old] = 0 AND man_TCD_DATE_TIME IS NOT NULL AND EXISTS &#xA;(SELECT 0 FROM [webproject].[dbo].[notices_msg] ms WHERE ms.[MessageSent] = 0 &#xA;AND n.CargoID = ms.CargoID AND ms.event_name = 'Получение ТСД')&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT прибытие"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{A2B2F86D-0693-4B6F-AB00-5F60C4801B67}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT прибытие"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [webproject].[dbo].[notices_msg]&#xA;           ([Username]&#xA;           ,[CargoID]&#xA;           ,[event_name]&#xA;           ,[msg_sent]&#xA;           ,[No_]&#xA;           ,[CustomerName]&#xA;           ,[MessageSent]&#xA;           ,[event_datetime]&#xA;&#x9;&#x9;   ,[message_text])&#xA;     SELECT &#xA;&#x9;&#x9;cr.UserName&#xA;&#x9;&#x9;,n.[CargoID]&#xA;&#x9;&#x9;,'Прибытие на терминал' [event_name]&#xA;&#x9;&#x9;,0 [msg_sent]&#xA;&#x9;&#x9;,cd.DeliveryNo_ [No_]&#xA;&#x9;&#x9;,cust.[Name] [CustomerName]&#xA;&#x9;&#x9;,0 [MessageSent]&#xA;&#x9;&#x9;,n.[DELIVERY_SVX_DATE_TIME] [event_datetime]&#xA;&#x9;&#x9;,'Транспортное средство: ' + n.transport&#xA;&#x9;&#x9;+ CASE WHEN cr.is_lk_user = 1 THEN CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + &#xA;'Copyright © 2020 ООО &quot;Елтранс+&quot; | 117218, Россия, Москва, ул. Б. Черемушкинская, д. 40, корп. 3. | +7 495 411-99-39&#xA;Вы получили это письмо потому что заполнили форму получения уведомлений в личном кабинете федерального логистического оператора Елтранс+ . Если вы не хотите больше получать рассылку, зайдите в веб форму личного кабинета cabinet.eltransplus.ru либо напишите об этом на bizline@eltransplus.ru'&#xA;+ CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + 'Письмо создано автоматически, отвечать на него не нужно' ELSE '' END&#xA;&#x9;&#x9;FROM [webproject].[dbo].[manual_notices] n&#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[CargoDelivery] cd ON cd.CargoID = n.CargoID&#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[ETP$SQL_Cargo] c ON c.[Cargo ID] = n.CargoID  &#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[ETP$Customer] cust ON cust.[No_] = c.[Customer No_]  &#xA;&#x9;&#x9;CROSS APPLY &#xA;&#x9;&#x9;(SELECT * FROM&#xA;&#x9;&#x9;(SELECT s.[CargoID],s.[UserName],s.[is_lk_user]      &#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send] s JOIN [webproject].[dbo].[notices_user_events] ev&#xA;&#x9;&#x9;ON s.[UserName] = ev.Username AND s.[is_lk_user] = ev.[is_lk_user] AND ev.terminal_arrival_flag = 1&#xA;&#x9;&#x9;UNION&#xA;&#x9;&#x9;SELECT man.CargoID, man.UserName, '0'&#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send_manual] man&#xA;&#x9;&#x9;WHERE man.terminal_arrival_flag = 1) cm&#xA;&#x9;&#x9;WHERE cm.CargoID = n.[CargoID]) AS cr&#xA;&#x9;&#x9;WHERE [DELIVERY_SVX_DATE_TIME] IS NOT NULL AND old = 0&#xA;GO&#xA;UPDATE [webproject].[dbo].[manual_notices]&#xA;SET [old] = 1&#xA;FROM [webproject].[dbo].[manual_notices] n&#xA;WHERE [old] = 0 AND [DELIVERY_SVX_DATE_TIME] IS NOT NULL AND EXISTS &#xA;(SELECT 0 FROM [webproject].[dbo].[notices_msg] ms WHERE ms.[MessageSent] = 0 &#xA;AND n.CargoID = ms.CargoID AND ms.event_name = 'Прибытие на терминал')&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT регистрация ДТ"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{5BBEF9D4-3BF1-408E-904C-2C088D7536D1}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT регистрация ДТ"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [webproject].[dbo].[notices_msg]&#xA;           ([Username]&#xA;           ,[CargoID]&#xA;           ,[event_name]&#xA;           ,[msg_sent]&#xA;           ,[No_]&#xA;           ,[CustomerName]&#xA;           ,[MessageSent]&#xA;           ,[event_datetime]&#xA;&#x9;&#x9;   ,[message_text])&#xA;     SELECT &#x9;&#xA;&#x9;&#x9;x.[UserName]&#xA;&#x9;&#x9;,x.[CargoID]&#xA;&#x9;&#x9;,x.[event_name]&#xA;&#x9;&#x9;,x.[msg_sent]&#xA;&#x9;&#x9;,x.[No_]&#xA;&#x9;&#x9;,x.[CustomerName]&#xA;&#x9;&#x9;,x.[MessageSent]&#xA;&#x9;&#x9;,x.[event_datetime]&#xA;&#x9;&#x9;,'Особенности декларирования: ' + (CASE WHEN COALESCE(x.ptd_sign, '') = '' THEN '-' ELSE x.ptd_sign END) &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Транспортное средство: ' + x.transport &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Номер ДТ: ' + x.Result &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + CASE WHEN x.is_lk_user = 1 OR COALESCE(x.Result, '') = '' THEN '' ELSE 'Ссылка на ЭД-обмен: https://mon.eltransplus.ru/portal/messages-by-dt-number/' + x.Result END&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Отправитель: ' + x.sender&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Инвойс: ' + x.inv&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Терминал: ' + x.terminal_name&#xA;&#x9;&#x9;+ CASE WHEN x.is_lk_user = 1 THEN CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + &#xA;'Copyright © 2020 ООО &quot;Елтранс+&quot; | 117218, Россия, Москва, ул. Б. Черемушкинская, д. 40, корп. 3. | +7 495 411-99-39&#xA;Вы получили это письмо потому что заполнили форму получения уведомлений в личном кабинете федерального логистического оператора Елтранс+ . Если вы не хотите больше получать рассылку, зайдите в веб форму личного кабинета cabinet.eltransplus.ru либо напишите об этом на bizline@eltransplus.ru'&#xA;+ CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + 'Письмо создано автоматически, отвечать на него не нужно' ELSE '' END&#xA;&#x9;&#x9;FROM&#xA;&#x9;&#x9;(SELECT &#xA;&#x9;&#x9;cr.UserName&#xA;&#x9;&#x9;,n.[CargoID]&#xA;&#x9;&#x9;,'Регистрация ДТ' [event_name]&#xA;&#x9;&#x9;,0 [msg_sent]&#xA;&#x9;&#x9;,n.[&amp;&amp;PRIM] [No_]&#xA;&#x9;&#x9;,n.[Name] [CustomerName]&#xA;&#x9;&#x9;,0 [MessageSent]&#xA;&#x9;&#x9;,n.InOutDateTime [event_datetime]&#x9;&#x9;&#xA;&#x9;&#x9;,n.regnum&#xA;&#x9;&#x9;,n.transport&#xA;&#x9;&#x9;,n.ptd_sign&#xA;&#x9;&#x9;,n.Result&#xA;&#x9;&#x9;,n.sender&#xA;&#x9;&#x9;,n.inv&#xA;&#x9;&#x9;,cr.is_lk_user&#xA;&#x9;&#x9;,n.terminal_name&#xA;&#x9;&#x9;FROM [webproject].[dbo].[alta_notices] n&#xA;&#x9;&#x9;CROSS APPLY &#xA;&#x9;&#x9;(SELECT * FROM&#xA;&#x9;&#x9;(SELECT s.[CargoID],s.[UserName],s.[is_lk_user]     &#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send] s JOIN [webproject].[dbo].[notices_user_events] ev&#xA;&#x9;&#x9;ON s.[UserName] = ev.Username AND s.[is_lk_user] = ev.[is_lk_user] AND ev.dt_registration_flag = 1&#xA;&#x9;&#x9;UNION&#xA;&#x9;&#x9;SELECT man.CargoID, man.UserName, '0'&#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send_manual] man&#xA;&#x9;&#x9;WHERE man.dt_registration_flag = 1) cm&#xA;&#x9;&#x9;WHERE cm.CargoID = n.[CargoID]&#xA;&#x9;&#x9;) AS cr&#xA;&#x9;&#x9;WHERE reg = 1 AND old = 0 &#xA;&#x9;&#x9;) x&#xA;GO&#xA;UPDATE [webproject].[dbo].[alta_notices]&#xA;SET [old] = 1&#xA;FROM [webproject].[dbo].[alta_notices] n&#xA;WHERE [old] = 0 AND reg = 1 AND EXISTS &#xA;(SELECT 0 FROM [webproject].[dbo].[notices_msg] ms WHERE ms.[MessageSent] = 0 &#xA;AND n.CargoID = ms.CargoID AND ms.event_name = 'Регистрация ДТ')&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT решение по товарам"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{00BAB4E6-7EFB-4FAE-BF64-D3EF0372C214}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT решение по товарам"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [webproject].[dbo].[notices_msg]&#xA;           ([Username]&#xA;           ,[CargoID]&#xA;           ,[event_name]&#xA;           ,[msg_sent]&#xA;           ,[No_]&#xA;           ,[CustomerName]&#xA;           ,[MessageSent]&#xA;           ,[event_datetime]&#xA;&#x9;&#x9;   ,[message_text])&#xA;     SELECT &#x9;&#xA;&#x9;&#x9;x.[UserName]&#xA;&#x9;&#x9;,x.[CargoID]&#xA;&#x9;&#x9;,x.[event_name]&#xA;&#x9;&#x9;,x.[msg_sent]&#xA;&#x9;&#x9;,x.[No_]&#xA;&#x9;&#x9;,x.[CustomerName]&#xA;&#x9;&#x9;,x.[MessageSent]&#xA;&#x9;&#x9;,x.[event_datetime]&#x9;&#x9;&#xA;&#x9;&#x9;,'Транспортное средство: ' + x.transport &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Номер ДТ: ' + x.regnum &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Решение: ' + x.result &#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + CASE WHEN x.is_lk_user = 1 OR COALESCE(x.regnum, '') = '' THEN '' ELSE 'Ссылка на ЭД-обмен: https://mon.eltransplus.ru/portal/messages-by-dt-number/' + x.regnum END&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Отправитель: ' + x.sender&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Инвойс: ' + x.inv&#xA;&#x9;&#x9;+ CHAR(13) + CHAR(10) + 'Терминал: ' + x.terminal_name&#xA;&#x9;&#x9;+ CASE WHEN x.is_lk_user = 1 THEN CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + &#xA;'Copyright © 2020 ООО &quot;Елтранс+&quot; | 117218, Россия, Москва, ул. Б. Черемушкинская, д. 40, корп. 3. | +7 495 411-99-39&#xA;Вы получили это письмо потому что заполнили форму получения уведомлений в личном кабинете федерального логистического оператора Елтранс+ . Если вы не хотите больше получать рассылку, зайдите в веб форму личного кабинета cabinet.eltransplus.ru либо напишите об этом на bizline@eltransplus.ru'&#xA;+ CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + 'Письмо создано автоматически, отвечать на него не нужно' ELSE '' END&#xA;&#x9;&#x9;FROM&#xA;&#x9;&#x9;(SELECT &#xA;&#x9;&#x9;cr.UserName&#xA;&#x9;&#x9;,n.[CargoID]&#xA;&#x9;&#x9;,'Решение по ДТ' [event_name]&#xA;&#x9;&#x9;,0 [msg_sent]&#xA;&#x9;&#x9;,n.[&amp;&amp;PRIM] [No_]&#xA;&#x9;&#x9;,n.[Name] [CustomerName]&#xA;&#x9;&#x9;,0 [MessageSent]&#xA;&#x9;&#x9;,n.InOutDateTime [event_datetime]&#x9;&#x9;&#xA;&#x9;&#x9;,n.regnum&#xA;&#x9;&#x9;,n.transport&#xA;&#x9;&#x9;,n.sender&#xA;&#x9;&#x9;,n.inv&#xA;&#x9;&#x9;,CASE &#xA;&#x9;&#x9; WHEN n.MessageType = 'CMN.11089' THEN 'Выпуск товаров, заявленных в Обязательстве о подаче ДТ'&#xA;         WHEN n.MessageType = 'CMN.11264' THEN 'Разрешение на выпуск заявления о выпуске товаров до подачи ДТ'&#xA;         WHEN n.MessageType = 'CMN.11101' THEN 'Выпуск товаров под обеспечение (ИМ)'&#xA;         WHEN n.MessageType = 'CMN.11117' THEN 'Частичный выпуск товаров (ИМ)'&#xA;         WHEN n.MessageType = 'CMN.11118' THEN 'Частичный выпуск товаров (ЭК)'&#xA;         WHEN n.MessageType = 'CMN.11124' THEN 'Условный выпуск ДТ (ЭК)'&#xA;         WHEN n.MessageType = 'CMN.11163' THEN 'ДТ считается не поданной (ИМ)'&#xA;         WHEN n.MessageType = 'CMN.11010' THEN n.Result + ' (ИМ)'&#xA;         WHEN n.MessageType = 'CMN.11012' THEN 'Разрешение на отзыв ДТ (ИМ)'&#xA;         WHEN n.MessageType = 'CMN.11033' THEN n.Result + ' (ЭК)'&#xA;         WHEN n.MessageType = 'CMN.11034' THEN 'Разрешение на отзыв ДТ (ЭК)'&#xA;         WHEN n.MessageType = 'CMN.11042' THEN 'Выпуск товаров под обеспечение (ЭК)'&#xA;         WHEN n.MessageType = 'CMN.11043' THEN 'Условный выпуск товаров (ИМ)'&#xA;         WHEN n.MessageType = 'CMN.11124' THEN 'Условный выпуск ДТ (ЭК)'&#xA;&#x9;&#x9; ELSE ''&#xA;&#x9;&#x9; END Result&#xA;&#x9;&#x9; ,cr.is_lk_user&#xA;&#x9;&#x9; ,n.terminal_name&#xA;&#x9;&#x9;FROM [webproject].[dbo].[alta_notices] n&#xA;&#x9;&#x9;CROSS APPLY &#xA;&#x9;&#x9;(SELECT * FROM&#xA;&#x9;&#x9;(SELECT s.[CargoID],s.[UserName],s.[is_lk_user]      &#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send] s JOIN [webproject].[dbo].[notices_user_events] ev&#xA;&#x9;&#x9;ON s.[UserName] = ev.Username AND s.[is_lk_user] = ev.[is_lk_user] AND ev.dt_decision_flag = 1&#xA;&#x9;&#x9;UNION&#xA;&#x9;&#x9;SELECT man.CargoID, man.UserName, '0'&#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send_manual] man&#xA;&#x9;&#x9;WHERE man.dt_decision_flag = 1) cm&#xA;&#x9;&#x9;WHERE cm.CargoID = n.[CargoID]&#xA;&#x9;&#x9;) AS cr&#xA;&#x9;&#x9;WHERE decision = 1 AND old = 0 &#xA;&#x9;&#x9;) x&#xA;GO&#xA;UPDATE [webproject].[dbo].[alta_notices]&#xA;SET [old] = 1&#xA;FROM [webproject].[dbo].[alta_notices] n&#xA;WHERE [old] = 0 AND decision = 1 AND EXISTS &#xA;(SELECT 0 FROM [webproject].[dbo].[notices_msg] ms WHERE ms.[MessageSent] = 0 &#xA;AND n.CargoID = ms.CargoID AND ms.event_name = 'Решение по ДТ')&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\INSERT убытие"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{7c8f036d-9de8-4b24-91e8-8fc09065792c}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="INSERT убытие"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [webproject].[dbo].[notices_msg]&#xA;           ([Username]&#xA;           ,[CargoID]&#xA;           ,[event_name]&#xA;           ,[msg_sent]&#xA;           ,[No_]&#xA;           ,[CustomerName]&#xA;           ,[MessageSent]&#xA;           ,[event_datetime]&#xA;&#x9;&#x9;   ,[message_text])&#xA;     SELECT &#xA;&#x9;&#x9;cr.UserName&#xA;&#x9;&#x9;,n.[CargoID]&#xA;&#x9;&#x9;,'Убытие с терминала' [event_name]&#xA;&#x9;&#x9;,0 [msg_sent]&#xA;&#x9;&#x9;,cd.DeliveryNo_ [No_]&#xA;&#x9;&#x9;,cust.[Name] [CustomerName]&#xA;&#x9;&#x9;,0 [MessageSent]&#xA;&#x9;&#x9;,n.man_DEPARTURE_SVX_DATE_TIME [event_datetime]&#xA;&#x9;&#x9;,'Транспортное средство: ' + n.transport&#xA;&#x9;&#x9;+ CASE WHEN cr.is_lk_user = 1 THEN CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + &#xA;'Copyright © 2020 ООО &quot;Елтранс+&quot; | 117218, Россия, Москва, ул. Б. Черемушкинская, д. 40, корп. 3. | +7 495 411-99-39&#xA;Вы получили это письмо потому что заполнили форму получения уведомлений в личном кабинете федерального логистического оператора Елтранс+ . Если вы не хотите больше получать рассылку, зайдите в веб форму личного кабинета cabinet.eltransplus.ru либо напишите об этом на bizline@eltransplus.ru'&#xA;+ CHAR(13) + CHAR(10) + CHAR(13) + CHAR(10) + 'Письмо создано автоматически, отвечать на него не нужно' ELSE '' END&#xA;&#x9;&#x9;FROM [webproject].[dbo].[manual_notices] n&#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[CargoDelivery] cd ON cd.CargoID = n.CargoID&#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[ETP$SQL_Cargo] c ON c.[Cargo ID] = n.CargoID  &#xA;&#x9;&#x9;LEFT JOIN [BI].[dwh].[ETP$Customer] cust ON cust.[No_] = c.[Customer No_]  &#xA;&#x9;&#x9;CROSS APPLY &#xA;&#x9;&#x9;(SELECT * FROM&#xA;&#x9;&#x9;(SELECT s.[CargoID],s.[UserName],s.[is_lk_user]      &#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send] s JOIN [webproject].[dbo].[notices_user_events] ev&#xA;&#x9;&#x9;ON s.[UserName] = ev.Username AND s.[is_lk_user] = ev.[is_lk_user] AND ev.terminal_departure_flag = 1&#xA;&#x9;&#x9;UNION&#xA;&#x9;&#x9;SELECT man.CargoID, man.UserName, '0'&#xA;&#x9;&#x9;FROM [webproject].[dbo].[notices_send_manual] man&#xA;&#x9;&#x9;WHERE man.terminal_departure_flag = 1) cm&#xA;&#x9;&#x9;WHERE cm.CargoID = n.[CargoID]) AS cr&#xA;&#x9;&#x9;WHERE man_DEPARTURE_SVX_DATE_TIME IS NOT NULL AND old = 0&#xA;GO&#xA;UPDATE [webproject].[dbo].[manual_notices]&#xA;SET [old] = 1&#xA;FROM [webproject].[dbo].[manual_notices] n&#xA;WHERE [old] = 0 AND man_DEPARTURE_SVX_DATE_TIME IS NOT NULL AND EXISTS &#xA;(SELECT 0 FROM [webproject].[dbo].[notices_msg] ms WHERE ms.[MessageSent] = 0 &#xA;AND n.CargoID = ms.CargoID AND ms.event_name = 'Убытие с терминала')&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\Messages"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{b0ce7cb9-e767-41ff-9ef8-6fee987cb239}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Messages"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="SELECT&#xA;  COALESCE(t.No_, '') + ' ' + COALESCE(t.CargoID, '') + ' ' + COALESCE(t.CustomerName, '') + ' ' + COALESCE(t.event_name, '') + ' ' + COALESCE(REPLACE(CONVERT(VARCHAR(16),&#xA;  t.event_datetime, 104), '-', '.'), '') + ' ' + COALESCE(REPLACE(CONVERT(VARCHAR(16),&#xA;  t.event_datetime, 108), '-', '.'), '') AS MessageText&#xA; ,t.Username&#xA; ,t.id&#xA; ,COALESCE(t.message_text, '')&#xA;FROM webproject.dbo.notices_msg t&#xA;WHERE t.MessageSent IS NULL&#xA;OR t.MessageSent = 0"
              SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::Obj" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\UPDATE отправки man"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{0c632d38-7739-4727-85cc-3c6a6d57f505}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="UPDATE отправки man"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="UPDATE [webproject].[dbo].[manual_notices]&#xA;SET [old] = 1&#xA;WHERE [old] = 0 AND &#xA;([DELIVERY_SVX_DATE_TIME] &lt; DATEADD(hour, -2, GETDATE())&#xA;OR [man_TCD_DATE_TIME] &lt; DATEADD(hour, -2, GETDATE())&#xA;OR [man_TransportDeliveryCloseDateTimeCaption] &lt; DATEADD(hour, -2, GETDATE())&#xA;OR [man_DEPARTURE_SVX_DATE_TIME] &lt; DATEADD(hour, -2, GETDATE()))&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\UPDATE отправки ЭД"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{0CB66B34-FBDB-4534-AFD7-BC4D38E7174D}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="UPDATE отправки ЭД"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="UPDATE [webproject].[dbo].[alta_notices]&#xA;SET [old] = 1&#xA;WHERE [old] = 0 AND InOutDateTime &lt; DATEADD(hour, -2, GETDATE())&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\Обновление таблицы SEND"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Задача &quot;Выполнение SQL&quot;"
          DTS:DTSID="{099F4BCB-8331-4541-A44C-4561BCC7CB10}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Обновление таблицы SEND"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [webproject].[dbo].[notices_send]&#xA;GO&#xA;INSERT INTO [webproject].[dbo].[notices_send]&#xA;           ([CargoID]&#xA;           ,[UserName]&#xA;&#x9;&#x9;   ,[is_lk_user])&#xA;  SELECT DISTINCT ca.CargoID, f.username, f.is_lk_user&#xA;  FROM [webproject].[dbo].[notices_user_filters] f&#xA;  CROSS APPLY &#xA;  (SELECT cargoid &#xA;  FROM [BI].[dwh].[MonitorsDatamart] m&#xA;  WHERE &#xA;  f.customer_filter = m.CustomerName&#xA;  OR f.sto_department_filter = m.DCLDepartmentCode&#xA;  OR f.sto_specialist_filter = m.STOSalesPersoCode&#xA;  OR f.decl_creater_filter = m.CreaterUsername_Full&#xA;  OR f.decl_reg_filter = m.RegUsername_Full&#xA;  OR f.terminal_filter = m.TERMINAL_NAME) AS ca&#xA;  WHERE [CargoID] IS NOT NULL&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\Пари уведомления бухгалтерам"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{ED070C5A-7070-4516-8ED0-7DBAF9B3C346}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Пари уведомления бухгалтерам">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:DTSID="{22588D7B-8BF2-471D-9F5F-9488367D0948}"
              DTS:IncludeInDebugDump="2345"
              DTS:Namespace="User"
              DTS:ObjectName="pari_cc">
              <DTS:VariableValue
                DTS:DataType="8"
                xml:space="preserve"></DTS:VariableValue>
            </DTS:Variable>
            <DTS:Variable
              DTS:CreationName=""
              DTS:DTSID="{B4627ACA-FE34-46FE-8DB0-5F020E293DA1}"
              DTS:IncludeInDebugDump="2345"
              DTS:Namespace="User"
              DTS:ObjectName="pari_msgtext">
              <DTS:VariableValue
                DTS:DataType="8">тест</DTS:VariableValue>
            </DTS:Variable>
            <DTS:Variable
              DTS:CreationName=""
              DTS:DTSID="{FAE8CF1D-02E2-4CB6-9F2E-9CF362D64DBA}"
              DTS:IncludeInDebugDump="2345"
              DTS:Namespace="User"
              DTS:ObjectName="pari_recipient">
              <DTS:VariableValue
                DTS:DataType="8"
                xml:space="preserve"></DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Пари уведомления бухгалтерам\Container_FOR"
              DTS:CreationName="STOCK:FOREACHLOOP"
              DTS:Description="Контейнер &quot;Цикл по каждому элементу&quot;"
              DTS:DTSID="{ad52aa6e-bec6-4b9e-9486-618739974999}"
              DTS:ExecutableType="STOCK:FOREACHLOOP"
              DTS:LocaleID="-1"
              DTS:ObjectName="Container_FOR">
              <DTS:ForEachEnumerator
                DTS:CreationName="Microsoft.ForEachADOEnumerator"
                DTS:DTSID="{e5bfc68d-0e6b-43f3-b6e6-2c7a796c5d05}"
                DTS:ObjectName="{82E40C60-FDD8-410C-9F79-3AB5436911ED}">
                <DTS:ObjectData>
                  <FEEADO
                    EnumType="EnumerateRowsInFirstTable"
                    VarName="User::Obj_pari" />
                </DTS:ObjectData>
              </DTS:ForEachEnumerator>
              <DTS:Variables />
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Система уведомлений\Пари уведомления бухгалтерам\Container_FOR\Задача &quot;Отправка почты&quot;"
                  DTS:CreationName="Microsoft.SendMailTask"
                  DTS:Description="Задача &quot;Отправка почты&quot;"
                  DTS:DTSID="{9b60713c-1f40-482d-b6a6-b142d54e5ca2}"
                  DTS:ExecutableType="Microsoft.SendMailTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Задача &quot;Отправка почты&quot;"
                  DTS:ThreadHint="0">
                  <DTS:Variables />
                  <DTS:PropertyExpression
                    DTS:Name="CCLine">@[User::pari_cc]</DTS:PropertyExpression>
                  <DTS:PropertyExpression
                    DTS:Name="Subject">@[User::pari_msgtext]</DTS:PropertyExpression>
                  <DTS:PropertyExpression
                    DTS:Name="ToLine">@[User::pari_recipient]</DTS:PropertyExpression>
                  <DTS:ObjectData>
                    <SendMailTask:SendMailTaskData
                      SendMailTask:SMTPServer="{403970C5-EC92-4000-9E2B-5AD29D5787C6}"
                      SendMailTask:From="info@eltransplus.ru"
                      SendMailTask:BCC="mailing@eltransplus.ru;nikulina@eltransplus.ru"
                      SendMailTask:Subject="тест" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
              <DTS:ForEachVariableMappings>
                <DTS:ForEachVariableMapping
                  DTS:CreationName=""
                  DTS:DTSID="{F3A6D7C2-697C-4D7D-ADB3-2EC72915103F}"
                  DTS:ObjectName="{F3A6D7C2-697C-4D7D-ADB3-2EC72915103F}"
                  DTS:ValueIndex="0"
                  DTS:VariableName="User::pari_msgtext" />
                <DTS:ForEachVariableMapping
                  DTS:CreationName=""
                  DTS:DTSID="{549B7F02-4718-4F78-8347-C351C6E38A6E}"
                  DTS:ObjectName="{549B7F02-4718-4F78-8347-C351C6E38A6E}"
                  DTS:ValueIndex="1"
                  DTS:VariableName="User::pari_recipient" />
                <DTS:ForEachVariableMapping
                  DTS:CreationName=""
                  DTS:DTSID="{7FF7897B-06E2-4A56-A006-A13B4F95D878}"
                  DTS:ObjectName="{7FF7897B-06E2-4A56-A006-A13B4F95D878}"
                  DTS:ValueIndex="2"
                  DTS:VariableName="User::pari_cc" />
              </DTS:ForEachVariableMappings>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Пари уведомления бухгалтерам\INSERT новых заявок"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{6B8CE566-69D5-4042-A945-5CAD264191C4}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="INSERT новых заявок"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{269005C9-151E-46DF-9269-93184C45A32A}"
                  SQLTask:SqlStatementSource="INSERT [webproject].[dbo].[ins_notices]&#xA;([Date]&#xA;      ,[Time of Loading]&#xA;      ,[Document No_]&#xA;      ,[Customer Name]&#xA;      ,[Delivery No_]&#xA;      ,[Cargo ID]&#xA;      ,[Request Type]&#xA;      ,[Document Type]&#xA;      ,[Relator Code]&#xA;      ,[Dept_ Code])&#xA;SELECT&#xA;   dll.[Date]&#xA;  ,dll.[Time of Loading]&#xA;  ,dll.[Document No_]&#xA;  ,ins.[Customer Name]&#xA;  ,ins.[Delivery No_]&#xA;  ,ins.[Cargo ID]&#xA;  ,ins.[Request Type]&#xA;  ,ins.[Document Type]&#xA;  ,ins.[Relator Code]&#xA;  ,sp.[Dept_ Code]&#xA;FROM [ETP].[dbo].[ETP$Document Loading Log] dll&#xA;left join [ETP].[dbo].[ETP$Insured Request Entry] ins on dll.[Document No_] = ins.[Ins_ Req_ No_]&#xA;left join [ETP].[dbo].[ETP$Salesperson_Purchaser] sp on ins.[Relator Code] = sp.[Code]&#xA;where dll.[Document Code] like 'INS' and dll.[Status] = 0&#xA;AND NOT EXISTS (SELECT 0 FROM [webproject].[dbo].[ins_notices] ins&#xA;WHERE ins.[Document No_] = dll.[Document No_] COLLATE Cyrillic_General_CI_AS)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Пари уведомления бухгалтерам\UPDATE"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{BDF28199-D52E-432D-8464-E1F90A0FD3C9}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="UPDATE"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{269005C9-151E-46DF-9269-93184C45A32A}"
                  SQLTask:SqlStatementSource="UPDATE [webproject].[dbo].[ins_notices]&#xA;SET is_sent = 1&#xA;WHERE is_sent = 0" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Пари уведомления бухгалтерам\Список новых писем"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{E0815952-A611-4D7C-8AA1-CD1AC8C11FF6}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Список новых писем"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{269005C9-151E-46DF-9269-93184C45A32A}"
                  SQLTask:SqlStatementSource="SELECT &#xA;&#x9;  msg_text = CONVERT(varchar, [Date], 104) + '-' + &#xA;&#x9;  CAST(CONVERT(time(0), [Time of Loading]) AS varchar) + '-' + &#xA;&#x9;  [Document No_] + '-' +&#xA;&#x9;  [Customer Name] + '-' +&#xA;&#x9;  [Delivery No_] + '-' + &#xA;&#x9;  [Cargo ID] + '-' + &#xA;&#x9;  CASE &#xA;&#x9;  WHEN [Request Type] = 0 THEN 'Заявка на страхование'&#xA;&#x9;  WHEN [Request Type] = 1 THEN 'Заявка на изменение уже созданной заявки'&#xA;&#x9;  WHEN [Request Type] = 3 THEN 'Заявка на расторжение'&#xA;&#x9;  ELSE ''&#xA;&#x9;  END + '-Обработана'&#xA;&#x9;  ,r.email email1&#xA;&#x9;  ,CASE WHEN oa.[E-Mail] IS NOT NULL THEN oa.[E-Mail] ELSE '' END email2&#xA;FROM [webproject].[dbo].[ins_notices] i&#xA;JOIN [webproject].[dbo].[ins_recipient] r ON i.[Dept_ Code] = r.dept_code&#xA;OUTER APPLY (&#xA;  SELECT TOP (1) p.[E-Mail] &#xA;  FROM [ETP].[dbo].[ETP$Salesperson_Purchaser] p&#xA;  WHERE p.Code = i.[Relator Code] COLLATE Cyrillic_General_CI_AS&#xA;  ) AS oa&#xA;  WHERE is_sent = 0"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::Obj_pari" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Система уведомлений\Пари уведомления бухгалтерам.PrecedenceConstraints[Ограничение]"
              DTS:CreationName=""
              DTS:DTSID="{6AD1C775-BA9D-4D8E-AB13-93A8092967DB}"
              DTS:From="Package\Система уведомлений\Пари уведомления бухгалтерам\INSERT новых заявок"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение"
              DTS:To="Package\Система уведомлений\Пари уведомления бухгалтерам\Список новых писем" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Система уведомлений\Пари уведомления бухгалтерам.PrecedenceConstraints[Ограничение 1]"
              DTS:CreationName=""
              DTS:DTSID="{F4022135-1336-4CD2-83CC-7B454B2B80B3}"
              DTS:From="Package\Система уведомлений\Пари уведомления бухгалтерам\Список новых писем"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 1"
              DTS:To="Package\Система уведомлений\Пари уведомления бухгалтерам\Container_FOR" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Система уведомлений\Пари уведомления бухгалтерам.PrecedenceConstraints[Ограничение 2]"
              DTS:CreationName=""
              DTS:DTSID="{99723534-2606-4608-9ED4-AA37EF548055}"
              DTS:From="Package\Система уведомлений\Пари уведомления бухгалтерам\Container_FOR"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 2"
              DTS:To="Package\Система уведомлений\Пари уведомления бухгалтерам\UPDATE" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Система уведомлений\Чеки ВБД"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Контейнер последовательности"
          DTS:DTSID="{328AD028-5A5E-40FA-BF3C-71B9A00A36B0}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Чеки ВБД">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:DTSID="{6D03F5D0-926D-4488-A46D-4AE08F4093E3}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="User"
              DTS:ObjectName="object_vbd">
              <DTS:VariableValue
                DTS:DataSubType="ManagedSerializable"
                DTS:DataType="13">
                <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
                  <SOAP-ENV:Body>
                    <xsd:anyType
                      id="ref-1"></xsd:anyType>
                  </SOAP-ENV:Body>
                </SOAP-ENV:Envelope>
              </DTS:VariableValue>
            </DTS:Variable>
            <DTS:Variable
              DTS:CreationName=""
              DTS:DTSID="{D9FCFBCA-3420-45BF-A320-1087D3653C8D}"
              DTS:IncludeInDebugDump="2345"
              DTS:Namespace="User"
              DTS:ObjectName="subject_vbd">
              <DTS:VariableValue
                DTS:DataType="8">тест</DTS:VariableValue>
            </DTS:Variable>
            <DTS:Variable
              DTS:CreationName=""
              DTS:DTSID="{CE75CCB8-4D5E-48CB-84C6-BC8BD8B5B0B3}"
              DTS:IncludeInDebugDump="2345"
              DTS:Namespace="User"
              DTS:ObjectName="xml_vbd">
              <DTS:VariableValue
                DTS:DataType="8"
                xml:space="preserve"></DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Чеки ВБД\Container_FOR"
              DTS:CreationName="STOCK:FOREACHLOOP"
              DTS:Description="Контейнер &quot;Цикл по каждому элементу&quot;"
              DTS:DTSID="{c4bebd79-11bc-4f66-94fe-2bc4bb2c88f3}"
              DTS:ExecutableType="STOCK:FOREACHLOOP"
              DTS:LocaleID="-1"
              DTS:ObjectName="Container_FOR">
              <DTS:ForEachEnumerator
                DTS:CreationName="Microsoft.ForEachADOEnumerator"
                DTS:DTSID="{92682ed5-b1e8-4f24-a3ea-95e2cfb5bde4}"
                DTS:ObjectName="{82E40C60-FDD8-410C-9F79-3AB5436911ED}">
                <DTS:ObjectData>
                  <FEEADO
                    EnumType="EnumerateRowsInFirstTable"
                    VarName="User::object_vbd" />
                </DTS:ObjectData>
              </DTS:ForEachEnumerator>
              <DTS:Variables />
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Система уведомлений\Чеки ВБД\Container_FOR\Задача &quot;Отправка почты&quot;"
                  DTS:CreationName="Microsoft.SendMailTask"
                  DTS:Description="Задача &quot;Отправка почты&quot;"
                  DTS:DTSID="{dddfa204-96fe-4c56-976c-3d1714e2c0f2}"
                  DTS:ExecutableType="Microsoft.SendMailTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Задача &quot;Отправка почты&quot;"
                  DTS:ThreadHint="1">
                  <DTS:Variables />
                  <DTS:PropertyExpression
                    DTS:Name="FileAttachments">@[User::file_vbd]</DTS:PropertyExpression>
                  <DTS:PropertyExpression
                    DTS:Name="Subject">@[User::subject_vbd]</DTS:PropertyExpression>
                  <DTS:ObjectData>
                    <SendMailTask:SendMailTaskData
                      SendMailTask:SMTPServer="{403970C5-EC92-4000-9E2B-5AD29D5787C6}"
                      SendMailTask:From="info@eltransplus.ru"
                      SendMailTask:To="arakcheeva@eltransplus.ru;babenko@eltransplus.ru"
                      SendMailTask:BCC="mailing@eltransplus.ru"
                      SendMailTask:Subject="тест" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
                  </DTS:ObjectData>
                </DTS:Executable>
                <DTS:Executable
                  DTS:refId="Package\Система уведомлений\Чеки ВБД\Container_FOR\Конвертация чека"
                  DTS:CreationName="Microsoft.ScriptTask"
                  DTS:Description="Script Task"
                  DTS:DTSID="{30660869-e6a8-4e9b-b1db-8d0d1952aa71}"
                  DTS:ExecutableType="Microsoft.ScriptTask"
                  DTS:ForceExecutionResult="0"
                  DTS:LocaleID="-1"
                  DTS:MaxErrorCount="0"
                  DTS:ObjectName="Конвертация чека"
                  DTS:ThreadHint="1">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <ScriptProject
                      Name="ST_7789ad873ae04f4e9b97d541a0c32fa2"
                      VSTAMajorVersion="14"
                      VSTAMinorVersion="0"
                      Language="CSharp"
                      ReadOnlyVariables="User::xml_vbd"
                      ReadWriteVariables="User::file_vbd">
                      <ProjectItem
                        Name="Properties\Resources.resx"
                        Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>]]></ProjectItem>
                      <ProjectItem
                        Name="Properties\Settings.Designer.cs"
                        Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_e6a525588f3140f4851d015a3bacb54d.Properties.Settings.get_Default():ST_e6a525588f3140f4851d015a3bacb54d.Properties.Sett" +
    "ings")]

namespace ST_e6a525588f3140f4851d015a3bacb54d.Properties {
    
    
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        private static Settings defaultInstance = new Settings();
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}]]></ProjectItem>
                      <ProjectItem
                        Name="Web_api.cs"
                        Encoding="UTF8"><![CDATA[using System.Runtime.Serialization;
using System;
using System.Collections.Generic;
using System.IO;
using System.Net;
using System.Security.Cryptography;
using System.Text;
using System.Xml;
using System.Runtime.Serialization.Json;

namespace ST_e6a525588f3140f4851d015a3bacb54d
{
    class Web_api
    {
        private string login = "sa10552";
        private string password = "2VsW5aMn";

        public string[] ProcessXml(string fileName)
        {            
            string[] xmlFiles = ParseXml(fileName);
            string[] result = new string[xmlFiles.Length];

            for (int i = 0; i < xmlFiles.Length; i++)
            {
                result[i] = GetPdf(xmlFiles[i]);             
            }
            return result;
        }

        private string GetPdf(string fullPath)
        {
            byte[] xml = File.ReadAllBytes(fullPath);
            string secret = GetMd5Hash(xml.Length.ToString() + ":" + login + ":" + GetMd5Hash(password));
            string url = @"https://www.alta.ru/xml-preview/api/?login=" + login + "&secret=" + secret;
            string result;

            HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);
            req.ContentType = "application/xml";
            req.ContentLength = xml.Length;
            req.Method = "POST";

            //запись данных в запрос
            using (Stream s = req.GetRequestStream())
            {
                s.Write(xml, 0, xml.Length);
            }

            //запрос на конвертацию
            //в случае некорректного запроса - 401 ошибка
            try
            {

                using (HttpWebResponse resp = (HttpWebResponse)req.GetResponse())
                {
                    if (resp.StatusCode == HttpStatusCode.OK)
                    {
                        //возврат pdf для файлов размером менее 100 КБ
                        if (resp.ContentType.StartsWith("application/pdf"))
                        {
                            MemoryStream ms = new MemoryStream();
                            resp.GetResponseStream().CopyTo(ms);
                            byte[] pdf = ms.ToArray();
                            ms.Close();
                            result = fullPath.Remove(fullPath.LastIndexOf(".")) + ".pdf";
                            File.WriteAllBytes(result, pdf);
                            return result;
                        }
                        //постановка в очередь для файлов более 100 КБ и возврат id для нового запроса
                        else if (resp.ContentType.StartsWith("application/json"))
                        {
                            string json = string.Empty;
                            string id = string.Empty;
                            Encoding enc = Encoding.UTF8;
                            JsonResponse jr;
                            DataContractJsonSerializer deserializer = new DataContractJsonSerializer(typeof(JsonResponse));

                            try
                            {
                                using (Stream st = resp.GetResponseStream())                           
                                {
                                    jr = (JsonResponse)deserializer.ReadObject(st);                                 
                                }
                            }               
                            catch
                            {
                                throw new JsonException();
                            }

                            id = jr.id;

                            string jSecret = GetMd5Hash(id + ":" + login + ":" + GetMd5Hash(password));
                            string jUrl = @"https://www.alta.ru/xml-preview/api/?login=" + login + "&secret=" + jSecret + "&id=" + id;

                            //запрос на получение файла в очереди
                            HttpWebRequest jReq = (HttpWebRequest)WebRequest.Create(jUrl);
                            jReq.Method = "GET";

                            //10 циклов по 6 секунд - ждем возврата файла в течение минуты
                            for (int i = 0; i < 10; i++)
                            {
                                System.Threading.Thread.Sleep(6000);

                                try
                                {
                                    using (HttpWebResponse jResp = (HttpWebResponse)jReq.GetResponse())
                                    {
                                        if (jResp.ContentType.StartsWith("application/pdf"))
                                        {
                                            MemoryStream ms = new MemoryStream();
                                            jResp.GetResponseStream().CopyTo(ms);
                                            byte[] pdf = ms.ToArray();
                                            ms.Close();
                                            result = fullPath.Remove(fullPath.LastIndexOf(".")) + ".pdf";
                                            File.WriteAllBytes(result, pdf);
                                            return result;
                                        }
                                    }
                                }
                                catch
                                {
                                    //игнорируем ошибки, возникающие с GET запросом
                                    //и пытаемся дождаться файла
                                    continue;
                                }
                            }
                            throw new TimeOutException();
                        }
                        else
                        {
                            throw new UnknownContentException();
                        }
                    }
                    else
                    {
                        throw new BadResponseException();
                    }
                }
            }
            catch
            {
                //возвращаем xml в случае любых ошибок             
                return fullPath;
            }
        }

        private string GetMd5Hash(string input)
        {
            MD5 md5Hash = MD5.Create();
            byte[] data = md5Hash.ComputeHash(Encoding.UTF8.GetBytes(input));
            StringBuilder sBuilder = new StringBuilder();

            for (int i = 0; i < data.Length; i++)
            {
                sBuilder.Append(data[i].ToString("x2"));
            }
            return sBuilder.ToString();
        }

        private string[] ParseXml(string fileNameNoExt)
        {
            string xmlFileName = fileNameNoExt + ".xml";
            XmlDocument xDoc = new XmlDocument();
            xDoc.Load(xmlFileName);
            XmlNodeList nList = xDoc.GetElementsByTagName("edcnt:ContainerDoc");
            int c = nList.Count;

            //если файл представляет собой контейнер, то разбиваем на отдельные документы
            if (c > 1)
            {
                List<string> filesList = new List<string>();
                string xmlTempFileName;
                for (int i = 0; i < c; i++)
                {
                    XmlDocument xTempDoc = new XmlDocument();
                    xTempDoc.Load(xmlFileName);
                    XmlNodeList nTempList = xTempDoc.GetElementsByTagName("edcnt:ContainerDoc");

                    for (int j = c - 1; j >= 0; j--)
                    {
                        if (j != i)
                        {
                            nTempList[j].ParentNode.RemoveChild(nTempList[j]);
                        }
                    }
                    xmlTempFileName = fileNameNoExt + (i + 1).ToString() + ".xml";
                    xTempDoc.Save(xmlTempFileName);
                    filesList.Add(xmlTempFileName);
                }

                string[] str = filesList.ToArray();
                return str;
            }
            else
            {
                string[] str = new string[] { xmlFileName };
                return str;
            }
        }

        [DataContract]
        public class JsonResponse
        {
            [DataMember]
            public string status { get; set; }
            [DataMember]
            public string text { get; set; }
            [DataMember]
            public string id { get; set; }
        }

        public static void ClearFolder(string folderName)
        {
            DirectoryInfo dir = new DirectoryInfo(folderName);

            foreach (FileInfo fi in dir.GetFiles())
            {
                try
                {
                    fi.Delete();
                }
                catch (Exception) { }
            }
        }

        public class TimeOutException : Exception
        {
            public TimeOutException()
            {

            }
        }
        public class BadResponseException : Exception
        {
            public BadResponseException()
            {

            }
        }
        public class UnknownContentException : Exception
        {
            public UnknownContentException()
            {
            }
        }
        public class JsonException : Exception
        {
            public JsonException() { }
        }

    }


}]]></ProjectItem>
                      <ProjectItem
                        Name="ScriptMain.cs"
                        Encoding="UTF8"><![CDATA[#region Help:  Introduction to the script task
/* The Script Task allows you to perform virtually any operation that can be accomplished in
 * a .Net application within the context of an Integration Services control flow. 
 * 
 * Expand the other regions which have "Help" prefixes for examples of specific ways to use
 * Integration Services features within this script task. */
#endregion


#region Namespaces
using System;
using System.IO;
using System.Text;
#endregion
using System.Net;
using System.Reflection;

namespace ST_e6a525588f3140f4851d015a3bacb54d
{
    /// <summary>
    /// ScriptMain is the entry point class of the script.  Do not change the name, attributes,
    /// or parent of this class.
    /// </summary>
	[Microsoft.SqlServer.Dts.Tasks.ScriptTask.SSISScriptTaskEntryPointAttribute]
    public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
    {
        #region Help:  Using Integration Services variables and parameters in a script
        /* To use a variable in this script, first ensure that the variable has been added to 
         * either the list contained in the ReadOnlyVariables property or the list contained in 
         * the ReadWriteVariables property of this script task, according to whether or not your
         * code needs to write to the variable.  To add the variable, save this script, close this instance of
         * Visual Studio, and update the ReadOnlyVariables and 
         * ReadWriteVariables properties in the Script Transformation Editor window.
         * To use a parameter in this script, follow the same steps. Parameters are always read-only.
         * 
         * Example of reading from a variable:
         *  DateTime startTime = (DateTime) Dts.Variables["System::StartTime"].Value;
         * 
         * Example of writing to a variable:
         *  Dts.Variables["User::myStringVariable"].Value = "new value";
         * 
         * Example of reading from a package parameter:
         *  int batchId = (int) Dts.Variables["$Package::batchId"].Value;
         *  
         * Example of reading from a project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].Value;
         * 
         * Example of reading from a sensitive project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].GetSensitiveValue();
         * */

        #endregion

        #region Help:  Firing Integration Services events from a script
        /* This script task can fire events for logging purposes.
         * 
         * Example of firing an error event:
         *  Dts.Events.FireError(18, "Process Values", "Bad value", "", 0);
         * 
         * Example of firing an information event:
         *  Dts.Events.FireInformation(3, "Process Values", "Processing has started", "", 0, ref fireAgain)
         * 
         * Example of firing a warning event:
         *  Dts.Events.FireWarning(14, "Process Values", "No values received for input", "", 0);
         * */
        #endregion

        #region Help:  Using Integration Services connection managers in a script
        /* Some types of connection managers can be used in this script task.  See the topic 
         * "Working with Connection Managers Programatically" for details.
         * 
         * Example of using an ADO.Net connection manager:
         *  object rawConnection = Dts.Connections["Sales DB"].AcquireConnection(Dts.Transaction);
         *  SqlConnection myADONETConnection = (SqlConnection)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Sales DB"].ReleaseConnection(rawConnection);
         *
         * Example of using a File connection manager
         *  object rawConnection = Dts.Connections["Prices.zip"].AcquireConnection(Dts.Transaction);
         *  string filePath = (string)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Prices.zip"].ReleaseConnection(rawConnection);
         * */
        #endregion


        /// <summary>
        /// This method is called when this script task executes in the control flow.
        /// Before returning from this method, set the value of Dts.TaskResult to indicate success or failure.
        /// To open Help, press F1.
        /// </summary>
        public void Main()
        {
            AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(CurrentDomain_AssemblyResolve);
            try
            {                
                Dts.Variables["User::file_vbd"].Value = "";
                string xmlFileName = @"\\10.10.0.28\alta\PaymentCheck\check.xml";
                string xmlText = (string)Dts.Variables["User::xml_vbd"].Value;
                Web_api.ClearFolder(@"\\10.10.0.28\alta\PaymentCheck");

                if (xmlText != "")
                {
                    using (Stream st = File.Create(xmlFileName)) { }
                    File.WriteAllText(xmlFileName, xmlText, Encoding.UTF8);
                    Web_api w = new Web_api();
                    string[] files = w.ProcessXml(xmlFileName.Remove(xmlFileName.LastIndexOf(".")));
                    Dts.Variables["User::file_vbd"].Value = string.Join("|", files);
                }
            }
            catch (Exception e)
            {
                Dts.Events.FireError(0, "Script Task", e.Message, String.Empty, 0);
            }
            Dts.TaskResult = (int)ScriptResults.Success;
        }

        public Assembly CurrentDomain_AssemblyResolve(object sender, ResolveEventArgs args)
        {
            Assembly assembly = null;
            try
            {
                assembly = LoadAssembly(args, assembly);
            }
            catch (Exception exception)
            {
                Dts.Log(exception.ToString(), 0, new byte[0]);
                throw;
            }

            Dts.Log("Exiting CurrentDomain_AssemblyResolve", 0, new byte[0]);
            return assembly;
        }

        private Assembly LoadAssembly(ResolveEventArgs args, Assembly assembly)
        {
            Dts.Log(string.Format("Entering CurrentDomain_AssemblyResolve with args.Name [{0}]", args.Name), 0, new byte[0]);
            String _Common_DLLs = @"\\10.10.0.28\alta\Robot\Data";

            var dllName = string.Format("{0}.dll", args.Name.Split(',')[0]);
            Dts.Log("DLL Name is " + dllName, 0, new byte[0]);
            var dllFilename = Path.Combine(_Common_DLLs, dllName);
            if (File.Exists(dllFilename))
            {
                Dts.Log(string.Format("The file [{0}] was found and that assembly will be loaded.", dllFilename), 0, new byte[0]);
                assembly = Assembly.LoadFile(dllFilename);
            }
            else
            {
                Dts.Log(string.Format("Couldn't find the file [{0}].", dllFilename), 0, new byte[0]);
            }

            return assembly;
        }

        #region ScriptResults declaration
        /// <summary>
        /// This enum provides a convenient shorthand within the scope of this class for setting the
        /// result of the script.
        /// 
        /// This code was generated automatically.
        /// </summary>
        enum ScriptResults
        {
            Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
            Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
        };
        #endregion

    }
}]]></ProjectItem>
                      <ProjectItem
                        Name="ST_7789ad873ae04f4e9b97d541a0c32fa2.csproj"
                        Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?><Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"><PropertyGroup><ProjectTypeGuids>{30D016F9-3734-4E33-A861-5E7D899E18F3};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids><Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration><Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform><ProductVersion>8.0.30703</ProductVersion><SchemaVersion>2.0</SchemaVersion><ProjectGuid>{BEA7C3AD-CAFC-4969-843F-F10A53346992}</ProjectGuid><OutputType>Library</OutputType><AppDesignerFolder>Properties</AppDesignerFolder><RootNamespace>ST_e6a525588f3140f4851d015a3bacb54d</RootNamespace><AssemblyName>ST_7789ad873ae04f4e9b97d541a0c32fa2</AssemblyName><TargetFrameworkVersion>v4.0</TargetFrameworkVersion><FileAlignment>512</FileAlignment><ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>true</ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch></PropertyGroup><PropertyGroup Condition=" '$(Configuration)' == 'Debug' "><DebugSymbols>true</DebugSymbols><DebugType>full</DebugType><Optimize>false</Optimize><OutputPath>.\bin\Debug\</OutputPath><EnableUnmanagedDebugging>false</EnableUnmanagedDebugging><DefineConstants>DEBUG;TRACE</DefineConstants><ErrorReport>prompt</ErrorReport><WarningLevel>4</WarningLevel></PropertyGroup><PropertyGroup Condition=" '$(Configuration)' == 'Release' "><DebugSymbols>false</DebugSymbols><Optimize>true</Optimize><OutputPath>.\bin\Release\</OutputPath><EnableUnmanagedDebugging>false</EnableUnmanagedDebugging><DefineConstants>TRACE</DefineConstants><ErrorReport>prompt</ErrorReport><WarningLevel>4</WarningLevel></PropertyGroup><ItemGroup><Reference Include="System" /><Reference Include="System.Data" /><Reference Include="System.Runtime.Serialization" /><Reference Include="System.Windows.Forms" /><Reference Include="System.Xml" /><Reference Include="Microsoft.SqlServer.ManagedDTS, Version=13.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" /><Reference Include="Microsoft.SqlServer.ScriptTask, Version=13.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" /></ItemGroup><ItemGroup><AppDesigner Include="Properties\" /><Compile Include="Web_api.cs" /><Compile Include="Properties\AssemblyInfo.cs"><SubType>Code</SubType></Compile><EmbeddedResource Include="Properties\Resources.resx"><Generator>ResXFileCodeGenerator</Generator><LastGenOutput>Resources.Designer.cs</LastGenOutput></EmbeddedResource><Compile Include="Properties\Resources.Designer.cs"><AutoGen>True</AutoGen><DependentUpon>Resources.resx</DependentUpon></Compile><None Include="Properties\Settings.settings"><Generator>SettingsSingleFileGenerator</Generator><LastGenOutput>Settings.Designer.cs</LastGenOutput></None><Compile Include="Properties\Settings.Designer.cs"><AutoGen>True</AutoGen><DependentUpon>Settings.settings</DependentUpon></Compile><Compile Include="ScriptMain.cs"><SubType>Code</SubType></Compile></ItemGroup><!-- Include the build rules for a C# project.--><Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" /><ProjectExtensions><VisualStudio><FlavorProperties GUID="{30D016F9-3734-4E33-A861-5E7D899E18F3}"><ProjectProperties HostName="VSTAHostName" HostPackage="{B3A685AA-7EAF-4BC6-9940-57959FA5AC07}" ApplicationType="usd" Language="cs" TemplatesPath="" /><Host Name="ScriptTask" /><ProjectClient><HostIdentifier>SSIS_ST130</HostIdentifier></ProjectClient></FlavorProperties></VisualStudio></ProjectExtensions></Project>]]></ProjectItem>
                      <ProjectItem
                        Name="Project"
                        Encoding="UTF16LE"><![CDATA[<?xml version="1.0" encoding="UTF-16" standalone="yes"?>
<c:Project xmlns:c="http://schemas.microsoft.com/codeprojectml/2010/08/main" xmlns:msb="http://schemas.microsoft.com/developer/msbuild/2003" runtimeVersion="3.0" schemaVersion="1.0">
	<msb:PropertyGroup>
		<msb:Language>msBuild</msb:Language>
		<msb:CodeName>ST_e6a525588f3140f4851d015a3bacb54d</msb:CodeName>
		<msb:DisplayName>ST_e6a525588f3140f4851d015a3bacb54d</msb:DisplayName>
		<msb:ProjectId>{95329CA5-7133-4412-B9C1-C4C86BAF6E86}</msb:ProjectId>
	</msb:PropertyGroup>
	<msb:ItemGroup>
		<msb:Project Include="ST_7789ad873ae04f4e9b97d541a0c32fa2.csproj"/>
		<msb:File Include="Properties\Settings.settings"/>
		<msb:File Include="Properties\AssemblyInfo.cs"/>
		<msb:File Include="Properties\Resources.resx"/>
		<msb:File Include="Properties\Resources.Designer.cs"/>
		<msb:File Include="Web_api.cs"/>
		<msb:File Include="Properties\Settings.Designer.cs"/>
		<msb:File Include="ScriptMain.cs"/>
	</msb:ItemGroup>
</c:Project>]]></ProjectItem>
                      <ProjectItem
                        Name="Properties\AssemblyInfo.cs"
                        Encoding="UTF8"><![CDATA[using System.Reflection;
using System.Runtime.CompilerServices;

//
// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
//
[assembly: AssemblyTitle("ST_e6a525588f3140f4851d015a3bacb54d")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("ST_e6a525588f3140f4851d015a3bacb54d")]
[assembly: AssemblyCopyright("Copyright @  2020")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]
//
// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Revision and Build Numbers 
// by using the '*' as shown below:

[assembly: AssemblyVersion("1.0.*")]]]></ProjectItem>
                      <ProjectItem
                        Name="Properties\Settings.settings"
                        Encoding="UTF8"><![CDATA[<?xml version='1.0' encoding='iso-8859-1'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>]]></ProjectItem>
                      <ProjectItem
                        Name="Properties\Resources.Designer.cs"
                        Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_e6a525588f3140f4851d015a3bacb54d.Properties.Resources.get_ResourceManager():System.Resources.Resou" +
    "rceManager")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_e6a525588f3140f4851d015a3bacb54d.Properties.Resources.get_Culture():System.Globalization.CultureIn" +
    "fo")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_e6a525588f3140f4851d015a3bacb54d.Properties.Resources.set_Culture(System.Globalization.CultureInfo" +
    "):Void")]

namespace ST_e6a525588f3140f4851d015a3bacb54d.Properties {
    
    
    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if ((resourceMan == null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("ST_e6a525588f3140f4851d015a3bacb54d.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}]]></ProjectItem>
                      <BinaryItem
                        Name="ST_7789ad873ae04f4e9b97d541a0c32fa2.dll">TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1v
ZGUuDQ0KJAAAAAAAAABQRQAATAEDAJEUYl4AAAAAAAAAAOAAIiALATAAACgAAAAIAAAAAAAATkYA
AAAgAAAAYAAAAAAAEAAgAAAAAgAABAAAAAAAAAAEAAAAAAAAAACgAAAAAgAAAAAAAAMAQIUAABAA
ABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAPxFAABPAAAAAGAAAHgEAAAAAAAAAAAAAAAAAAAA
AAAAAIAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAIAAACAAAAAAAAAAAAAAACCAAAEgAAAAAAAAAAAAAAC50ZXh0AAAAVCYAAAAgAAAAKAAAAAIA
AAAAAAAAAAAAAAAAACAAAGAucnNyYwAAAHgEAAAAYAAAAAYAAAAqAAAAAAAAAAAAAAAAAABAAABA
LnJlbG9jAAAMAAAAAIAAAAACAAAAMAAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAAAw
RgAAAAAAAEgAAAACAAUA5CgAAGAcAAABAAAAAAAAAERFAAC4AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAABMwBQAtAAAAAQAAEQIDKAQAAAYKBo5pjScAAAELFgwrEAcI
AgYImigCAAAGoggXWAwIBo5pMuoHKgAAABswBgD8AgAAAgAAEQMoEgAACgoCG40nAAABJRYGjmkN
EgMoEwAACqIlF3IBAABwoiUYAnsBAAAEoiUZcgEAAHCiJRoCAnsCAAAEKAMAAAaiKBQAAAooAwAA
BgtyBQAAcAJ7AQAABHJdAABwBygVAAAKKBYAAAp0DgAAAQwIcm8AAHBvFwAACggGjmlqbxgAAAoI
co8AAHBvGQAACghvGgAAChMEEQQGFgaOaW8bAAAK3gwRBCwHEQRvHAAACtwACG8dAAAKdBAAAAET
BREFbx4AAAogyAAAAEAQAgAAEQVvHwAACnKZAABwbyAAAAosT3MhAAAKEwYRBW8iAAAKEQZvIwAA
ChEGbyQAAAoTBxEGbyUAAAoDA3K5AABwbyYAAApvJwAACnK9AABwKCgAAAolEQcoKQAAChMI3cYB
AAARBW8fAAAKcscAAHBvIAAACjmSAQAAfioAAAomfioAAAoTCSgrAAAKJtAGAAACKCwAAApzLQAA
ChMLEQVvIgAAChMOEQsRDm8uAAAKdAYAAAITCt4MEQ4sBxEObxwAAArc3gcmcxwAAAZ6EQpvFgAA
BhMJAhuNJwAAASUWEQmiJRdyAQAAcKIlGAJ7AQAABKIlGXIBAABwoiUaAgJ7AgAABCgDAAAGoigU
AAAKKAMAAAYTDByNJwAAASUWcgUAAHCiJRcCewEAAASiJRhyXQAAcKIlGREMoiUacukAAHCiJRsR
CaIoFAAACigWAAAKdA4AAAETDRENcvMAAHBvGQAAChYTDziQAAAAIHAXAAAoLwAAChENbx0AAAp0
EAAAARMQERBvHwAACnKZAABwbyAAAAosTHMhAAAKExEREG8iAAAKERFvIwAAChERbyQAAAoTEhER
byUAAAoDA3K5AABwbyYAAApvJwAACnK9AABwKCgAAAolERIoKQAAChMI3kbeDBEQLAcREG8cAAAK
3N4DJt4AEQ8XWBMPEQ8fCj9n////cxkAAAZ6cxsAAAZ6cxoAAAZ6EQUsBxEFbxwAAArcJgMTCN4A
EQgqQawAAAIAAACYAAAADgAAAKYAAAAMAAAAAAAAAAIAAAB2AQAAEgAAAIgBAAAMAAAAAAAAAAAA
AABtAQAAKQAAAJYBAAAHAAAADQAAAQIAAABUAgAAYQAAALUCAAAMAAAAAAAAAAAAAABGAgAAfQAA
AMMCAAADAAAADQAAAQIAAADAAAAAJwIAAOcCAAAMAAAAAAAAAAAAAACzAAAAQAIAAPMCAAAGAAAA
DQAAARMwAwBJAAAAAwAAESgwAAAKKCsAAAoDbzEAAApvMgAACgpzMwAACgsWDCscBwYIjzUAAAFy
+wAAcCg0AAAKbzUAAAomCBdYDAgGjmky3gdvNgAACioAAAATMAQA1wAAAAQAABEDcgEBAHAoKAAA
CgpzNwAACiUGbzgAAApyCwEAcG85AAAKbzoAAAoLBxc+nQAAAHM7AAAKDBYTBDiAAAAAczcAAAoT
BREFBm84AAAKEQVyCwEAcG85AAAKEwYHF1kTByspEQcRBC4dEQYRB288AAAKbz0AAAoRBhEHbzwA
AApvPgAACiYRBxdZEwcRBxYv0gMRBBdYEwgSCCgTAAAKcgEBAHAoPwAACg0RBQlvQAAACggJb0EA
AAoRBBdYEwQRBAc/eP///whvQgAACioXjScAAAElFgaiKgAbMAIAKgAAAAUAABECc0MAAApvRAAA
CgoWCysTBgeaDAhvRQAACt4DJt4ABxdYCwcGjmky5yoAAAEQAAAAABQACBwAAxgAAAF2AnIxAQBw
fQEAAAQCckEBAHB9AgAABAIoRgAACioAABswBgAJAQAABgAAEShHAAAKAv4GCAAABnNIAAAKb0kA
AAoCKEoAAApvSwAACnJTAQBwb0wAAApycQEAcG9NAAAKcnMBAHAKAihKAAAKb0sAAApyxQEAcG9M
AAAKb04AAAp0JwAAAQty4QEAcCgFAAAGB3JxAQBwKE8AAAosYAYoUAAACg3eCgksBglvHAAACtwG
BygrAAAKKFEAAApzBgAABgYGcrkAAHBvJgAACm8nAAAKbwEAAAYMAihKAAAKb0sAAApyUwEAcG9M
AAAKch8CAHAIKFIAAApvTQAACt4oEwQCKEoAAApvUwAAChZyIwIAcBEEb1QAAAp+KgAAChZvVQAA
CibeAAIoSgAAChZvVgAACioAAAABHAAAAgB5AAJ7AAoAAAAAAAAWAL7UACgYAAABGzAEAEEAAAAH
AAARFAoCBAYoCQAABgreGwsCKEoAAAoHbzYAAAoWFo01AAABb1cAAAr+GgIoSgAACnI7AgBwFhaN
NQAAAW9XAAAKBioAAAABEAAAAAACAAsNABsYAAABEzAGAL4AAAAIAAARAihKAAAKcocCAHADb1gA
AAooWQAAChYWjTUAAAFvVwAACnL/AgBwCnI5AwBwA29YAAAKF41AAAABJRYfLJ1vWgAAChaaKFkA
AAoLAihKAAAKckkDAHAHKCgAAAoWFo01AAABb1cAAAoGByhbAAAKDAgoXAAACiwnAihKAAAKcmMD
AHAIKFkAAAoWFo01AAABb1cAAAoIKF0AAAoQAisdAihKAAAKctkDAHAIKFkAAAoWFo01AAABb1cA
AAoEKh4CKF4AAAoqHgIoRgAACiqufgMAAAQtHnIVBABw0AQAAAIoLAAACm9fAAAKc2AAAAqAAwAA
BH4DAAAEKhp+BAAABCoeAoAEAAAEKhp+BQAABCoeAihhAAAKKi5zEAAABoAFAAAEKh4CewYAAAQq
IgIDfQYAAAQqHgJ7BwAABCoiAgN9BwAABCoeAnsIAAAEKiICA30IAAAEKh4CKGIAAAoqAEJTSkIB
AAEAAAAAAAwAAAB2NC4wLjMwMzE5AAAAAAUAbAAAANwIAAAjfgAASAkAAFQLAAAjU3RyaW5ncwAA
AACcFAAAiAQAACNVUwAkGQAAEAAAACNHVUlEAAAANBkAACwDAAAjQmxvYgAAAAAAAAACAAABVx2i
CQkDAAAA+gEzABYAAAEAAABBAAAACwAAAAsAAAAcAAAADQAAAGIAAAACAAAAHQAAAAgAAAADAAAA
BgAAAAoAAAABAAAAAQAAAAYAAAABAAAABgAAAAAATQYBAAAAAAAGABkE8QgGAL4E8QgGAFED3ggP
AGUJAAAGAH4DdwcGAOgDdwcGAMkDdwcGAKUEdwcGAE8EdwcGAGgEdwcGAJUDdwcGALADcQUGAFUK
2AYKAJ4KXAoGAMgGSAAKALkCXAoGAMIGSAAOAJgI1QcGADsIzQoGAAEAggASAIgKdQYSAK0KdQYG
AP4HSAAGAMsH2AYOADkEWgcGABkD8QgOAAUEWgcWAIME/AUWAIUC/AUGAC4LdwcGAOcJ2AYGAO0G
2AYGADQD3ggGAGAIEQkGAAcIRQcKAPcCNwYKAGUDNwYKAKECMAcGAI0F2AYGANYBSAAGAAgA2AYK
AKIKXAoGAKIB2AYKAL0CXAoKAGcBXAoGAGgFzQoGAFAC2AYGAK4B2AYOALMIWgcGAMEAVwUGADIA
AAsGAN8GAAsGANwE2AYSAHYBdQYGACIISAAGABMISAAGAAkH2AYGAHAI2AYWACUG/AUaAKcJDQIa
AJkBDQIGAJQGSAAWAIQI/AUGADYI2AYGALMFSAAAAAAAPwAAAAAAAQABAAAAEADVBZ0ANQABAAEA
AQAQAP4GnQB1AAMABwAAABAAGAl0CTUAAwALAAABEADeCXQJmQAFAA8AAgAQAMkCAAA1AAYAEgAC
ABAAxAcAAGEACQAZAAIAEACJBwAAYQAJABoAAgAQAKwHAABhAAkAGwACABAAngcAAGEACQAcAAMB
AAANCgAAgQAJAB0AAQAlB6sAAQA/AasAEQDyBgoCEQB1Ag8CEQBIARQCAQDzAKsAAQALAasAAQDf
AKsABgZxABgCVoD9CRsCVoBVAhsCUCAAAAAAhgCJBh8CAQCMIAAAAACBAFAF6gACAEAkAAAAAIEA
mAXqAAMAmCQAAAAAgQCABh8CBAB8JQAAAACWAEkIJQIFAMQlAAAAAIYY0QgGAAYA5CUAAAAAhgAE
BwYABgAYJwAAAACGABQFKgIGAHgnAAAAAIEAKgsyAggAQigAAAAAhhjRCAYACgBKKAAAAACDGNEI
BgAKAFIoAAAAAJMIXAg7AgoAfigAAAAAkwhdAkECCgCFKAAAAACTCGkCRwIKAI0oAAAAAJYIbQpO
AgsAlCgAAAAAhhjRCAYACwCcKAAAAACRGNcIUwILAKgoAAAAAIYILQpNAAsAsCgAAAAAhgg4ChAA
CwC5KAAAAACGCOYKTQAMAMEoAAAAAIYI7woQAAwAyigAAAAAhgjRAE0ADQDSKAAAAACGCNgAEAAN
AEooAAAAAIYY0QgGAA4A2ygAAAAAhhjRCAYADgDbKAAAAACGGNEIBgAOANsoAAAAAIYY0QgGAA4A
2ygAAAAAhhjRCAYADgAAAAEA5AEAAAEArwUAAAEAuQoAAAEAvwoAAAEAAgIAAAEAVQgAAAIA+AkA
AAEA+AkAAAIANwsAAAEA9QQAAAEA9QQAAAEA9QQAAAEA9QQJANEIAQARANEIBgAZANEICgApANEI
EAAxANEIEAA5ANEIEABBANEIEABJANEIEABRANEIEABZANEIEABhANEIEADJANEIBgDRANEIBgDZ
ANEIBgDhANEIBgAJAdEIBgApAdEIFQBBAboJRwBJAYsFTQA5AUMKUQA5AUMKVwBRAfACXwBRAUUC
EABRAbgFZgBRATQBEABRAbEGawB5ABMDcABZAegCBgBRAdYCeACBAFgBfgBhATUCTQA5AcoFhACJ
ANEIBgBhAZ8GawB5APcHiQCJAPgKjwB5AOICBgA5AUQFlAA5ATIFmQA5AUMKngBBAccJpAA5AU4L
qwBxATYArgB5AcABtACRANEIvQCJAVEKxACRATAIygCZAfAC1wBxAdUJ3QChAaMF4wCZANEIBgCp
AYsF6gCZAC0B7wBpAIsFTQCpANEIBgCpAMgAEACpAO0BBwGxAJQKDQEMANEIBgCxADkFFwGxAX4B
HgGxASEBJAE5AUMKLQGpAPsEEAAMAM0ANAEMAPgKOgG5AdEIEAC5AbEJSQHBAQwDBgBpANEIBgDJ
ARMHWgHRAdEIYAHJAQAFZgHpAAUKbQHZAaMJcwHhAc8GeQHpAesEgAHpAeEEhQE5AUALiQFBAfAC
jwFBAdkKlgE5ASsHnwHZARsKpgHBAI0BTQD5AccIrAHZAXkKAQDZAZQFvAH5ANsBTQA5AUoKygE5
AWcK0AEJAi0CngBBASYK1wHxANIB3AHpANEIBgB5AR0L4gERAdEI5wExAdEIBgDBANEIBgAIACgA
AAIIACwABQIpAIsAlAIuAAsAbAIuABMAdQIuABsAlAIuACMAnQIuACsAxgIuADMAxgIuADsAxgIu
AEMAnQIuAEsAzAIuAFMAxgIuAFsA4wJJAIsAlAJjAHsABQKDAIMABQKJAHMABQKhAGsABQKpAHMA
BQLBAGsABQLDAGMABQLJAHMABQLhAGsABQIBAWsABQJAAmsABQJgAmsABQKAAmsABQKgAmsABQLA
AmsABQLgAmsABQIcACQAzwD1AEABTwG1AcQBBAABAAUAAwAGAAQAAABgCFcCAAB9Al0CAABxCmMC
AAA8CmgCAADzCmgCAADcAGgCAgAMAAMAAgANAAUAAQAOAAUAAgAPAAcAAgASAAkAAQATAAkAAgAU
AAsAAQAVAAsAAgAWAA0AAQAXAA0AEQEEgAAAAQAAAMocH1YAAAAAAAAOAAAABAAAAAAAAAAAAAAA
7gF5AAAAAAAEAAAAAAAAAAAAAADuAdgGAAAAAAQAAAAAAAAAAAAAAO4BWgcAAAAABAAAAAAAAAAA
AAAA7gF1BgAAAAANAAAAAAAAAAAAAAD3Ad0FAAAAAA0AAAAAAAAAAAAAAPcBUgAAAAAAAAAAAAEA
AAAiCQAABgACAAcAAgAIAAIACQACAAoAAgALAAMAAAAAAABMaXN0YDEASW50MzIAU1RfNzc4OWFk
ODczYWUwNGY0ZTliOTdkNTQxYTBjMzJmYTIATUQ1AGdldF9VVEY4ADxNb2R1bGU+AFN5c3RlbS5J
TwBNaWNyb3NvZnQuU3FsU2VydmVyLk1hbmFnZWREVFMAdmFsdWVfXwBtc2NvcmxpYgBTeXN0ZW0u
Q29sbGVjdGlvbnMuR2VuZXJpYwBTVF9lNmE1MjU1ODhmMzE0MGY0ODUxZDAxNWEzYmFjYjU0ZABU
aHJlYWQATG9hZABBZGQAZ2V0X2lkAHNldF9pZAA8aWQ+a19fQmFja2luZ0ZpZWxkADxzdGF0dXM+
a19fQmFja2luZ0ZpZWxkADx0ZXh0PmtfX0JhY2tpbmdGaWVsZABSZW1vdmVDaGlsZABBcHBlbmQA
c2V0X01ldGhvZABwYXNzd29yZABkZWZhdWx0SW5zdGFuY2UAZ2V0X1N0YXR1c0NvZGUASHR0cFN0
YXR1c0NvZGUAWG1sTm9kZQBnZXRfUGFyZW50Tm9kZQBnZXRfTWVzc2FnZQBWYXJpYWJsZQBJRGlz
cG9zYWJsZQBSdW50aW1lVHlwZUhhbmRsZQBHZXRUeXBlRnJvbUhhbmRsZQBMb2FkRmlsZQBnZXRf
TmFtZQBmaWxlTmFtZQBHZXRFbGVtZW50c0J5VGFnTmFtZQBmb2xkZXJOYW1lAE1pY3Jvc29mdC5T
cWxTZXJ2ZXIuRHRzLlJ1bnRpbWUAQ29tYmluZQBnZXRfQ29udGVudFR5cGUAc2V0X0NvbnRlbnRU
eXBlAEZhaWx1cmUAZ2V0X0N1bHR1cmUAc2V0X0N1bHR1cmUAcmVzb3VyY2VDdWx0dXJlAFZTVEFS
VFNjcmlwdE9iamVjdE1vZGVsQmFzZQBBcHBsaWNhdGlvblNldHRpbmdzQmFzZQBIdHRwV2ViUmVz
cG9uc2UASnNvblJlc3BvbnNlAEdldFJlc3BvbnNlAENsb3NlAERpc3Bvc2UAQ3JlYXRlAEVkaXRv
ckJyb3dzYWJsZVN0YXRlAERlbGV0ZQBXcml0ZQBDb21waWxlckdlbmVyYXRlZEF0dHJpYnV0ZQBE
ZWJ1Z2dlck5vblVzZXJDb2RlQXR0cmlidXRlAERlYnVnZ2FibGVBdHRyaWJ1dGUARWRpdG9yQnJv
d3NhYmxlQXR0cmlidXRlAEFzc2VtYmx5VGl0bGVBdHRyaWJ1dGUAQXNzZW1ibHlUcmFkZW1hcmtB
dHRyaWJ1dGUAVGFyZ2V0RnJhbWV3b3JrQXR0cmlidXRlAEFzc2VtYmx5Q29uZmlndXJhdGlvbkF0
dHJpYnV0ZQBBc3NlbWJseURlc2NyaXB0aW9uQXR0cmlidXRlAERhdGFNZW1iZXJBdHRyaWJ1dGUA
Q29tcGlsYXRpb25SZWxheGF0aW9uc0F0dHJpYnV0ZQBEYXRhQ29udHJhY3RBdHRyaWJ1dGUAQXNz
ZW1ibHlQcm9kdWN0QXR0cmlidXRlAEFzc2VtYmx5Q29weXJpZ2h0QXR0cmlidXRlAFNTSVNTY3Jp
cHRUYXNrRW50cnlQb2ludEF0dHJpYnV0ZQBBc3NlbWJseUNvbXBhbnlBdHRyaWJ1dGUAUnVudGlt
ZUNvbXBhdGliaWxpdHlBdHRyaWJ1dGUAQnl0ZQBnZXRfVmFsdWUAc2V0X1ZhbHVlAHZhbHVlAFNh
dmUAYWRkX0Fzc2VtYmx5UmVzb2x2ZQBDdXJyZW50RG9tYWluX0Fzc2VtYmx5UmVzb2x2ZQBSZW1v
dmUAZ2V0X0l0ZW1PZgBMYXN0SW5kZXhPZgBHZXRQZGYAU3lzdGVtLlRocmVhZGluZwBFbmNvZGlu
ZwBTeXN0ZW0uUnVudGltZS5WZXJzaW9uaW5nAFRvU3RyaW5nAExvZwBHZXRNZDVIYXNoAENvbXB1
dGVIYXNoAGZ1bGxQYXRoAHNldF9Db250ZW50TGVuZ3RoAFN0YXJ0c1dpdGgAV2ViX2FwaQBNaWNy
b3NvZnQuU3FsU2VydmVyLlNjcmlwdFRhc2sATWljcm9zb2Z0LlNxbFNlcnZlci5EdHMuVGFza3Mu
U2NyaXB0VGFzawBTY3JpcHRPYmplY3RNb2RlbABTeXN0ZW0uQ29tcG9uZW50TW9kZWwAU1RfNzc4
OWFkODczYWUwNGY0ZTliOTdkNTQxYTBjMzJmYTIuZGxsAFN5c3RlbS5YbWwAUGFyc2VYbWwAUHJv
Y2Vzc1htbABGaWxlU3RyZWFtAEdldFJlc3BvbnNlU3RyZWFtAEdldFJlcXVlc3RTdHJlYW0ATWVt
b3J5U3RyZWFtAGdldF9JdGVtAFN5c3RlbQBIYXNoQWxnb3JpdGhtAEVudW0AcmVzb3VyY2VNYW4A
U2NyaXB0TWFpbgBBcHBEb21haW4AZ2V0X0N1cnJlbnREb21haW4AbG9naW4ASm9pbgBTeXN0ZW0u
Q29uZmlndXJhdGlvbgBTeXN0ZW0uR2xvYmFsaXphdGlvbgBTeXN0ZW0uUnVudGltZS5TZXJpYWxp
emF0aW9uAFN5c3RlbS5SZWZsZWN0aW9uAEJhZFJlc3BvbnNlRXhjZXB0aW9uAEpzb25FeGNlcHRp
b24AVW5rbm93bkNvbnRlbnRFeGNlcHRpb24AVGltZU91dEV4Y2VwdGlvbgBTeXN0ZW0uUnVudGlt
ZS5TZXJpYWxpemF0aW9uLkpzb24AQ29weVRvAEZpbGVJbmZvAEN1bHR1cmVJbmZvAEZpbGVTeXN0
ZW1JbmZvAERpcmVjdG9yeUluZm8AU2xlZXAAQ2hhcgBTdHJpbmdCdWlsZGVyAENsZWFyRm9sZGVy
AHNlbmRlcgBnZXRfUmVzb3VyY2VNYW5hZ2VyAFJlc29sdmVFdmVudEhhbmRsZXIARXZlbnRzT2Jq
ZWN0V3JhcHBlcgBEYXRhQ29udHJhY3RKc29uU2VyaWFsaXplcgBYbWxPYmplY3RTZXJpYWxpemVy
AEZpcmVFcnJvcgAuY3RvcgAuY2N0b3IAU3lzdGVtLkRpYWdub3N0aWNzAFN5c3RlbS5SdW50aW1l
LkNvbXBpbGVyU2VydmljZXMAU3lzdGVtLlJlc291cmNlcwBTVF9lNmE1MjU1ODhmMzE0MGY0ODUx
ZDAxNWEzYmFjYjU0ZC5Qcm9wZXJ0aWVzLlJlc291cmNlcy5yZXNvdXJjZXMARGVidWdnaW5nTW9k
ZXMAU1RfZTZhNTI1NTg4ZjMxNDBmNDg1MWQwMTVhM2JhY2I1NGQuUHJvcGVydGllcwBnZXRfVmFy
aWFibGVzAEdldEZpbGVzAFJlYWRBbGxCeXRlcwBXcml0ZUFsbEJ5dGVzAEdldEJ5dGVzAFNldHRp
bmdzAFJlc29sdmVFdmVudEFyZ3MAYXJncwBTdWNjZXNzAGdldF9EdHMAU2NyaXB0UmVzdWx0cwBn
ZXRfRXZlbnRzAEV4aXN0cwBnZXRfc3RhdHVzAHNldF9zdGF0dXMAQ29uY2F0AEZvcm1hdABSZWFk
T2JqZWN0AFN5c3RlbS5OZXQAU3BsaXQAZ2V0X0RlZmF1bHQAc2V0X1Rhc2tSZXN1bHQAWG1sRG9j
dW1lbnQAZ2V0X0NvdW50AEh0dHBXZWJSZXF1ZXN0AFhtbE5vZGVMaXN0AGlucHV0AGZpbGVOYW1l
Tm9FeHQAU3lzdGVtLlRleHQAV3JpdGVBbGxUZXh0AGdldF90ZXh0AHNldF90ZXh0AFRvQXJyYXkA
U3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeQBnZXRfQXNzZW1ibHkATG9hZEFzc2VtYmx5AGFz
c2VtYmx5AG9wX0luZXF1YWxpdHkARW1wdHkAAAM6AABXaAB0AHQAcABzADoALwAvAHcAdwB3AC4A
YQBsAHQAYQAuAHIAdQAvAHgAbQBsAC0AcAByAGUAdgBpAGUAdwAvAGEAcABpAC8APwBsAG8AZwBp
AG4APQABESYAcwBlAGMAcgBlAHQAPQAAH2EAcABwAGwAaQBjAGEAdABpAG8AbgAvAHgAbQBsAAAJ
UABPAFMAVAAAH2EAcABwAGwAaQBjAGEAdABpAG8AbgAvAHAAZABmAAADLgAACS4AcABkAGYAACFh
AHAAcABsAGkAYwBhAHQAaQBvAG4ALwBqAHMAbwBuAAAJJgBpAGQAPQAAB0cARQBUAAAFeAAyAAAJ
LgB4AG0AbAAAJWUAZABjAG4AdAA6AEMAbwBuAHQAYQBpAG4AZQByAEQAbwBjAAAPcwBhADEAMAA1
ADUAMgAAETIAVgBzAFcANQBhAE0AbgAAHVUAcwBlAHIAOgA6AGYAaQBsAGUAXwB2AGIAZAAAAQBR
XABcADEAMAAuADEAMAAuADAALgAyADgAXABhAGwAdABhAFwAUABhAHkAbQBlAG4AdABDAGgAZQBj
AGsAXABjAGgAZQBjAGsALgB4AG0AbAAAG1UAcwBlAHIAOgA6AHgAbQBsAF8AdgBiAGQAAD1cAFwA
MQAwAC4AMQAwAC4AMAAuADIAOABcAGEAbAB0AGEAXABQAGEAeQBtAGUAbgB0AEMAaABlAGMAawAA
A3wAABdTAGMAcgBpAHAAdAAgAFQAYQBzAGsAAEtFAHgAaQB0AGkAbgBnACAAQwB1AHIAcgBlAG4A
dABEAG8AbQBhAGkAbgBfAEEAcwBzAGUAbQBiAGwAeQBSAGUAcwBvAGwAdgBlAAB3RQBuAHQAZQBy
AGkAbgBnACAAQwB1AHIAcgBlAG4AdABEAG8AbQBhAGkAbgBfAEEAcwBzAGUAbQBiAGwAeQBSAGUA
cwBvAGwAdgBlACAAdwBpAHQAaAAgAGEAcgBnAHMALgBOAGEAbQBlACAAWwB7ADAAfQBdAAA5XABc
ADEAMAAuADEAMAAuADAALgAyADgAXABhAGwAdABhAFwAUgBvAGIAbwB0AFwARABhAHQAYQAAD3sA
MAB9AC4AZABsAGwAABlEAEwATAAgAE4AYQBtAGUAIABpAHMAIAAAdVQAaABlACAAZgBpAGwAZQAg
AFsAewAwAH0AXQAgAHcAYQBzACAAZgBvAHUAbgBkACAAYQBuAGQAIAB0AGgAYQB0ACAAYQBzAHMA
ZQBtAGIAbAB5ACAAdwBpAGwAbAAgAGIAZQAgAGwAbwBhAGQAZQBkAC4AADtDAG8AdQBsAGQAbgAn
AHQAIABmAGkAbgBkACAAdABoAGUAIABmAGkAbABlACAAWwB7ADAAfQBdAC4AAXFTAFQAXwBlADYA
YQA1ADIANQA1ADgAOABmADMAMQA0ADAAZgA0ADgANQAxAGQAMAAxADUAYQAzAGIAYQBjAGIANQA0
AGQALgBQAHIAbwBwAGUAcgB0AGkAZQBzAC4AUgBlAHMAbwB1AHIAYwBlAHMAAABXm+HMrAvZR6M3
lTpxsPvjAAQgAQEIAyAAAQUgAQEREQQgAQEOBiABARGAkQcHAx0OHQ4IIgcTHQUOEjkIEj0SQRJF
HQUODhIYEkkOEjkSPQgSQRJFHQUFAAEdBQ4DIAAOBQABDh0OBwAEDg4ODg4GAAESgKkOBCABAQoE
IAASPQcgAwEdBQgIBSAAEoCxBSAAEYC1BCABAg4FIAEBEj0EIAAdBQQgAQgOBCABDggFAAIODg4G
AAIBDh0FAgYOBQAAEoC5CAABEoC9EYDBBiABARKAvQUgARwSPQQAAQEIBwcDHQUSTQgFAAASgM0F
IAEdBQ4GIAEdBR0FBCABDg4FIAESTQ4RBwkOCBUSUQEODggSVRJZCAgFIAESWQ4DIAAIBRUSUQEO
BiABEoDZCAUgABKA2QggARKA2RKA2QYAAw4ODg4FIAEBEwAFIAAdEwAIBwMdEl0IEl0FIAAdEl0K
BwUODh0OEj0SYQUAABKA5QUgAgEcGAYgAQESgOkFIAASgO0FIAASgPEGIAESgPUcBCABARwDIAAc
BQACAg4OBgABEoD5DggAAwEODhKAuQYAAg4OHQ4FIAASgP0IIAUCCA4ODggGBwISeRJhByADAQ4I
HQUFBwMODg4FAAIODhwGIAEdDh0DBAABAg4FAAESeQ4EIAASeQYgAgEOEnkIt3pcVhk04IkIiYRd
zYCAzJEEAAAAAAQBAAAABAYSgIkEBhKAjQMGEhQCBggDBhEsBSABHQ4OBAABAQ4HIAISeRwSfQgg
AhJ5En0SeQUAABKAiQUAABKAjQYAAQESgI0EAAASFAMAAAEFCAASgIkFCAASgI0ECAASFAMoAA4I
AQAIAAAAAAAeAQABAFQCFldyYXBOb25FeGNlcHRpb25UaHJvd3MBCAEAAgAAAAAAKAEAI1NUX2U2
YTUyNTU4OGYzMTQwZjQ4NTFkMDE1YTNiYWNiNTRkAAAFAQAAAAAWAQARQ29weXJpZ2h0IEAgIDIw
MjAAAEcBABouTkVURnJhbWV3b3JrLFZlcnNpb249djQuMAEAVA4URnJhbWV3b3JrRGlzcGxheU5h
bWUQLk5FVCBGcmFtZXdvcmsgNAC0AAAAzsrvvgEAAACRAAAAbFN5c3RlbS5SZXNvdXJjZXMuUmVz
b3VyY2VSZWFkZXIsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwg
UHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OSNTeXN0ZW0uUmVzb3VyY2VzLlJ1bnRpbWVS
ZXNvdXJjZVNldAIAAAAAAAAAAAAAAFBBRFBBRFC0AAAAJEYAAAAAAAAAAAAAPkYAAAAgAAAAAAAA
AAAAAAAAAAAAAAAAAAAAADBGAAAAAAAAAAAAAAAAX0NvckRsbE1haW4AbXNjb3JlZS5kbGwAAAAA
AP8lACAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABABAAAAAY
AACAAAAAAAAAAAAAAAAAAAABAAEAAAAwAACAAAAAAAAAAAAAAAAAAAABAAAAAABIAAAAWGAAABoE
AAAAAAAAAAAAABoENAAAAFYAUwBfAFYARQBSAFMASQBPAE4AXwBJAE4ARgBPAAAAAAC9BO/+AAAB
AAAAAQAfVsocAAABAB9Wyhw/AAAAAAAAAAQAAAACAAAAAAAAAAAAAAAAAAAARAAAAAEAVgBhAHIA
RgBpAGwAZQBJAG4AZgBvAAAAAAAkAAQAAABUAHIAYQBuAHMAbABhAHQAaQBvAG4AAAAAAAAAsAR6
AwAAAQBTAHQAcgBpAG4AZwBGAGkAbABlAEkAbgBmAG8AAABWAwAAAQAwADAAMAAwADAANABiADAA
AAAaAAEAAQBDAG8AbQBtAGUAbgB0AHMAAAAAAAAAIgABAAEAQwBvAG0AcABhAG4AeQBOAGEAbQBl
AAAAAAAAAAAAcAAkAAEARgBpAGwAZQBEAGUAcwBjAHIAaQBwAHQAaQBvAG4AAAAAAFMAVABfAGUA
NgBhADUAMgA1ADUAOAA4AGYAMwAxADQAMABmADQAOAA1ADEAZAAwADEANQBhADMAYgBhAGMAYgA1
ADQAZAAAAD4ADwABAEYAaQBsAGUAVgBlAHIAcwBpAG8AbgAAAAAAMQAuADAALgA3ADMANwAwAC4A
MgAyADAANAA3AAAAAABwACgAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAFMAVABfADcANwA4
ADkAYQBkADgANwAzAGEAZQAwADQAZgA0AGUAOQBiADkANwBkADUANAAxAGEAMABjADMAMgBmAGEA
MgAuAGQAbABsAAAASAASAAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0AAAAQwBvAHAAeQBy
AGkAZwBoAHQAIABAACAAIAAyADAAMgAwAAAAKgABAAEATABlAGcAYQBsAFQAcgBhAGQAZQBtAGEA
cgBrAHMAAAAAAAAAAAB4ACgAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBuAGEAbQBlAAAAUwBU
AF8ANwA3ADgAOQBhAGQAOAA3ADMAYQBlADAANABmADQAZQA5AGIAOQA3AGQANQA0ADEAYQAwAGMA
MwAyAGYAYQAyAC4AZABsAGwAAABoACQAAQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUAAAAAAFMAVABf
AGUANgBhADUAMgA1ADUAOAA4AGYAMwAxADQAMABmADQAOAA1ADEAZAAwADEANQBhADMAYgBhAGMA
YgA1ADQAZAAAAEIADwABAFAAcgBvAGQAdQBjAHQAVgBlAHIAcwBpAG8AbgAAADEALgAwAC4ANwAz
ADcAMAAuADIAMgAwADQANwAAAAAARgAPAAEAQQBzAHMAZQBtAGIAbAB5ACAAVgBlAHIAcwBpAG8A
bgAAADEALgAwAC4ANwAzADcAMAAuADIAMgAwADQANwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAwAAABQNgAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=</BinaryItem>
                    </ScriptProject>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
              <DTS:PrecedenceConstraints>
                <DTS:PrecedenceConstraint
                  DTS:refId="Package\Система уведомлений\Чеки ВБД\Container_FOR.PrecedenceConstraints[Ограничение]"
                  DTS:CreationName=""
                  DTS:DTSID="{100B4DCA-FF20-4055-BA13-119F801A7C0E}"
                  DTS:From="Package\Система уведомлений\Чеки ВБД\Container_FOR\Конвертация чека"
                  DTS:LogicalAnd="True"
                  DTS:ObjectName="Ограничение"
                  DTS:To="Package\Система уведомлений\Чеки ВБД\Container_FOR\Задача &quot;Отправка почты&quot;" />
              </DTS:PrecedenceConstraints>
              <DTS:ForEachVariableMappings>
                <DTS:ForEachVariableMapping
                  DTS:CreationName=""
                  DTS:DTSID="{CC6789E4-2119-4B12-A042-1EA7DED8244E}"
                  DTS:ObjectName="{CC6789E4-2119-4B12-A042-1EA7DED8244E}"
                  DTS:ValueIndex="0"
                  DTS:VariableName="User::subject_vbd" />
                <DTS:ForEachVariableMapping
                  DTS:CreationName=""
                  DTS:DTSID="{82251876-2944-4BD0-B56D-18D63BA44429}"
                  DTS:ObjectName="{82251876-2944-4BD0-B56D-18D63BA44429}"
                  DTS:ValueIndex="1"
                  DTS:VariableName="User::xml_vbd" />
              </DTS:ForEachVariableMappings>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Чеки ВБД\UPDATE"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{5C4A4573-E2DA-47A1-893F-3532C7500C3F}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="UPDATE"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
                  SQLTask:SqlStatementSource="UPDATE [webproject].[dbo].[payment_checks]&#xA;  SET [old] = 1&#xA;  WHERE [old] = 0" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Чеки ВБД\Вставка новых чеков"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{FA62590F-7483-4957-9FDB-2D9C5D671041}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Вставка новых чеков"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
                  SQLTask:SqlStatementSource="DECLARE @DBNAME nvarchar(100);&#xA;DECLARE @COUNTER int = 100;&#xA;&#xA;WHILE @COUNTER &gt;= 0&#xA;BEGIN&#xA;IF EXISTS(SELECT 0 FROM sys.databases s WHERE UPPER(s.[name]) = 'GTD_ED' + CAST(@COUNTER AS nvarchar(10)))&#xA;&#x9;BEGIN&#xA;&#x9;&#x9;SET @DBNAME = (SELECT [name] FROM sys.databases s WHERE UPPER(s.[name]) = 'GTD_ED' + CAST(@COUNTER AS nvarchar(10)))&#xA;&#x9;&#x9;BREAK&#xA;&#x9;END &#xA;SET @COUNTER = @COUNTER - 1&#xA;END&#xA;&#xA;DECLARE @SQL nvarchar(max) = &#xA;N'USE [webproject] INSERT [webproject].[dbo].[payment_checks]           &#xA;&#x9;&#x9;   ([EnvelopeID]&#xA;&#x9;&#x9;&#x9;  ,[msgDB]&#xA;&#x9;&#x9;&#x9;  ,[xml]&#xA;&#x9;&#x9;&#x9;  ,[InOutDateTime]&#xA;&#x9;&#x9;&#x9;  ,[MessageType]&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;  ,[Result]&#xA;&#x9;&#x9;&#x9;  ,[DocGuid]&#xA;&#x9;&#x9;&#x9;  ,[regnum]&#xA;&#x9;&#x9;&#x9;  ,[&amp;&amp;PRIM]&#xA;&#x9;&#x9;&#x9;  ,[VAT]&#xA;&#x9;&#x9;&#x9;  ,[CargoID]&#xA;&#x9;&#x9;&#x9;  ,[Name])  &#xA;&#x9; SELECT &#xA;&#x9; [EnvelopeID]&#xA;&#x9;&#x9;&#x9;  ,[msgDB]&#xA;&#x9;&#x9;&#x9;  ,[xml] = (SELECT TOP (1) automation.dbo.EdmsgConvert(CAST(Msg AS varbinary(max))) FROM ' + QUOTENAME(@DBNAME) + N'.dbo.EDMsgsXML g WHERE g.EnvelopeID = x.EnvelopeID)&#xA;&#x9;&#x9;&#x9;  ,[InOutDateTime]&#xA;&#x9;&#x9;&#x9;  ,[MessageType]&#x9;&#x9;&#x9;  &#xA;&#x9;&#x9;&#x9;  ,[Result]&#xA;&#x9;&#x9;&#x9;  ,[DocGuid]&#xA;&#x9;&#x9;&#x9;  ,[regnum]&#xA;&#x9;&#x9;&#x9;  ,[&amp;&amp;PRIM]&#xA;&#x9;&#x9;&#x9;  ,[VAT]&#xA;&#x9;&#x9;&#x9;  ,[CargoID]&#xA;&#x9;&#x9;&#x9;  ,[Name]&#x9;&#xA;&#x9; FROM (&#xA;     SELECT [EnvelopeID]      &#xA;      ,[InOutDateTime]      &#xA;      ,[MessageType] &#xA;      ,[Result]&#xA;      ,[DocGuid]&#xA;&#x9;  ,ca.[&amp;&amp;PRIM]&#xA;&#x9;  ,ca.VAT&#xA;&#x9;  ,ca.RegNum&#xA;&#x9;  ,ed.MsgDB&#xA;  FROM [gtd].[dbo].[EDMsgs] ed&#xA;  CROSS APPLY &#xA;  (SELECT COALESCE([&amp;&amp;PRIM], '''') [&amp;&amp;PRIM], &#xA;  CASE WHEN CHARINDEX(''/'', [14_4]) &gt; 0 THEN SUBSTRING([14_4], 1, CHARINDEX(''/'', [14_4]) - 1)&#xA;  ELSE COALESCE([14_4], '''')&#xA;  END VAT,&#xA;  COALESCE(g.RegNum, '''') RegNum &#xA;  FROM gtd.dbo.GTDList g WHERE g.DOCGID = ed.[DocGuid]) AS ca&#xA;  WHERE InOutDateTime BETWEEN DATEADD(day, -1, GETDATE()) AND DATEADD(day, 1, GETDATE())&#xA;  ) x&#xA;  CROSS APPLY (SELECT TOP (1) cd.[CargoID], cust.[Name]&#xA;  FROM [BI].[dwh].[CargoDelivery] cd&#xA;  JOIN [BI].[dwh].[ETP$SQL_Cargo] sc ON cd.CargoID = sc.[Cargo ID]&#xA;  JOIN [BI].[dwh].[ETP$Customer] cust ON sc.[Customer No_] = cust.[No_]&#xA;  WHERE cd.[DeliveryNo_] = x.[&amp;&amp;PRIM] AND cust.[VAT Registration No_] = x.VAT) AS ca1&#xA;  WHERE &#xA;  NOT EXISTS(SELECT 0 FROM [dbo].[payment_checks] n WHERE n.[EnvelopeID] = x.EnvelopeID)&#xA;  AND x.MessageType = ''TKP.00002'' AND x.vat IN (''7705034202'', ''7713085659'', ''7705189397'')'&#xA;&#xA;EXEC (@SQL)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Система уведомлений\Чеки ВБД\Выборка для рассылки"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{58E55EF2-C696-4E77-B973-9C8F59FF7CAF}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Выборка для рассылки"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
                  SQLTask:SqlStatementSource="SELECT [Result] + ' ' + [Name] + ' ' + [regnum] + ' ' + [&amp;&amp;PRIM] + ' ' + [CargoID]       &#xA;      ,[xml]&#xA;  FROM [webproject].[dbo].[payment_checks]&#xA;  WHERE [old] = 0"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::object_vbd" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Система уведомлений\Чеки ВБД.PrecedenceConstraints[Ограничение]"
              DTS:CreationName=""
              DTS:DTSID="{315957B9-6720-4B8E-9312-CCF8064D10FB}"
              DTS:From="Package\Система уведомлений\Чеки ВБД\Вставка новых чеков"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение"
              DTS:To="Package\Система уведомлений\Чеки ВБД\Выборка для рассылки" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Система уведомлений\Чеки ВБД.PrecedenceConstraints[Ограничение 1]"
              DTS:CreationName=""
              DTS:DTSID="{82FB6230-83CE-4911-96B5-BA038FCD33D8}"
              DTS:From="Package\Система уведомлений\Чеки ВБД\Выборка для рассылки"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 1"
              DTS:To="Package\Система уведомлений\Чеки ВБД\Container_FOR" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Система уведомлений\Чеки ВБД.PrecedenceConstraints[Ограничение 2]"
              DTS:CreationName=""
              DTS:DTSID="{EEC10D37-1F23-4DE1-ADEF-6F1E9B6CB448}"
              DTS:From="Package\Система уведомлений\Чеки ВБД\Container_FOR"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Ограничение 2"
              DTS:To="Package\Система уведомлений\Чеки ВБД\UPDATE" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение]"
          DTS:CreationName=""
          DTS:DTSID="{06EE6F3F-9ACE-4E8A-91D3-7D8190D958CE}"
          DTS:From="Package\Система уведомлений\INSERT новых записей ED Main"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение"
          DTS:To="Package\Система уведомлений\INSERT подача ДТ" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 1]"
          DTS:CreationName=""
          DTS:DTSID="{D9B057CE-9AEF-4F34-BECB-A9497771E1EE}"
          DTS:From="Package\Система уведомлений\INSERT подача ДТ"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 1"
          DTS:To="Package\Система уведомлений\INSERT регистрация ДТ" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 10]"
          DTS:CreationName=""
          DTS:DTSID="{a75d2784-0e99-4555-925d-7f067ddbb683}"
          DTS:From="Package\Система уведомлений\Messages"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 10"
          DTS:To="Package\Система уведомлений\Container_FOR" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 11]"
          DTS:CreationName=""
          DTS:DTSID="{260D94E3-140B-40E1-BF50-8942E41E9BB0}"
          DTS:From="Package\Система уведомлений\Обновление таблицы SEND"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 11"
          DTS:To="Package\Система уведомлений\INSERT новых записей ED TNP" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 12]"
          DTS:CreationName=""
          DTS:DTSID="{F6DD965B-749E-4D77-ADE1-0B626E28BA32}"
          DTS:From="Package\Система уведомлений\UPDATE отправки man"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 12"
          DTS:To="Package\Система уведомлений\Messages" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 13]"
          DTS:CreationName=""
          DTS:DTSID="{0A956585-63AF-41B4-9B7D-82CF3C40554C}"
          DTS:From="Package\Система уведомлений\UPDATE отправки ЭД"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 13"
          DTS:To="Package\Система уведомлений\INSERT прибытие" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 14]"
          DTS:CreationName=""
          DTS:DTSID="{A3655053-47DA-4A87-AA49-D52F1D032CCB}"
          DTS:From="Package\Система уведомлений\INSERT новых записей ED TNP"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 14"
          DTS:To="Package\Система уведомлений\INSERT новых записей ED Main" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 15]"
          DTS:CreationName=""
          DTS:DTSID="{4A91B619-05EA-4C33-8264-190442A1FA82}"
          DTS:From="Package\Система уведомлений\Container_FOR"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 15"
          DTS:To="Package\Система уведомлений\Чеки ВБД" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 16]"
          DTS:CreationName=""
          DTS:DTSID="{5F0FAF61-14DA-4E56-AB9B-BF378A72B74A}"
          DTS:From="Package\Система уведомлений\Container_FOR"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 16"
          DTS:To="Package\Система уведомлений\Пари уведомления бухгалтерам" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 2]"
          DTS:CreationName=""
          DTS:DTSID="{15EA886D-221B-4207-8041-54951089585B}"
          DTS:From="Package\Система уведомлений\INSERT регистрация ДТ"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 2"
          DTS:To="Package\Система уведомлений\INSERT отправка уведомления ПТД" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 3]"
          DTS:CreationName=""
          DTS:DTSID="{73E66FB1-47A7-4D48-8C19-02A4725E1043}"
          DTS:From="Package\Система уведомлений\INSERT отправка уведомления ПТД"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 3"
          DTS:To="Package\Система уведомлений\INSERT досмотр" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 4]"
          DTS:CreationName=""
          DTS:DTSID="{1A1FD65A-1278-4956-B7D1-7A13F76E8374}"
          DTS:From="Package\Система уведомлений\INSERT досмотр"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 4"
          DTS:To="Package\Система уведомлений\INSERT решение по товарам" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 5]"
          DTS:CreationName=""
          DTS:DTSID="{D46D09C7-2D8A-449B-A56A-E0511BCDA17C}"
          DTS:From="Package\Система уведомлений\INSERT решение по товарам"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 5"
          DTS:To="Package\Система уведомлений\UPDATE отправки ЭД" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 6]"
          DTS:CreationName=""
          DTS:DTSID="{3C76A7E1-02D6-4DEE-87C6-16705EA77D6B}"
          DTS:From="Package\Система уведомлений\INSERT прибытие"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 6"
          DTS:To="Package\Система уведомлений\INSERT получение ТСД" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 7]"
          DTS:CreationName=""
          DTS:DTSID="{517C653F-5EAE-4039-8595-531F10B2EE27}"
          DTS:From="Package\Система уведомлений\INSERT получение ТСД"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 7"
          DTS:To="Package\Система уведомлений\INSERT закрытие ТТ" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 8]"
          DTS:CreationName=""
          DTS:DTSID="{ED288CD8-D5E8-4FA9-9928-9ED34153E971}"
          DTS:From="Package\Система уведомлений\INSERT закрытие ТТ"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 8"
          DTS:To="Package\Система уведомлений\INSERT убытие" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Система уведомлений.PrecedenceConstraints[Ограничение 9]"
          DTS:CreationName=""
          DTS:DTSID="{77C40758-3A03-4C24-AA69-A9E78D0EF9D1}"
          DTS:From="Package\Система уведомлений\INSERT убытие"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 9"
          DTS:To="Package\Система уведомлений\UPDATE отправки man" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--В данном разделе CDATA содержатся сведения о макете пакета. В данном разделе содержатся сведения о координатах (x,y), ширине и высоте.-->
<!--В случае возникновения ошибки при редактировании этого раздела вручную его можно удалить. -->
<!--Пакет можно загрузить обычным образом, но прежние сведения о макете будут утеряны, и конструктор автоматически перераспределит элементы в области конструктора.-->
<Objects
  Version="8">
  <!--Все приведенные ниже узлы будут содержать свойства, не влияющие на поведение среды выполнения.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="143,42"
          Id="Package\Система уведомлений\Container_FOR\MessageSent"
          TopLeft="65,117" />
        <NodeLayout
          Size="205,42"
          Id="Package\Система уведомлений\Container_FOR\Задача &quot;Отправка почты&quot;"
          TopLeft="36.5,21.5" />
        <EdgeLayout
          Id="Package\Система уведомлений\Container_FOR.PrecedenceConstraints[Ограничение]"
          TopLeft="137.75,63.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,53.5"
              Start="0,0"
              End="0,46">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,46" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-28.87931640625,17.29296875,57.7586328125,11.4140625"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="247,177"
          Size="247,220"
          Id="Package\Система уведомлений\Container_FOR"
          TopLeft="486.285714285714,375.5" />
        <NodeLayout
          Size="158,42"
          Id="Package\Система уведомлений\INSERT досмотр"
          TopLeft="54.0000000000001,486.642857142857" />
        <NodeLayout
          Size="180,42"
          Id="Package\Система уведомлений\INSERT закрытие ТТ"
          TopLeft="285.585714285714,464.5" />
        <NodeLayout
          Size="233,42"
          Id="Package\Система уведомлений\INSERT новых записей ED Main"
          TopLeft="17.0000000000001,184.928571428571" />
        <NodeLayout
          Size="230,42"
          Id="Package\Система уведомлений\INSERT новых записей ED TNP"
          TopLeft="25.2500000000001,105.25" />
        <NodeLayout
          Size="255,42"
          Id="Package\Система уведомлений\INSERT отправка уведомления ПТД"
          TopLeft="5.5,411.214285714286" />
        <NodeLayout
          Size="170,42"
          Id="Package\Система уведомлений\INSERT подача ДТ"
          TopLeft="48,260.357142857143" />
        <NodeLayout
          Size="194,42"
          Id="Package\Система уведомлений\INSERT получение ТСД"
          TopLeft="278.585714285714,548.5" />
        <NodeLayout
          Size="166,42"
          Id="Package\Система уведомлений\INSERT прибытие"
          TopLeft="292.585714285714,632.5" />
        <NodeLayout
          Size="196,42"
          Id="Package\Система уведомлений\INSERT регистрация ДТ"
          TopLeft="35.0000000000001,335.785714285714" />
        <NodeLayout
          Size="220,42"
          Id="Package\Система уведомлений\INSERT решение по товарам"
          TopLeft="23,562.071428571429" />
        <NodeLayout
          Size="153,42"
          Id="Package\Система уведомлений\INSERT убытие"
          TopLeft="299.085714285714,380.5" />
        <NodeLayout
          Size="126,42"
          Id="Package\Система уведомлений\Messages"
          TopLeft="539.285714285714,294.5" />
        <NodeLayout
          Size="190,42"
          Id="Package\Система уведомлений\UPDATE отправки man"
          TopLeft="284.585714285714,296.5" />
        <NodeLayout
          Size="183,42"
          Id="Package\Система уведомлений\UPDATE отправки ЭД"
          TopLeft="41.5000000000001,637.5" />
        <NodeLayout
          Size="214,42"
          Id="Package\Система уведомлений\Обновление таблицы SEND"
          TopLeft="28.7857142857143,19.25" />
        <NodeLayout
          Size="205,42"
          Id="Package\Система уведомлений\Пари уведомления бухгалтерам\Container_FOR\Задача &quot;Отправка почты&quot;"
          TopLeft="58.5,19.5" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="330,117"
          Size="330,160"
          Id="Package\Система уведомлений\Пари уведомления бухгалтерам\Container_FOR"
          TopLeft="5.50000000000006,209.5" />
        <NodeLayout
          Size="184,42"
          Id="Package\Система уведомлений\Пари уведомления бухгалтерам\INSERT новых заявок"
          TopLeft="78.5,5.5" />
        <NodeLayout
          Size="118,42"
          Id="Package\Система уведомлений\Пари уведомления бухгалтерам\UPDATE"
          TopLeft="105,400" />
        <NodeLayout
          Size="180,42"
          Id="Package\Система уведомлений\Пари уведомления бухгалтерам\Список новых писем"
          TopLeft="80.5,107.5" />
        <EdgeLayout
          Id="Package\Система уведомлений\Пари уведомления бухгалтерам.PrecedenceConstraints[Ограничение]"
          TopLeft="170.5,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений\Пари уведомления бухгалтерам.PrecedenceConstraints[Ограничение 1]"
          TopLeft="170.5,149.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений\Пари уведомления бухгалтерам.PrecedenceConstraints[Ограничение 2]"
          TopLeft="167.25,369.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,30.5"
              Start="0,0"
              End="0,23">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="341,478"
          Size="341,521"
          Id="Package\Система уведомлений\Пари уведомления бухгалтерам"
          TopLeft="6,818" />
        <NodeLayout
          Size="205,42"
          Id="Package\Система уведомлений\Чеки ВБД\Container_FOR\Задача &quot;Отправка почты&quot;"
          TopLeft="18.5,93.5" />
        <NodeLayout
          Size="168,42"
          Id="Package\Система уведомлений\Чеки ВБД\Container_FOR\Конвертация чека"
          TopLeft="39,26" />
        <EdgeLayout
          Id="Package\Система уведомлений\Чеки ВБД\Container_FOR.PrecedenceConstraints[Ограничение]"
          TopLeft="122,68">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25.5"
              Start="0,0"
              End="0,18">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,18" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="360,190"
          Size="360,233"
          Id="Package\Система уведомлений\Чеки ВБД\Container_FOR"
          TopLeft="5.50000000000009,209.5" />
        <NodeLayout
          Size="118,42"
          Id="Package\Система уведомлений\Чеки ВБД\UPDATE"
          TopLeft="126.5,502.5" />
        <NodeLayout
          Size="182,42"
          Id="Package\Система уведомлений\Чеки ВБД\Вставка новых чеков"
          TopLeft="94.5000000000001,5.5" />
        <NodeLayout
          Size="191,42"
          Id="Package\Система уведомлений\Чеки ВБД\Выборка для рассылки"
          TopLeft="90.0000000000001,107.5" />
        <EdgeLayout
          Id="Package\Система уведомлений\Чеки ВБД.PrecedenceConstraints[Ограничение]"
          TopLeft="185.5,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений\Чеки ВБД.PrecedenceConstraints[Ограничение 1]"
          TopLeft="185.5,149.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений\Чеки ВБД.PrecedenceConstraints[Ограничение 2]"
          TopLeft="185.5,442.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="371,599"
          Size="371,642"
          Id="Package\Система уведомлений\Чеки ВБД"
          TopLeft="419,731" />
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение]"
          TopLeft="133.25,226.928571428571">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33.4285714285716"
              Start="0,0"
              End="0,25.9285714285716">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.9285714285716" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 1]"
          TopLeft="133,302.357142857143">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33.428571428571"
              Start="0,0"
              End="0,25.928571428571">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.928571428571" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 10]"
          TopLeft="606.035714285714,336.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,38.9999999999999"
              Start="0,0"
              End="0,31.4999999999999">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.4999999999999" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 11]"
          TopLeft="138.017857142857,61.25">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,44"
              Start="0,0"
              End="0,36.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,36.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 12]"
          TopLeft="474.585714285714,316.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="64.6999999999997,0"
              Start="0,0"
              End="57.1999999999997,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="57.1999999999997,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 13]"
          TopLeft="224.5,656">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="68.0857142857143,0"
              Start="0,0"
              End="60.5857142857143,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="60.5857142857143,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 14]"
          TopLeft="136.875,147.25">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,37.678571428571"
              Start="0,0"
              End="0,30.178571428571">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.178571428571" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 15]"
          TopLeft="649.619047619047,595.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-45.1190476190473,135.5"
              Start="0,0"
              End="-45.1190476190473,128">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.7232502011263" />
                  <mssgle:CubicBezierSegment
                    Point1="0,50.7232502011263"
                    Point2="0,54.7232502011263"
                    Point3="-4,54.7232502011263" />
                  <mssgle:LineSegment
                    End="-41.1190476190473,54.7232502011263" />
                  <mssgle:CubicBezierSegment
                    Point1="-41.1190476190473,54.7232502011263"
                    Point2="-45.1190476190473,54.7232502011263"
                    Point3="-45.1190476190473,58.7232502011263" />
                  <mssgle:LineSegment
                    End="-45.1190476190473,128" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 16]"
          TopLeft="569.952380952381,595.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-393.452380952381,222.5"
              Start="0,0"
              End="-393.452380952381,215">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,85.8592115848753" />
                  <mssgle:CubicBezierSegment
                    Point1="0,85.8592115848753"
                    Point2="0,89.8592115848753"
                    Point3="-4,89.8592115848753" />
                  <mssgle:LineSegment
                    End="-389.452380952381,89.8592115848753" />
                  <mssgle:CubicBezierSegment
                    Point1="-389.452380952381,89.8592115848753"
                    Point2="-393.452380952381,89.8592115848753"
                    Point3="-393.452380952381,93.8592115848753" />
                  <mssgle:LineSegment
                    End="-393.452380952381,215" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 2]"
          TopLeft="133,377.785714285714">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33.4285714285713"
              Start="0,0"
              End="0,25.9285714285713">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.9285714285713" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 3]"
          TopLeft="133,453.214285714286">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33.4285714285713"
              Start="0,0"
              End="0,25.9285714285713">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.9285714285713" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 4]"
          TopLeft="133,528.642857142857">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33.4285714285713"
              Start="0,0"
              End="0,25.9285714285713">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.9285714285713" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 5]"
          TopLeft="133,604.071428571429">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33.4285714285713"
              Start="0,0"
              End="0,25.9285714285713">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.9285714285713" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 6]"
          TopLeft="375.585714285714,632.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-42"
              Start="0,0"
              End="0,-34.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-34.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 7]"
          TopLeft="375.585714285714,548.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-42"
              Start="0,0"
              End="0,-34.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-34.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 8]"
          TopLeft="375.585714285714,464.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-42"
              Start="0,0"
              End="0,-34.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-34.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Система уведомлений.PrecedenceConstraints[Ограничение 9]"
          TopLeft="377.585714285714,380.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-42"
              Start="0,0"
              End="0,-34.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-34.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="818,1428"
          Size="818,1471"
          Id="Package\Система уведомлений"
          TopLeft="80.5,22.75" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>