<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="9/28/2020 2:02:11 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="ETP025"
  DTS:CreatorName="ELTRANSPLUS\andreydruzhinin"
  DTS:DTSID="{CE8F104F-963A-4B30-8177-45A656736B2A}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.71"
  DTS:LocaleID="1049"
  DTS:ObjectName="Package4"
  DTS:PackageType="5"
  DTS:VersionBuild="76"
  DTS:VersionGUID="{FEA62BD3-5B22-4502-A9B1-AD394AFB2B25}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[10.0.0.33.phpuser 1]"
      DTS:CreationName="ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
      DTS:DTSID="{7FB4CEBE-F58C-4E52-9414-9B9D396D7B34}"
      DTS:ObjectName="10.0.0.33.phpuser 1">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=10.0.0.33;User ID=phpuser;Persist Security Info=True;Application Name=SSIS-Package1-{7FB4CEBE-F58C-4E52-9414-9B9D396D7B34}10.0.0.33.phpuser;">
          <DTS:Password
            DTS:Name="Password"
            Sensitive="1"
            Encrypted="1">AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAjGy6skELtUm1I7eSzGaWbwAAAAAIAAAARABUAFMAAAADZgAAwAAAABAAAAAygZr1MvGmbstSwXBjR/xmAAAAAASAAACgAAAAEAAAANT5sb9B1Y9SOLCrLTSaxf4YAAAAWDLtIq3W/F31v/yOil1qPC7rk6kBBaT6FAAAADqEa4wWOMsAPyH3dysg+fgqx5ia</DTS:Password>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[\\10.10.0.28\alta\Robot\Data]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{F7BCE820-98D6-458C-8ECE-BA52159162FD}"
      DTS:ObjectName="\\10.10.0.28\alta\Robot\Data">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=\\10.10.0.28\alta\Robot\DBF_tariff_import;Provider=Microsoft.Jet.OLEDB.4.0;Extended Properties=dbase IV;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[\\10.10.0.28\alta\Robot\MDB_rois\reg_ois.mdb]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{0CF007D9-5A28-4DF5-93A3-36C96F04C312}"
      DTS:ObjectName="\\10.10.0.28\alta\Robot\MDB_rois\reg_ois.mdb">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=\\10.10.0.28\alta\Robot\MDB_rois\reg_ois.mdb;Provider=Microsoft.ACE.OLEDB.12.0;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Currency rates"
      DTS:CreationName="Microsoft.ScriptTask"
      DTS:Description="Script Task"
      DTS:DTSID="{9B523628-BF8B-4400-8283-D56A9455A2F5}"
      DTS:ExecutableType="Microsoft.ScriptTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Currency rates"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ScriptProject
          Name="ST_4a21c772056a4080bdc8ac987227967f"
          VSTAMajorVersion="14"
          VSTAMinorVersion="0"
          Language="CSharp">
          <ProjectItem
            Name="Properties\AssemblyInfo.cs"
            Encoding="UTF8"><![CDATA[using System.Reflection;
using System.Runtime.CompilerServices;

//
// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
//
[assembly: AssemblyTitle("ST_4a21c772056a4080bdc8ac987227967f")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("ST_4a21c772056a4080bdc8ac987227967f")]
[assembly: AssemblyCopyright("Copyright @  2020")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]
//
// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Revision and Build Numbers 
// by using the '*' as shown below:

[assembly: AssemblyVersion("1.0.*")]]]></ProjectItem>
          <ProjectItem
            Name="Properties\Resources.resx"
            Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>]]></ProjectItem>
          <ProjectItem
            Name="ScriptMain.cs"
            Encoding="UTF8"><![CDATA[#region Help:  Introduction to the script task
/* The Script Task allows you to perform virtually any operation that can be accomplished in
 * a .Net application within the context of an Integration Services control flow. 
 * 
 * Expand the other regions which have "Help" prefixes for examples of specific ways to use
 * Integration Services features within this script task. */
#endregion


#region Namespaces
using System;
using System.Data;
using Microsoft.SqlServer.Dts.Runtime;
using System.Windows.Forms;
using System.Xml.Linq;
using System.Data.SqlClient;
using System.Linq;
#endregion

namespace ST_4a21c772056a4080bdc8ac987227967f
{
    /// <summary>
    /// ScriptMain is the entry point class of the script.  Do not change the name, attributes,
    /// or parent of this class.
    /// </summary>
	[Microsoft.SqlServer.Dts.Tasks.ScriptTask.SSISScriptTaskEntryPointAttribute]
	public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
	{
        #region Help:  Using Integration Services variables and parameters in a script
        /* To use a variable in this script, first ensure that the variable has been added to 
         * either the list contained in the ReadOnlyVariables property or the list contained in 
         * the ReadWriteVariables property of this script task, according to whether or not your
         * code needs to write to the variable.  To add the variable, save this script, close this instance of
         * Visual Studio, and update the ReadOnlyVariables and 
         * ReadWriteVariables properties in the Script Transformation Editor window.
         * To use a parameter in this script, follow the same steps. Parameters are always read-only.
         * 
         * Example of reading from a variable:
         *  DateTime startTime = (DateTime) Dts.Variables["System::StartTime"].Value;
         * 
         * Example of writing to a variable:
         *  Dts.Variables["User::myStringVariable"].Value = "new value";
         * 
         * Example of reading from a package parameter:
         *  int batchId = (int) Dts.Variables["$Package::batchId"].Value;
         *  
         * Example of reading from a project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].Value;
         * 
         * Example of reading from a sensitive project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].GetSensitiveValue();
         * */

        #endregion

        #region Help:  Firing Integration Services events from a script
        /* This script task can fire events for logging purposes.
         * 
         * Example of firing an error event:
         *  Dts.Events.FireError(18, "Process Values", "Bad value", "", 0);
         * 
         * Example of firing an information event:
         *  Dts.Events.FireInformation(3, "Process Values", "Processing has started", "", 0, ref fireAgain)
         * 
         * Example of firing a warning event:
         *  Dts.Events.FireWarning(14, "Process Values", "No values received for input", "", 0);
         * */
        #endregion

        #region Help:  Using Integration Services connection managers in a script
        /* Some types of connection managers can be used in this script task.  See the topic 
         * "Working with Connection Managers Programatically" for details.
         * 
         * Example of using an ADO.Net connection manager:
         *  object rawConnection = Dts.Connections["Sales DB"].AcquireConnection(Dts.Transaction);
         *  SqlConnection myADONETConnection = (SqlConnection)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Sales DB"].ReleaseConnection(rawConnection);
         *
         * Example of using a File connection manager
         *  object rawConnection = Dts.Connections["Prices.zip"].AcquireConnection(Dts.Transaction);
         *  string filePath = (string)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Prices.zip"].ReleaseConnection(rawConnection);
         * */
        #endregion


        /// <summary>
        /// This method is called when this script task executes in the control flow.
        /// Before returning from this method, set the value of Dts.TaskResult to indicate success or failure.
        /// To open Help, press F1.
        /// </summary>
        public void Main()
        {
            string ConnectionString = @"Data Source=10.10.0.28;User ID=phpuser;Password=gnQCUElU";
            XDocument doc = XDocument.Load(@"https://www.cbr-xml-daily.ru/daily_utf8.xml");
            DateTime date = DateTime.Parse(doc.Element("ValCurs").Attribute("Date").Value);

            var query = doc.Descendants("Valute").Select(v => new
            {
                Date = date,
                NumCode = v.Element("NumCode").Value,
                CharCode = v.Element("CharCode").Value,
                Nominal = Int32.Parse(v.Element("Nominal").Value),
                Name = v.Element("Name").Value,
                Value = Decimal.Parse(v.Element("Value").Value)
            });

            DataTable toSql = new DataTable();
            DataRow row;
            DataColumn[] dataColumns = new DataColumn[]
            {
                new DataColumn("Date", typeof(DateTime)),
                new DataColumn("NumCode", typeof(string)),
                new DataColumn("CharCode", typeof(string)),
                new DataColumn("Nominal", typeof(int)),
                new DataColumn("Name", typeof(string)),
                new DataColumn("Value", typeof(decimal))
            };
            toSql.Columns.AddRange(dataColumns);

            foreach (var item in query)
            {
                if (ExistsInDatabase(item.Date, item.Name) == false)
                {
                    row = toSql.NewRow();
                    row["Date"] = item.Date;
                    row["NumCode"] = item.NumCode;
                    row["CharCode"] = item.CharCode;
                    row["Nominal"] = item.Nominal;
                    row["Name"] = item.Name;
                    row["Value"] = item.Value;
                    toSql.Rows.Add(row);
                }
            }

            using (SqlConnection SqlConnectionObj = new SqlConnection(ConnectionString))
            {
                SqlConnectionObj.Open();
                SqlBulkCopy bulkCopy = new SqlBulkCopy(SqlConnectionObj, SqlBulkCopyOptions.Default | SqlBulkCopyOptions.FireTriggers | SqlBulkCopyOptions.UseInternalTransaction, null);
                bulkCopy.DestinationTableName = @"automation.dbo.currency_rates";
                bulkCopy.ColumnMappings.Add("Date", "Date");
                bulkCopy.ColumnMappings.Add("NumCode", "NumCode");
                bulkCopy.ColumnMappings.Add("CharCode", "CharCode");
                bulkCopy.ColumnMappings.Add("Nominal", "Nominal");
                bulkCopy.ColumnMappings.Add("Name", "Name");
                bulkCopy.ColumnMappings.Add("Value", "Value");
                bulkCopy.WriteToServer(toSql);
            }

            Dts.TaskResult = (int)ScriptResults.Success;
        }

        public bool ExistsInDatabase(DateTime date, string name)
        {
            string ConnectionString = @"Data Source=10.10.0.28;User ID=phpuser;Password=gnQCUElU";
            string query_contents = @"SELECT TOP (100) * FROM [automation].[dbo].[currency_rates] ORDER BY [Date] DESC";
            DataTable src_contents = new DataTable();

            using (SqlDataAdapter sda = new SqlDataAdapter(query_contents, ConnectionString))
            {
                sda.Fill(src_contents);
            }

            var query = from c in src_contents.AsEnumerable()
                        where c.Field<DateTime>("Date") == date && c.Field<string>("Name") == name
                        select c;

            return query.Any();
        }

        #region ScriptResults declaration
        /// <summary>
        /// This enum provides a convenient shorthand within the scope of this class for setting the
        /// result of the script.
        /// 
        /// This code was generated automatically.
        /// </summary>
        enum ScriptResults
        {
            Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
            Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
        };
        #endregion

	}
}]]></ProjectItem>
          <ProjectItem
            Name="ST_4a21c772056a4080bdc8ac987227967f.csproj"
            Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProjectTypeGuids>{30D016F9-3734-4E33-A861-5E7D899E18F3};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{600FB630-74AB-4215-BD79-F292FB085D2F}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>ST_4a21c772056a4080bdc8ac987227967f</RootNamespace>
    <AssemblyName>ST_4a21c772056a4080bdc8ac987227967f</AssemblyName>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>true</ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>.\bin\Debug\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <DebugSymbols>false</DebugSymbols>
    <Optimize>true</Optimize>
    <OutputPath>.\bin\Release\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="System.Data.Linq" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.SqlServer.ManagedDTS, Version=13.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="Microsoft.SqlServer.ScriptTask, Version=13.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="System.Xml.Linq" />
  </ItemGroup>
  <ItemGroup>
    <AppDesigner Include="Properties\" />
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
    </Compile>
    <Compile Include="ScriptMain.cs">
      <SubType>Code</SubType>
    </Compile>
  </ItemGroup>
  <!-- Include the build rules for a C# project.-->
  <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />
  <ProjectExtensions>
    <VisualStudio>
      <FlavorProperties GUID="{30D016F9-3734-4E33-A861-5E7D899E18F3}">
        <ProjectProperties HostName="VSTAHostName" HostPackage="{B3A685AA-7EAF-4BC6-9940-57959FA5AC07}" ApplicationType="usd" Language="cs" TemplatesPath="" />
        <Host Name="ScriptTask" />
        <ProjectClient>
          <HostIdentifier>SSIS_ST130</HostIdentifier>
        </ProjectClient>
      </FlavorProperties>
    </VisualStudio>
  </ProjectExtensions>
</Project>]]></ProjectItem>
          <ProjectItem
            Name="Project"
            Encoding="UTF16LE"><![CDATA[<?xml version="1.0" encoding="UTF-16" standalone="yes"?>
<c:Project xmlns:c="http://schemas.microsoft.com/codeprojectml/2010/08/main" xmlns:msb="http://schemas.microsoft.com/developer/msbuild/2003" runtimeVersion="3.0" schemaVersion="1.0">
	<msb:PropertyGroup>
		<msb:Language>msBuild</msb:Language>
		<msb:CodeName>ST_4a21c772056a4080bdc8ac987227967f</msb:CodeName>
		<msb:DisplayName>ST_4a21c772056a4080bdc8ac987227967f</msb:DisplayName>
		<msb:ProjectId>{95F969FE-74F7-49A4-8F2D-F10D5398B052}</msb:ProjectId>
	</msb:PropertyGroup>
	<msb:ItemGroup>
		<msb:Project Include="ST_4a21c772056a4080bdc8ac987227967f.csproj"/>
		<msb:File Include="Properties\Settings.settings"/>
		<msb:File Include="Properties\AssemblyInfo.cs"/>
		<msb:File Include="Properties\Resources.resx"/>
		<msb:File Include="Properties\Resources.Designer.cs"/>
		<msb:File Include="Properties\Settings.Designer.cs"/>
		<msb:File Include="ScriptMain.cs"/>
	</msb:ItemGroup>
</c:Project>]]></ProjectItem>
          <ProjectItem
            Name="Properties\Settings.Designer.cs"
            Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_4a21c772056a4080bdc8ac987227967f.Properties.Settings.get_Default():ST_4a21c772056a4080bdc8ac987227967f.Properties.Sett" +
    "ings")]

namespace ST_4a21c772056a4080bdc8ac987227967f.Properties {
    
    
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        private static Settings defaultInstance = new Settings();
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}]]></ProjectItem>
          <ProjectItem
            Name="Properties\Settings.settings"
            Encoding="UTF8"><![CDATA[<?xml version='1.0' encoding='iso-8859-1'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>]]></ProjectItem>
          <ProjectItem
            Name="Properties\Resources.Designer.cs"
            Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_4a21c772056a4080bdc8ac987227967f.Properties.Resources.get_ResourceManager():System.Resources.Resou" +
    "rceManager")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_4a21c772056a4080bdc8ac987227967f.Properties.Resources.get_Culture():System.Globalization.CultureIn" +
    "fo")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_4a21c772056a4080bdc8ac987227967f.Properties.Resources.set_Culture(System.Globalization.CultureInfo" +
    "):Void")]

namespace ST_4a21c772056a4080bdc8ac987227967f.Properties {
    
    
    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if ((resourceMan == null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("ST_4a21c772056a4080bdc8ac987227967f.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}]]></ProjectItem>
          <BinaryItem
            Name="ST_4a21c772056a4080bdc8ac987227967f.dll">TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1v
ZGUuDQ0KJAAAAAAAAABQRQAATAEDAMQZd18AAAAAAAAAAOAAIiALATAAACYAAAAIAAAAAAAA/kMA
AAAgAAAAYAAAAAAAEAAgAAAAAgAABAAAAAAAAAAGAAAAAAAAAACgAAAAAgAAAAAAAAMAYIUAABAA
ABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAKxDAABPAAAAAGAAAHgEAAAAAAAAAAAAAAAAAAAA
AAAAAIAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAIAAACAAAAAAAAAAAAAAACCAAAEgAAAAAAAAAAAAAAC50ZXh0AAAABCQAAAAgAAAAJgAAAAIA
AAAAAAAAAAAAAAAAACAAAGAucnNyYwAAAHgEAAAAYAAAAAYAAAAoAAAAAAAAAAAAAAAAAABAAABA
LnJlbG9jAAAMAAAAAIAAAAACAAAALgAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAADg
QwAAAAAAAEgAAAACAAUAfCcAAHgbAAABAAAAAAAAAPRCAAC4AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4CexIAAAoqHgJ7EwAACioeAnsUAAAKKh4CexUAAAoqHgJ7
FgAACioeAnsXAAAKKtICKBgAAAoCA30SAAAKAgR9EwAACgIFfRQAAAoCDgR9FQAACgIOBX0WAAAK
Ag4GfRcAAAoqAAAAEzADAJ4AAAABAAARA3UBAAAbCgY5jwAAACgZAAAKAnsSAAAKBnsSAAAKbxoA
AAosdygbAAAKAnsTAAAKBnsTAAAKbxwAAAosXygdAAAKAnsUAAAKBnsUAAAKbx4AAAosRygfAAAK
AnsVAAAKBnsVAAAKbyAAAAosLyghAAAKAnsWAAAKBnsWAAAKbyIAAAosFygjAAAKAnsXAAAKBnsX
AAAKbyQAAAoqFioAABMwAwCQAAAAAAAAACAw3hDZIClVVaVaKBkAAAoCexIAAApvJQAAClggKVVV
pVooGwAACgJ7EwAACm8mAAAKWCApVVWlWigdAAAKAnsUAAAKbycAAApYIClVVaVaKB8AAAoCexUA
AApvKAAAClggKVVVpVooIQAACgJ7FgAACm8pAAAKWCApVVWlWigjAAAKAnsXAAAKbyoAAApYKhMw
BwDoAAAAAgAAERRyAQAAcByNDgAAASUWAnsSAAAKChIABowIAAAbLQQmFCsL/hYIAAAbbysAAAqi
JRcCexMAAAoLEgEHjAkAABstBCYUKwv+FgkAABtvKwAACqIlGAJ7FAAACgwSAgiMCgAAGy0EJhQr
C/4WCgAAG28rAAAKoiUZAnsVAAAKDRIDCYwLAAAbLQQmFCsL/hYLAAAbbysAAAqiJRoCexYAAAoT
BBIEEQSMDAAAGy0EJhQrC/4WDAAAG28rAAAKoiUbAnsXAAAKEwUSBREFjA0AABstBCYUKwv+Fg0A
ABtvKwAACqIoLAAACiobMAUAugIAAAMAABFzFQAABgpysgAAcAtyJAEAcCgtAAAKDAYIcnwBAHAo
LgAACm8vAAAKcowBAHAoLgAACm8wAAAKbzEAAAooMgAACn0NAAAECHKWAQBwKC4AAApvMwAACgb+
BhYAAAZzNAAACigBAAArDXM2AAAKEwQcjRoAAAElFnKMAQBw0BYAAAEoNwAACnM4AAAKoiUXcqQB
AHDQJwAAASg3AAAKczgAAAqiJRhytAEAcNAnAAABKDcAAApzOAAACqIlGXLGAQBw0DAAAAEoNwAA
CnM4AAAKoiUactYBAHDQJwAAASg3AAAKczgAAAqiJRty4AEAcNAXAAABKDcAAApzOAAACqITBhEE
bzkAAAoRBm86AAAKCW87AAAKEwc4ugAAABEHbzwAAAoTCAIRCG89AAAKEQhvPgAACigMAAAGOpgA
AAARBG8/AAAKEwURBXKMAQBwEQhvPQAACowWAAABb0AAAAoRBXKkAQBwEQhvQQAACm9AAAAKEQVy
tAEAcBEIb0IAAApvQAAAChEFcsYBAHARCG9DAAAKjDAAAAFvQAAAChEFctYBAHARCG8+AAAKb0AA
AAoRBXLgAQBwEQhvRAAACowXAAABb0AAAAoRBG9FAAAKEQVvRgAAChEHb0cAAAo6Ov///94MEQcs
BxEHb0gAAArcB3NJAAAKEwkRCW9KAAAKEQkfMBRzSwAACiVy7AEAcG9MAAAKJW9NAAAKcowBAHBy
jAEAcG9OAAAKJiVvTQAACnKkAQBwcqQBAHBvTgAACiYlb00AAApytAEAcHK0AQBwb04AAAomJW9N
AAAKcsYBAHByxgEAcG9OAAAKJiVvTQAACnLWAQBwctYBAHBvTgAACiYlb00AAApy4AEAcHLgAQBw
b04AAAomEQRvTwAACt4MEQksBxEJb0gAAArcAihQAAAKFm9RAAAKKgAAARwAAAIAFwHN5AEMAAAA
AAIA+AGpoQIMAAAAABswAwBdAAAABAAAEXMXAAAGCgYDfQ4AAAQGBH0PAAAEcrIAAHALcigCAHBz
NgAACgwHc1IAAAoNCQhvUwAACibeCgksBglvSAAACtwIKFQAAAoG/gYYAAAGc1UAAAooAgAAKygD
AAArKgAAAAEQAAACACwACjYACgAAAAAeAihYAAAKKh4CKBgAAAoqrn4HAAAELR5yywIAcNAEAAAC
KDcAAApvWQAACnNaAAAKgAcAAAR+BwAABCoafggAAAQqHgKACAAABCoafgkAAAQqHgIoWwAACiou
cxMAAAaACQAABCoAABMwBwB/AAAAAAAAAAJ7DQAABANypAEAcCguAAAKby8AAApvXAAACgNytAEA
cCguAAAKby8AAApvXAAACgNyxgEAcCguAAAKby8AAApvXAAACihdAAAKA3LWAQBwKC4AAApvLwAA
Cm9cAAAKA3LgAQBwKC4AAApvLwAACm9cAAAKKF4AAApzXwAACirGA3KMAQBwKAQAACsCew4AAAQo
YQAACiwXA3LWAQBwKAUAACsCew8AAAQoYgAACioWKgAAAEJTSkIBAAEAAAAAAAwAAAB2NC4wLjMw
MzE5AAAAAAUAbAAAAAwJAAAjfgAAeAkAAGAKAAAjU3RyaW5ncwAAAADYEwAAQAMAACNVUwAYFwAA
EAAAACNHVUlEAAAAKBcAAFAEAAAjQmxvYgAAAAAAAAACAAABVx2iCQkPAAAA+gEzABYAAAEAAABB
AAAACAAAAA8AAAAYAAAADAAAAGIAAAACAAAAHQAAAAQAAAADAAAACQAAAAoAAAASAAAAAQAAAAcA
AAABAAAAAwAAAAYAAAAFAAAAAADCBQEAAAAAAAYAIQQJCAYAsAQJCAYAOgP2Bw8AfQgAAAYAggNk
BgYABARkBgYA5QNkBgYAlwRkBgYAQQRkBgYAWgRkBgYAmQNkBgYAtAMCBQYAAgMJCAYAsAn4BQYA
ywL2BwYATgP2BwYAzQP2BwoAdQRdBQoAagJdBQ4ABAr6BgYATQDfAAYAGgL4BQYAhgX4BRIApgHK
ABIAJQrKABIAIAbKAAYAiADfABIAzQblCRIAsgflCQYA/wX4BQ4A+wn6BgYAHQP2BwYAiQcpCAYA
7gZABhYA4gKsBRYAaQOsBRYAhgIrBgYAdQDfAAYANwX4BQYAdQf4BQ4A7QH6Bg4AmQf6Bg4A9wL6
BgYAnAD4BRoAsgEKBwYAIwL4BQYAyQH4BQYAlgD4BRIAmQbKABIArgbKAAYAzwdQCQYAvQH4BRIA
wAbbBhIARQrlCRIAYwnlCRIAVQblCRIAdgblCRIAHAXlCQoAmgVdBRIApAfbBh4A6gjKAB4AWwDK
AB4A/gjKAAYAOApkBh4APgnKAAAAAAC5AAAAAAABAAEAAAEQAKMAAAA5AAEAAQABABAAFQbeBE0A
BwALAAAAEAAwCIwIOQAHAA4AAAEQAM4IjAiVAAkAEgADAQAAhgkAAHkACgAVAAMBEAABAAAAOQAN
ABUAAwEQABYAAAA5AA4AFwAhADcBMwAhAAMBNwAhABUBOwAhAFYBPwAhACgBQwAhAEYBRwARAAQG
9QIRAFoC+gIRAGgB/wIGBsIAAwNWgHYJBgNWgDoCBgMGAMYCCgMGAMYCCgMGABUCDgNQIAAAAACG
CL0CzwEBAFggAAAAAIYIhAHxAQEAYCAAAAAAhgiQAfYBAQBoIAAAAACGCI4F+wEBAHAgAAAAAIYI
8wHhAQEAeCAAAAAAhgjOBAACAQCAIAAAAACGGOkHqQIBALggAAAAAMYA1wgRAwcAZCEAAAAAxgB4
ARYDCAAAIgAAAADGADUFuAAIAPQiAAAAAIYAGwYGAAgA2CUAAAAAhgCeAhoDCABUJgAAAACGGOkH
BgAKAFwmAAAAAIMY6QcGAAoAZCYAAAAAkwiFByEDCgCQJgAAAACTCEICJwMKAJcmAAAAAJMITgIt
AwoAnyYAAAAAlgjKCTQDCwCmJgAAAACGGOkHBgALAK4mAAAAAJEY7wc5AwsAXCYAAAAAhhjpBwYA
CwC8JgAAAACDAEIAPQMLAFwmAAAAAIYY6QcGAAwARycAAAAAgwArAE4DDAAAAAEAwQIAAAIAiAEA
AAMAlAEAAAQAkgUAAAUAEAIAAAYA0gQAAAEA2AQAAAEAxgIAAAIAFQIAAAEA2AQAAAEAIwoAAAEA
+AAJAOkHAQARAOkHBgAZAOkHCgApAOkHEAAxAOkHEAA5AOkHEABBAOkHEABJAOkHEABRAOkHEABZ
AOkHEABhAOkHEABpAOkHBgCBAOkHFQCJAOkHBgCRAOkHBgABAekHBgAhAekHGwAMADcBMwAMAAMB
NwAMABUBOwAMAFYBPwAMACgBQwAMAEYBRwBxAOkHBgAUAMoJZgAUANcIcAAcAMoJZgAcANcIcAAk
AMoJZgAkANcIcAAsAMoJZgAsANcIcAA0AMoJZgA0ANcIcAA8AMoJZgA8ANcIcAAUAHgBoAAcAHgB
oAAkAHgBoAAsAHgBoAA0AHgBoAA8AHgBoABxADUFuAA5AakJywChAPoAEgFJAb4JGAFRAfwJHwH5
AMQEJwFZAc4EuACxALcCMAFRAZQJNgF0AOkHVgFpAbcJXAHBAOkHBgBxAdsBhgHRAOkHjwHBAN4I
lwGJAZ0BnQF8ANsHtQGEAA4KzwGMAL0CzwGMAPMB4QHBAC0K5gHJAO8F6wGMAIQB8QGMAJAB9gGM
AI4F+wGMAM4EAALBAKAJBQKRAf8ACwKZARoKEQKhAa8CBgDhAOkHEACpARAGBgCxAekHFQKxAfwB
EACxAbsIIQLJAf8AJwKxAcEHLwKZAH4JNQLZAdYJAQDpAOkHRQLhAeoFSwLpAbABUQKUAOkHVgH5
ASgCZgJpAUEKhQKZAOkHBgBxATQKkAIJAekHlgIpAekHBgD5AM4EuACBAbcCngK5ALcCowKMAOkH
qQIJAmIBuQKxAFEKxwI5AVEK0wIIACwA6wIIADAA8AIhAGsARAQuAAsAgwMuABMAjAMuABsAqwMu
ACMAtAMuACsA3QMuADMA3QMuADsA3QMuAEMAtAMuAEsA4wMuAFMA3QMuAFsA+gNBAGsARARDAGMA
8AJhAGsARARjAHsA8AKBAGsARASDAIMA8AKhAGsARATBAGsARATgAHMA8ALjAGMA8ALpAIsAqwMA
AXMA8AIDAWMA8AIJAYsAqwMgAXMA8AIhAWMA8AJAAXMA8AJLAKYA1QA7AgIAAQAEAAcABQAJAAAA
wQJUAwAAiAFZAwAAlAFeAwAAkgVjAwAAEAJoAwAA0gRtAwAAiQdyAwAAYgJ4AwAAzgl+AwIAAQAD
AAIAAgAFAAIAAwAHAAIABAAJAAIABQALAAIABgANAAIADwAPAAIAEAARAAEAEQARAAIAEgATACIA
XgB4AIAAiACQAJgAtQC8AL8AwgDFAMgAQgGkAb4B1AFdAgSAAAABAAAAnB06awAAAAAAAN4EAAAE
AAAAAAAAAAAAAADZAtYAAAAAAA0AAAAAAAAAAAAAAOICPgUAAAAABAAAAAAAAAAAAAAA2QL6BgAA
AAAEAAAAAAAAAAAAAADZAsoAAAAAAAQAAAAAAAAAAAAAANkC+AUAAAAABAAAAAAAAAAAAAAA2QIu
AgAAAAAEAAAAAAAAAAAAAADZAiAJAAAAAAAAAAABAAAAOggAAAYAAwAHAAMACAADAAAAAAAEAEcH
AQAAAAQAFgcCAAAABAAnBwMAAAAEAGQHBAAAAAQAOQcFAAAABABVB2sAdQGtAIACrwCAAsEAwgLB
AM8CAAAAAAA8PmNfX0Rpc3BsYXlDbGFzczBfMAA8PmNfX0Rpc3BsYXlDbGFzczFfMAA8RXhpc3Rz
SW5EYXRhYmFzZT5iX18wADxNYWluPmJfXzAASUVudW1lcmFibGVgMQBFbnVtZXJhYmxlUm93Q29s
bGVjdGlvbmAxAEVxdWFsaXR5Q29tcGFyZXJgMQBJRW51bWVyYXRvcmAxAEludDMyAEZ1bmNgMgA8
PmZfX0Fub255bW91c1R5cGUwYDYAPE1vZHVsZT4AdmFsdWVfXwBTeXN0ZW0uRGF0YQBtc2Nvcmxp
YgBTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYwBMb2FkAEFkZAA8TnVtQ29kZT5pX19GaWVsZAA8
Q2hhckNvZGU+aV9fRmllbGQAPE5hbWU+aV9fRmllbGQAPERhdGU+aV9fRmllbGQAPFZhbHVlPmlf
X0ZpZWxkADxOb21pbmFsPmlfX0ZpZWxkAGRlZmF1bHRJbnN0YW5jZQBHZXRIYXNoQ29kZQBnZXRf
TnVtQ29kZQBnZXRfQ2hhckNvZGUAQWRkUmFuZ2UARGF0YVRhYmxlAEFzRW51bWVyYWJsZQBJRGlz
cG9zYWJsZQBSdW50aW1lVHlwZUhhbmRsZQBHZXRUeXBlRnJvbUhhbmRsZQBYTmFtZQBnZXRfTmFt
ZQBzZXRfRGVzdGluYXRpb25UYWJsZU5hbWUAbmFtZQBEYXRlVGltZQBUeXBlAFdoZXJlAFN5c3Rl
bS5Db3JlAEZhaWx1cmUAZ2V0X0N1bHR1cmUAc2V0X0N1bHR1cmUAcmVzb3VyY2VDdWx0dXJlAFZT
VEFSVFNjcmlwdE9iamVjdE1vZGVsQmFzZQBBcHBsaWNhdGlvblNldHRpbmdzQmFzZQBFeGlzdHNJ
bkRhdGFiYXNlAERpc3Bvc2UAUGFyc2UAZ2V0X0RhdGUAZGF0ZQBEZWJ1Z2dlckJyb3dzYWJsZVN0
YXRlAEVkaXRvckJyb3dzYWJsZVN0YXRlAFhBdHRyaWJ1dGUAQ29tcGlsZXJHZW5lcmF0ZWRBdHRy
aWJ1dGUARGVidWdnZXJOb25Vc2VyQ29kZUF0dHJpYnV0ZQBEZWJ1Z2dhYmxlQXR0cmlidXRlAERl
YnVnZ2VyQnJvd3NhYmxlQXR0cmlidXRlAEVkaXRvckJyb3dzYWJsZUF0dHJpYnV0ZQBBc3NlbWJs
eVRpdGxlQXR0cmlidXRlAEFzc2VtYmx5VHJhZGVtYXJrQXR0cmlidXRlAFRhcmdldEZyYW1ld29y
a0F0dHJpYnV0ZQBEZWJ1Z2dlckhpZGRlbkF0dHJpYnV0ZQBBc3NlbWJseUNvbmZpZ3VyYXRpb25B
dHRyaWJ1dGUAQXNzZW1ibHlEZXNjcmlwdGlvbkF0dHJpYnV0ZQBDb21waWxhdGlvblJlbGF4YXRp
b25zQXR0cmlidXRlAEFzc2VtYmx5UHJvZHVjdEF0dHJpYnV0ZQBBc3NlbWJseUNvcHlyaWdodEF0
dHJpYnV0ZQBTU0lTU2NyaXB0VGFza0VudHJ5UG9pbnRBdHRyaWJ1dGUAQXNzZW1ibHlDb21wYW55
QXR0cmlidXRlAFJ1bnRpbWVDb21wYXRpYmlsaXR5QXR0cmlidXRlAGdldF9WYWx1ZQB2YWx1ZQBT
VF80YTIxYzc3MjA1NmE0MDgwYmRjOGFjOTg3MjI3OTY3ZgBTeXN0ZW0uUnVudGltZS5WZXJzaW9u
aW5nAFNxbEJ1bGtDb3B5Q29sdW1uTWFwcGluZwBUb1N0cmluZwBNaWNyb3NvZnQuU3FsU2VydmVy
LlNjcmlwdFRhc2sATWljcm9zb2Z0LlNxbFNlcnZlci5EdHMuVGFza3MuU2NyaXB0VGFzawBEZWNp
bWFsAGdldF9Ob21pbmFsAFNjcmlwdE9iamVjdE1vZGVsAFN5c3RlbS5Db21wb25lbnRNb2RlbABT
VF80YTIxYzc3MjA1NmE0MDgwYmRjOGFjOTg3MjI3OTY3Zi5kbGwARmlsbABzZXRfSXRlbQBTeXN0
ZW0ARW51bQByZXNvdXJjZU1hbgBPcGVuAFNjcmlwdE1haW4ARGF0YUNvbHVtbgBTeXN0ZW0uQ29u
ZmlndXJhdGlvbgBTeXN0ZW0uR2xvYmFsaXphdGlvbgBTcWxUcmFuc2FjdGlvbgBTeXN0ZW0uUmVm
bGVjdGlvbgBTcWxCdWxrQ29weUNvbHVtbk1hcHBpbmdDb2xsZWN0aW9uAERhdGFDb2x1bW5Db2xs
ZWN0aW9uAERhdGFSb3dDb2xsZWN0aW9uAERiQ29ubmVjdGlvbgBTcWxDb25uZWN0aW9uAFN5c3Rl
bS5EYXRhLkNvbW1vbgBDdWx0dXJlSW5mbwBTeXN0ZW0uWG1sLkxpbnEAU3lzdGVtLkxpbnEAPE51
bUNvZGU+al9fVFBhcgA8Q2hhckNvZGU+al9fVFBhcgA8TmFtZT5qX19UUGFyADxEYXRlPmpfX1RQ
YXIAPFZhbHVlPmpfX1RQYXIAPE5vbWluYWw+al9fVFBhcgBJRm9ybWF0UHJvdmlkZXIAZ2V0X1Jl
c291cmNlTWFuYWdlcgBYQ29udGFpbmVyAERiRGF0YUFkYXB0ZXIAU3FsRGF0YUFkYXB0ZXIAV3Jp
dGVUb1NlcnZlcgBJRW51bWVyYXRvcgBHZXRFbnVtZXJhdG9yAC5jdG9yAC5jY3RvcgBTeXN0ZW0u
RGlhZ25vc3RpY3MAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNlcwBTeXN0ZW0uUmVzb3Vy
Y2VzAFNUXzRhMjFjNzcyMDU2YTQwODBiZGM4YWM5ODcyMjc5NjdmLlByb3BlcnRpZXMuUmVzb3Vy
Y2VzLnJlc291cmNlcwBEZWJ1Z2dpbmdNb2RlcwBTVF80YTIxYzc3MjA1NmE0MDgwYmRjOGFjOTg3
MjI3OTY3Zi5Qcm9wZXJ0aWVzAGdldF9Db2x1bW5NYXBwaW5ncwBTZXR0aW5ncwBFcXVhbHMAZ2V0
X0NvbHVtbnMARGF0YVRhYmxlRXh0ZW5zaW9ucwBFbnVtZXJhYmxlUm93Q29sbGVjdGlvbkV4dGVu
c2lvbnMAU3lzdGVtLkRhdGEuRGF0YVNldEV4dGVuc2lvbnMARGF0YVJvd0V4dGVuc2lvbnMAU3lz
dGVtLkNvbGxlY3Rpb25zAFNxbEJ1bGtDb3B5T3B0aW9ucwBTdWNjZXNzAGdldF9EdHMAU2NyaXB0
UmVzdWx0cwBEZXNjZW5kYW50cwBnZXRfUm93cwBGb3JtYXQAT2JqZWN0AFNlbGVjdABvcF9JbXBs
aWNpdABnZXRfRGVmYXVsdABzZXRfVGFza1Jlc3VsdABTeXN0ZW0uRGF0YS5TcWxDbGllbnQAWEVs
ZW1lbnQAWERvY3VtZW50AGdldF9DdXJyZW50AE1vdmVOZXh0AHYARGF0YVJvdwBOZXdSb3cAZ2V0
X0Fzc2VtYmx5AEFueQBTcWxCdWxrQ29weQBvcF9FcXVhbGl0eQAAAAAAgK97AHsAIABEAGEAdABl
ACAAPQAgAHsAMAB9ACwAIABOAHUAbQBDAG8AZABlACAAPQAgAHsAMQB9ACwAIABDAGgAYQByAEMA
bwBkAGUAIAA9ACAAewAyAH0ALAAgAE4AbwBtAGkAbgBhAGwAIAA9ACAAewAzAH0ALAAgAE4AYQBt
AGUAIAA9ACAAewA0AH0ALAAgAFYAYQBsAHUAZQAgAD0AIAB7ADUAfQAgAH0AfQAAcUQAYQB0AGEA
IABTAG8AdQByAGMAZQA9ADEAMAAuADEAMAAuADAALgAyADgAOwBVAHMAZQByACAASQBEAD0AcABo
AHAAdQBzAGUAcgA7AFAAYQBzAHMAdwBvAHIAZAA9AGcAbgBRAEMAVQBFAGwAVQAAV2gAdAB0AHAA
cwA6AC8ALwB3AHcAdwAuAGMAYgByAC0AeABtAGwALQBkAGEAaQBsAHkALgByAHUALwBkAGEAaQBs
AHkAXwB1AHQAZgA4AC4AeABtAGwAAQ9WAGEAbABDAHUAcgBzAAAJRABhAHQAZQAADVYAYQBsAHUA
dABlAAAPTgB1AG0AQwBvAGQAZQAAEUMAaABhAHIAQwBvAGQAZQAAD04AbwBtAGkAbgBhAGwAAAlO
AGEAbQBlAAALVgBhAGwAdQBlAAA7YQB1AHQAbwBtAGEAdABpAG8AbgAuAGQAYgBvAC4AYwB1AHIA
cgBlAG4AYwB5AF8AcgBhAHQAZQBzAACAoVMARQBMAEUAQwBUACAAVABPAFAAIAAoADEAMAAwACkA
IAAqACAARgBSAE8ATQAgAFsAYQB1AHQAbwBtAGEAdABpAG8AbgBdAC4AWwBkAGIAbwBdAC4AWwBj
AHUAcgByAGUAbgBjAHkAXwByAGEAdABlAHMAXQAgAE8AUgBEAEUAUgAgAEIAWQAgAFsARABhAHQA
ZQBdACAARABFAFMAQwAAcVMAVABfADQAYQAyADEAYwA3ADcAMgAwADUANgBhADQAMAA4ADAAYgBk
AGMAOABhAGMAOQA4ADcAMgAyADcAOQA2ADcAZgAuAFAAcgBvAHAAZQByAHQAaQBlAHMALgBSAGUA
cwBvAHUAcgBjAGUAcwAAAAAAq2dfgoO7N0aq1b941pkrvAAEIAEBCAMgAAEFIAEBEREEIAEBDgUg
AQERPQYgAQERgI0QFRIIBhMAEwETAhMDEwQTBQMGEwADBhMBAwYTAgMGEwMDBhMEAwYTBRIHARUS
CAYTABMBEwITAxMEEwUHFRKAmQETAAkAABUSgJkBEwAHIAICEwATAAcVEoCZARMBBxUSgJkBEwIH
FRKAmQETAwcVEoCZARMEBxUSgJkBEwUFIAEIEwAOBwYTABMBEwITAxMEEwUCEwADIAAOAhMBAhMC
AhMDAhMEAhMFCQADDhKAoQ4dHDwHChIcDhJRFRJVARUSCAYRWQ4OCA4RXRJhEmUdEmkVEm0BFRII
BhFZDg4IDhFdFRIIBhFZDg4IDhFdEnEFAAESUQ4GAAESgKUOByABEn0SgKUIIAESgK0SgKUFAAER
WQ4LIAEVElUBEn0SgKUTFRKAsQISfRUSCAYRWQ4OCA4RXQUgAgEcGBgQAgIVElUBHgEVElUBHgAV
EoCxAh4AHgEQCgISfRUSCAYRWQ4OCA4RXQgAARKAuRGAvQcgAgEOEoC5BSAAEoDFBiABAR0SaRAV
ElUBFRIIBhFZDg4IDhFdCCAAFRJtARMAEBUSbQEVEggGEVkODggOEV0EIAATAAwVEggGEVkODggO
EV0EIAATBAQgABJlBSACAQ4cBCAAEwEEIAATAgQgABMDBCAAEwUFIAASgMkFIAEBEmUDIAACCyAD
ARJxEYDdEoDhBSAAEoDlByACEoDpDg4FIAEBEmEFIAASgO0JBwQSIA4SYRJ1BSACAQ4OBSABCBJh
CwABFRKA+QESZRJhCBUSgLECEmUCGRABAhUSgPkBHgAVEoD5AR4AFRKAsQIeAAIECgESZQoQAQEC
FRJVAR4ABSAAEoEBByACAQ4SgQEEAAEIDgUAARFdDg8gBgETABMBEwITAxMEEwUIEAECHgASZQ4E
CgERWQcAAgIRWRFZAwoBDgUAAgIODgi3elxWGTTgiQiJhF3NgIDMkQQAAAAABAEAAAAEBhKAhQQG
EoCJAwYSFAIGCAMGERgDBhFZAgYOBCABAhwDIAAIBiACAhFZDgUAABKAhQUAABKAiQYAAQESgIkE
AAASFAMAAAEQIAEVEggGEVkODggOEV0SfQUgAQISZQQoABMABCgAEwEEKAATAgQoABMDBCgAEwQE
KAATBQUIABKAhQUIABKAiQQIABIUCAEACAAAAAAAHgEAAQBUAhZXcmFwTm9uRXhjZXB0aW9uVGhy
b3dzAQgBAAIAAAAAACgBACNTVF80YTIxYzc3MjA1NmE0MDgwYmRjOGFjOTg3MjI3OTY3ZgAABQEA
AAAAFgEAEUNvcHlyaWdodCBAICAyMDIwAABJAQAaLk5FVEZyYW1ld29yayxWZXJzaW9uPXY0LjUB
AFQOFEZyYW1ld29ya0Rpc3BsYXlOYW1lEi5ORVQgRnJhbWV3b3JrIDQuNQgBAAAAAAAAAAAAALQA
AADOyu++AQAAAJEAAABsU3lzdGVtLlJlc291cmNlcy5SZXNvdXJjZVJlYWRlciwgbXNjb3JsaWIs
IFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1
NjE5MzRlMDg5I1N5c3RlbS5SZXNvdXJjZXMuUnVudGltZVJlc291cmNlU2V0AgAAAAAAAAAAAAAA
UEFEUEFEULQAAADUQwAAAAAAAAAAAADuQwAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4EMAAAAA
AAAAAAAAAABfQ29yRGxsTWFpbgBtc2NvcmVlLmRsbAAAAAAA/yUAIAAQAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAQAAAA
GAAAgAAAAAAAAAAAAAAAAAAAAQABAAAAMAAAgAAAAAAAAAAAAAAAAAAAAQAAAAAASAAAAFhgAAAa
BAAAAAAAAAAAAAAaBDQAAABWAFMAXwBWAEUAUgBTAEkATwBOAF8ASQBOAEYATwAAAAAAvQTv/gAA
AQAAAAEAOmucHQAAAQA6a5wdPwAAAAAAAAAEAAAAAgAAAAAAAAAAAAAAAAAAAEQAAAABAFYAYQBy
AEYAaQBsAGUASQBuAGYAbwAAAAAAJAAEAAAAVAByAGEAbgBzAGwAYQB0AGkAbwBuAAAAAAAAALAE
egMAAAEAUwB0AHIAaQBuAGcARgBpAGwAZQBJAG4AZgBvAAAAVgMAAAEAMAAwADAAMAAwADQAYgAw
AAAAGgABAAEAQwBvAG0AbQBlAG4AdABzAAAAAAAAACIAAQABAEMAbwBtAHAAYQBuAHkATgBhAG0A
ZQAAAAAAAAAAAHAAJAABAEYAaQBsAGUARABlAHMAYwByAGkAcAB0AGkAbwBuAAAAAABTAFQAXwA0
AGEAMgAxAGMANwA3ADIAMAA1ADYAYQA0ADAAOAAwAGIAZABjADgAYQBjADkAOAA3ADIAMgA3ADkA
NgA3AGYAAAA+AA8AAQBGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADEALgAwAC4ANwA1ADgAMAAu
ADIANwA0ADUAMAAAAAAAcAAoAAEASQBuAHQAZQByAG4AYQBsAE4AYQBtAGUAAABTAFQAXwA0AGEA
MgAxAGMANwA3ADIAMAA1ADYAYQA0ADAAOAAwAGIAZABjADgAYQBjADkAOAA3ADIAMgA3ADkANgA3
AGYALgBkAGwAbAAAAEgAEgABAEwAZQBnAGEAbABDAG8AcAB5AHIAaQBnAGgAdAAAAEMAbwBwAHkA
cgBpAGcAaAB0ACAAQAAgACAAMgAwADIAMAAAACoAAQABAEwAZQBnAGEAbABUAHIAYQBkAGUAbQBh
AHIAawBzAAAAAAAAAAAAeAAoAAEATwByAGkAZwBpAG4AYQBsAEYAaQBsAGUAbgBhAG0AZQAAAFMA
VABfADQAYQAyADEAYwA3ADcAMgAwADUANgBhADQAMAA4ADAAYgBkAGMAOABhAGMAOQA4ADcAMgAy
ADcAOQA2ADcAZgAuAGQAbABsAAAAaAAkAAEAUAByAG8AZAB1AGMAdABOAGEAbQBlAAAAAABTAFQA
XwA0AGEAMgAxAGMANwA3ADIAMAA1ADYAYQA0ADAAOAAwAGIAZABjADgAYQBjADkAOAA3ADIAMgA3
ADkANgA3AGYAAABCAA8AAQBQAHIAbwBkAHUAYwB0AFYAZQByAHMAaQBvAG4AAAAxAC4AMAAuADcA
NQA4ADAALgAyADcANAA1ADAAAAAAAEYADwABAEEAcwBzAGUAbQBiAGwAeQAgAFYAZQByAHMAaQBv
AG4AAAAxAC4AMAAuADcANQA4ADAALgAyADcANAA1ADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAMAAAAADQAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</BinaryItem>
        </ScriptProject>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Docs2SQL transformation"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Контейнер последовательности"
      DTS:DTSID="{d8accecb-3ae8-4898-9fed-e1a3c5821937}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Docs2SQL transformation">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Broker contracts"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{566F576B-23B2-4244-82A6-0E44A191E0CA}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Broker contracts"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [automation].[dbo].[broker_contracts];  &#xA;GO&#xA;WITH cte AS (&#xA;SELECT &#xA;[G141], &#xA;CASE&#xA;&#xA;WHEN [G141] IN ('7713085659','7705189397','7705034202')&#xA;THEN &#xA;&#x9;CASE &#xA;&#x9;WHEN COALESCE(sd.[Declarant Code], '') &lt;&gt; '' AND COALESCE(sd.[Executive Code], '') &lt;&gt; '' &#xA;&#x9;THEN 'to_teo'&#xA;&#x9;ELSE 'to' &#xA;&#x9;END&#xA;ELSE '' END AS condition,&#xA;&#xA;t.G442, t.G443, t.ED_ID, h.GD1, h.GD11, h.[DocNum]&#xA;FROM [Docs2SQL].[dbo].[DBRHEAD] AS h&#xA;JOIN [Docs2SQL].[dbo].[DBRTECHD] AS t ON h.DocNum = t.DocNum &#xA;LEFT JOIN [BI].[dwh].[ETP$SQL_Delivery] AS sd ON LEFT(h.EXTRNL, 7) = sd.No_&#xA;WHERE t.G441 = '11002' AND t.G32 = '1' AND t.ED_ID IS NOT NULL AND G141 IS NOT NULL&#xA;),&#xA;&#xA;cte_rownum AS (&#xA;SELECT *, ROW_NUMBER() OVER (&#xA;&#x9;PARTITION BY [G141] + condition&#xA;&#x9;ORDER BY GD1 DESC, GD11 DESC&#xA;) AS rownum&#xA;FROM cte&#xA;)&#xA;&#xA;INSERT [automation].[dbo].[broker_contracts] &#xA;([G141]&#xA;,[condition]&#xA;,[G442]&#xA;,[G443]&#xA;,[ED_ID]&#xA;,[DocNum])&#xA;&#xA;SELECT [G141]&#xA;,[condition]&#xA;,[G442]&#xA;,[G443]&#xA;,[ED_ID]&#xA;,[DocNum]&#xA;FROM cte_rownum&#xA;WHERE rownum = 1" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Contract add"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{6354ECFE-9465-44EA-9CE7-BF850A5AF86D}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Contract add"
          DTS:ThreadHint="2">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE automation.dbo.contract_additions;  &#xA;GO&#xA;WITH cte_contracts AS (&#xA;&#x9;SELECT h.DocNum, h.G141, td.G442, td.G443,&#xA;&#x9;ROW_NUMBER() OVER (PARTITION BY h.G141, td.G442, td.G443 ORDER BY h.GD1 DESC, h.GD11 DESC) AS order_dt_contract &#xA;&#x9;FROM [Docs2SQL].[dbo].[DBRHEAD] h WITH (NOLOCK) &#xA;&#x9;JOIN [Docs2SQL].[dbo].[DBRTECHD_FIXED_CONTRACT] td WITH (NOLOCK)  &#xA;&#x9;ON h.DocNum = td.DocNum AND td.G441 = '03011' AND td.G32 = '1'&#xA;),&#xA;&#xA;cte_final AS (&#xA;SELECT &#xA;&#x9;h.G141, &#xA;&#x9;order_dt_contract, &#xA;&#x9;h.[G442] AS contract_num, &#xA;&#x9;h.G443 AS contract_date, &#xA;&#x9;t.*,&#xA;&#x9;COUNT(0) OVER (PARTITION BY h.G141, h.[G442], h.G443, t.[G442], t.G443) AS repetition&#xA;&#x9;FROM cte_contracts AS h WITH (NOLOCK)&#xA;&#x9;JOIN Docs2SQL.[dbo].[DBRTECHD] AS t WITH (NOLOCK)&#xA;&#x9;ON h.DocNum = t.DocNum AND t.G441 = '03012' AND t.G32 = '1'&#xA;&#x9;WHERE t.G444 NOT LIKE '%СПЕЦИФ%'&#xA;)&#xA;INSERT [automation].[dbo].contract_additions&#xA;([G141]&#xA;      ,[order_dt_contract]&#xA;      ,[contract_num]&#xA;      ,[contract_date]&#xA;      ,[G071]&#xA;      ,[G072]&#xA;      ,[G073]&#xA;      ,[G32]&#xA;      ,[G4401]&#xA;      ,[G4402]&#xA;      ,[G4403]&#xA;      ,[G44020]&#xA;      ,[G44_CUST]&#xA;      ,[G440]&#xA;      ,[G441]&#xA;      ,[G441A]&#xA;      ,[ID_BDRD]&#xA;      ,[PRSBDRD]&#xA;      ,[PREVNUMTYP]&#xA;      ,[PREVNUMDOC]&#xA;      ,[RECORDID]&#xA;      ,[EXECUTBODY]&#xA;      ,[EXECNAME]&#xA;      ,[INETURL]&#xA;      ,[G442]&#xA;      ,[G442LIC1]&#xA;      ,[G442LIC2]&#xA;      ,[G442R]&#xA;      ,[G442SIMP]&#xA;      ,[G44MDP1]&#xA;      ,[G44MDP2]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[G445]&#xA;      ,[G446]&#xA;      ,[G447]&#xA;      ,[G4480ET]&#xA;      ,[G4481ET]&#xA;      ,[G44STPER]&#xA;      ,[G44SFCNTRY]&#xA;      ,[G44ALLDOC]&#xA;      ,[G4491]&#xA;      ,[G4492]&#xA;      ,[G4493]&#xA;      ,[G44DD]&#xA;      ,[NZP]&#xA;      ,[DMODIFY]&#xA;      ,[TMODIFY]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]&#xA;      ,[repetition])&#xA;&#xA;SELECT [G141]&#xA;      ,[order_dt_contract]&#xA;      ,[contract_num]&#xA;      ,[contract_date]&#xA;      ,[G071]&#xA;      ,[G072]&#xA;      ,[G073]&#xA;      ,[G32]&#xA;      ,[G4401]&#xA;      ,[G4402]&#xA;      ,[G4403]&#xA;      ,[G44020]&#xA;      ,[G44_CUST]&#xA;      ,[G440]&#xA;      ,[G441]&#xA;      ,[G441A]&#xA;      ,[ID_BDRD]&#xA;      ,[PRSBDRD]&#xA;      ,[PREVNUMTYP]&#xA;      ,[PREVNUMDOC]&#xA;      ,[RECORDID]&#xA;      ,[EXECUTBODY]&#xA;      ,[EXECNAME]&#xA;      ,[INETURL]&#xA;      ,[G442]&#xA;      ,[G442LIC1]&#xA;      ,[G442LIC2]&#xA;      ,[G442R]&#xA;      ,[G442SIMP]&#xA;      ,[G44MDP1]&#xA;      ,[G44MDP2]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[G445]&#xA;      ,[G446]&#xA;      ,[G447]&#xA;      ,[G4480ET]&#xA;      ,[G4481ET]&#xA;      ,[G44STPER]&#xA;      ,[G44SFCNTRY]&#xA;      ,[G44ALLDOC]&#xA;      ,[G4491]&#xA;      ,[G4492]&#xA;      ,[G4493]&#xA;      ,[G44DD]&#xA;      ,[NZP]&#xA;      ,[DMODIFY]&#xA;      ,[TMODIFY]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]&#xA;      ,[repetition] &#xA;&#xA;FROM cte_final&#xA;WHERE order_dt_contract = 1 AND repetition &gt; 1" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Declarants"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{64D3837A-6F40-450E-8F72-DFC94089F335}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Declarants"
          DTS:ThreadHint="3">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [automation].[dbo].[declarants]&#xA;GO&#xA;INSERT [automation].[dbo].[declarants] ([bitrix_id], &#xA;&#x9;&#x9;[G5441]&#xA;      ,[G5441NM]&#xA;      ,[G5441MDNM]&#xA;      ,[G5442]&#xA;      ,[G5443]&#xA;      ,[G5444]&#xA;      ,[G5445]&#xA;      ,[G5446]&#xA;      ,[G5447]&#xA;      ,[G5451]&#xA;      ,[G5451A]&#xA;      ,[G54521]&#xA;      ,[G54522]&#xA;      ,[G54523]&#xA;      ,[G5453]&#xA;&#x9;  ,[ed_passport]&#xA;      ,[ed_dov])&#xA;SELECT [bitrix_id], &#xA;&#x9;&#x9;[G5441]&#xA;      ,[G5441NM]&#xA;      ,[G5441MDNM]&#xA;      ,[G5442]&#xA;      ,[G5443]&#xA;      ,[G5444]&#xA;      ,[G5445]&#xA;      ,[G5446]&#xA;      ,[G5447]&#xA;      ,[G5451]&#xA;      ,[G5451A]&#xA;      ,[G54521]&#xA;      ,[G54522]&#xA;      ,[G54523]&#xA;      ,[G5453]&#xA;&#x9;  ,passport_id&#xA;&#x9;  ,dov_id&#xA;  FROM [motivation].[dbo].[bitrix_users] AS b&#xA;  CROSS APPLY (&#xA;&#x9;SELECT TOP 1 &#xA;      [G5441]&#xA;      ,[G5441NM]&#xA;      ,[G5441MDNM]&#xA;      ,[G5442]&#xA;      ,[G5443]&#xA;      ,[G5444]&#xA;      ,[G5445]&#xA;      ,[G5446]&#xA;      ,[G5447]&#xA;      ,[G5451]&#xA;      ,[G5451A]&#xA;      ,[G54521]&#xA;      ,[G54522]&#xA;      ,[G54523]&#xA;      ,[G5453]&#xA;&#x9;  ,td1.ED_ID AS passport_id&#xA;&#x9;  ,td2.ED_ID AS dov_id&#xA;&#x9;FROM Docs2SQL.dbo.DBRHEAD AS h&#xA;&#x9;JOIN Docs2SQL.dbo.DBRTECHD AS td1 ON td1.DocNum = h.DocNum AND td1.G441 = '11001'&#xA;&#x9;JOIN Docs2SQL.dbo.DBRTECHD AS td2 ON td2.DocNum = h.DocNum AND td2.G441 = '11004'&#xA;&#x9;WHERE &#xA;&#x9;UPPER(REPLACE(b.name, ' ', '')) = h.[G5441] + h.[G5441NM] + h.[G5441MDNM]&#xA;&#x9;AND h.GD1 &gt;= DATEADD(MONTH, -1, GETDATE())&#xA;&#x9;AND td1.ED_ID IS NOT NULL&#xA;&#x9;AND td2.ED_ID IS NOT NULL&#xA;&#x9;ORDER BY h.GD1 DESC, h.GD11 DESC&#xA;  ) AS ca&#xA;&#xA;  WHERE b.active = 'Y'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Descriptions"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{5335C06B-A6CD-4D2B-96CC-277E504DB72C}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Descriptions"
          DTS:ThreadHint="4">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [automation].[dbo].[description_files]&#xA;GO&#xA;WITH cte_dirs AS (&#xA;&#x9;SELECT &#xA;&#x9;GID AS dir_gid &#x9;&#xA;&#x9;,CASE &#xA;&#x9;WHEN ISNUMERIC(LEFT(DOCKEY, 12)) = 1 THEN LEFT(DOCKEY, 12)&#xA;&#x9;WHEN ISNUMERIC(LEFT(DOCKEY, 10)) = 1 THEN LEFT(DOCKEY, 10)&#xA;&#x9;END AS VAT&#xA;&#x9;FROM gtd.dbo.docs WHERE PATHGID = 'EADB1B07-5383-4104-BB7A-BA6ED6A199FE'&#xA;),&#xA;&#xA;cte_files AS (&#xA;&#x9;SELECT&#xA;&#x9;&#x9;c.vat&#xA;&#x9;&#x9;,d.COMMENT&#xA;&#x9;&#x9;,d.PATHGID&#xA;&#x9;&#x9;,d.GID&#xA;&#x9;&#x9;,'*{' + CAST(d.PATHGID AS varchar(100)) + '}\{' + CAST(d.GID AS varchar(100)) + '}.FRB' AS ED_ID&#xA;&#x9;FROM cte_dirs AS c&#xA;&#x9;JOIN gtd.dbo.docs AS d ON c.dir_gid = d.PATHGID&#xA;&#x9;WHERE d.DOCTYP = 'FreeBinaryDoc'&#xA;)&#xA;&#xA;INSERT [automation].[dbo].[description_files] &#xA;&#x9;([vat]&#xA;      ,[COMMENT]&#xA;      ,[PATHGID]&#xA;      ,[GID]&#xA;      ,[ED_ID])&#xA;SELECT [vat]&#xA;      ,[COMMENT]&#xA;      ,[PATHGID]&#xA;      ,[GID]&#xA;      ,[ED_ID] &#xA;FROM cte_files&#xA;GO&#xA;UPDATE gtd.dbo.Docs&#xA;SET MODDATE = GETDATE()&#xA;WHERE GID IN (SELECT GID FROM [automation].[dbo].[description_files])" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Extended docs"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{AF5AD39B-8719-4D99-B1A1-2FF24F8B9DE9}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Extended docs"
          DTS:ThreadHint="6">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE automation.dbo.contract_ext_docs;  &#xA;GO&#xA;WITH cte_contracts AS (&#xA;&#x9;SELECT h.DocNum, h.G141, td.G442, td.G443,&#xA;&#x9;ROW_NUMBER() OVER (PARTITION BY h.G141, td.G442, td.G443 ORDER BY h.GD1 DESC, h.GD11 DESC) AS order_dt_contract &#xA;&#x9;FROM [Docs2SQL].[dbo].[DBRHEAD] h WITH (NOLOCK) &#xA;&#x9;JOIN [Docs2SQL].[dbo].[DBRTECHD_FIXED_CONTRACT] td WITH (NOLOCK)  &#xA;&#x9;ON h.DocNum = td.DocNum AND td.G441 = '03011' AND td.G32 = '1'&#xA;),&#xA;&#xA;cte_final AS (&#xA;SELECT &#xA;&#x9;h.G141, &#xA;&#x9;order_dt_contract, &#xA;&#x9;h.[G442] AS contract_num, &#xA;&#x9;h.G443 AS contract_date, &#xA;&#x9;t.*&#xA;&#x9;FROM cte_contracts AS h WITH (NOLOCK)&#xA;&#x9;JOIN Docs2SQL.[dbo].[DBRTECHD] AS t WITH (NOLOCK)&#xA;&#x9;ON h.DocNum = t.DocNum AND t.G441 = '09023'&#xA;&#x9;WHERE t.G442R IS NOT NULL&#xA;),&#xA;&#xA;cte_distinct AS (&#xA;&#x9; SELECT DISTINCT &#xA;&#x9;   [G141]&#x9; &#xA;      ,[order_dt_contract]&#xA;      ,[contract_num]&#xA;      ,[contract_date]&#xA;      ,[G071]&#xA;      ,[G072]&#xA;      ,[G073]&#xA;      ,0 AS [G32]&#xA;      ,[G4401]&#xA;      ,[G4402]&#xA;      ,[G4403]&#xA;      ,[G44020]&#xA;      ,[G44_CUST]&#xA;      ,[G440]&#xA;      ,[G441]&#xA;      ,[G441A]&#xA;      ,[ID_BDRD]&#xA;      ,[PRSBDRD]&#xA;      ,[PREVNUMTYP]&#xA;      ,[PREVNUMDOC]&#xA;      ,[RECORDID]&#xA;      ,[EXECUTBODY]&#xA;      ,[EXECNAME]&#xA;      ,[INETURL]&#xA;      ,[G442]&#xA;      ,[G442LIC1]&#xA;      ,[G442LIC2]&#xA;      ,[G442R]&#xA;      ,[G442SIMP]&#xA;      ,[G44MDP1]&#xA;      ,[G44MDP2]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[G445]&#xA;      ,[G446]&#xA;      ,[G447]&#xA;      ,[G4480ET]&#xA;      ,[G4481ET]&#xA;      ,[G44STPER]&#xA;      ,[G44SFCNTRY]&#xA;      ,[G44ALLDOC]&#xA;      ,[G4491]&#xA;      ,[G4492]&#xA;      ,[G4493]&#xA;      ,[G44DD]&#xA;      ,[NZP]&#xA;      ,[DMODIFY]&#xA;      ,[TMODIFY]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]   &#xA;&#xA;&#x9;FROM cte_final&#xA;&#x9;WHERE order_dt_contract = 1&#xA;)&#xA;INSERT [automation].[dbo].contract_ext_docs&#xA;([G141]&#xA;      ,[order_dt_contract]&#xA;      ,[contract_num]&#xA;      ,[contract_date]&#xA;      ,[G071]&#xA;      ,[G072]&#xA;      ,[G073]&#xA;      ,[G32]&#xA;      ,[G4401]&#xA;      ,[G4402]&#xA;      ,[G4403]&#xA;      ,[G44020]&#xA;      ,[G44_CUST]&#xA;      ,[G440]&#xA;      ,[G441]&#xA;      ,[G441A]&#xA;      ,[ID_BDRD]&#xA;      ,[PRSBDRD]&#xA;      ,[PREVNUMTYP]&#xA;      ,[PREVNUMDOC]&#xA;      ,[RECORDID]&#xA;      ,[EXECUTBODY]&#xA;      ,[EXECNAME]&#xA;      ,[INETURL]&#xA;      ,[G442]&#xA;      ,[G442LIC1]&#xA;      ,[G442LIC2]&#xA;      ,[G442R]&#xA;      ,[G442SIMP]&#xA;      ,[G44MDP1]&#xA;      ,[G44MDP2]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[G445]&#xA;      ,[G446]&#xA;      ,[G447]&#xA;      ,[G4480ET]&#xA;      ,[G4481ET]&#xA;      ,[G44STPER]&#xA;      ,[G44SFCNTRY]&#xA;      ,[G44ALLDOC]&#xA;      ,[G4491]&#xA;      ,[G4492]&#xA;      ,[G4493]&#xA;      ,[G44DD]&#xA;      ,[NZP]&#xA;      ,[DMODIFY]&#xA;      ,[TMODIFY]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]&#xA;      ,[GID])&#xA;&#xA;SELECT  &#xA;&#x9;   [G141]&#x9; &#xA;      ,[order_dt_contract]&#xA;      ,[contract_num]&#xA;      ,[contract_date]&#xA;      ,[G071]&#xA;      ,[G072]&#xA;      ,[G073]&#xA;      ,[G32]&#xA;      ,[G4401]&#xA;      ,[G4402]&#xA;      ,[G4403]&#xA;      ,[G44020]&#xA;      ,[G44_CUST]&#xA;      ,[G440]&#xA;      ,[G441]&#xA;      ,[G441A]&#xA;      ,[ID_BDRD]&#xA;      ,[PRSBDRD]&#xA;      ,[PREVNUMTYP]&#xA;      ,[PREVNUMDOC]&#xA;      ,[RECORDID]&#xA;      ,[EXECUTBODY]&#xA;      ,[EXECNAME]&#xA;      ,[INETURL]&#xA;      ,[G442]&#xA;      ,[G442LIC1]&#xA;      ,[G442LIC2]&#xA;      ,[G442R]&#xA;      ,[G442SIMP]&#xA;      ,[G44MDP1]&#xA;      ,[G44MDP2]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[G445]&#xA;      ,[G446]&#xA;      ,[G447]&#xA;      ,[G4480ET]&#xA;      ,[G4481ET]&#xA;      ,[G44STPER]&#xA;      ,[G44SFCNTRY]&#xA;      ,[G44ALLDOC]&#xA;      ,[G4491]&#xA;      ,[G4492]&#xA;      ,[G4493]&#xA;      ,[G44DD]&#xA;      ,[NZP]&#xA;      ,[DMODIFY]&#xA;      ,[TMODIFY]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]&#xA;      ,CASE &#xA;&#x9;&#x9;WHEN CHARINDEX('}\{', ED_ID) &lt;&gt; 0 THEN SUBSTRING(ED_ID, CHARINDEX('}\{', ED_ID) + 3, 36) &#xA;&#x9;&#x9;WHEN CHARINDEX('ARCHDOCID=', ED_ID) &lt;&gt; 0 THEN &#xA;&#x9;&#x9;(SELECT TOP (1) GID FROM gtd.dbo.Docs AS d WHERE d.ARCHDOCID = SUBSTRING(ED_ID, CHARINDEX('ARCHDOCID=', ED_ID) + 11, 36))&#xA;&#x9;&#x9;END AS GID &#xA;&#xA;FROM cte_distinct&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Load DBF"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Задача потока данных"
          DTS:DTSID="{d5075749-05d4-445d-95ab-88de69f43197}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Load DBF"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Docs2SQL transformation\Load DBF\DBF"
                  componentClassID="Microsoft.OLEDBSource"
                  contactInfo="Источник &quot;OLE DB&quot;;Корпорация Майкрософт. Microsoft SQL Server. (C) Корпорация Майкрософт (Microsoft Corporation). Все права защищены. http://www.microsoft.com/sql/support;7"
                  description="Источник &quot;OLE DB&quot;"
                  name="DBF"
                  usesDispositions="true"
                  version="7">
                  <properties>
                    <property
                      dataType="System.Int32"
                      description="Время ожидания команды, в секундах. Величина 0 означает неограниченное время ожидания."
                      name="CommandTimeout">0</property>
                    <property
                      dataType="System.String"
                      description="Указывает имя объекта базы данных, используемого для открытия набора строк."
                      name="OpenRowset">ST_IMP</property>
                    <property
                      dataType="System.String"
                      description="Указывает переменную, содержащую имя объекта базы данных, используемого для открытия набора строк."
                      name="OpenRowsetVariable"></property>
                    <property
                      dataType="System.String"
                      description="Команда SQL для выполнения."
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                    <property
                      dataType="System.String"
                      description="Переменная, содержащая команду SQL для выполнения."
                      name="SqlCommandVariable"></property>
                    <property
                      dataType="System.Int32"
                      description="Указывает кодовую страницу столбца, используемую, когда недоступны сведения о кодовой странице из источника данных."
                      name="DefaultCodePage">1251</property>
                    <property
                      dataType="System.Boolean"
                      description="Вызывает безусловное использование значение свойства DefaultCodePage при описании символьных данных."
                      name="AlwaysUseDefaultCodePage">false</property>
                    <property
                      dataType="System.Int32"
                      description="Указывает используемый режим доступа к базе данных."
                      name="AccessMode"
                      typeConverter="AccessMode">0</property>
                    <property
                      dataType="System.String"
                      description="Сопоставления между параметрами в команде SQL и переменными."
                      name="ParameterMapping"></property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Docs2SQL transformation\Load DBF\DBF.Connections[OleDbConnection]"
                      connectionManagerID="Package.ConnectionManagers[\\10.10.0.28\alta\Robot\Data]"
                      connectionManagerRefId="Package.ConnectionManagers[\\10.10.0.28\alta\Robot\Data]"
                      description="Соединение OLE DB среды выполнения, используемое для доступа к базе данных."
                      name="OleDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;]"
                      name="Выход источника &quot;OLE DB&quot;">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[MINCODE]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[MINCODE]"
                          length="10"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[MINCODE]"
                          name="MINCODE"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[MAXCODE]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[MAXCODE]"
                          length="10"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[MAXCODE]"
                          name="MAXCODE"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[CODE]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[CODE]"
                          length="22"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[CODE]"
                          name="CODE"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[NAME]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[NAME]"
                          length="80"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[NAME]"
                          name="NAME"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[STAVKA2]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[STAVKA2]"
                          length="20"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[STAVKA2]"
                          name="STAVKA2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[STAVKA3]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[STAVKA3]"
                          length="5"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[STAVKA3]"
                          name="STAVKA3"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[STAVKA4]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[STAVKA4]"
                          length="20"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[STAVKA4]"
                          name="STAVKA4"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[PRIM]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[PRIM]"
                          length="1"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[PRIM]"
                          name="PRIM"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[BASE]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[BASE]"
                          length="1"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[BASE]"
                          name="BASE"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[PREF]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[PREF]"
                          length="1"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[PREF]"
                          name="PREF"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[ORDER]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[ORDER]"
                          length="8"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[ORDER]"
                          name="ORDER"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[ORDER2]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[ORDER2]"
                          length="18"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[ORDER2]"
                          name="ORDER2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[_DATE1]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[_DATE1]"
                          length="8"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[_DATE1]"
                          name="_DATE1"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[_DATE2]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[_DATE2]"
                          length="8"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[_DATE2]"
                          name="_DATE2"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[NEWCODE]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[NEWCODE]"
                          length="10"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[NEWCODE]"
                          name="NEWCODE"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[REF]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[REF]"
                          length="1"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[REF]"
                          name="REF"
                          truncationRowDisposition="FailComponent" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[CONDITION]"
                          dataType="wstr"
                          errorOrTruncationOperation="Преобразование"
                          errorRowDisposition="FailComponent"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[CONDITION]"
                          length="31"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[CONDITION]"
                          name="CONDITION"
                          truncationRowDisposition="FailComponent" />
                      </outputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[MINCODE]"
                          dataType="wstr"
                          length="10"
                          name="MINCODE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[MAXCODE]"
                          dataType="wstr"
                          length="10"
                          name="MAXCODE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[CODE]"
                          dataType="wstr"
                          length="22"
                          name="CODE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[NAME]"
                          dataType="wstr"
                          length="80"
                          name="NAME" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[STAVKA2]"
                          dataType="wstr"
                          length="20"
                          name="STAVKA2" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[STAVKA3]"
                          dataType="wstr"
                          length="5"
                          name="STAVKA3" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[STAVKA4]"
                          dataType="wstr"
                          length="20"
                          name="STAVKA4" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[PRIM]"
                          dataType="wstr"
                          length="1"
                          name="PRIM" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[BASE]"
                          dataType="wstr"
                          length="1"
                          name="BASE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[PREF]"
                          dataType="wstr"
                          length="1"
                          name="PREF" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[ORDER]"
                          dataType="wstr"
                          length="8"
                          name="ORDER" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[ORDER2]"
                          dataType="wstr"
                          length="18"
                          name="ORDER2" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[_DATE1]"
                          dataType="wstr"
                          length="8"
                          name="_DATE1" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[_DATE2]"
                          dataType="wstr"
                          length="8"
                          name="_DATE2" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[NEWCODE]"
                          dataType="wstr"
                          length="10"
                          name="NEWCODE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[REF]"
                          dataType="wstr"
                          length="1"
                          name="REF" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].ExternalColumns[CONDITION]"
                          dataType="wstr"
                          length="31"
                          name="CONDITION" />
                      </externalMetadataColumns>
                    </output>
                    <output
                      refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;]"
                      isErrorOut="true"
                      name="Вывод ошибок источника &quot;OLE DB&quot;">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[MINCODE]"
                          dataType="wstr"
                          length="10"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[MINCODE]"
                          name="MINCODE" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[MAXCODE]"
                          dataType="wstr"
                          length="10"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[MAXCODE]"
                          name="MAXCODE" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[CODE]"
                          dataType="wstr"
                          length="22"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[CODE]"
                          name="CODE" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[NAME]"
                          dataType="wstr"
                          length="80"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[NAME]"
                          name="NAME" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[STAVKA2]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[STAVKA2]"
                          name="STAVKA2" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[STAVKA3]"
                          dataType="wstr"
                          length="5"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[STAVKA3]"
                          name="STAVKA3" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[STAVKA4]"
                          dataType="wstr"
                          length="20"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[STAVKA4]"
                          name="STAVKA4" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[PRIM]"
                          dataType="wstr"
                          length="1"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[PRIM]"
                          name="PRIM" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[BASE]"
                          dataType="wstr"
                          length="1"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[BASE]"
                          name="BASE" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[PREF]"
                          dataType="wstr"
                          length="1"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[PREF]"
                          name="PREF" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[ORDER]"
                          dataType="wstr"
                          length="8"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[ORDER]"
                          name="ORDER" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[ORDER2]"
                          dataType="wstr"
                          length="18"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[ORDER2]"
                          name="ORDER2" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[_DATE1]"
                          dataType="wstr"
                          length="8"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[_DATE1]"
                          name="_DATE1" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[_DATE2]"
                          dataType="wstr"
                          length="8"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[_DATE2]"
                          name="_DATE2" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[NEWCODE]"
                          dataType="wstr"
                          length="10"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[NEWCODE]"
                          name="NEWCODE" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[REF]"
                          dataType="wstr"
                          length="1"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[REF]"
                          name="REF" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[CONDITION]"
                          dataType="wstr"
                          length="31"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[CONDITION]"
                          name="CONDITION" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Вывод ошибок источника &quot;OLE DB&quot;].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Docs2SQL transformation\Load DBF\SQL"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;2"
                  description="Loads data into an ADO.NET-compliant database that uses a database table or view. Load data into a new or existing table. For example, use an ADO.NET provider for ODBC to load data into an ODBC destination."
                  name="SQL"
                  usesDispositions="true"
                  version="2">
                  <properties>
                    <property
                      dataType="System.String"
                      description="The Destination database table name."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">"dbo"."import_tariff_raw"</property>
                    <property
                      dataType="System.Int32"
                      description="Specify the number of rows per batch. The default is 0 which uses the same size as SSIS internal buffer. "
                      expressionType="Notify"
                      name="BatchSize">0</property>
                    <property
                      dataType="System.Int32"
                      description="The number of seconds before a command times out. A value of 0 indicates infinite time-out. "
                      expressionType="Notify"
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Specifies whether to use the SqlBulkCopy interface to improve the performance of bulk insert operations. Only certain providers support this interface."
                      expressionType="Notify"
                      name="UseBulkInsertWhenPossible">true</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.ADONETDestination</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Docs2SQL transformation\Load DBF\SQL.Connections[IDbConnection]"
                      connectionManagerID="{76382CC5-2C1A-4767-958A-4AFC8DEA4336}:external"
                      connectionManagerRefId="Project.ConnectionManagers[10.10.0.28.automation.phpuser]"
                      description="Managed connection manager"
                      name="IDbConnection" />
                  </connections>
                  <inputs>
                    <input
                      refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input]"
                      errorRowDisposition="FailComponent"
                      hasSideEffects="true"
                      name="ADO NET Destination Input">
                      <inputColumns>
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[MINCODE]"
                          cachedDataType="wstr"
                          cachedLength="10"
                          cachedName="MINCODE"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[MINCODE]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[MINCODE]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[MAXCODE]"
                          cachedDataType="wstr"
                          cachedLength="10"
                          cachedName="MAXCODE"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[MAXCODE]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[MAXCODE]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[CODE]"
                          cachedDataType="wstr"
                          cachedLength="22"
                          cachedName="CODE"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[CODE]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[CODE]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[NAME]"
                          cachedDataType="wstr"
                          cachedLength="80"
                          cachedName="NAME"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[NAME]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[NAME]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[STAVKA2]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="STAVKA2"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[STAVKA2]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[STAVKA2]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[STAVKA3]"
                          cachedDataType="wstr"
                          cachedLength="5"
                          cachedName="STAVKA3"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[STAVKA3]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[STAVKA3]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[STAVKA4]"
                          cachedDataType="wstr"
                          cachedLength="20"
                          cachedName="STAVKA4"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[STAVKA4]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[STAVKA4]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[PRIM]"
                          cachedDataType="wstr"
                          cachedLength="1"
                          cachedName="PRIM"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[PRIM]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[PRIM]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[BASE]"
                          cachedDataType="wstr"
                          cachedLength="1"
                          cachedName="BASE"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[BASE]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[BASE]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[PREF]"
                          cachedDataType="wstr"
                          cachedLength="1"
                          cachedName="PREF"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[PREF]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[PREF]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[ORDER]"
                          cachedDataType="wstr"
                          cachedLength="8"
                          cachedName="ORDER"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[ORDER]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[ORDER]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[ORDER2]"
                          cachedDataType="wstr"
                          cachedLength="18"
                          cachedName="ORDER2"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[ORDER2]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[ORDER2]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[_DATE1]"
                          cachedDataType="wstr"
                          cachedLength="8"
                          cachedName="_DATE1"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[_DATE1]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[_DATE1]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[_DATE2]"
                          cachedDataType="wstr"
                          cachedLength="8"
                          cachedName="_DATE2"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[_DATE2]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[_DATE2]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[NEWCODE]"
                          cachedDataType="wstr"
                          cachedLength="10"
                          cachedName="NEWCODE"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[NEWCODE]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[NEWCODE]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[REF]"
                          cachedDataType="wstr"
                          cachedLength="1"
                          cachedName="REF"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[REF]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[REF]" />
                        <inputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].Columns[CONDITION]"
                          cachedDataType="wstr"
                          cachedLength="31"
                          cachedName="CONDITION"
                          externalMetadataColumnId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[CONDITION]"
                          lineageId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;].Columns[CONDITION]" />
                      </inputColumns>
                      <externalMetadataColumns
                        isUsed="True">
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[MINCODE]"
                          dataType="wstr"
                          length="100"
                          name="MINCODE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[MAXCODE]"
                          dataType="wstr"
                          length="100"
                          name="MAXCODE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[CODE]"
                          dataType="wstr"
                          length="220"
                          name="CODE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[NAME]"
                          dataType="wstr"
                          length="800"
                          name="NAME" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[STAVKA2]"
                          dataType="wstr"
                          length="200"
                          name="STAVKA2" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[STAVKA3]"
                          dataType="wstr"
                          length="50"
                          name="STAVKA3" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[STAVKA4]"
                          dataType="wstr"
                          length="200"
                          name="STAVKA4" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[PRIM]"
                          dataType="wstr"
                          length="10"
                          name="PRIM" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[BASE]"
                          dataType="wstr"
                          length="10"
                          name="BASE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[PREF]"
                          dataType="wstr"
                          length="10"
                          name="PREF" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[ORDER]"
                          dataType="wstr"
                          length="80"
                          name="ORDER" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[ORDER2]"
                          dataType="wstr"
                          length="180"
                          name="ORDER2" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[_DATE1]"
                          dataType="wstr"
                          length="80"
                          name="_DATE1" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[_DATE2]"
                          dataType="wstr"
                          length="80"
                          name="_DATE2" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[NEWCODE]"
                          dataType="wstr"
                          length="100"
                          name="NEWCODE" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[REF]"
                          dataType="wstr"
                          length="10"
                          name="REF" />
                        <externalMetadataColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input].ExternalColumns[CONDITION]"
                          dataType="wstr"
                          length="310"
                          name="CONDITION" />
                      </externalMetadataColumns>
                    </input>
                  </inputs>
                  <outputs>
                    <output
                      refId="Package\Docs2SQL transformation\Load DBF\SQL.Outputs[ADO NET Destination Error Output]"
                      exclusionGroup="1"
                      isErrorOut="true"
                      name="ADO NET Destination Error Output"
                      synchronousInputId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input]">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Docs2SQL transformation\Load DBF\SQL.Outputs[ADO NET Destination Error Output].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Docs2SQL transformation\Load DBF\SQL.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Docs2SQL transformation\Load DBF\SQL.Outputs[ADO NET Destination Error Output].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
              <paths>
                <path
                  refId="Package\Docs2SQL transformation\Load DBF.Paths[Выход источника &quot;OLE DB&quot;]"
                  endId="Package\Docs2SQL transformation\Load DBF\SQL.Inputs[ADO NET Destination Input]"
                  name="Выход источника &quot;OLE DB&quot;"
                  startId="Package\Docs2SQL transformation\Load DBF\DBF.Outputs[Выход источника &quot;OLE DB&quot;]" />
              </paths>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\New contracts"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{A679B83A-7734-4EDF-8560-8A98BF4FEE64}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="New contracts"
          DTS:ThreadHint="7">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE automation.dbo.contracts;  &#xA;GO&#xA;&#xA;WITH cte AS (&#xA;SELECT [G141]&#xA;      ,[rn]&#xA;      ,[G4403]&#xA;      ,[G441]&#xA;      ,[G442]&#xA;      ,[G442R]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]&#xA;      ,[G442_PS]&#xA;      ,[G442_PS_DATE] &#xA;&#x9;  ,CASE &#xA;&#x9;&#x9;WHEN CHARINDEX('}\{', ED_ID) &lt;&gt; 0 THEN SUBSTRING(ED_ID, CHARINDEX('}\{', ED_ID) + 3, 36) &#xA;&#x9;&#x9;WHEN CHARINDEX('ARCHDOCID=', ED_ID) &lt;&gt; 0 THEN &#xA;&#x9;&#x9;(SELECT TOP (1) GID FROM gtd.dbo.Docs AS d WHERE d.ARCHDOCID = SUBSTRING(ED_ID, CHARINDEX('ARCHDOCID=', ED_ID) + 11, 36))&#xA;&#x9;&#x9;END AS GID&#xA;FROM&#xA;(&#xA;SELECT h.G141, ROW_NUMBER() OVER (PARTITION BY h.G141, ca1.G442, ca1.G443 ORDER BY h.GD1 DESC, h.GD11 DESC) AS rn, &#xA;ca1.G4403,&#xA;ca1.G441,&#xA;ca1.G442,&#xA;ca1.G442R,&#xA;ca1.G443,&#xA;ca1.G444,&#xA;ca1.ED_ID,&#xA;ca1.DocNum&#xA;FROM [Docs2SQL].[dbo].[DBRHEAD] h WITH (NOLOCK) &#xA;CROSS APPLY (SELECT TOP (1) td.G4403,&#xA;td.G441,&#xA;td.G442,&#xA;td.G442R,&#xA;td.G443,&#xA;td.G444,&#xA;td.ED_ID,&#xA;td.DocNum FROM [Docs2SQL].[dbo].DBRTECHD_FIXED_CONTRACT td WITH (NOLOCK)  WHERE h.DocNum = td.DocNum AND td.G441 = '03011' AND td.G32 = '1') AS ca1&#xA;) x&#xA;OUTER APPLY (SELECT TOP (1) G442 G442_PS, G443 G442_PS_DATE FROM [Docs2SQL].[dbo].[DBRTECHD] td WITH (NOLOCK) WHERE x.DocNum = td.DocNum AND td.G441 = '03031' AND td.G32 = '1') AS oa1 &#xA;WHERE rn = 1&#xA;),&#xA;&#xA;cte_joined_gtd AS (&#xA;&#x9;SELECT c.*, CASE WHEN d.GID IS NOT NULL THEN DATEDIFF(DD, d.MODDATE, GETDATE()) END AS moddate_diff&#xA;&#x9;FROM cte AS c&#xA;&#x9;LEFT JOIN gtd.dbo.Docs AS d ON c.GID = d.GID&#xA;)&#xA;&#xA;INSERT automation.dbo.contracts&#xA;([G141]&#xA;      ,[rn]&#xA;      ,[G4403]&#xA;      ,[G441]&#xA;      ,[G442]&#xA;      ,[G442R]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]&#xA;      ,[G442_PS]&#xA;      ,[G442_PS_DATE]&#xA;&#x9;  ,GID&#xA;&#x9;  ,moddate_diff)&#xA;&#xA;SELECT [G141]&#xA;      ,[rn]&#xA;      ,[G4403]&#xA;      ,[G441]&#xA;      ,[G442]&#xA;      ,[G442R]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]&#xA;      ,[G442_PS]&#xA;      ,[G442_PS_DATE]&#xA;&#x9;  ,GID&#xA;&#x9;  ,moddate_diff&#xA;&#xA;FROM cte_joined_gtd&#xA;GO" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\New HS Codes"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{E9F9F9A7-233D-490D-86AB-59B085D0C3FB}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="New HS Codes"
          DTS:ThreadHint="10">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE  [automation].[dbo].[import_tariff_new_codes]&#xA;GO&#xA;INSERT  [automation].[dbo].[import_tariff_new_codes] ([CODE])&#xA;&#xA;SELECT DISTINCT&#xA;LTRIM(RTRIM(i.CODE)) AS CODE&#xA;  FROM [automation].[dbo].[import_tariff_raw] AS i&#xA;  WHERE &#xA;  LEN(LTRIM(RTRIM(i.CODE))) = 10&#xA;  AND (_DATE2 IS NULL OR TRY_CONVERT(datetime, _DATE2, 4) &gt;= CAST(GETDATE() AS date))&#xA;  AND NOT EXISTS (&#xA;&#x9;SELECT 0 &#xA;&#x9;FROM [automation].[dbo].[basic_descriptions] AS b&#xA;&#x9;WHERE LTRIM(RTRIM(i.CODE)) = b.code&#xA;  )" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\New terminals"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{3CE70522-FA97-4744-B43E-A5AC4CB91CD1}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="New terminals"
          DTS:ThreadHint="8">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [automation].[dbo].[TERMINALS]&#xA;GO&#xA;INSERT INTO [automation].[dbo].[TERMINALS]&#xA;           ([NAV_CODE]&#xA;           ,[NLIC]&#xA;           ,[DBEGIN]&#xA;           ,[G30A]&#xA;           ,[G30AN]&#xA;           ,[G30SUBD]&#xA;           ,[G30CITY]&#xA;           ,[G30STREET]&#xA;           ,[G30BUILD]&#xA;           ,[G30LNAME]&#xA;           ,[G3012]&#xA;           ,[VAT]&#xA;&#x9;&#x9;   ,if_at_border_customs_name)&#xA;SELECT &#xA;w.code,&#xA;w.LIN,&#xA;CASE WHEN w.code = 'СВХЯРЦЕВО' THEN COALESCE(ca.G3011, '20141014') ELSE ca.G3011 END,&#xA;ca.G30A,&#xA;ca.G30AN,&#xA;ca.G30SUBD,&#xA;ca.G30CITY,&#xA;ca.G30STREET,&#xA;ca.G30BUILD,&#xA;ca.G30LNAME,&#xA;ca.G3012,&#xA;NULL,&#xA;ca.if_at_border_customs_name &#xA;FROM [BI].[dwh].[Warehouses] w WITH (NOLOCK)&#xA;  CROSS APPLY&#xA;  (SELECT TOP (1)&#xA;  h.[G30_ITN]&#xA; ,h.[G300]&#xA; ,h.[G3010]&#xA; ,h.[G30AEOOWN]&#xA; ,h.[G30AEOCNTR]&#xA; ,h.[G301]&#xA; ,h.[G30AEOKIND]&#xA; ,h.[G30AEORCOD]&#xA; ,h.[G3011]&#xA; ,h.[G30]&#xA; ,h.[G30D]&#xA; ,h.[G30DD]&#xA; ,h.[G30POST]&#xA; ,h.[G30A]&#xA; ,h.[G30AN]&#xA; ,h.[G30SUBD]&#xA; ,h.[G30CITY]&#xA; ,h.[G30STREET]&#xA; ,h.[G30BUILD]&#xA; ,h.[G30LNAME]&#xA; ,h.[G3012]&#xA; ,h.[G30121]&#xA; ,h.[G30122]&#xA; ,CASE WHEN h.[G3012] = oa_border.G29 THEN oa_border_customs.customs_name END AS if_at_border_customs_name&#xA;FROM Docs2SQL.[dbo].[DBRHEAD] h WITH (NOLOCK)&#xA;OUTER APPLY (&#xA;&#x9;SELECT TOP (1) * &#xA;&#x9;FROM [Docs2SQL].[dbo].[DBRTRANS] AS t &#xA;&#x9;WHERE t.DocNum = h.DocNum AND t.NGR = '29'&#xA;) AS oa_border&#xA;OUTER APPLY (&#xA;&#x9;SELECT TOP (1) * &#xA;&#x9;FROM [automation].[dbo].[customs_ref] AS cr&#xA;&#x9;WHERE cr.code = h.[G3012]&#xA;) AS oa_border_customs&#xA;WHERE w.LIN = h.G30&#xA;ORDER BY h.GD1 DESC, h.GD11 DESC) AS ca&#xA;WHERE COALESCE(w.LIN, '') &lt;&gt; ''" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Persistent files"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{D9CD83B1-8B65-4180-8267-DE2A20AD9A36}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Persistent files"
          DTS:ThreadHint="9">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE automation.dbo.persistent_files&#xA;GO&#xA;WITH cte_dirs AS (&#xA;&#x9;SELECT &#xA;&#x9;GID AS dir_gid &#x9;&#xA;&#x9;,CASE &#xA;&#x9;WHEN ISNUMERIC(LEFT(DOCKEY, 12)) = 1 THEN LEFT(DOCKEY, 12)&#xA;&#x9;WHEN ISNUMERIC(LEFT(DOCKEY, 10)) = 1 THEN LEFT(DOCKEY, 10)&#xA;&#x9;END AS VAT&#xA;&#x9;FROM gtd.dbo.docs WHERE PATHGID = '82216895-AC56-4A2E-BE50-6D830525ABEF'&#xA;),&#xA;&#xA;cte_files AS (&#xA;&#x9;SELECT&#xA;&#x9;&#x9;c.vat&#xA;&#x9;&#x9;,d.COMMENT&#xA;&#x9;&#x9;,d.PATHGID&#xA;&#x9;&#x9;,d.GID&#xA;&#x9;&#x9;,'*{' + CAST(d.PATHGID AS varchar(100)) + '}\{' + CAST(d.GID AS varchar(100)) + '}.' &#xA;&#x9;&#x9;+ CASE &#xA;&#x9;&#x9;WHEN d.DOCTYP = 'FreeBinaryDoc' THEN 'FRB' &#xA;&#x9;&#x9;WHEN d.DOCTYP = 'FreeDoc' THEN 'FRE' &#xA;&#x9;&#x9;END AS ED_ID&#xA;&#x9;FROM cte_dirs AS c&#xA;&#x9;JOIN gtd.dbo.docs AS d ON c.dir_gid = d.PATHGID&#xA;&#x9;WHERE d.DOCTYP IN ('FreeBinaryDoc','FreeDoc')&#xA;)&#xA;&#xA;INSERT automation.dbo.persistent_files&#xA;&#x9;([vat]&#xA;      ,[PATHGID]&#xA;      ,[GID]&#xA;      ,[ED_ID]&#xA;&#x9;  ,CODE&#xA;&#x9;  ,[DESCRIPTION])&#xA;SELECT [vat]&#xA;      ,[PATHGID]&#xA;      ,[GID]&#xA;      ,[ED_ID] &#xA;&#x9;  ,COALESCE(fbList.DocumentCode, fdocList.documentcode, '00000') AS CODE&#xA;&#x9;  ,COALESCE(fbList.DocumentInfo_PrDocumentName, fdocList.DocumentHead_DocumentName, '') AS [DESCRIPTION]&#xA;FROM cte_files&#xA;LEFT JOIN gtd.dbo.FreeBinaryDocList AS fbList ON fbList.docgid = GID&#xA;LEFT JOIN gtd.dbo.FreeDocList AS fdocList ON fdocList.docgid = GID&#xA;GO&#xA;UPDATE gtd.dbo.Docs&#xA;SET MODDATE = GETDATE()&#xA;WHERE GID IN (SELECT GID FROM automation.dbo.persistent_files)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Reg docs"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{B29F9860-D4DB-4FB7-9C29-641711DCC2B5}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Reg docs"
          DTS:ThreadHint="5">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE automation.dbo.regdocs;  &#xA;GO&#xA;WITH cte AS (&#xA;SELECT h.G141, t.*, &#xA;CASE &#xA;WHEN CHARINDEX('}\{', ED_ID) &lt;&gt; 0 THEN SUBSTRING(ED_ID, CHARINDEX('}\{', ED_ID) + 3, 36) &#xA;WHEN CHARINDEX('ARCHDOCID=', ED_ID) &lt;&gt; 0 THEN &#xA;(SELECT TOP (1) GID FROM gtd.dbo.Docs AS d WHERE d.ARCHDOCID = SUBSTRING(ED_ID, CHARINDEX('ARCHDOCID=', ED_ID) + 11, 36))&#xA;END AS GID,&#xA;DENSE_RANK() OVER (PARTITION BY h.G141 ORDER BY h.GD1 DESC, h.GD11 DESC, h.DocNum DESC) AS rownum&#xA;FROM [Docs2SQL].[dbo].[DBRHEAD] AS h WITH (NOLOCK)&#xA;JOIN [Docs2SQL].[dbo].[DBRTECHD] AS t WITH (NOLOCK)&#xA;ON t.DocNum = h.DocNum AND t.G32 = 1 AND &#xA;(t.G441 = '04011' OR t.G441 = '09011' OR (t.G441 IN ('10999','09999') AND (t.G444 LIKE '%СВИДЕТЕЛЬСТВО%ИНН%' OR t.G444 LIKE '%СВИДЕТЕЛЬСТВО%НАЛОГОВОМ%ОРГАНЕ%' )))&#xA;),&#xA;&#xA;cte_joined_gtd AS (&#xA;&#x9;SELECT c.*, CASE WHEN d.GID IS NOT NULL THEN DATEDIFF(DD, d.MODDATE, GETDATE()) END AS moddate_diff&#xA;&#x9;FROM cte AS c&#xA;&#x9;LEFT JOIN gtd.dbo.Docs AS d ON c.GID = d.GID&#xA;&#xA;)&#xA;&#xA;INSERT automation.dbo.regdocs&#xA;([G141]&#xA;      ,[G071]&#xA;      ,[G072]&#xA;      ,[G073]&#xA;      ,[G32]&#xA;      ,[G4401]&#xA;      ,[G4402]&#xA;      ,[G4403]&#xA;      ,[G44020]&#xA;      ,[G44_CUST]&#xA;      ,[G440]&#xA;      ,[G441]&#xA;      ,[G441A]&#xA;      ,[ID_BDRD]&#xA;      ,[PRSBDRD]&#xA;      ,[PREVNUMTYP]&#xA;      ,[PREVNUMDOC]&#xA;      ,[RECORDID]&#xA;      ,[EXECUTBODY]&#xA;      ,[EXECNAME]&#xA;      ,[INETURL]&#xA;      ,[G442]&#xA;      ,[G442LIC1]&#xA;      ,[G442LIC2]&#xA;      ,[G442R]&#xA;      ,[G442SIMP]&#xA;      ,[G44MDP1]&#xA;      ,[G44MDP2]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[G445]&#xA;      ,[G446]&#xA;      ,[G447]&#xA;      ,[G4480ET]&#xA;      ,[G4481ET]&#xA;      ,[G44STPER]&#xA;      ,[G44SFCNTRY]&#xA;      ,[G44ALLDOC]&#xA;      ,[G4491]&#xA;      ,[G4492]&#xA;      ,[G4493]&#xA;      ,[G44DD]&#xA;      ,[NZP]&#xA;      ,[DMODIFY]&#xA;      ,[TMODIFY]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]&#xA;      ,[rownum]&#xA;&#x9;  ,GID&#xA;&#x9;  ,moddate_diff&#xA;)&#xA;&#xA;SELECT [G141]&#xA;      ,[G071]&#xA;      ,[G072]&#xA;      ,[G073]&#xA;      ,[G32]&#xA;      ,[G4401]&#xA;      ,[G4402]&#xA;      ,[G4403]&#xA;      ,[G44020]&#xA;      ,[G44_CUST]&#xA;      ,[G440]&#xA;      ,[G441]&#xA;      ,[G441A]&#xA;      ,[ID_BDRD]&#xA;      ,[PRSBDRD]&#xA;      ,[PREVNUMTYP]&#xA;      ,[PREVNUMDOC]&#xA;      ,[RECORDID]&#xA;      ,[EXECUTBODY]&#xA;      ,[EXECNAME]&#xA;      ,[INETURL]&#xA;      ,[G442]&#xA;      ,[G442LIC1]&#xA;      ,[G442LIC2]&#xA;      ,[G442R]&#xA;      ,[G442SIMP]&#xA;      ,[G44MDP1]&#xA;      ,[G44MDP2]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[G445]&#xA;      ,[G446]&#xA;      ,[G447]&#xA;      ,[G4480ET]&#xA;      ,[G4481ET]&#xA;      ,[G44STPER]&#xA;      ,[G44SFCNTRY]&#xA;      ,[G44ALLDOC]&#xA;      ,[G4491]&#xA;      ,[G4492]&#xA;      ,[G4493]&#xA;      ,[G44DD]&#xA;      ,[NZP]&#xA;      ,[DMODIFY]&#xA;      ,[TMODIFY]&#xA;      ,[ED_ID]&#xA;      ,[DocNum]&#xA;      ,[rownum]&#xA;&#x9;  ,GID&#xA;&#x9;  ,moddate_diff&#xA;&#xA;FROM cte_joined_gtd&#xA;WHERE rownum = 1" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Specs"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{77C4863C-6201-474B-A9B2-DB74290AEDF6}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Specs"
          DTS:ThreadHint="11">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE automation.dbo.contract_specifications;  &#xA;GO&#xA;WITH cte_contracts AS (&#xA;&#x9;SELECT h.DocNum, h.G141, td.G442, td.G443,&#xA;&#x9;ROW_NUMBER() OVER (PARTITION BY h.G141, td.G442, td.G443 ORDER BY h.GD1 DESC, h.GD11 DESC) AS order_dt_contract &#xA;&#x9;FROM [Docs2SQL].[dbo].[DBRHEAD] h WITH (NOLOCK) &#xA;&#x9;JOIN [Docs2SQL].[dbo].[DBRTECHD_FIXED_CONTRACT] td WITH (NOLOCK)  &#xA;&#x9;ON h.DocNum = td.DocNum AND td.G441 = '03011' AND td.G32 = '1'&#xA;),&#xA;&#xA;cte_final AS (&#xA;SELECT &#xA;&#x9;h.G141, &#xA;&#x9;order_dt_contract, &#xA;&#x9;h.[G442] AS contract_num, &#xA;&#x9;h.G443 AS contract_date, &#xA;&#x9;t.*&#xA;&#x9;FROM cte_contracts AS h WITH (NOLOCK)&#xA;&#x9;JOIN Docs2SQL.[dbo].[DBRTECHD] AS t WITH (NOLOCK)&#xA;&#x9;ON h.DocNum = t.DocNum AND t.G441 = '03012' AND t.G32 = '1'&#xA;&#x9;WHERE t.G444 LIKE '%СПЕЦИФ%' AND t.ED_ID IS NOT NULL&#xA;)&#xA;&#xA;INSERT automation.dbo.contract_specifications &#xA;([G141]&#xA;      ,[order_dt_contract]&#xA;      ,[contract_num]&#xA;      ,[contract_date]&#xA;      ,[G071]&#xA;      ,[G072]&#xA;      ,[G073]&#xA;      ,[G32]&#xA;      ,[G4401]&#xA;      ,[G4402]&#xA;      ,[G4403]&#xA;      ,[G44020]&#xA;      ,[G44_CUST]&#xA;      ,[G440]&#xA;      ,[G441]&#xA;      ,[G441A]&#xA;      ,[ID_BDRD]&#xA;      ,[PRSBDRD]&#xA;      ,[PREVNUMTYP]&#xA;      ,[PREVNUMDOC]&#xA;      ,[RECORDID]&#xA;      ,[EXECUTBODY]&#xA;      ,[EXECNAME]&#xA;      ,[INETURL]&#xA;      ,[G442]&#xA;      ,[G442LIC1]&#xA;      ,[G442LIC2]&#xA;      ,[G442R]&#xA;      ,[G442SIMP]&#xA;      ,[G44MDP1]&#xA;      ,[G44MDP2]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[G445]&#xA;      ,[G446]&#xA;      ,[G447]&#xA;      ,[G4480ET]&#xA;      ,[G4481ET]&#xA;      ,[G44STPER]&#xA;      ,[G44SFCNTRY]&#xA;      ,[G44ALLDOC]&#xA;      ,[G4491]&#xA;      ,[G4492]&#xA;      ,[G4493]&#xA;      ,[G44DD]&#xA;      ,[NZP]&#xA;      ,[DMODIFY]&#xA;      ,[TMODIFY]&#xA;      ,[ED_ID]&#xA;      ,[DocNum])&#xA;SELECT [G141]&#xA;      ,[order_dt_contract]&#xA;      ,[contract_num]&#xA;      ,[contract_date]&#xA;      ,[G071]&#xA;      ,[G072]&#xA;      ,[G073]&#xA;      ,[G32]&#xA;      ,[G4401]&#xA;      ,[G4402]&#xA;      ,[G4403]&#xA;      ,[G44020]&#xA;      ,[G44_CUST]&#xA;      ,[G440]&#xA;      ,[G441]&#xA;      ,[G441A]&#xA;      ,[ID_BDRD]&#xA;      ,[PRSBDRD]&#xA;      ,[PREVNUMTYP]&#xA;      ,[PREVNUMDOC]&#xA;      ,[RECORDID]&#xA;      ,[EXECUTBODY]&#xA;      ,[EXECNAME]&#xA;      ,[INETURL]&#xA;      ,[G442]&#xA;      ,[G442LIC1]&#xA;      ,[G442LIC2]&#xA;      ,[G442R]&#xA;      ,[G442SIMP]&#xA;      ,[G44MDP1]&#xA;      ,[G44MDP2]&#xA;      ,[G443]&#xA;      ,[G444]&#xA;      ,[G445]&#xA;      ,[G446]&#xA;      ,[G447]&#xA;      ,[G4480ET]&#xA;      ,[G4481ET]&#xA;      ,[G44STPER]&#xA;      ,[G44SFCNTRY]&#xA;      ,[G44ALLDOC]&#xA;      ,[G4491]&#xA;      ,[G4492]&#xA;      ,[G4493]&#xA;      ,[G44DD]&#xA;      ,[NZP]&#xA;      ,[DMODIFY]&#xA;      ,[TMODIFY]&#xA;      ,[ED_ID]&#xA;      ,[DocNum] &#xA;FROM cte_final" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Tariff (incorrect)"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:Disabled="True"
          DTS:DTSID="{3fee1f3c-80cf-412e-b767-00af4b5968c5}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Tariff (incorrect)"
          DTS:ThreadHint="12">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="INSERT INTO [automation].[dbo].[import_tariff]&#xA;           ([code]&#xA;           ,[base_percent_value]&#xA;           ,[base_spec_value]&#xA;           ,[base_spec_currency]&#xA;           ,[base_spec_unit]&#xA;           ,[min_spec_value]&#xA;           ,[min_spec_currency]&#xA;           ,[min_spec_unit])&#xA;SELECT &#xA;CODE code,&#xA;&#xA;CASE &#xA;WHEN CHARINDEX('%', STAVKA2) &gt; 0&#xA;THEN CONVERT(money, SUBSTRING(STAVKA2, 1, CHARINDEX('%', STAVKA2) - 1))&#xA;ELSE NULL&#xA;END base_percent_value,&#xA;&#xA;CASE&#xA;WHEN CHARINDEX('/', STAVKA2) &gt; 0&#xA;THEN &#xA; CASE&#xA; WHEN CHARINDEX('+', STAVKA2) &gt; 0&#xA; THEN CONVERT(money, SUBSTRING(STAVKA2, CHARINDEX('+', STAVKA2) + 1, PATINDEX('%[^0-9.]%', SUBSTRING(STAVKA2, CHARINDEX('+', STAVKA2) + 1, LEN(STAVKA2))) - 1))&#xA; ELSE CONVERT(money, SUBSTRING(STAVKA2, 1, PATINDEX('%[^0-9.]%', STAVKA2) - 1))&#xA; END&#xA;ELSE NULL&#xA;END base_spec_value,&#xA;&#xA;CASE&#xA;WHEN CHARINDEX('ДОЛ', STAVKA2) &gt; 0 THEN 'USD'&#xA;WHEN CHARINDEX('ЕВР', STAVKA2) &gt; 0 THEN 'EUR'&#xA;ELSE NULL&#xA;END base_spec_currency,&#xA;&#xA;CASE&#xA;WHEN CHARINDEX('/ПАРУ', STAVKA2) &gt; 0 THEN '715'&#xA;WHEN CHARINDEX('/КВТ', STAVKA2) &gt; 0 THEN '214'&#xA;WHEN CHARINDEX('/ТШТ', STAVKA2) &gt; 0 THEN '798'&#xA;WHEN CHARINDEX('/ШТ', STAVKA2) &gt; 0 THEN '796'&#xA;WHEN CHARINDEX('/КГ', STAVKA2) &gt; 0 THEN '166'&#xA;WHEN CHARINDEX('/СМ3', STAVKA2) &gt; 0 THEN '111'&#xA;WHEN CHARINDEX('/Л', STAVKA2) &gt; 0 THEN '112'&#xA;WHEN CHARINDEX('/М', STAVKA2) &gt; 0 THEN '006'&#xA;WHEN CHARINDEX('/Т', STAVKA2) &gt; 0 THEN '168'&#xA;ELSE NULL&#xA;END base_spec_unit,&#xA;&#xA;CASE&#xA;WHEN CHARINDEX('/', STAVKA4) &gt; 0&#xA;THEN CONVERT(money, SUBSTRING(STAVKA4, 1, PATINDEX('%[^0-9.]%', STAVKA4) - 1))&#xA;ELSE NULL&#xA;END min_spec_value,&#xA;&#xA;CASE&#xA;WHEN CHARINDEX('ДОЛ', STAVKA4) &gt; 0 THEN 'USD'&#xA;WHEN CHARINDEX('ЕВР', STAVKA4) &gt; 0 THEN 'EUR'&#xA;ELSE NULL&#xA;END min_spec_currency,&#xA;&#xA;CASE&#xA;WHEN CHARINDEX('/ПАРУ', STAVKA4) &gt; 0 THEN '715'&#xA;WHEN CHARINDEX('/КВТ', STAVKA4) &gt; 0 THEN '214'&#xA;WHEN CHARINDEX('/ТШТ', STAVKA4) &gt; 0 THEN '798'&#xA;WHEN CHARINDEX('/ШТ', STAVKA4) &gt; 0 THEN '796'&#xA;WHEN CHARINDEX('/КГ', STAVKA4) &gt; 0 THEN '166'&#xA;WHEN CHARINDEX('/СМ3', STAVKA4) &gt; 0 THEN '111'&#xA;WHEN CHARINDEX('/Л', STAVKA4) &gt; 0 THEN '112'&#xA;WHEN CHARINDEX('/М', STAVKA4) &gt; 0 THEN '006'&#xA;WHEN CHARINDEX('/Т', STAVKA4) &gt; 0 THEN '168'&#xA;ELSE NULL&#xA;END min_spec_unit&#xA;&#xA;FROM (&#xA;SELECT [CODE], [STAVKA2], [STAVKA4] FROM &#xA;(SELECT REPLACE([CODE], ' ', '') [CODE]&#xA;      ,IIF([STAVKA2] = '0', '0%', UPPER(REPLACE([STAVKA2], ' ', ''))) [STAVKA2]     &#xA;      ,UPPER(REPLACE([STAVKA4], ' ', '')) [STAVKA4]  &#xA;   ,ROW_NUMBER() OVER (PARTITION BY CODE ORDER BY CONVERT(datetime, _DATE1, 4) DESC) rn&#xA;FROM [automation].[dbo].[import_tariff_raw]&#xA;WHERE LEN(code) = 10 AND [STAVKA2]  &lt;&gt; 'Б/ПОШЛ') x&#xA;WHERE x.rn = 1) y" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Docs2SQL transformation\Truncate tariff"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{05fa4864-80cd-4990-b77e-24f60868b878}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Truncate tariff"
          DTS:ThreadHint="10">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{9FEB3277-5F6F-47B9-86DD-F48ABBDA0231}"
              SQLTask:SqlStatementSource="TRUNCATE TABLE [automation].[dbo].[import_tariff]&#xA;TRUNCATE TABLE [automation].[dbo].[import_tariff_raw]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Docs2SQL transformation.PrecedenceConstraints[Ограничение]"
          DTS:CreationName=""
          DTS:DTSID="{6D660CD4-A030-4009-A18F-7F20BA2F90C8}"
          DTS:From="Package\Docs2SQL transformation\Load DBF"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение"
          DTS:To="Package\Docs2SQL transformation\Tariff (incorrect)" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Docs2SQL transformation.PrecedenceConstraints[Ограничение 1]"
          DTS:CreationName=""
          DTS:DTSID="{0F740AF7-B2B4-469D-90AD-BE224384E655}"
          DTS:From="Package\Docs2SQL transformation\Load DBF"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 1"
          DTS:To="Package\Docs2SQL transformation\New HS Codes" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Docs2SQL transformation.PrecedenceConstraints[Ограничение 8]"
          DTS:CreationName=""
          DTS:DTSID="{d799e8ab-1459-4032-8dff-2555c8d67d8e}"
          DTS:From="Package\Docs2SQL transformation\Truncate tariff"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Ограничение 8"
          DTS:To="Package\Docs2SQL transformation\Load DBF" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--В данном разделе CDATA содержатся сведения о макете пакета. В данном разделе содержатся сведения о координатах (x,y), ширине и высоте.-->
<!--В случае возникновения ошибки при редактировании этого раздела вручную его можно удалить. -->
<!--Пакет можно загрузить обычным образом, но прежние сведения о макете будут утеряны, и конструктор автоматически перераспределит элементы в области конструктора.-->
<Objects
  Version="8">
  <!--Все приведенные ниже узлы будут содержать свойства, не влияющие на поведение среды выполнения.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="148,42"
          Id="Package\Currency rates"
          TopLeft="222.25,33.25" />
        <NodeLayout
          Size="156,42"
          Id="Package\Docs2SQL transformation\Broker contracts"
          TopLeft="406,373" />
        <NodeLayout
          Size="139,42"
          Id="Package\Docs2SQL transformation\Contract add"
          TopLeft="593,437" />
        <NodeLayout
          Size="129,42"
          Id="Package\Docs2SQL transformation\Declarants"
          TopLeft="235,367" />
        <NodeLayout
          Size="136,42"
          Id="Package\Docs2SQL transformation\Descriptions"
          TopLeft="231,428" />
        <NodeLayout
          Size="148,42"
          Id="Package\Docs2SQL transformation\Extended docs"
          TopLeft="409,438" />
        <NodeLayout
          Size="146,42"
          Id="Package\Docs2SQL transformation\New contracts"
          TopLeft="589,312" />
        <NodeLayout
          Size="146,42"
          Id="Package\Docs2SQL transformation\New terminals"
          TopLeft="223,493" />
        <NodeLayout
          Size="147,42"
          Id="Package\Docs2SQL transformation\Persistent files"
          TopLeft="229,306" />
        <NodeLayout
          Size="122,42"
          Id="Package\Docs2SQL transformation\Reg docs"
          TopLeft="417,307" />
        <NodeLayout
          Size="106,42"
          Id="Package\Docs2SQL transformation\Specs"
          TopLeft="597,371" />
        <NodeLayout
          Size="146,42"
          Id="Package\Docs2SQL transformation\Truncate tariff"
          TopLeft="49.5,25.5" />
        <NodeLayout
          Size="124,42"
          Id="Package\Docs2SQL transformation\Load DBF"
          TopLeft="58.5,121.5" />
        <NodeLayout
          Size="156,42"
          Id="Package\Docs2SQL transformation\Tariff (incorrect)"
          TopLeft="44.5,213.5" />
        <EdgeLayout
          Id="Package\Docs2SQL transformation.PrecedenceConstraints[Ограничение 8]"
          TopLeft="121.5,67.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,54"
              Start="0,0"
              End="0,46.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,46.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Docs2SQL transformation.PrecedenceConstraints[Ограничение]"
          TopLeft="121.5,163.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,50"
              Start="0,0"
              End="0,42.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,42.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="148,42"
          Id="Package\Docs2SQL transformation\New HS Codes"
          TopLeft="228,119" />
        <EdgeLayout
          Id="Package\Docs2SQL transformation.PrecedenceConstraints[Ограничение 1]"
          TopLeft="182.5,141.25">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="45.5,0"
              Start="0,0"
              End="38,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="38,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="742,590"
          Size="742,633"
          Id="Package\Docs2SQL transformation"
          TopLeft="37.9999999999999,114.75" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Docs2SQL transformation\Load DBF">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="98,42"
          Id="Package\Docs2SQL transformation\Load DBF\SQL"
          TopLeft="343,216" />
        <NodeLayout
          Size="98,42"
          Id="Package\Docs2SQL transformation\Load DBF\DBF"
          TopLeft="349,139" />
        <EdgeLayout
          Id="Package\Docs2SQL transformation\Load DBF.Paths[Выход источника &quot;OLE DB&quot;]"
          TopLeft="395,181">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,35"
              Start="0,0"
              End="0,27.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,27.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Docs2SQL transformation\Load DBF\DBF">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Docs2SQL transformation\Load DBF\SQL">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>